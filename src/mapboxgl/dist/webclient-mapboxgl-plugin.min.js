(function(e){var t={};function r(i){if(t[i]){return t[i].exports}var n=t[i]={i:i,l:false,exports:{}};e[i].call(n.exports,n,n.exports,r);n.l=true;return n.exports}r.m=e;r.c=t;r.d=function(e,t,i){if(!r.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:i})}};r.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};r.t=function(e,t){if(t&1)e=r(e);if(t&8)return e;if(t&4&&typeof e==="object"&&e&&e.__esModule)return e;var i=Object.create(null);r.r(i);Object.defineProperty(i,"default",{enumerable:true,value:e});if(t&2&&typeof e!="string")for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i};r.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};r.d(t,"a",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="";return r(r.s=220)})([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=window.Zondy=window.Zondy||{};i.Event=i.Event||{};i.Object=i.Object||{};i.Object.ContourAnalyse=i.Object.ContourAnalyse||{};i.Object.Theme=i.Object.Theme||{};i.Service=i.Service||{};i.Socket=i.Socket||{};i.Enum=i.Enum||{};i.Enum.Net=i.Enum.Net||{};i.Enum.Theme=i.Enum.Theme||{};i.Enum.Map=i.Enum.Map||{};i.Catalog=i.Catalog||{};i.Util=i.Util||{};i.CRS=i.CRS||{};i.Map=i.Map||{};i.xsd=i.xsd||{};i.XLink=i.XLink||{};i.extent=i.extent||{};i.xml=i.xml||{};i.array=i.array||{};i.string=i.string||{};i.LevelRenderer=i.LevelRenderer||{};i.LevelRenderer.Tool=i.LevelRenderer.Tool||{};i.LevelRenderer.Animation=i.LevelRenderer.Animation||{};i.Feature=i.Feature||{};i.Feature.ShapeParameters=i.Feature.ShapeParameters||{};i.Geometry=i.Geometry||{};i.Client=i.Client||{};i.Source=i.Source||{};i.GeomInteraction=i.GeomInteraction||{};i.Format=i.Format||{};i.Control=i.Control||{};i.OGC=i.OGC||{};t.Zondy=i},function(e,t,r){"use strict";t.__esModule=true;t.default=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}},function(e,t,r){e.exports={default:r(254),__esModule:true}},function(e,t,r){"use strict";t.__esModule=true;var i=r(18);var n=a(i);function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&((typeof t==="undefined"?"undefined":(0,n.default)(t))==="object"||typeof t==="function")?t:e}},function(e,t,r){"use strict";t.__esModule=true;var i=r(293);var n=u(i);var a=r(85);var o=u(a);var s=r(18);var l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof t==="undefined"?"undefined":(0,l.default)(t)))}e.prototype=(0,o.default)(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)n.default?(0,n.default)(e,t):e.__proto__=t}},function(e,t,r){"use strict";t.__esModule=true;var i=r(56);var n=a(i);function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;(0,n.default)(e,i.key,i)}}return function(t,r,i){if(r)e(t.prototype,r);if(i)e(t,i);return t}}()},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createCanvasContext2D=exports.mixin=exports.merge=exports.DeepMerge=exports.ChineseToUtf8=exports.getTopAnalysisResult=exports.bindAsEventListener=exports.bind=exports.newGuid=exports.cloneObject=exports.copyAttributesWithClip=exports.copyAttributes=exports.transformResult=exports.toJSON=exports.isInTheSameDomain=exports.supportCanvas=exports.isSupportCanvas=exports.getBrowser=exports.Browser=exports.IS_GECKO=exports.getParameters=exports.urlAppend=exports.getWFParameterString=exports.getParameterString=exports.applyDefaults=exports.modifyDOMElement=exports.indexOf=exports.removeItem=exports.isElement=exports.getElement=exports.reset=exports.copyExcluce=exports.copy=exports.extendDeep=exports.isArray=exports.extend=undefined;var _defineProperty=__webpack_require__(56);var _defineProperty2=_interopRequireDefault(_defineProperty);var _getOwnPropertyDescriptor=__webpack_require__(81);var _getOwnPropertyDescriptor2=_interopRequireDefault(_getOwnPropertyDescriptor);var _getOwnPropertySymbols=__webpack_require__(280);var _getOwnPropertySymbols2=_interopRequireDefault(_getOwnPropertySymbols);var _getOwnPropertyNames=__webpack_require__(84);var _getOwnPropertyNames2=_interopRequireDefault(_getOwnPropertyNames);var _classCallCheck2=__webpack_require__(1);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _typeof2=__webpack_require__(18);var _typeof3=_interopRequireDefault(_typeof2);var _Base=__webpack_require__(0);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var extend=function e(t,r){t=t||{};if(r){for(var i in r){var n=r[i];if(n!==undefined){t[i]=n}}var a=typeof window.Event==="function"&&r instanceof window.Event;if(!a&&r.hasOwnProperty&&r.hasOwnProperty("toString")){t.toString=r.toString}}return t};var isArray=function e(t){return Object.prototype.toString.call(t)==="[object Array]"};var extendDeep=function e(t,r){var i,n=Object.prototype.toString,a="[object Array]";t=t||{};for(i in r){if(r.hasOwnProperty(i)){if((0,_typeof3.default)(r[i])==="object"){if(n.call(t[i])==="[object Null]"||n.call(t[i])==="[object Undefined]"){t[i]=n.call(r[i])===a?[]:{}}e(t[i],r[i])}else{t[i]=r[i]}if(r[i]===""||r[i]===null){t[i]=r[i]}}}return t};var copy=function e(t,r){t=t||{};var i;if(r){for(var n in t){i=r[n];if(typeof i!=="undefined"){t[n]=i}}}};var copyExcluce=function e(t,r,i){t=t||{};var n;if(r){for(var a in r){n=r[a];if(typeof n!=="undefined"&&typeof n!=="function"){if(i.indexOf(a)<0){t[a]=n}}}}};var reset=function e(t){t=t||{};for(var r in t){if(t.hasOwnProperty(r)){if((0,_typeof3.default)(t[r])==="object"&&t[r]instanceof Array){for(var i in t[r]){if(t[r][i].destroy){t[r][i].destroy()}}t[r].length=0}else if((0,_typeof3.default)(t[r])==="object"&&t[r]instanceof Object){if(t[r].destroy){t[r].destroy()}}t[r]=null}}};var getElement=function e(){var t=[];for(var r=0,i=arguments.length;r<i;r++){var n=arguments[r];if(typeof n==="string"){n=document.getElementById(n)}if(arguments.length===1){return n}t.push(n)}return t};var isElement=function e(t){return!!(t&&t.nodeType===1)};var removeItem=function e(t,r){for(var i=t.length-1;i>=0;i--){if(t[i]===r){t.splice(i,1)}}return t};var indexOf=function e(t,r){if(t==null){return-1}else{if(typeof t.indexOf==="function"){return t.indexOf(r)}else{for(var i=0,n=t.length;i<n;i++){if(t[i]===r){return i}}return-1}}};var modifyDOMElement=function e(t,r,i,n,a,o,s,l){if(r){t.id=r}if(i){t.style.left=i.x+"px";t.style.top=i.y+"px"}if(n){t.style.width=n.w+"px";t.style.height=n.h+"px"}if(a){t.style.position=a}if(o){t.style.border=o}if(s){t.style.overflow=s}if(parseFloat(l)>=0&&parseFloat(l)<1){t.style.filter="alpha(opacity="+l*100+")";t.style.opacity=l}else if(parseFloat(l)===1){t.style.filter="";t.style.opacity=""}};var applyDefaults=function e(t,r){t=t||{};var i=typeof window.Event==="function"&&r instanceof window.Event;for(var n in r){if(t[n]===undefined||!i&&r.hasOwnProperty&&r.hasOwnProperty(n)&&!t.hasOwnProperty(n)){t[n]=r[n]}}if(!i&&r&&r.hasOwnProperty&&r.hasOwnProperty("toString")&&!t.hasOwnProperty("toString")){t.toString=r.toString}return t};var getParameterString=function e(t){var r=[];for(var i in t){var n=t[i];if(n!=null&&typeof n!=="function"){var a;if((typeof n==="undefined"?"undefined":(0,_typeof3.default)(n))==="object"&&n.constructor===Array){var o=[];var s;for(var l=0,u=n.length;l<u;l++){s=n[l];o.push(encodeURIComponent(s===null||s===undefined?"":s))}a=o.join(",")}else{a=encodeURIComponent(n)}r.push(encodeURIComponent(i)+"="+a)}}return r.join("&")};var getWFParameterString=function e(t){var r=[];for(var i in t){var n=t[i];if(n!=null&&typeof n!=="function"){var a;if((typeof n==="undefined"?"undefined":(0,_typeof3.default)(n))==="object"&&n.constructor===Array){var o=[];var s;for(var l=0,u=n.length;l<u;l++){s=n[l];o.push(encodeURIComponent(s===null||s===undefined?"":s))}a=o.join(",")}else{a=encodeURIComponent(n)}r.push(encodeURIComponent(i)+":"+a)}}return r.join(";")};var urlAppend=function e(t,r){var i=t;if(r){var n=(t+" ").split(/[?&]/);i+=n.pop()===" "?r:n.length?"&"+r:"?"+r}return i};var getParameters=function e(t){t=t===null||t===undefined?window.location.href:t;var r="";if(t.indexOf("?")>-1){var i=t.indexOf("?")+1;t.indexOf("#")>-1;var n=t.indexOf("#")>-1?t.indexOf("#"):t.length;r=t.substring(i,n)}var a={};var o=r.split(/[&;]/);for(var s=0,l=o.length;s<l;++s){var u=o[s].split("=");if(u[0]){var f=u[0];try{f=decodeURIComponent(f)}catch(e){f=unescape(f)}var c=(u[1]||"").replace(/\+/g," ");try{c=decodeURIComponent(c)}catch(e){c=unescape(c)}c=c.split(",");if(c.length==1){c=c[0]}a[f]=c}}return a};var IS_GECKO=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("webkit")===-1&&e.indexOf("gecko")!==-1}();var Browser=function(){var e="",t="",r="pc",i;var n=navigator.userAgent.toLowerCase();if(n.indexOf("msie")>-1||n.indexOf("trident")>-1&&n.indexOf("rv")>-1){e="msie";i=n.match(/msie ([\d.]+)/)||n.match(/rv:([\d.]+)/)}else if(n.indexOf("chrome")>-1){e="chrome";i=n.match(/chrome\/([\d.]+)/)}else if(n.indexOf("firefox")>-1){e="firefox";i=n.match(/firefox\/([\d.]+)/)}else if(n.indexOf("opera")>-1){e="opera";i=n.match(/version\/([\d.]+)/)}else if(n.indexOf("safari")>-1){e="safari";i=n.match(/version\/([\d.]+)/)}t=i?i[1]:"";if(n.indexOf("ipad")>-1||n.indexOf("ipod")>-1||n.indexOf("iphone")>-1){r="apple"}else if(n.indexOf("android")>-1){i=n.match(/version\/([\d.]+)/);t=i?i[1]:"";r="android"}return{name:e,version:t,device:r}}();var getBrowser=function e(){return Browser};var isSupportCanvas=function(){var e=true,t=getBrowser();if(document.createElement("canvas").getContext){if(t.name==="firefox"&&parseFloat(t.version)<5){e=false}if(t.name==="safari"&&parseFloat(t.version)<4){e=false}if(t.name==="opera"&&parseFloat(t.version)<10){e=false}if(t.name==="msie"&&parseFloat(t.version)<9){e=false}}else{e=false}return e}();var supportCanvas=function e(){return isSupportCanvas};var isInTheSameDomain=function e(t){if(!t){return true}var r=t.indexOf("//");var i=document.location.toString();var n=i.indexOf("//");if(r===-1){return true}else{var a;var o=a=t.substring(0,r);var s=i.substring(n+2);n=s.indexOf("/");var l=s.indexOf(":");var u=s.substring(0,n);var f=document.location.protocol;if(l!==-1){}else{u+=":"+(f.toLowerCase()==="http:"?80:443)}if(f.toLowerCase()!==o.toLowerCase()){return false}o=t.substring(r+2);var c=o.indexOf(":");r=o.indexOf("/");var h=o.substring(0,r);var p;if(c!==-1){p=o.substring(0,c)}else{p=o.substring(0,r);h+=":"+(a.toLowerCase()==="http:"?80:443)}var d=document.domain;if(p===d&&h===u){return true}}return false};var toJSON=function e(t){var r=t;if(r==null){return null}switch(r.constructor){case String:r='"'+r.replace(/(["\\])/g,"\\$1")+'"';r=r.replace(/\n/g,"\\n");r=r.replace(/\r/g,"\\r");r=r.replace("<","&lt;");r=r.replace(">","&gt;");r=r.replace(/%/g,"%25");r=r.replace(/&/g,"%26");return r;case Array:var i=[];for(var n=0,a=r.length;n<a;n++){i.push(e(r[n]))}return"["+i.join(",")+"]";case Number:return isFinite(r)?String(r):null;case Boolean:return String(r);case Date:var o="{"+"'__type':\"System.DateTime\","+"'Year':"+r.getFullYear()+","+"'Month':"+(r.getMonth()+1)+","+"'Day':"+r.getDate()+","+"'Hour':"+r.getHours()+","+"'Minute':"+r.getMinutes()+","+"'Second':"+r.getSeconds()+","+"'Millisecond':"+r.getMilliseconds()+","+"'TimezoneOffset':"+r.getTimezoneOffset()+"}";return o;default:if((typeof r==="undefined"?"undefined":(0,_typeof3.default)(r))==="object"){if(r.length){var i=[];for(var n=0,a=r.length;n<a;n++){i.push(e(r[n]))}return"["+i.join(",")+"]"}var s=[];for(var l in r){if(typeof r[l]!=="function"&&l!=="CLASS_NAME"){s.push("'"+l+"':"+e(r[l]))}}if(s.length>0){return"{"+s.join(",")+"}"}else{return"{}"}}return r.toString()}};var transformResult=function e(t){if(t.responseText&&typeof t.responseText==="string"){t=JSON.parse(t.responseText)}return t};var copyAttributes=function e(t,r){t=t||{};if(r){for(var i in r){var n=r[i];if(n!==undefined&&i!=="CLASS_NAME"&&typeof n!=="function"){t[i]=n}}}return t};var copyAttributesWithClip=function e(t,r,i){t=t||{};if(r){for(var n in r){var a=false;if(i&&i.length){for(var o=0,s=i.length;o<s;o++){if(n===i[o]){a=true;break}}}if(a===true){continue}var l=r[n];if(l!==undefined&&n!=="CLASS_NAME"&&typeof l!=="function"){t[n]=l}}}return t};var cloneObject=function e(t){if(null===t||"object"!==(typeof t==="undefined"?"undefined":(0,_typeof3.default)(t))){return t}if(t instanceof Date){var r=new Date;r.setTime(t.getTime());return r}if(t instanceof Array){var r=t.slice(0);return r}if(t instanceof Object){var r={};for(var i in t){if(t.hasOwnProperty(i)){r[i]=e(t[i])}}return r}throw new Error("Unable to copy obj! Its type isn't supported.")};var newGuid=function e(){var t="";for(var r=1;r<=32;r++){var i=Math.floor(Math.random()*16).toString(16);t+=i;if(r==8||r==12||r==16||r==20)t+="-"}return t};var bind=function e(t,r){var i=Array.prototype.slice.apply(arguments,[2]);return function(){var e=i.concat(Array.prototype.slice.apply(arguments,[0]));return t.apply(r,e)}};var bindAsEventListener=function e(t,r){return function(e){return t.call(r,e||window.event)}};var getTopAnalysisResult=function e(t){var r=t.value;switch(r){case 0:return"Intersect";case 1:return"Disjoin";case 2:return"Include";case 3:return"Adjacent";default:return"Unknown"}};var ChineseToUtf8=function e(t){return t.replace(/([\u4E00-\u9FA5]|[\uFE30-\uFFA0])/g,function(e){return EncodeUtf8(e)})};var EncodeUtf8=function e(t){var r=escape(t);var i=r.split("%");var n="";if(i[0]!=""){n=i[0]}for(var a=1;a<i.length;a++){if(i[a].substring(0,1)=="u"){n+=Hex2Utf8(Str2Hex(i[a].substring(1,5)))}else n+="%"+i[a]}return n};var Str2Hex=function Str2Hex(s){var c="";var n;var ss="0123456789ABCDEF";var digS="";for(var i=0;i<s.length;i++){c=s.charAt(i);n=ss.indexOf(c);digS+=Dec2Dig(eval(n))}return digS};var Hex2Utf8=function Hex2Utf8(s){var retS="";var tempS="";var ss="";if(s.length==16){tempS="1110"+s.substring(0,4);tempS+="10"+s.substring(4,10);tempS+="10"+s.substring(10,16);var sss="0123456789ABCDEF";for(var i=0;i<3;i++){retS+="%";ss=tempS.substring(i*8,(eval(i)+1)*8);retS+=sss.charAt(Dig2Dec(ss.substring(0,4)));retS+=sss.charAt(Dig2Dec(ss.substring(4,8)))}return retS}return""};var Dig2Dec=function Dig2Dec(s){var retV=0;if(s.length==4){for(var i=0;i<4;i++){retV+=eval(s.charAt(i))*Math.pow(2,3-i)}return retV}return-1};var Dec2Dig=function e(t){var r="";var i=0;for(var n=0;n<4;n++){i=Math.pow(2,3-n);if(t>=i){r+="1";t=t-i}else r+="0"}return r};var DeepMerge=function e(t,r){if(Object.prototype.toString.call(t)==="[object Object]"&&Object.prototype.toString.call(r)==="[object Object]"){for(var i in r){if(!t[i]){t[i]=r[i]}else{t[i]=e(t[i],r[i])}}}else if(Object.prototype.toString.call(t)==="[object Array]"&&Object.prototype.toString.call(r)==="[object Array]"){t=t.concat(r)}else{t=r}return t};var mergeItem=function e(t,r,i,n){var a={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1};if(r.hasOwnProperty(i)){if((0,_typeof3.default)(t[i])=="object"&&!a[Object.prototype.toString.call(t[i])]){merge(t[i],r[i],n)}else if(n||!(i in t)){t[i]=r[i]}}};var merge=function e(t,r,i){for(var n in r){mergeItem(t,r,n,i)}return t};var mixin=function e(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++){r[i]=arguments[i]}var n=function e(t){(0,_classCallCheck3.default)(this,e);for(var i=0;i<r.length;i++){o(this,new r[i](t))}};for(var a=0;a<r.length;a++){var e=r[a];o(n,e);o(n.prototype,e.prototype);o(n.prototype,new e)}return n;function o(e,t){var r=(0,_getOwnPropertyNames2.default)(t);if(_getOwnPropertySymbols2.default){r=r.concat((0,_getOwnPropertySymbols2.default)(t))}for(var i=0;i<r.length;i++){var n=r[i];if(n!=="constructor"&&n!=="prototype"&&n!=="name"&&n!=="length"){var a=(0,_getOwnPropertyDescriptor2.default)(t,n);if(window["ActiveXObject"]){(0,_defineProperty2.default)(e,n,a||{})}else{(0,_defineProperty2.default)(e,n,a)}}}}};var createCanvasContext2D=function e(t,r){var i=document.createElement("CANVAS");if(t){i.width=t}if(r){i.height=r}return i.getContext("2d")};exports.extend=extend;exports.isArray=isArray;exports.extendDeep=extendDeep;exports.copy=copy;exports.copyExcluce=copyExcluce;exports.reset=reset;exports.getElement=getElement;exports.isElement=isElement;exports.removeItem=removeItem;exports.indexOf=indexOf;exports.modifyDOMElement=modifyDOMElement;exports.applyDefaults=applyDefaults;exports.getParameterString=getParameterString;exports.getWFParameterString=getWFParameterString;exports.urlAppend=urlAppend;exports.getParameters=getParameters;exports.IS_GECKO=IS_GECKO;exports.Browser=Browser;exports.getBrowser=getBrowser;exports.isSupportCanvas=isSupportCanvas;exports.supportCanvas=supportCanvas;exports.isInTheSameDomain=isInTheSameDomain;exports.toJSON=toJSON;exports.transformResult=transformResult;exports.copyAttributes=copyAttributes;exports.copyAttributesWithClip=copyAttributesWithClip;exports.cloneObject=cloneObject;exports.newGuid=newGuid;exports.bind=bind;exports.bindAsEventListener=bindAsEventListener;exports.getTopAnalysisResult=getTopAnalysisResult;exports.ChineseToUtf8=ChineseToUtf8;exports.DeepMerge=DeepMerge;exports.merge=merge;exports.mixin=mixin;exports.createCanvasContext2D=createCanvasContext2D;_Base.Zondy.Util.extend=extend;_Base.Zondy.Util.isArray=isArray;_Base.Zondy.Util.extendDeep=extendDeep;_Base.Zondy.Util.copy=copy;_Base.Zondy.Util.copyExcluce=copyExcluce;_Base.Zondy.Util.reset=reset;_Base.Zondy.Util.getElement=getElement;_Base.Zondy.Util.isElement=isElement;_Base.Zondy.Util.removeItem=removeItem;_Base.Zondy.Util.indexOf=indexOf;_Base.Zondy.Util.modifyDOMElement=modifyDOMElement;_Base.Zondy.Util.applyDefaults=applyDefaults;_Base.Zondy.Util.getParameterString=getParameterString;_Base.Zondy.Util.getWFParameterString=getWFParameterString;_Base.Zondy.Util.urlAppend=urlAppend;_Base.Zondy.Util.getParameters=getParameters;_Base.Zondy.IS_GECKO=IS_GECKO;_Base.Zondy.Browser=Browser;_Base.Zondy.Util.getBrowser=getBrowser;_Base.Zondy.Util.isSupportCanvas=isSupportCanvas;_Base.Zondy.Util.supportCanvas=supportCanvas;_Base.Zondy.Util.isInTheSameDomain=isInTheSameDomain;_Base.Zondy.Util.toJSON=toJSON;_Base.Zondy.Util.transformResult=transformResult;_Base.Zondy.Util.copyAttributes=copyAttributes;_Base.Zondy.Util.copyAttributesWithClip=copyAttributesWithClip;_Base.Zondy.Util.cloneObject=cloneObject;_Base.Zondy.Util.newGuid=newGuid;_Base.Zondy.Util.bind=bind;_Base.Zondy.Util.bindAsEventListener=bindAsEventListener;_Base.Zondy.Util.getTopAnalysisResult=getTopAnalysisResult;_Base.Zondy.Util.ChineseToUtf8=ChineseToUtf8;_Base.Zondy.Util.DeepMerge=DeepMerge;_Base.Zondy.Util.merge=merge;_Base.Zondy.Util.mixin=mixin;_Base.Zondy.Util.createCanvasContext2D=createCanvasContext2D},function(e,t,r){"use strict";t.__esModule=true;var i=r(2);var n=s(i);var a=r(81);var o=s(a);function s(e){return e&&e.__esModule?e:{default:e}}t.default=function e(t,r,i){if(t===null)t=Function.prototype;var a=(0,o.default)(t,r);if(a===undefined){var s=(0,n.default)(t);if(s===null){return undefined}else{return e(s,r,i)}}else if("value"in a){return a.value}else{var l=a.get;if(l===undefined){return undefined}return l.call(i)}}},function(e,t){var r=e.exports={version:"2.6.11"};if(typeof __e=="number")__e=r},function(e,t,r){e.exports={default:r(262),__esModule:true}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.IgsServiceBase=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(7);var h=m(c);var p=r(4);var d=m(p);var v=r(6);var y=r(154);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,d.default)(t,e);function t(e,r){(0,o.default)(this,t);var r=r||{};var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r));i.CLASS_NAME="Zondy.IgsServiceBase";return i}(0,l.default)(t,[{key:"destroy",value:function e(){(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this);var r=this;if(r.events){r.events.un(r.eventListeners);r.events.listeners=null;r.events.destroy();r.events=null;r.eventListeners=null}}},{key:"processAsync",value:function e(t){var r=this;r.request({method:t&&t.method?t.method:"GET",scope:r,success:r.serviceProcessCompleted,failure:r.serviceProcessFailed,data:t&&t.data?t.data:null,headers:t&&t.headers?t.headers:null})}},{key:"serviceProcessCompleted",value:function e(t){var r=this;t=(0,v.transformResult)(t);if(t.succeed){r.events&&r.events.triggerEvent("processCompleted",{result:t})}else{r.events.triggerEvent("processFailed",{error:t})}}}]);return t}(y.CommonServiceBase);t.IgsServiceBase=g;Zondy.Service.IgsServiceBase=g},function(e,t){e.exports=function(e){return typeof e==="object"?e!==null:typeof e==="function"}},function(e,t){var r=e.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();if(typeof __g=="number")__g=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ShapeFactory=undefined;var i=r(1);var n=T(i);var a=r(5);var o=T(a);var s=r(0);var l=r(70);var u=r(115);var f=r(71);var c=r(207);var h=r(72);var p=r(208);var d=r(209);var v=r(116);var y=r(117);var m=r(210);var g=r(211);var _=r(118);var x=r(114);var b=r(73);var w=r(212);var S=r(213);var C=r(6);function T(e){return e&&e.__esModule?e:{default:e}}var P=function(){function e(t){(0,n.default)(this,e);this.shapeParameters=t;this.CLASS_NAME="Zondy.Feature.ShapeFactory"}(0,o.default)(e,[{key:"destroy",value:function e(){this.shapeParameters=null}},{key:"createShape",value:function t(r){if(r){this.shapeParameters=r}if(!this.shapeParameters){return null}var i=this.shapeParameters;if(i instanceof l.Point){var n=new Object;n["x"]=i.x;n["y"]=i.y;n["r"]=i.r;n=(0,C.copyAttributesWithClip)(n,i.style,["x","y"]);var a=new y.SmicPoint;a.style=e.transformStyle(n);a.highlightStyle=e.transformStyle(i.highlightStyle);(0,C.copyAttributesWithClip)(a,i,["x","y","style","highlightStyle"]);return a}else if(i instanceof u.Line){if(!i.pointList){return null}var o=new Object;o["pointList"]=i.pointList;o=(0,C.copyAttributesWithClip)(o,i.style,["pointList"]);var s=new _.SmicBrokenLine;s.style=e.transformStyle(o);s.highlightStyle=e.transformStyle(i.highlightStyle);(0,C.copyAttributesWithClip)(s,i,["pointList","style","highlightStyle"]);return s}else if(i instanceof f.Polygon){if(!i.pointList){return null}var T=new Object;T["pointList"]=i.pointList;T=(0,C.copyAttributesWithClip)(T,i.style,["pointList"]);var P=new b.SmicPolygon;P.style=e.transformStyle(T);P.highlightStyle=e.transformStyle(i.highlightStyle);(0,C.copyAttributesWithClip)(P,i,["pointList","style","highlightStyle"]);return P}else if(i instanceof c.Rectangle){if(!i.x&&!i.y&!i.width&!i.height){return null}var M=new Object;M["x"]=i.x;M["y"]=i.y;M["width"]=i.width;M["height"]=i.height;M=(0,C.copyAttributesWithClip)(M,i.style,["x","y","width","height"]);var I=new w.SmicRectangle;I.style=e.transformStyle(M);I.highlightStyle=e.transformStyle(i.highlightStyle);(0,C.copyAttributesWithClip)(I,i,["x","y","width","height","style","highlightStyle"]);return I}else if(i instanceof h.Sector){var A=new Object;A["x"]=i.x;A["y"]=i.y;A["r"]=i.r;A["startAngle"]=i.startAngle;A["endAngle"]=i.endAngle;if(i["r0"]){A["r0"]=i.r0}if(i["clockWise"]){A["clockWise"]=i.clockWise}A=(0,C.copyAttributesWithClip)(A,i.style,["x","y","r","startAngle","endAngle","r0","endAngle"]);var L=new S.SmicSector;L.style=e.transformStyle(A);L.highlightStyle=e.transformStyle(i.highlightStyle);(0,C.copyAttributesWithClip)(L,i,["x","y","r","startAngle","endAngle","r0","endAngle","style","highlightStyle"]);return L}else if(i instanceof p.Label){var E=new Object;E["x"]=i.x;E["y"]=i.y;E["text"]=i.text;E=(0,C.copyAttributesWithClip)(E,i.style,["x","y","text"]);var k=new m.SmicText;k.style=e.transformStyle(E);k.highlightStyle=e.transformStyle(i.highlightStyle);(0,C.copyAttributesWithClip)(k,i,["x","y","text","style","highlightStyle"]);return k}else if(i instanceof d.Image){var D=new Object;D["x"]=i.x;D["y"]=i.y;if(i["image"]){D["image"]=i.image}if(i["width"]){D["width"]=i.width}if(i["height"]){D["height"]=i.height}if(i["sx"]){D["sx"]=i.sx}if(i["sy"]){D["sy"]=i.sy}if(i["sWidth"]){D["sWidth"]=i.sWidth}if(i["sHeight"]){D["sHeight"]=i.sHeight}D=(0,C.copyAttributesWithClip)(D,i.style,["x","y","image","width","height","sx","sy","sWidth","sHeight"]);var B=new x.SmicImage;B.style=e.transformStyle(D);B.highlightStyle=e.transformStyle(i.highlightStyle);(0,C.copyAttributesWithClip)(B,i,["x","y","image","width","height","style","highlightStyle"]);return B}else if(i instanceof v.Circle){var R=new Object;R["x"]=i.x;R["r"]=i.r;R["y"]=i.y;R=(0,C.copyAttributesWithClip)(R,i.style,["x","y","r"]);var F=new g.SmicCircle;F.style=new e.transformStyle(R);F.highlightStyle=new e.transformStyle(i.highlightStyle);(0,C.copyAttributesWithClip)(F,i,["x","y","r","style","highlightStyle","lineWidth","text","textPosition"]);return F}return null}}],[{key:"transformStyle",value:function e(t){var r={};var i=["normal","normal","normal","12","arial,sans-serif"];var n=[true,false];for(var a in t){switch(a){case"fill":n[0]=t[a];break;case"fillColor":r["color"]=t[a];break;case"stroke":n[1]=t[a];break;case"strokeWidth":r["lineWidth"]=t[a];break;case"strokeLinecap":r["lineCap"]=t[a];break;case"strokeLineJoin":r["lineJoin"]=t[a];break;case"strokeDashstyle":r["lineType"]=t[a];break;case"pointRadius":r["r"]=t[a];break;case"label":r["text"]=t[a];break;case"labelRect":r["labelRect"]=t[a];break;case"fontColor":r["textColor"]=t[a];break;case"fontStyle":i[0]=t[a];break;case"fontVariant":i[1]=t[a];break;case"fontWeight":i[2]=t[a];break;case"fontSize":var o="";if(t[a]&&t[a].toString().indexOf("px")<0){o="px"}i[3]=t[a]+o;break;case"fontFamily":i[4]=t[a];break;case"fontOpacity":r["opacity"]=t[a];break;case"labelPosition":r["textPosition"]=t[a];break;case"labelAlign":r["textAlign"]=t[a];break;case"labelBaseline":r["textBaseline"]=t[a];break;case"labelRotation":r["textRotation"]=t[a];break;default:r[a]=t[a];break}}r["textFont"]=i.join(" ");if(n[0]===true&&n[1]===false){r["brushType"]="fill"}else if(n[0]===false&&n[1]===true){r["brushType"]="stroke"}else if(n[0]===true&&n[1]===true){r["brushType"]="both"}else{r["brushType"]="fill"}if(r["lineWidth"]==null){r["lineWidth"]=1}return r}},{key:"Background",value:function e(t,r,i){var n=i?i:{};var a=new c.Rectangle(r[0],r[3],Math.abs(r[2]-r[0]),Math.abs(r[3]-r[1]));a.style={fillColor:"#f3f3f3"};if(n.backgroundStyle){(0,C.copyAttributesWithClip)(a.style,n.backgroundStyle)}if(n.backgroundRadius){a.style["radius"]=n.backgroundRadius}a.clickable=false;a.hoverable=false;return t.createShape(a)}},{key:"GraphAxis",value:function e(t,r,i,n){var a=r;var o=i?i:{};var s=[];var l=[];var c=o.useXReferenceLine?o.useXReferenceLine:false;var h=o.axisYTick&&!isNaN(o.axisYTick)?o.axisYTick:0;var d=[];var v=[];var y=[];if(h===0){y.push([a[0],a[3]-5]);y.push([a[0],a[1]]);if(o.axis3DParameter&&!isNaN(o.axis3DParameter)&&o.axis3DParameter>=15){var m=parseInt(o.axis3DParameter);var g=[a[0]-m,a[1]+m];if(o.axisUseArrow){v.push([g[0]+1.5,g[1]-7.5]);v.push([g[0]-1,g[1]+1]);v.push([g[0]+7.5,g[1]-1.5]);y.push([g[0],g[1]])}else{y.push([g[0],g[1]])}y.push([a[0],a[1]])}y.push([a[2]+5,a[1]])}else{var _=Math.abs(a[1]-a[3])/h;var x=a[3];y.push([a[0],x-5]);for(var b=0;b<h;b++){y.push([a[0],x]);y.push([a[0]-5,x]);y.push([a[0],x]);if(c){var w=new u.Line([[a[0],x],[a[2],x]]);w.style={strokeColor:"#cfcfcf",strokeLinecap:"butt",strokeLineJoin:"round",strokeWidth:1};w.clickable=false;w.hoverable=false;if(o.xReferenceLineStyle){(0,C.copyAttributesWithClip)(w.style,o.xReferenceLineStyle)}s.push(t.createShape(w))}x+=_}y.push([a[0],a[1]]);if(o.axis3DParameter&&!isNaN(o.axis3DParameter)&&o.axis3DParameter>=15){var S=parseInt(o.axis3DParameter);var T=[a[0]-S,a[1]+S];if(o.axisUseArrow){v.push([T[0]+1.5,T[1]-7.5]);v.push([T[0]-1,T[1]+1]);v.push([T[0]+7.5,T[1]-1.5]);y.push([T[0],T[1]])}else{y.push([T[0],T[1]])}y.push([a[0],a[1]])}y.push([a[2]+5,a[1]])}if(o.axisUseArrow){var P=[[a[2]+5,a[1]+4],[a[2]+13,a[1]],[a[2]+5,a[1]-4]];var M=[[a[0]-4,a[3]-5],[a[0],a[3]-13],[a[0]+4,a[3]-5]];var I=new f.Polygon(P);I.style={fillColor:"#008acd"};(0,C.copyAttributesWithClip)(I.style,o.axisStyle);l.push(t.createShape(I));var A=new f.Polygon(M);A.style={fillColor:"#008acd"};(0,C.copyAttributesWithClip)(A.style,o.axisStyle);l.push(t.createShape(A));if(o.axis3DParameter&&!isNaN(o.axis3DParameter)&&o.axis3DParameter>=15){var L=new f.Polygon(v);L.style={fillColor:"#008acd"};(0,C.copyAttributesWithClip)(L.style,o.axisStyle);l.push(t.createShape(L))}}d=y;var E=new u.Line(d);E.style={strokeLinecap:"butt",strokeLineJoin:"round",strokeColor:"#008acd",strokeWidth:1};if(o.axisStyle){(0,C.copyAttributesWithClip)(E.style,o.axisStyle)}E.clickable=false;E.hoverable=false;var k=[t.createShape(E)];var D=[];if(o.axisYLabels&&o.axisYLabels.length&&o.axisYLabels.length>0){var B=o.axisYLabels;var R=B.length;var F=[0,0];if(o.axisYLabelsOffset&&o.axisYLabelsOffset.length){F=o.axisYLabelsOffset}if(R===1){var O=new p.Label(a[0]-5+F[0],a[3]+F[1],B[0]);O.style={labelAlign:"right"};if(o.axisYLabelsStyle){(0,C.copyAttributesWithClip)(O.style,o.axisYLabelsStyle)}O.clickable=false;O.hoverable=false;D.push(t.createShape(O))}else{var z=a[3];var U=Math.abs(a[1]-a[3])/(R-1);for(var N=0;N<R;N++){var j=new p.Label(a[0]-5+F[0],z+F[1],B[N]);j.style={labelAlign:"right"};if(o.axisYLabelsStyle){(0,C.copyAttributesWithClip)(j.style,o.axisYLabelsStyle)}j.clickable=false;j.hoverable=false;D.push(t.createShape(j));z+=U}}}var V=[];if(o.axisXLabels&&o.axisXLabels.length&&o.axisXLabels.length>0){var G=o.axisXLabels;var Z=G.length;var q=[0,0];if(o.axisXLabelsOffset&&o.axisXLabelsOffset.length){q=o.axisXLabelsOffset}if(n&&n.xPositions&&n.xPositions.length&&n.xPositions.length===Z){var H=n.xPositions;for(var W=0;W<Z;W++){var X=new p.Label(H[W]+q[0],a[1]+q[1],G[W]);X.style={labelAlign:"center",labelBaseline:"top"};if(o.axisXLabelsStyle){(0,C.copyAttributesWithClip)(X.style,o.axisXLabelsStyle)}X.clickable=false;X.hoverable=false;V.push(t.createShape(X))}}else{if(Z===1){var Y=new p.Label(a[0]-5+q[0],a[1]+q[0],G[0]);Y.style={labelAlign:"center",labelBaseline:"top"};if(o.axisXLabelsStyle){(0,C.copyAttributesWithClip)(Y.style,o.axisXLabelsStyle)}Y.clickable=false;Y.hoverable=false;V.push(t.createShape(Y))}else{var K=a[0];var J=Math.abs(a[2]-a[0])/(Z-1);for(var $=0;$<Z;$++){var Q=new p.Label(K+q[0],a[1]+q[1],G[$]);Q.style={labelAlign:"center",labelBaseline:"top"};if(o.axisXLabelsStyle){(0,C.copyAttributesWithClip)(Q.style,o.axisXLabelsStyle)}Q.clickable=false;Q.hoverable=false;V.push(t.createShape(Q));K+=J}}}}return s.concat(k).concat(D).concat(V).concat(l)}},{key:"ShapeStyleTool",value:function e(t,r,i,n,a,o){var s=t?t:{};if(r){(0,C.copyAttributesWithClip)(s,r)}if(i&&i.length&&typeof a!=="undefined"&&!isNaN(a)&&a>=0){if(i[a]){(0,C.copyAttributesWithClip)(s,i[a])}}if(n&&n.length&&typeof o!=="undefined"){var l=n;var u=l.length;var f=parseFloat(o);for(var c=0;c<u;c++){if(l[c].start<=f&&f<l[c].end){(0,C.copyAttributesWithClip)(s,l[c].style);break}}}return s}}]);return e}();t.ShapeFactory=P;s.Zondy.Feature.ShapeFactory=P},function(e,t,r){var i=r(79)("wks");var n=r(53);var a=r(12).Symbol;var o=typeof a=="function";var s=e.exports=function(e){return i[e]||(i[e]=o&&a[e]||(o?a:n)("Symbol."+e))};s.store=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LayerStatusType=t.MapType=t.CItemType=t.CLinStyleMakeType=t.CLinJointType=t.CLinHeadType=t.CLinAdjustType=t.NetElemType=t.NetAnalyType=t.ISShowArc=t.EightDirType=t.LineConstrain=t.LabelSpreadType=t.RepeatType=t.LabelPntType=t.LabelRegType=t.LabelLinType=t.FontShape=t.FeatureType=t.VectClsType=t.XClsType=undefined;var i=r(291);var n=s(i);var a;var o=r(0);function s(e){return e&&e.__esModule?e:{default:e}}var l={SFCls:"SFeatureCls",OCls:"ObjectCls",ACls:"AnnotationCls",GnetCls:"GNetCls",RDS:"RasterDataset",SFClsInfo:"sfcls_new"};t.XClsType=l;o.Zondy.Enum.XClsType=l;var u={Unknown:0,SFCls:"SFeatureCls",AnnoCls:"AnnotationCls"};t.VectClsType=u;o.Zondy.Enum.VectClsType=u;var f={Unknown:0,Pnt:1,Lin:2,Reg:3};t.FeatureType=f;o.Zondy.Enum.FeatureType=f;var c={Positive:0,LeftOblique:1,RightOblique:2,LeftTowering:3,RightTowering:4};t.FontShape=c;o.Zondy.Enum.FontShape=c;var h={Curved:0,Forward:1,Horizontal:2,Tangent:3};t.LabelLinType=h;o.Zondy.Enum.LabelLinType=h;var p={Curved:0,Forward:1,Horizontal:2,Boundray:3,Outside:4};t.LabelRegType=p;o.Zondy.Enum.LabelRegType=p;var d={PntAnyDir:0,PntEightDir:1,PntOnFea:2};t.LabelPntType=d;o.Zondy.Enum.LabelPntType=d;var v={Auto:0,NoRep:1,OnStep:2};t.RepeatType=v;o.Zondy.Enum.RepeatType=v;var y={AutoSpread:0,Centralization:1,Decentralization:2};t.LabelSpreadType=y;o.Zondy.Enum.LabelSpreadType=y;var m={Left:0,Right:1,Above:2,Below:3,Both:4,NoRes:5};t.LineConstrain=m;o.Zondy.Enum.LineConstrain=m;var g={East:0,North:1,NorthEast:2,NorthWest:3,South:4,SouthEast:5,SouthWest:6,West:7,NoDir:8};t.EightDirType=g;o.Zondy.Enum.EightDirType=g;var _={Reg:0,Arc:1,All:2};t.ISShowArc=_;o.Zondy.Enum.ISShowArc=_;var x=(a={UserMode:"UserMode",SysModeCommwayPrefer:"SysModeCommwayPrefer",SysModeHighWayPrefer:"SysModeHighWayPrefer",SysModeMinCost:"SysModeMinCost",SysModeMinDis:"SysModeMinDis"},(0,n.default)(a,"SysModeMinDis","SysModeMinDis"),(0,n.default)(a,"SysModeSysRecommend","SysModeSysRecommend"),a);t.NetAnalyType=x;o.Zondy.Enum.Net.NetAnalyType=x;var b={Node:1,Edge:2,CNode:3,Chain:4,Center:5,Source:13,Sink:13};t.NetElemType=b;o.Zondy.Enum.Net.NetElemType=b;var w={Adjust:0,NoAdjust:1};t.CLinAdjustType=w;o.Zondy.Enum.Theme.CLinAdjustType=w;var S={Round:0,Square:1,Butt:2};t.CLinHeadType=S;o.Zondy.Enum.Theme.CLinHeadType=S;var C={Round:0,Square:1,Butt:2};t.CLinJointType=C;o.Zondy.Enum.Theme.CLinJointType=C;var T={Byrule:0,Bypoint:1};t.CLinStyleMakeType=T;o.Zondy.Enum.Theme.CLinStyleMakeType=T;var P={Unknown:0,UniqueTheme:1,RangeTheme:2};t.CItemType=P;o.Zondy.Enum.Theme.CItemType=P;var M={Doc:"mapType",Tile:"tileType"};t.MapType=M;o.Zondy.Enum.Map.MapType=M;var I={Show:"show",Hide:"hide",Include:"include",Exclude:"exclude"};t.LayerStatusType=I;o.Zondy.Enum.Map.LayerStatusType=I},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Shape=undefined;var i=r(2);var n=x(i);var a=r(1);var o=x(a);var s=r(5);var l=x(s);var u=r(3);var f=x(u);var c=r(7);var h=x(c);var p=r(4);var d=x(p);var v=r(0);var y=r(6);var m=r(50);var g=r(67);var _=r(20);function x(e){return e&&e.__esModule?e:{default:e}}var b=function(e){(0,d.default)(t,e);function t(e){(0,o.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));e=e||{};r.id=null;r.style={};r.highlightStyle=null;r.parent=null;r.__dirty=true;r.__clipShapes=[];r.invisible=false;r.ignore=false;r.zlevel=0;r.draggable=false;r.clickable=false;r.hoverable=true;r.z=0;r.refOriginalPosition=[0,0];r.refDataID=null;r.isHoverByRefDataID=false;r.refDataHoverGroup=null;r.dataInfo=null;(0,y.extend)(r,e);r.id=r.id||(0,y.newGuid)();r.CLASS_NAME="Zondy.LevelRenderer.Shape";r.getTansform=function(){var e=[];return function(t,r){var i=[t,r];if(this.needTransform&&this.transform){_.SUtil.Util_matrix.invert(e,this.transform);_.SUtil.Util_matrix.mulVector(i,e,[t,r,1]);if(t===i[0]&&r===i[1]){this.updateNeedTransform()}}return i}}();return r}(0,l.default)(t,[{key:"destroy",value:function e(){this.id=null;this.style=null;this.highlightStyle=null;this.parent=null;this.__dirty=null;this.__clipShapes=null;this.invisible=null;this.ignore=null;this.zlevel=null;this.draggable=null;this.clickable=null;this.hoverable=null;this.z=null;this.refOriginalPosition=null;this.refDataID=null;this.refDataHoverGroup=null;this.isHoverByRefDataID=null;this.dataInfo=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"brush",value:function e(t,r){var i=this.beforeBrush(t,r);t.beginPath();this.buildPath(t,i);switch(i.brushType){case"both":this.setCtxGlobalAlpha(t,"fill",i);t.fill();if(i.lineWidth>0){this.setCtxGlobalAlpha(t,"stroke",i);t.stroke()}this.setCtxGlobalAlpha(t,"reset",i);break;case"stroke":this.setCtxGlobalAlpha(t,"stroke",i);i.lineWidth>0&&t.stroke();this.setCtxGlobalAlpha(t,"reset",i);break;default:this.setCtxGlobalAlpha(t,"fill",i);t.fill();this.setCtxGlobalAlpha(t,"reset",i);break}this.drawText(t,i,this.style);this.afterBrush(t)}},{key:"beforeBrush",value:function e(t,r){var i=this.style;if(this.brushTypeOnly){i.brushType=this.brushTypeOnly}if(r){i=this.getHighlightStyle(i,this.highlightStyle||{},this.brushTypeOnly)}if(this.brushTypeOnly==="stroke"){i.strokeColor=i.strokeColor||i.color}t.save();this.doClip(t);this.setContext(t,i);this.setTransform(t);return i}},{key:"afterBrush",value:function e(t){t.restore()}},{key:"setContext",value:function e(t,r){var i=[["color","fillStyle"],["strokeColor","strokeStyle"],["opacity","globalAlpha"],["lineCap","lineCap"],["lineJoin","lineJoin"],["miterLimit","miterLimit"],["lineWidth","lineWidth"],["shadowBlur","shadowBlur"],["shadowColor","shadowColor"],["shadowOffsetX","shadowOffsetX"],["shadowOffsetY","shadowOffsetY"]];for(var n=0,a=i.length;n<a;n++){var o=i[n][0];var s=r[o];var l=i[n][1];if(typeof s!="undefined"){t[l]=s}}}},{key:"doClip",value:function e(t){var r=_.SUtil.Util_matrix.create();if(this.__clipShapes){for(var i=0;i<this.__clipShapes.length;i++){var n=this.__clipShapes[i];if(n.needTransform){var a=n.transform;_.SUtil.Util_matrix.invert(r,a);t.transform(a[0],a[1],a[2],a[3],a[4],a[5])}t.beginPath();n.buildPath(t,n.style);t.clip();if(n.needTransform){var o=r;t.transform(o[0],o[1],o[2],o[3],o[4],o[5])}}}}},{key:"getHighlightStyle",value:function e(t,r,i){var n={};for(var a in t){n[a]=t[a]}var o=_.SUtil.Util_color.getHighlightColor();if(t.brushType!=="stroke"){n.strokeColor=o;n.lineWidth=t.lineWidth||1;n.brushType="both"}else{if(i!=="stroke"){n.strokeColor=o;n.lineWidth=t.lineWidth||1}else{n.strokeColor=r.strokeColor||_.SUtil.Util_color.mix(t.strokeColor,_.SUtil.Util_color.toRGB(o))}}for(var s in r){if(typeof r[s]!="undefined"){n[s]=r[s]}}return n}},{key:"getHighlightZoom",value:function e(){return this.type!=="text"?6:2}},{key:"drift",value:function e(t,r){this.position[0]+=t;this.position[1]+=r}},{key:"buildPath",value:function e(t,r){}},{key:"getRect",value:function e(t){}},{key:"isCover",value:function e(t,r){var i=this.getTansform(t,r);t=i[0];r=i[1];var n=this.style.__rect;if(!n){n=this.style.__rect=this.getRect(this.style)}if(t>=n.x&&t<=n.x+n.width&&r>=n.y&&r<=n.y+n.height){return _.SUtil.Util_area.isInside(this,this.style,t,r)}return false}},{key:"drawText",value:function e(r,i,n){if(typeof i.text=="undefined"||i.text===false){return}var a=i.textColor||i.color||i.strokeColor;r.fillStyle=a;var o=10;var s;var l;var u;var f;var c=i.textPosition||this.textPosition||"top";var h=[];if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){h=[0,0]}else{h=this.refOriginalPosition}switch(c){case"inside":case"top":case"bottom":case"left":case"right":if(this.getRect){var p=(n||i).__rect||this.getRect(n||i);switch(c){case"inside":u=p.x+p.width/2;f=p.y+p.height/2;s="center";l="middle";if(i.brushType!=="stroke"&&a===i.color){r.fillStyle="#fff"}break;case"left":u=p.x-o;f=p.y+p.height/2;s="end";l="middle";break;case"right":u=p.x+p.width+o;f=p.y+p.height/2;s="start";l="middle";break;case"top":u=p.x+p.width/2;f=p.y-o;s="center";l="bottom";break;case"bottom":u=p.x+p.width/2;f=p.y+p.height+o;s="center";l="top";break}}break;case"start":case"end":var d=0;var v=0;var y=0;var m=0;if(typeof i.pointList!="undefined"){var g=i.pointList;if(g.length<2){return}var _=g.length;switch(c){case"start":d=g[0][0]+h[0];v=g[1][0]+h[0];y=g[0][1]+h[1];m=g[1][1]+h[1];break;case"end":d=g[_-2][0]+h[0];v=g[_-1][0]+h[0];y=g[_-2][1]+h[1];m=g[_-1][1]+h[1];break}}else{d=i.xStart+h[0]||0;v=i.xEnd+h[0]||0;y=i.yStart+h[1]||0;m=i.yEnd+h[1]||0}switch(c){case"start":s=d<v?"end":"start";l=y<m?"bottom":"top";u=d;f=y;break;case"end":s=d<v?"start":"end";l=y<m?"top":"bottom";u=v;f=m;break}o-=4;if(d&&v&&d!==v){u-=s==="end"?o:-o}else{s="center"}if(y!==m){f-=l==="bottom"?o:-o}else{l="middle"}break;case"specific":u=i.textX||0;f=i.textY||0;s="start";l="middle";break}if(i.labelXOffset&&!isNaN(i.labelXOffset)){u+=i.labelXOffset}if(i.labelYOffset&&!isNaN(i.labelYOffset)){f+=i.labelYOffset}if(u!=null&&f!=null){t._fillText(r,i.text,u,f,i.textFont,i.textAlign||s,i.textBaseline||l)}}},{key:"modSelf",value:function e(){this.__dirty=true;if(this.style){this.style.__rect=null}if(this.highlightStyle){this.highlightStyle.__rect=null}}},{key:"isSilent",value:function e(){return!(this.hoverable||this.draggable||this.clickable||this.onmousemove||this.onmouseover||this.onmouseout||this.onmousedown||this.onmouseup||this.onclick||this.ondragenter||this.ondragover||this.ondragleave||this.ondrop)}},{key:"setCtxGlobalAlpha",value:function e(t,r,i){if(r==="fill"){t.globalAlpha=typeof i["fillOpacity"]==="undefined"?typeof i["opacity"]==="undefined"?1:i["opacity"]:i["fillOpacity"]}else if(r==="stroke"){t.globalAlpha=typeof i["strokeOpacity"]==="undefined"?typeof i["opacity"]==="undefined"?1:i["opacity"]:i["strokeOpacity"]}else{t.globalAlpha=typeof i["opacity"]==="undefined"?1:i["opacity"]}}}],[{key:"_fillText",value:function e(r,i,n,a,o,s,l){if(o){r.font=o}r.textAlign=s;r.textBaseline=l;var u=t._getTextRect(i,n,a,o,s,l);i=(i+"").split("\n");var f=_.SUtil.Util_area.getTextHeight("ZH",o);switch(l){case"top":a=u.y;break;case"bottom":a=u.y+f;break;default:a=u.y+f/2}for(var c=0,h=i.length;c<h;c++){r.fillText(i[c],n,a);a+=f}}},{key:"_getTextRect",value:function e(t,r,i,n,a,o){var s=_.SUtil.Util_area.getTextWidth(t,n);var l=_.SUtil.Util_area.getTextHeight("ZH",n);t=(t+"").split("\n");switch(a){case"end":case"right":r-=s;break;case"center":r-=s/2;break}switch(o){case"top":break;case"bottom":i-=l*t.length;break;default:i-=l*t.length/2}return{x:r,y:i,width:s,height:l*t.length}}}]);return t}((0,y.mixin)(m.Eventful,g.Transformable));t.Shape=b;v.Zondy.LevelRenderer.Shape=b},function(e,t,r){var i=r(12);var n=r(8);var a=r(45);var o=r(35);var s=r(34);var l="prototype";var u=function(e,t,r){var f=e&u.F;var c=e&u.G;var h=e&u.S;var p=e&u.P;var d=e&u.B;var v=e&u.W;var y=c?n:n[t]||(n[t]={});var m=y[l];var g=c?i:h?i[t]:(i[t]||{})[l];var _,x,b;if(c)r=t;for(_ in r){x=!f&&g&&g[_]!==undefined;if(x&&s(y,_))continue;b=x?g[_]:r[_];y[_]=c&&typeof g[_]!="function"?r[_]:d&&x?a(b,i):v&&g[_]==b?function(e){var t=function(t,r,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,i)}return e.apply(this,arguments)};t[l]=e[l];return t}(b):p&&typeof b=="function"?a(Function.call,b):b;if(p){(y.virtual||(y.virtual={}))[_]=b;if(e&u.R&&m&&!m[_])o(m,_,b)}}};u.F=1;u.G=2;u.S=4;u.P=8;u.B=16;u.W=32;u.U=64;u.R=128;e.exports=u},function(e,t,r){"use strict";t.__esModule=true;var i=r(265);var n=l(i);var a=r(272);var o=l(a);var s=typeof o.default==="function"&&typeof n.default==="symbol"?function(e){return typeof e}:function(e){return e&&typeof o.default==="function"&&e.constructor===o.default&&e!==o.default.prototype?"symbol":typeof e};function l(e){return e&&e.__esModule?e:{default:e}}t.default=typeof o.default==="function"&&s(n.default)==="symbol"?function(e){return typeof e==="undefined"?"undefined":s(e)}:function(e){return e&&typeof o.default==="function"&&e.constructor===o.default&&e!==o.default.prototype?"symbol":typeof e==="undefined"?"undefined":s(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Point2D=undefined;var i=r(2);var n=d(i);var a=r(1);var o=d(a);var s=r(5);var l=d(s);var u=r(3);var f=d(u);var c=r(4);var h=d(c);var p=r(37);function d(e){return e&&e.__esModule?e:{default:e}}var v=function(e){(0,h.default)(t,e);function t(e,r,i){(0,o.default)(this,t);var a=i?i:{};var s=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,a));s.x=e!==undefined?e:null;s.y=r!==undefined?r:null;s.nearDis=a.nearDis!==undefined?parseFloat(a.nearDis):null;s.CLASS_NAME="Zondy.Object.Point2D";return s}(0,l.default)(t,[{key:"getGeometryType",value:function e(){return"point"}},{key:"setByOL",value:function e(t){if(t!==undefined){var r=t.getCoordinates();this.x=r[0];this.y=r[1]}}},{key:"toString",value:function e(){if(this.x===null||this.y===null)return"";var t=this.x+","+this.y;if(this.nearDis!==undefined){t+=";"+this.nearDis}return t}}]);return t}(p.Tangram);t.Point2D=v;Zondy.Object.Point2D=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SUtil=undefined;var i=r(1);var n=_(i);var a=r(5);var o=_(a);var s=r(0);var l=r(195);var u=r(112);var f=r(196);var c=r(68);var h=r(197);var p=r(198);var d=r(199);var v=r(200);var y=r(201);var m=r(42);var g=r(69);function _(e){return e&&e.__esModule?e:{default:e}}var x=function(){function e(){(0,n.default)(this,e)}(0,o.default)(e,null,[{key:"SUtil_smoothBezier",value:function t(r,i,n,a,o){if(!o||o!==2){o=[0,0]}var s=o;var l=[];var u=[];var f=[];var c=[];var h=!!a;var p,d;if(h){p=[Infinity,Infinity];d=[-Infinity,-Infinity];var v=r.length;for(var y=0;y<v;y++){e.Util_vector.min(p,p,[r[y][0]+s[0],r[y][1]+s[1]]);e.Util_vector.max(d,d,[r[y][0]+s[0],r[y][1]+s[1]])}e.Util_vector.min(p,p,a[0]);e.Util_vector.max(d,d,a[1])}var m=r.length;for(var g=0;g<m;g++){var _=[r[g][0]+s[0],r[g][1]+s[1]];var x=void 0;var b=void 0;if(n){x=[r[g?g-1:m-1][0]+s[0],r[g?g-1:m-1][1]+s[1]];b=[r[(g+1)%m][0]+s[0],r[(g+1)%m][1]+s[1]]}else{if(g===0||g===m-1){l.push([r[g][0]+s[0],r[g][1]+s[1]]);continue}else{x=[r[g-1][0]+s[0],r[g-1][1]+s[1]];b=[r[g+1][0]+s[0],r[g+1][1]+s[1]]}}e.Util_vector.sub(u,b,x);e.Util_vector.scale(u,u,i);var w=e.Util_vector.distance(_,x);var S=e.Util_vector.distance(_,b);var C=w+S;if(C!==0){w/=C;S/=C}e.Util_vector.scale(f,u,-w);e.Util_vector.scale(c,u,S);var T=e.Util_vector.add([],_,f);var P=e.Util_vector.add([],_,c);if(h){e.Util_vector.max(T,T,p);e.Util_vector.min(T,T,d);e.Util_vector.max(P,P,p);e.Util_vector.min(P,P,d)}l.push(T);l.push(P)}if(n){l.push(l.shift())}return l}},{key:"SUtil_smoothSpline",value:function t(r,i,n,a){if(!a||a!==2){a=[0,0]}var o=a;var s=r.length;var l=[];var u=0;for(var f=1;f<s;f++){u+=e.Util_vector.distance([r[f-1][0]+o[0],r[f-1][1]+o[1]],[r[f][0]+o[0],r[f][1]+o[1]])}var c=u/5;c=c<s?s:c;for(var h=0;h<c;h++){var p=h/(c-1)*(i?s:s-1);var d=Math.floor(p);var v=p-d;var y=void 0;var m=[r[d%s][0]+o[0],r[d%s][1]+o[1]];var g=void 0;var _=void 0;if(!i){y=[r[d===0?d:d-1][0]+o[0],r[d===0?d:d-1][1]+o[1]];g=[r[d>s-2?s-1:d+1][0]+o[0],r[d>s-2?s-1:d+1][1]+o[1]];_=[r[d>s-3?s-1:d+2][0]+o[0],r[d>s-3?s-1:d+2][1]+o[1]]}else{y=[r[(d-1+s)%s][0]+o[0],r[(d-1+s)%s][1]+o[1]];g=[r[(d+1)%s][0]+o[0],r[(d+1)%s][1]+o[1]];_=[r[(d+2)%s][0]+o[0],r[(d+2)%s][1]+o[1]]}var x=v*v;var b=v*x;l.push([w(y[0],m[0],g[0],_[0],v,x,b),w(y[1],m[1],g[1],_[1],v,x,b)])}return l;function w(e,t,r,i,n,a,o){var s=(r-e)*.5;var l=(i-t)*.5;return(2*(t-r)+s+l)*o+(-3*(t-r)-2*s-l)*a+s*n+t}}},{key:"SUtil_dashedLineTo",value:function e(t,r,i,n,a,o,s){var l=[5,5];o=typeof o!="number"?5:o;if(t.setLineDash){l[0]=o;l[1]=o;if(s&&s instanceof Array){t.setLineDash(s)}else{t.setLineDash(l)}t.moveTo(r,i);t.lineTo(n,a);return}var u=n-r;var f=a-i;var c=Math.floor(Math.sqrt(u*u+f*f)/o);u=u/c;f=f/c;var h=true;for(var p=0;p<c;++p){if(h){t.moveTo(r,i)}else{t.lineTo(r,i)}h=!h;r+=u;i+=f}t.lineTo(n,a)}}]);return e}();x.Util_area=new l.Area;x.Util_color=new u.Color;x.Util_computeBoundingBox=new f.ComputeBoundingBox;x.Util_curve=new c.Curve;x.Util_env=new h.Env;x.Util_event=new p.Event;x.Util_http=new d.Http;x.Util_math=new v.Math;x.Util_matrix=new y.Matrix;x.Util=new m.Util;x.Util_vector=new g.Vector;t.SUtil=x;s.Zondy.LevelRenderer.SUtil=x},function(e,t){e.exports=mapboxgl},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CTheme=undefined;var i=r(1);var n=s(i);var a=r(0);var o=r(6);function s(e){return e&&e.__esModule?e:{default:e}}var l=function e(t){(0,n.default)(this,e);var r=t!==undefined?t:{};(0,o.extend)(this,r);this.Name=r&&r.Name?r.Name:null;this.IsBaseTheme=r&&r.IsBaseTheme?r.IsBaseTheme:true;this.Visible=r&&r.Visible?r.Visible:true};t.CTheme=l;a.Zondy.Object.Theme.CTheme=l},function(e,t,r){var i=r(11);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t,r){var i=r(17);var n=r(8);var a=r(44);e.exports=function(e,t){var r=(n.Object||{})[e]||Object[e];var o={};o[e]=t(r);i(i.S+i.F*a(function(){r(1)}),"Object",o)}},function(e,t,r){"use strict";(function(i,n){var a,o;var s=r(225);var l=U(s);var u=r(228);var f=U(u);var c=r(56);var h=U(c);var p=r(233);var d=U(p);var v=r(236);var y=U(v);var m=r(239);var g=U(m);var _=r(242);var x=U(_);var b=r(248);var w=U(b);var S=r(251);var C=U(S);var T=r(2);var P=U(T);var M=r(81);var I=U(M);var A=r(84);var L=U(A);var E=r(128);var k=U(E);var D=r(9);var B=U(D);var R=r(85);var F=U(R);var O=r(18);var z=U(O);function U(e){return e&&e.__esModule?e:{default:e}}(function(i,n){(false?undefined:(0,z.default)(t))==="object"&&typeof e!=="undefined"?e.exports=n():true?!(a=n,o=typeof a==="function"?a.call(t,r,t,e):a,o!==undefined&&(e.exports=o)):undefined})(undefined,function(){"use strict";var e,t,r;function a(i,n){if(!e){e=n}else if(!t){t=n}else{var a="var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk);";var o={};e(o);r=n(o);r.workerUrl=window.URL.createObjectURL(new Blob([a],{type:"text/javascript"}))}}a(["exports"],function(e){"use strict";var t=typeof window!=="undefined"?window:typeof i!=="undefined"?i:typeof self!=="undefined"?self:{};function r(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function o(e,t){return t={exports:{}},e(t,t.exports),t.exports}function s(e){return e&&e.default||e}var l=function e(t){return t&&(typeof t==="undefined"?"undefined":(0,z.default)(t))==="object"&&typeof t.copy==="function"&&typeof t.fill==="function"&&typeof t.readUInt8==="function"};var u=o(function(e){if(typeof F.default==="function"){e.exports=function e(t,r){t.super_=r;t.prototype=(0,F.default)(r.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}})}}else{e.exports=function e(t,r){t.super_=r;var i=function e(){};i.prototype=r.prototype;t.prototype=new i;t.prototype.constructor=t}}});var f=o(function(e,t){var r=/%[sdj%]/g;t.format=function(e){var t=arguments;if(!C(e)){var i=[];for(var n=0;n<arguments.length;n++){i.push(s(t[n]))}return i.join(" ")}var n=1;var a=arguments;var o=a.length;var l=String(e).replace(r,function(e){if(e==="%%"){return"%"}if(n>=o){return e}switch(e){case"%s":return String(a[n++]);case"%d":return Number(a[n++]);case"%j":try{return(0,B.default)(a[n++])}catch(e){return"[Circular]"}default:return e}});for(var u=a[n];n<o;u=a[++n]){if(b(u)||!A(u)){l+=" "+u}else{l+=" "+s(u)}}return l};t.deprecate=function(e,r){if(P(i.process)){return function(){return t.deprecate(e,r).apply(this,arguments)}}if(n.noDeprecation===true){return e}var a=false;function o(){if(!a){if(n.throwDeprecation){throw new Error(r)}else if(n.traceDeprecation){console.trace(r)}else{console.error(r)}a=true}return e.apply(this,arguments)}return o};var a={};var o;t.debuglog=function(e){if(P(o)){o=Object({NODE_ENV:undefined}).NODE_DEBUG||""}e=e.toUpperCase();if(!a[e]){if(new RegExp("\\b"+e+"\\b","i").test(o)){var r=n.pid;a[e]=function(){var i=t.format.apply(t,arguments);console.error("%s %d: %s",e,r,i)}}else{a[e]=function(){}}}return a[e]};function s(e,r){var i={seen:[],stylize:c};if(arguments.length>=3){i.depth=arguments[2]}if(arguments.length>=4){i.colors=arguments[3]}if(x(r)){i.showHidden=r}else if(r){t._extend(i,r)}if(P(i.showHidden)){i.showHidden=false}if(P(i.depth)){i.depth=2}if(P(i.colors)){i.colors=false}if(P(i.customInspect)){i.customInspect=true}if(i.colors){i.stylize=f}return p(i,e,i.depth)}t.inspect=s;s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function f(e,t){var r=s.styles[t];if(r){return"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m"}else{return e}}function c(e,t){return e}function h(e){var t={};e.forEach(function(e,r){t[e]=true});return t}function p(e,r,i){if(e.customInspect&&r&&R(r.inspect)&&r.inspect!==t.inspect&&!(r.constructor&&r.constructor.prototype===r)){var n=r.inspect(i,e);if(!C(n)){n=p(e,n,i)}return n}var a=d(e,r);if(a){return a}var o=(0,k.default)(r);var s=h(o);if(e.showHidden){o=(0,L.default)(r)}if(D(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0)){return v(r)}if(o.length===0){if(R(r)){var l=r.name?": "+r.name:"";return e.stylize("[Function"+l+"]","special")}if(M(r)){return e.stylize(RegExp.prototype.toString.call(r),"regexp")}if(E(r)){return e.stylize(Date.prototype.toString.call(r),"date")}if(D(r)){return v(r)}}var u="",f=false,c=["{","}"];if(_(r)){f=true;c=["[","]"]}if(R(r)){var x=r.name?": "+r.name:"";u=" [Function"+x+"]"}if(M(r)){u=" "+RegExp.prototype.toString.call(r)}if(E(r)){u=" "+Date.prototype.toUTCString.call(r)}if(D(r)){u=" "+v(r)}if(o.length===0&&(!f||r.length==0)){return c[0]+u+c[1]}if(i<0){if(M(r)){return e.stylize(RegExp.prototype.toString.call(r),"regexp")}else{return e.stylize("[Object]","special")}}e.seen.push(r);var b;if(f){b=y(e,r,i,s,o)}else{b=o.map(function(t){return m(e,r,i,s,t,f)})}e.seen.pop();return g(b,u,c)}function d(e,t){if(P(t)){return e.stylize("undefined","undefined")}if(C(t)){var r="'"+(0,B.default)(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(S(t)){return e.stylize(""+t,"number")}if(x(t)){return e.stylize(""+t,"boolean")}if(b(t)){return e.stylize("null","null")}}function v(e){return"["+Error.prototype.toString.call(e)+"]"}function y(e,t,r,i,n){var a=[];for(var o=0,s=t.length;o<s;++o){if(V(t,String(o))){a.push(m(e,t,r,i,String(o),true))}else{a.push("")}}n.forEach(function(n){if(!n.match(/^\d+$/)){a.push(m(e,t,r,i,n,true))}});return a}function m(e,t,r,i,n,a){var o,s,l;l=(0,I.default)(t,n)||{value:t[n]};if(l.get){if(l.set){s=e.stylize("[Getter/Setter]","special")}else{s=e.stylize("[Getter]","special")}}else{if(l.set){s=e.stylize("[Setter]","special")}}if(!V(i,n)){o="["+n+"]"}if(!s){if(e.seen.indexOf(l.value)<0){if(b(r)){s=p(e,l.value,null)}else{s=p(e,l.value,r-1)}if(s.indexOf("\n")>-1){if(a){s=s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2)}else{s="\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")}}}else{s=e.stylize("[Circular]","special")}}if(P(o)){if(a&&n.match(/^\d+$/)){return s}o=(0,B.default)(""+n);if(o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){o=o.substr(1,o.length-2);o=e.stylize(o,"name")}else{o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");o=e.stylize(o,"string")}}return o+": "+s}function g(e,t,r){var i=0;var n=e.reduce(function(e,t){i++;if(t.indexOf("\n")>=0){i++}return e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);if(n>60){return r[0]+(t===""?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]}return r[0]+t+" "+e.join(", ")+" "+r[1]}function _(e){return Array.isArray(e)}t.isArray=_;function x(e){return typeof e==="boolean"}t.isBoolean=x;function b(e){return e===null}t.isNull=b;function w(e){return e==null}t.isNullOrUndefined=w;function S(e){return typeof e==="number"}t.isNumber=S;function C(e){return typeof e==="string"}t.isString=C;function T(e){return(typeof e==="undefined"?"undefined":(0,z.default)(e))==="symbol"}t.isSymbol=T;function P(e){return e===void 0}t.isUndefined=P;function M(e){return A(e)&&O(e)==="[object RegExp]"}t.isRegExp=M;function A(e){return(typeof e==="undefined"?"undefined":(0,z.default)(e))==="object"&&e!==null}t.isObject=A;function E(e){return A(e)&&O(e)==="[object Date]"}t.isDate=E;function D(e){return A(e)&&(O(e)==="[object Error]"||e instanceof Error)}t.isError=D;function R(e){return typeof e==="function"}t.isFunction=R;function F(e){return e===null||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||(typeof e==="undefined"?"undefined":(0,z.default)(e))==="symbol"||typeof e==="undefined"}t.isPrimitive=F;t.isBuffer=l;function O(e){return Object.prototype.toString.call(e)}function U(e){return e<10?"0"+e.toString(10):e.toString(10)}var N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function j(){var e=new Date;var t=[U(e.getHours()),U(e.getMinutes()),U(e.getSeconds())].join(":");return[e.getDate(),N[e.getMonth()],t].join(" ")}t.log=function(){console.log("%s - %s",j(),t.format.apply(t,arguments))};t.inherits=u;t._extend=function(e,t){if(!t||!A(t)){return e}var r=(0,k.default)(t);var i=r.length;while(i--){e[r[i]]=t[r[i]]}return e};function V(e,t){return Object.prototype.hasOwnProperty.call(e,t)}});var c=f.format;var h=f.deprecate;var p=f.debuglog;var d=f.inspect;var v=f.isArray;var y=f.isBoolean;var m=f.isNull;var g=f.isNullOrUndefined;var _=f.isNumber;var b=f.isString;var S=f.isSymbol;var T=f.isUndefined;var M=f.isRegExp;var A=f.isObject;var E=f.isDate;var D=f.isError;var R=f.isFunction;var O=f.isPrimitive;var U=f.isBuffer;var N=f.log;var j=f.inherits;var V=f._extend;var G=o(function(e){"use strict";
/*!
             * The buffer module from node.js, for the browser.
             *
             * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
             * @license  MIT
             */function t(e,t){if(e===t){return 0}var r=e.length;var i=t.length;for(var n=0,a=Math.min(r,i);n<a;++n){if(e[n]!==t[n]){r=e[n];i=t[n];break}}if(r<i){return-1}if(i<r){return 1}return 0}function r(e){if(i.Buffer&&typeof i.Buffer.isBuffer==="function"){return i.Buffer.isBuffer(e)}return!!(e!=null&&e._isBuffer)}var n=Object.prototype.hasOwnProperty;var a=Array.prototype.slice;var o=function(){return function e(){}.name==="foo"}();function s(e){return Object.prototype.toString.call(e)}function l(e){if(r(e)){return false}if(typeof i.ArrayBuffer!=="function"){return false}if(typeof ArrayBuffer.isView==="function"){return ArrayBuffer.isView(e)}if(!e){return false}if(e instanceof DataView){return true}if(e.buffer&&e.buffer instanceof ArrayBuffer){return true}return false}var u=e.exports=m;var c=/\s*function\s+([^\(\s]*)\s*/;function h(e){if(!f.isFunction(e)){return}if(o){return e.name}var t=e.toString();var r=t.match(c);return r&&r[1]}u.AssertionError=function e(t){this.name="AssertionError";this.actual=t.actual;this.expected=t.expected;this.operator=t.operator;if(t.message){this.message=t.message;this.generatedMessage=false}else{this.message=v(this);this.generatedMessage=true}var r=t.stackStartFunction||y;if(Error.captureStackTrace){Error.captureStackTrace(this,r)}else{var i=new Error;if(i.stack){var n=i.stack;var a=h(r);var o=n.indexOf("\n"+a);if(o>=0){var s=n.indexOf("\n",o+1);n=n.substring(s+1)}this.stack=n}}};f.inherits(u.AssertionError,Error);function p(e,t){if(typeof e==="string"){return e.length<t?e:e.slice(0,t)}else{return e}}function d(e){if(o||!f.isFunction(e)){return f.inspect(e)}var t=h(e);var r=t?": "+t:"";return"[Function"+r+"]"}function v(e){return p(d(e.actual),128)+" "+e.operator+" "+p(d(e.expected),128)}function y(e,t,r,i,n){throw new u.AssertionError({message:r,actual:e,expected:t,operator:i,stackStartFunction:n})}u.fail=y;function m(e,t){if(!e){y(e,true,t,"==",u.ok)}}u.ok=m;u.equal=function e(t,r,i){if(t!=r){y(t,r,i,"==",u.equal)}};u.notEqual=function e(t,r,i){if(t==r){y(t,r,i,"!=",u.notEqual)}};u.deepEqual=function e(t,r,i){if(!g(t,r,false)){y(t,r,i,"deepEqual",u.deepEqual)}};u.deepStrictEqual=function e(t,r,i){if(!g(t,r,true)){y(t,r,i,"deepStrictEqual",u.deepStrictEqual)}};function g(e,i,n,a){if(e===i){return true}else if(r(e)&&r(i)){return t(e,i)===0}else if(f.isDate(e)&&f.isDate(i)){return e.getTime()===i.getTime()}else if(f.isRegExp(e)&&f.isRegExp(i)){return e.source===i.source&&e.global===i.global&&e.multiline===i.multiline&&e.lastIndex===i.lastIndex&&e.ignoreCase===i.ignoreCase}else if((e===null||(typeof e==="undefined"?"undefined":(0,z.default)(e))!=="object")&&(i===null||(typeof i==="undefined"?"undefined":(0,z.default)(i))!=="object")){return n?e===i:e==i}else if(l(e)&&l(i)&&s(e)===s(i)&&!(e instanceof Float32Array||e instanceof Float64Array)){return t(new Uint8Array(e.buffer),new Uint8Array(i.buffer))===0}else if(r(e)!==r(i)){return false}else{a=a||{actual:[],expected:[]};var o=a.actual.indexOf(e);if(o!==-1){if(o===a.expected.indexOf(i)){return true}}a.actual.push(e);a.expected.push(i);return x(e,i,n,a)}}function _(e){return Object.prototype.toString.call(e)=="[object Arguments]"}function x(e,t,r,i){if(e===null||e===undefined||t===null||t===undefined){return false}if(f.isPrimitive(e)||f.isPrimitive(t)){return e===t}if(r&&(0,P.default)(e)!==(0,P.default)(t)){return false}var n=_(e);var o=_(t);if(n&&!o||!n&&o){return false}if(n){e=a.call(e);t=a.call(t);return g(e,t,r)}var s=T(e);var l=T(t);var u,c;if(s.length!==l.length){return false}s.sort();l.sort();for(c=s.length-1;c>=0;c--){if(s[c]!==l[c]){return false}}for(c=s.length-1;c>=0;c--){u=s[c];if(!g(e[u],t[u],r,i)){return false}}return true}u.notDeepEqual=function e(t,r,i){if(g(t,r,false)){y(t,r,i,"notDeepEqual",u.notDeepEqual)}};u.notDeepStrictEqual=b;function b(e,t,r){if(g(e,t,true)){y(e,t,r,"notDeepStrictEqual",b)}}u.strictEqual=function e(t,r,i){if(t!==r){y(t,r,i,"===",u.strictEqual)}};u.notStrictEqual=function e(t,r,i){if(t===r){y(t,r,i,"!==",u.notStrictEqual)}};function w(e,t){if(!e||!t){return false}if(Object.prototype.toString.call(t)=="[object RegExp]"){return t.test(e)}try{if(e instanceof t){return true}}catch(e){}if(Error.isPrototypeOf(t)){return false}return t.call({},e)===true}function S(e){var t;try{e()}catch(e){t=e}return t}function C(e,t,r,i){var n;if(typeof t!=="function"){throw new TypeError('"block" argument must be a function')}if(typeof r==="string"){i=r;r=null}n=S(t);i=(r&&r.name?" ("+r.name+").":".")+(i?" "+i:".");if(e&&!n){y(n,r,"Missing expected exception"+i)}var a=typeof i==="string";var o=!e&&f.isError(n);var s=!e&&n&&!r;if(o&&a&&w(n,r)||s){y(n,r,"Got unwanted exception"+i)}if(e&&n&&r&&!w(n,r)||!e&&n){throw n}}u.throws=function(e,t,r){C(true,e,t,r)};u.doesNotThrow=function(e,t,r){C(false,e,t,r)};u.ifError=function(e){if(e){throw e}};var T=k.default||function(e){var t=[];for(var r in e){if(n.call(e,r)){t.push(r)}}return t}});var Z="mapbox-gl";var q="A WebGL interactive maps library";var H="0.51.0";var W="dist/mapbox-gl.js";var X="dist/mapbox-gl.css";var Y="SEE LICENSE IN LICENSE.txt";var K={type:"git",url:"git://github.com/mapbox/mapbox-gl-js.git"};var J={node:">=6.4.0"};var $={"@mapbox/geojson-types":"^1.0.2","@mapbox/jsonlint-lines-primitives":"^2.0.2","@mapbox/mapbox-gl-supported":"^1.4.0","@mapbox/point-geometry":"^0.1.0","@mapbox/tiny-sdf":"^1.1.0","@mapbox/unitbezier":"^0.0.0","@mapbox/vector-tile":"^1.3.1","@mapbox/whoots-js":"^3.1.0",csscolorparser:"~1.0.2",earcut:"^2.1.3",esm:"^3.0.84","geojson-rewind":"^0.3.0","geojson-vt":"^3.2.1","gl-matrix":"^2.6.1","grid-index":"^1.0.0",minimist:"0.0.8","murmurhash-js":"^1.0.0",pbf:"^3.0.5",potpack:"^1.0.1",quickselect:"^1.0.0",rw:"^1.3.3",supercluster:"^4.1.1",tinyqueue:"^1.1.0","vt-pbf":"^3.0.1"};var Q={"@mapbox/batfish":"^1.9.4","@mapbox/flow-remove-types":"^1.3.0-await.upstream.1","@mapbox/mapbox-gl-rtl-text":"^0.2.0","@mapbox/mapbox-gl-test-suite":"file:test/integration","@octokit/rest":"^15.9.5","babel-eslint":"^7.0.0",benchmark:"~2.1.0",browserify:"^16.1.0",d3:"^4.12.0",documentation:"~8.1.1",ejs:"^2.5.7",eslint:"4.1.1","eslint-config-mourner":"^2.0.0","eslint-plugin-flowtype":"^2.34.0","eslint-plugin-html":"^3.0.0","eslint-plugin-import":"^2.9.0","eslint-plugin-react":"^7.3.0","execcommand-copy":"^1.1.0","flow-bin":"^0.77.0","flow-coverage-report":"^0.3.0","github-slugger":"^1.1.1",gl:"^4.0.1",glob:"^7.0.3","is-builtin-module":"^1.0.0",jsdom:"^11.11.0","json-stringify-pretty-compact":"^1.0.4",jsonwebtoken:"^8.3.0","mock-geolocation":"^1.0.11","npm-run-all":"^4.0.1",nyc:"^10.1.2","object.entries":"^1.0.4",pirates:"^3.0.2",pngjs:"^3.0.0","postcss-cli":"^5.0.0","postcss-inline-svg":"^3.1.1","pretty-bytes":"^5.1.0",prismjs:"^1.8.1","prop-types":"^15.6.0","raw-loader":"^0.5.1",react:"^16.0.0","react-dom":"^16.0.0","react-helmet":"^5.2.0",remark:"^8.0.0","remark-html":"^5.0.1","remark-react":"^4.0.1",request:"^2.79.0",rollup:"^0.66.2","rollup-plugin-buble":"^0.18.0","rollup-plugin-commonjs":"^9.1.6","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"3.4.0","rollup-plugin-replace":"^2.0.0","rollup-plugin-sourcemaps":"^0.4.2","rollup-plugin-uglify":"^3.0.0","rollup-plugin-unassert":"^0.2.0",sinon:"^5.0.0",slugg:"^1.2.1",st:"^1.2.0",stylelint:"^8.4.0","stylelint-config-standard":"^18.0.0",tap:"^11.1.2"};var ee={"./src/shaders/index.js":"./src/shaders/shaders.js","./src/util/window.js":"./src/util/browser/window.js","./src/util/web_worker.js":"./src/util/browser/web_worker.js"};var te=true;var re={"build-dev":"rollup -c --environment BUILD:dev","watch-dev":"rollup -c --environment BUILD:dev --watch","build-prod":"rollup -c --environment BUILD:production","build-prod-min":"rollup -c --environment BUILD:production,MINIFY:true","build-flow-types":"cp build/mapbox-gl.js.flow dist/mapbox-gl.js.flow && cp build/mapbox-gl.js.flow dist/mapbox-gl-dev.js.flow","build-css":"postcss -o dist/mapbox-gl.css src/css/mapbox-gl.css","build-style-spec":"cd src/style-spec && npm run build && cd ../.. && mkdir -p dist/style-spec && cp src/style-spec/dist/* dist/style-spec","watch-css":"postcss --watch -o dist/mapbox-gl.css src/css/mapbox-gl.css","build-token":"node build/generate-access-token-script.js","build-benchmarks":'BENCHMARK_VERSION=${BENCHMARK_VERSION:-"$(git rev-parse --abbrev-ref HEAD) $(git rev-parse --short=7 HEAD)"} rollup -c bench/versions/rollup_config_benchmarks.js',"watch-benchmarks":'BENCHMARK_VERSION=${BENCHMARK_VERSION:-"$(git rev-parse --abbrev-ref HEAD) $(git rev-parse --short=7 HEAD)"} rollup -c bench/versions/rollup_config_benchmarks.js --watch',"watch-style-benchmarks":'BENCHMARK_VERSION=${BENCHMARK_VERSION:-"$(git rev-parse --abbrev-ref HEAD) $(git rev-parse --short=7 HEAD)"} rollup -c bench/styles/rollup_config_benchmarks.js --watch',"start-server":"st --no-cache -H 0.0.0.0 --port 9966 --index index.html .",start:"run-p build-token watch-css watch-dev watch-benchmarks watch-style-benchmarks start-server","start-debug":"run-p build-token watch-css watch-dev start-server","start-bench":"run-p build-token watch-benchmarks watch-style-benchmarks start-server","build-docs":"documentation build --github --format json --config ./docs/documentation.yml --output docs/components/api.json src/index.js",build:"run-s build-docs && batfish build # invoked by publisher when publishing docs on the mb-pages branch","start-docs":"run-s build-prod-min build-css build-docs && DEPLOY_ENV=local batfish start",lint:"eslint --cache --ignore-path .gitignore src test bench docs docs/pages/example/*.html debug/*.html","lint-docs":"documentation lint src/index.js","lint-css":"stylelint 'src/css/mapbox-gl.css'","open-changed-examples":"git diff --name-only mb-pages HEAD -- docs/pages/example/*.html | awk '{print \"http://127.0.0.1:4000/mapbox-gl-js/example/\" substr($0,33,length($0)-37)}' | xargs open",test:"run-s lint lint-css test-flow test-unit","test-suite":"run-s test-render test-query","test-suite-clean":'find test/integration/{render,query}-tests -mindepth 2 -type d  -not \\( -exec test -e "{}/style.json" \\; \\) -print | xargs -t rm -r',"test-unit":"build/run-tap --reporter classic --no-coverage test/unit","test-build":"build/run-tap --no-coverage test/build/**/*.test.js","test-render":"node --max-old-space-size=2048 test/render.test.js","test-query":"node test/query.test.js","test-expressions":"build/run-node test/expression.test.js","test-flow":"build/run-node build/generate-flow-typed-style-spec && flow .","test-flow-cov":"flow-coverage-report -i 'src/**/*.js' -t html","test-cov":"nyc --require=@mapbox/flow-remove-types/register --reporter=text-summary --reporter=lcov --cache run-s test-unit test-expressions test-query test-render",prepublishOnly:"run-s build-flow-types build-dev build-prod-min build-prod build-css build-style-spec test-build",codegen:"build/run-node build/generate-style-code.js && build/run-node build/generate-struct-arrays.js"};var ie=["build/","dist/","flow-typed/","src/",".flowconfig"];var ne={name:Z,description:q,version:H,main:W,style:X,license:Y,repository:K,engines:J,dependencies:$,devDependencies:Q,browser:ee,esm:te,scripts:re,files:ie};var ae=oe;function oe(e,t,r,i){this.cx=3*e;this.bx=3*(r-e)-this.cx;this.ax=1-this.cx-this.bx;this.cy=3*t;this.by=3*(i-t)-this.cy;this.ay=1-this.cy-this.by;this.p1x=e;this.p1y=i;this.p2x=r;this.p2y=i}oe.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e};oe.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e};oe.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx};oe.prototype.solveCurveX=function(e,t){var r=this;if(typeof t==="undefined"){t=1e-6}var i,n,a,o,s;for(a=e,s=0;s<8;s++){o=r.sampleCurveX(a)-e;if(Math.abs(o)<t){return a}var l=r.sampleCurveDerivativeX(a);if(Math.abs(l)<1e-6){break}a=a-o/l}i=0;n=1;a=e;if(a<i){return i}if(a>n){return n}while(i<n){o=r.sampleCurveX(a);if(Math.abs(o-e)<t){return a}if(e>o){i=a}else{n=a}a=(n-i)*.5+i}return a};oe.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};"use strict";var se=le;function le(e,t){this.x=e;this.y=t}le.prototype={clone:function e(){return new le(this.x,this.y)},add:function e(t){return this.clone()._add(t)},sub:function e(t){return this.clone()._sub(t)},multByPoint:function e(t){return this.clone()._multByPoint(t)},divByPoint:function e(t){return this.clone()._divByPoint(t)},mult:function e(t){return this.clone()._mult(t)},div:function e(t){return this.clone()._div(t)},rotate:function e(t){return this.clone()._rotate(t)},rotateAround:function e(t,r){return this.clone()._rotateAround(t,r)},matMult:function e(t){return this.clone()._matMult(t)},unit:function e(){return this.clone()._unit()},perp:function e(){return this.clone()._perp()},round:function e(){return this.clone()._round()},mag:function e(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function e(t){return this.x===t.x&&this.y===t.y},dist:function e(t){return Math.sqrt(this.distSqr(t))},distSqr:function e(t){var r=t.x-this.x,i=t.y-this.y;return r*r+i*i},angle:function e(){return Math.atan2(this.y,this.x)},angleTo:function e(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function e(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function e(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function e(t){var r=t[0]*this.x+t[1]*this.y,i=t[2]*this.x+t[3]*this.y;this.x=r;this.y=i;return this},_add:function e(t){this.x+=t.x;this.y+=t.y;return this},_sub:function e(t){this.x-=t.x;this.y-=t.y;return this},_mult:function e(t){this.x*=t;this.y*=t;return this},_div:function e(t){this.x/=t;this.y/=t;return this},_multByPoint:function e(t){this.x*=t.x;this.y*=t.y;return this},_divByPoint:function e(t){this.x/=t.x;this.y/=t.y;return this},_unit:function e(){this._div(this.mag());return this},_perp:function e(){var t=this.y;this.y=this.x;this.x=-t;return this},_rotate:function e(t){var r=Math.cos(t),i=Math.sin(t),n=r*this.x-i*this.y,a=i*this.x+r*this.y;this.x=n;this.y=a;return this},_rotateAround:function e(t,r){var i=Math.cos(t),n=Math.sin(t),a=r.x+i*(this.x-r.x)-n*(this.y-r.y),o=r.y+n*(this.x-r.x)+i*(this.y-r.y);this.x=a;this.y=o;return this},_round:function e(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}};le.convert=function(e){if(e instanceof le){return e}if(Array.isArray(e)){return new le(e[0],e[1])}return e};function ue(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length){return false}for(var r=0;r<e.length;r++){if(!ue(e[r],t[r])){return false}}return true}if((typeof e==="undefined"?"undefined":(0,z.default)(e))==="object"&&e!==null&&t!==null){if(!((typeof t==="undefined"?"undefined":(0,z.default)(t))==="object")){return false}var i=(0,k.default)(e);if(i.length!==(0,k.default)(t).length){return false}for(var n in e){if(!ue(e[n],t[n])){return false}}return true}return e===t}function fe(e){if(e<=0){return 0}if(e>=1){return 1}var t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}function ce(e,t,r,i){var n=new ae(e,t,r,i);return function(e){return n.solve(e)}}var he=ce(.25,.1,.25,1);function pe(e,t,r){return Math.min(r,Math.max(t,e))}function de(e,t,r){var i=r-t;var n=((e-t)%i+i)%i+t;return n===t?r:n}function ve(e,t,r){if(!e.length){return r(null,[])}var i=e.length;var n=new Array(e.length);var a=null;e.forEach(function(e,o){t(e,function(e,t){if(e){a=e}n[o]=t;if(--i===0){r(a,n)}})})}function ye(e){var t=[];for(var r in e){t.push(e[r])}return t}function me(e,t){var r=[];for(var i in e){if(!(i in t)){r.push(i)}}return r}function ge(e){var t=[],r=arguments.length-1;while(r-- >0){t[r]=arguments[r+1]}for(var i=0,n=t;i<n.length;i+=1){var a=n[i];for(var o in a){e[o]=a[o]}}return e}function _e(e,t){var r={};for(var i=0;i<t.length;i++){var n=t[i];if(n in e){r[n]=e[n]}}return r}var xe=1;function be(){return xe++}function we(){function e(t){return t?(t^Math.random()*16>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}return e()}function Se(e){return e?/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e):false}function Ce(e,t){e.forEach(function(e){if(!t[e]){return}t[e]=t[e].bind(t)})}function Te(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Pe(e,t,r){var i=this;var n={};for(var a in e){n[a]=t.call(r||i,e[a],a,e)}return n}function Me(e,t,r){var i=this;var n={};for(var a in e){if(t.call(r||i,e[a],a,e)){n[a]=e[a]}}return n}function Ie(e){if(Array.isArray(e)){return e.map(Ie)}else if((typeof e==="undefined"?"undefined":(0,z.default)(e))==="object"&&e){return Pe(e,Ie)}else{return e}}function Ae(e,t){for(var r=0;r<e.length;r++){if(t.indexOf(e[r])>=0){return true}}return false}var Le={};function Ee(e){if(!Le[e]){if(typeof console!=="undefined"){console.warn(e)}Le[e]=true}}function ke(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function De(e){var t=0;for(var r=0,i=e.length,n=i-1,a=void 0,o=void 0;r<i;n=r++){a=e[r];o=e[n];t+=(o.x-a.x)*(a.y+o.y)}return t}function Be(e){if(e.length<4){return false}var t=e[0];var r=e[e.length-1];if(Math.abs(t.x-r.x)>0||Math.abs(t.y-r.y)>0){return false}return Math.abs(De(e))>.01}function Re(e){var t=e[0];var r=e[1];var i=e[2];r+=90;r*=Math.PI/180;i*=Math.PI/180;return{x:t*Math.cos(r)*Math.sin(i),y:t*Math.sin(r)*Math.sin(i),z:t*Math.cos(i)}}function Fe(e){var t=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g;var r={};e.replace(t,function(e,t,i,n){var a=i||n;r[t]=a?a.toLowerCase():true;return""});if(r["max-age"]){var i=parseInt(r["max-age"],10);if(isNaN(i)){delete r["max-age"]}else{r["max-age"]=i}}return r}function Oe(e){try{var t=self[e];t.setItem("_mapbox_test_",1);t.removeItem("_mapbox_test_");return true}catch(e){return false}}var ze=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date);var Ue=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame;var Ne=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame;var je={now:ze,frame:function e(t){var e=Ue(t);return{cancel:function t(){return Ne(e)}}},getImageData:function e(t){var r=self.document.createElement("canvas");var i=r.getContext("2d");if(!i){throw new Error("failed to create canvas 2d context")}r.width=t.width;r.height=t.height;i.drawImage(t,0,0,t.width,t.height);return i.getImageData(0,0,t.width,t.height)},resolveURL:function e(t){var r=self.document.createElement("a");r.href=t;return r.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},supportsWebp:false};if(self.document){var Ve=self.document.createElement("img");Ve.onload=function(){je.supportsWebp=true};Ve.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="}var Ge={API_URL:"https://api.mapbox.com",get EVENTS_URL(){if(this.API_URL.indexOf("https://api.mapbox.cn")===0){return"https://events.mapbox.cn/events/v2"}else{return"https://events.mapbox.com/events/v2"}},REQUIRE_ACCESS_TOKEN:true,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16};var Ze="See https://www.mapbox.com/api-documentation/#access-tokens";var qe="mapbox.eventData";function He(e,t){var r=nt(Ge.API_URL);e.protocol=r.protocol;e.authority=r.authority;if(r.path!=="/"){e.path=""+r.path+e.path}if(!Ge.REQUIRE_ACCESS_TOKEN){return at(e)}t=t||Ge.ACCESS_TOKEN;if(!t){throw new Error("An API access token is required to use Mapbox GL. "+Ze)}if(t[0]==="s"){throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+Ze)}e.params.push("access_token="+t);return at(e)}function We(e){return e.indexOf("mapbox:")===0}var Xe=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Ye(e){return Xe.test(e)}var Ke=function e(t,r){if(!We(t)){return t}var i=nt(t);i.path="/styles/v1"+i.path;return He(i,r)};var Je=function e(t,r){if(!We(t)){return t}var i=nt(t);i.path="/fonts/v1"+i.path;return He(i,r)};var $e=function e(t,r){if(!We(t)){return t}var i=nt(t);i.path="/v4/"+i.authority+".json";i.params.push("secure");return He(i,r)};var Qe=function e(t,r,i,n){var a=nt(t);if(!We(t)){a.path+=""+r+i;return at(a)}a.path="/styles/v1"+a.path+"/sprite"+r+i;return He(a,n)};var et=/(\.(png|jpg)\d*)(?=$)/;var tt=function e(t,r,i){if(!r||!We(r)){return t}var n=nt(t);var a=je.devicePixelRatio>=2||i===512?"@2x":"";var o=je.supportsWebp?".webp":"$1";n.path=n.path.replace(et,""+a+o);rt(n.params);return at(n)};function rt(e){for(var t=0;t<e.length;t++){if(e[t].indexOf("access_token=tk.")===0){e[t]="access_token="+(Ge.ACCESS_TOKEN||"")}}}var it=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function nt(e){var t=e.match(it);if(!t){throw new Error("Unable to parse URL object")}return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function at(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}var ot=function e(t){this.type=t;this.anonId=null;this.eventData={lastSuccess:null,accessToken:Ge.ACCESS_TOKEN};this.queue=[];this.pendingRequest=null};ot.prototype.fetchEventData=function e(){var t=Oe("localStorage");var r=qe+":"+(Ge.ACCESS_TOKEN||"");var i=qe+".uuid:"+(Ge.ACCESS_TOKEN||"");if(t){try{var n=self.localStorage.getItem(r);if(n){this.eventData=JSON.parse(n)}var a=self.localStorage.getItem(i);if(a){this.anonId=a}}catch(e){Ee("Unable to read from LocalStorage")}}};ot.prototype.saveEventData=function e(){var t=Oe("localStorage");var r=qe+":"+(Ge.ACCESS_TOKEN||"");var i=qe+".uuid:"+(Ge.ACCESS_TOKEN||"");if(t){try{self.localStorage.setItem(i,this.anonId);if(this.eventData.lastSuccess){self.localStorage.setItem(r,(0,B.default)(this.eventData))}}catch(e){Ee("Unable to write to LocalStorage")}}};ot.prototype.processRequests=function e(){};ot.prototype.postEvent=function e(t,r,i){var n=this;var a=nt(Ge.EVENTS_URL);a.params.push("access_token="+(Ge.ACCESS_TOKEN||""));var o={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:H,userId:this.anonId};var s=r?ge(o,r):o;var l={url:at(a),headers:{"Content-Type":"text/plain"},body:(0,B.default)([s])};this.pendingRequest=bt(l,function(e){n.pendingRequest=null;i(e);n.saveEventData();n.processRequests()})};ot.prototype.queueRequest=function e(t){this.queue.push(t);this.processRequests()};var st=function(e){function t(){e.call(this,"map.load");this.success={}}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.postMapLoadEvent=function e(t,r){if(Ge.ACCESS_TOKEN&&Array.isArray(t)&&t.some(function(e){return Ye(e)})){this.queueRequest({id:r,timestamp:Date.now()})}};t.prototype.processRequests=function e(){var t=this;if(this.pendingRequest||this.queue.length===0){return}var r=this.queue.shift();var i=r.id;var n=r.timestamp;if(i&&this.success[i]){return}if(!this.anonId){this.fetchEventData()}if(!Se(this.anonId)){this.anonId=we()}this.postEvent(n,{},function(e){if(!e){if(i){t.success[i]=true}}})};return t}(ot);var lt=function(e){function t(){e.call(this,"appUserTurnstile")}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.postTurnstileEvent=function e(t){if(Ge.ACCESS_TOKEN&&Array.isArray(t)&&t.some(function(e){return Ye(e)})){this.queueRequest(Date.now())}};t.prototype.processRequests=function e(){var t=this;if(this.pendingRequest||this.queue.length===0){return}var r=this.eventData.accessToken?this.eventData.accessToken!==Ge.ACCESS_TOKEN:false;if(r){this.anonId=this.eventData.lastSuccess=null}if(!this.anonId||!this.eventData.lastSuccess){this.fetchEventData()}if(!Se(this.anonId)){this.anonId=we();r=true}var i=this.queue.shift();if(this.eventData.lastSuccess){var n=new Date(this.eventData.lastSuccess);var a=new Date(i);var o=(i-this.eventData.lastSuccess)/(24*60*60*1e3);r=r||o>=1||o<-1||n.getDate()!==a.getDate()}else{r=true}if(!r){return this.processRequests()}this.postEvent(i,{"enabled.telemetry":false},function(e){if(!e){t.eventData.lastSuccess=i;t.eventData.accessToken=Ge.ACCESS_TOKEN}})};return t}(ot);var ut=new lt;var ft=ut.postTurnstileEvent.bind(ut);var ct=new st;var ht=ct.postMapLoadEvent.bind(ct);var pt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};if(typeof C.default=="function"){(0,C.default)(pt)}var dt=function(e){function t(t,r,i){if(r===401&&Ye(i)){t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens"}e.call(this,t);this.status=r;this.url=i;this.name=this.constructor.name;this.message=t}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.toString=function e(){return this.name+": "+this.message+" ("+this.status+"): "+this.url};return t}(Error);var vt=typeof WorkerGlobalScope!=="undefined"&&typeof self!=="undefined"&&self instanceof WorkerGlobalScope?function(){return self.worker&&self.worker.referrer}:function(){var e=self.location.origin;if(e&&e!=="null"&&e!=="file://"){return e+self.location.pathname}};function yt(e,t){var r=new self.AbortController;var i=new self.Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:vt(),signal:r.signal});if(e.type==="json"){i.headers.set("Accept","application/json")}self.fetch(i).then(function(r){if(r.ok){r[e.type||"text"]().then(function(e){t(null,e,r.headers.get("Cache-Control"),r.headers.get("Expires"))}).catch(function(e){return t(new Error(e.message))})}else{t(new dt(r.statusText,r.status,e.url))}}).catch(function(e){t(new Error(e.message))});return{cancel:function e(){return r.abort()}}}function mt(e,t){var r=new self.XMLHttpRequest;r.open(e.method||"GET",e.url,true);if(e.type==="arrayBuffer"){r.responseType="arraybuffer"}for(var i in e.headers){r.setRequestHeader(i,e.headers[i])}if(e.type==="json"){r.setRequestHeader("Accept","application/json")}r.withCredentials=e.credentials==="include";r.onerror=function(){t(new Error(r.statusText))};r.onload=function(){if((r.status>=200&&r.status<300||r.status===0)&&r.response!==null){var i=r.response;if(e.type==="json"){try{i=JSON.parse(r.response)}catch(e){return t(e)}}t(null,i,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"))}else{t(new dt(r.statusText,r.status,e.url))}};r.send(e.body);return{cancel:function e(){return r.abort()}}}var gt=self.fetch&&self.Request&&self.AbortController?yt:mt;var _t=function e(t,r){return gt(ge(t,{type:"json"}),r)};var xt=function e(t,r){return gt(ge(t,{type:"arrayBuffer"}),r)};var bt=function e(t,r){return gt(ge(t,{method:"POST"}),r)};function wt(e){var t=self.document.createElement("a");t.href=e;return t.protocol===self.document.location.protocol&&t.host===self.document.location.host}var St="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";var Ct=[];var Tt=0;var Pt=function e(t,r){if(Tt>=Ge.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:t,callback:r,cancelled:false};Ct.push(i);return{cancel:function e(){i.cancelled=true}}}Tt++;return xt(t,function(t,i,n,a){Tt--;while(Ct.length&&Tt<Ge.MAX_PARALLEL_IMAGE_REQUESTS){var o=Ct.shift();var s=o.requestParameters;var l=o.callback;var u=o.cancelled;if(!u){e(s,l)}}if(t){r(t)}else if(i){var f=new self.Image;var c=self.URL||self.webkitURL;f.onload=function(){r(null,f);c.revokeObjectURL(f.src)};f.onerror=function(){return r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var h=new self.Blob([new Uint8Array(i)],{type:"image/png"});f.cacheControl=n;f.expires=a;f.src=i.byteLength?c.createObjectURL(h):St}})};var Mt=function e(t,r){var i=self.document.createElement("video");i.muted=true;i.onloadstart=function(){r(null,i)};for(var n=0;n<t.length;n++){var a=self.document.createElement("source");if(!wt(t[n])){i.crossOrigin="Anonymous"}a.src=t[n];i.appendChild(a)}return{cancel:function e(){}}};function It(e,t,r){var i=r[e]&&r[e].indexOf(t)!==-1;if(!i){r[e]=r[e]||[];r[e].push(t)}}function At(e,t,r){if(r&&r[e]){var i=r[e].indexOf(t);if(i!==-1){r[e].splice(i,1)}}}var Lt=function e(t,r){if(r===void 0)r={};ge(this,r);this.type=t};var Et=function(e){function t(t,r){if(r===void 0)r={};e.call(this,"error",ge({error:t},r))}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;return t}(Lt);var kt=function e(){};kt.prototype.on=function e(t,r){this._listeners=this._listeners||{};It(t,r,this._listeners);return this};kt.prototype.off=function e(t,r){At(t,r,this._listeners);At(t,r,this._oneTimeListeners);return this};kt.prototype.once=function e(t,r){this._oneTimeListeners=this._oneTimeListeners||{};It(t,r,this._oneTimeListeners);return this};kt.prototype.fire=function e(t){var r=this;if(typeof t==="string"){t=new Lt(t,arguments[1]||{})}var i=t.type;if(this.listens(i)){t.target=this;var n=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];for(var a=0,o=n;a<o.length;a+=1){var s=o[a];s.call(r,t)}var l=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];for(var u=0,f=l;u<f.length;u+=1){var c=f[u];At(i,c,r._oneTimeListeners);c.call(r,t)}var h=this._eventedParent;if(h){ge(t,typeof this._eventedParentData==="function"?this._eventedParentData():this._eventedParentData);h.fire(t)}}else if(t instanceof Et){console.error(t.error)}return this};kt.prototype.listens=function e(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)};kt.prototype.setEventedParent=function e(t,r){this._eventedParent=t;this._eventedParentData=r;return this};var Dt=8;var Bt={version:{required:true,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:true,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:true,type:"array",value:"layer"}};var Rt={"*":{type:"source"}};var Ft=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"];var Ot={type:{required:true,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}};var zt={type:{required:true,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}};var Ut={type:{required:true,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}};var Nt={type:{required:true,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:false},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},lineMetrics:{type:"boolean",default:false},generateId:{type:"boolean",default:false}};var jt={type:{required:true,type:"enum",values:{video:{}}},urls:{required:true,type:"array",value:"string"},coordinates:{required:true,type:"array",length:4,value:{type:"array",length:2,value:"number"}}};var Vt={type:{required:true,type:"enum",values:{image:{}}},url:{required:true,type:"string"},coordinates:{required:true,type:"array",length:4,value:{type:"array",length:2,value:"number"}}};var Gt={id:{type:"string",required:true},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:true},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}};var Zt=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"];var qt={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}};var Ht={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}};var Wt={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}};var Xt={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}};var Yt={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}};var Kt={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:false,expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"symbol-z-order":{type:"enum",values:{"viewport-y":{},source:{}},default:"viewport-y",expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:false,requires:["icon-image"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:false,requires:["icon-image"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:false,requires:["icon-image","text-field"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:true,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"string",tokens:true,expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:true,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:false,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:true,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:true,expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field"],expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:true,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:false,requires:["text-field"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:false,requires:["text-field"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:false,requires:["text-field","icon-image"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}};var Jt={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}};var $t={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}};var Qt={type:"array",value:"*"};var er={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}};var tr={type:"enum",values:{Point:{},LineString:{},Polygon:{}}};var rr={type:"array",minimum:0,maximum:22,value:["number","color"],length:2};var ir={type:"array",value:"*",minimum:1};var nr={type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Heatmap"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}};var ar={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:false,expression:{interpolated:false,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:true,expression:{interpolated:true,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:true,parameters:["zoom"]},transition:true},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:true,parameters:["zoom"]},transition:true}};var or=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"];var sr={"fill-antialias":{type:"boolean",default:true,expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:true,requires:[{"!":"fill-pattern"}],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:true,requires:[{"!":"fill-pattern"},{"fill-antialias":true}],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"string",transition:true,expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}};var lr={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:true,requires:[{"!":"line-pattern"}],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:true,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:false,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"string",transition:true,expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:false,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:true}}],expression:{interpolated:true,parameters:["line-progress"]},"property-type":"color-ramp"}};var ur={"circle-radius":{type:"number",default:5,minimum:0,transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:true,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:true,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:true,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}};var fr={"heatmap-radius":{type:"number",default:30,minimum:1,transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:false,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:false,expression:{interpolated:true,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"}};var cr={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,requires:["icon-image"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:true,requires:["icon-image"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:true,requires:["icon-image"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:true,units:"pixels",requires:["icon-image"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:true,units:"pixels",requires:["icon-image"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:true,units:"pixels",requires:["icon-image"],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:true,requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:true,requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:true,units:"pixels",requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:true,units:"pixels",requires:["text-field"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:true,units:"pixels",requires:["text-field"],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"}};var hr={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:true,units:"degrees",expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:false,units:"milliseconds",expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"}};var pr={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:false,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"}};var dr={"background-color":{type:"color",default:"#000000",transition:true,requires:[{"!":"background-pattern"}],expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"string",transition:true,expression:{interpolated:false,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"}};var vr={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}};var yr={$version:Dt,$root:Bt,sources:Rt,source:Ft,source_vector:Ot,source_raster:zt,source_raster_dem:Ut,source_geojson:Nt,source_video:jt,source_image:Vt,layer:Gt,layout:Zt,layout_background:qt,layout_fill:Ht,layout_circle:Wt,layout_heatmap:Xt,layout_line:Yt,layout_symbol:Kt,layout_raster:Jt,layout_hillshade:$t,filter:Qt,filter_operator:er,geometry_type:tr,function_stop:rr,expression:ir,expression_name:nr,light:ar,paint:or,paint_fill:sr,paint_line:lr,paint_circle:ur,paint_heatmap:fr,paint_symbol:cr,paint_raster:hr,paint_hillshade:pr,paint_background:dr,transition:vr,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:false}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:true,expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:true,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:true,units:"pixels",expression:{interpolated:true,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"string",transition:true,expression:{interpolated:false,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:true,expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:true,requires:["fill-extrusion-height"],expression:{interpolated:true,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:true,transition:false,expression:{interpolated:false,parameters:["zoom"]},"property-type":"data-constant"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}}};var mr=function e(t,r,i,n){this.message=(t?t+": ":"")+i;if(n){this.identifier=n}if(r!==null&&r!==undefined&&r.__line__){this.line=r.__line__}};function gr(e){var t=e.key;var r=e.value;if(r){return[new mr(t,r,"constants have been deprecated as of v8")]}else{return[]}}function _r(e){var t=[],r=arguments.length-1;while(r-- >0){t[r]=arguments[r+1]}for(var i=0,n=t;i<n.length;i+=1){var a=n[i];for(var o in a){e[o]=a[o]}}return e}function xr(e){if(e instanceof Number||e instanceof String||e instanceof Boolean){return e.valueOf()}else{return e}}function br(e){if(Array.isArray(e)){return e.map(br)}return xr(e)}var wr=function(e){function t(t,r){e.call(this,r);this.message=r;this.key=t}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;return t}(Error);var Sr=function e(t,r){var i=this;if(r===void 0)r=[];this.parent=t;this.bindings={};for(var n=0,a=r;n<a.length;n+=1){var o=a[n];var s=o[0];var l=o[1];i.bindings[s]=l}};Sr.prototype.concat=function e(t){return new Sr(this,t)};Sr.prototype.get=function e(t){if(this.bindings[t]){return this.bindings[t]}if(this.parent){return this.parent.get(t)}throw new Error(t+" not found in scope.")};Sr.prototype.has=function e(t){if(this.bindings[t]){return true}return this.parent?this.parent.has(t):false};var Cr={kind:"null"};var Tr={kind:"number"};var Pr={kind:"string"};var Mr={kind:"boolean"};var Ir={kind:"color"};var Ar={kind:"object"};var Lr={kind:"value"};var Er={kind:"error"};var kr={kind:"collator"};var Dr={kind:"formatted"};function Br(e,t){return{kind:"array",itemType:e,N:t}}function Rr(e){if(e.kind==="array"){var t=Rr(e.itemType);return typeof e.N==="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}else{return e.kind}}var Fr=[Cr,Tr,Pr,Mr,Ir,Dr,Ar,Br(Lr)];function Or(e,t){if(t.kind==="error"){return null}else if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Or(e.itemType,t.itemType))&&(typeof e.N!=="number"||e.N===t.N)){return null}}else if(e.kind===t.kind){return null}else if(e.kind==="value"){for(var r=0,i=Fr;r<i.length;r+=1){var n=i[r];if(!Or(n,t)){return null}}}return"Expected "+Rr(e)+" but found "+Rr(t)+" instead."}var zr=o(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(e){e=Math.round(e);return e<0?0:e>255?255:e}function n(e){return e<0?0:e>1?1:e}function a(e){if(e[e.length-1]==="%"){return i(parseFloat(e)/100*255)}return i(parseInt(e))}function o(e){if(e[e.length-1]==="%"){return n(parseFloat(e)/100)}return n(parseFloat(e))}function s(e,t,r){if(r<0){r+=1}else if(r>1){r-=1}if(r*6<1){return e+(t-e)*r*6}if(r*2<1){return t}if(r*3<2){return e+(t-e)*(2/3-r)*6}return e}function l(e){var t=e.replace(/ /g,"").toLowerCase();if(t in r){return r[t].slice()}if(t[0]==="#"){if(t.length===4){var n=parseInt(t.substr(1),16);if(!(n>=0&&n<=4095)){return null}return[(n&3840)>>4|(n&3840)>>8,n&240|(n&240)>>4,n&15|(n&15)<<4,1]}else if(t.length===7){var n=parseInt(t.substr(1),16);if(!(n>=0&&n<=16777215)){return null}return[(n&16711680)>>16,(n&65280)>>8,n&255,1]}return null}var l=t.indexOf("("),u=t.indexOf(")");if(l!==-1&&u+1===t.length){var f=t.substr(0,l);var c=t.substr(l+1,u-(l+1)).split(",");var h=1;switch(f){case"rgba":if(c.length!==4){return null}h=o(c.pop());case"rgb":if(c.length!==3){return null}return[a(c[0]),a(c[1]),a(c[2]),h];case"hsla":if(c.length!==4){return null}h=o(c.pop());case"hsl":if(c.length!==3){return null}var p=(parseFloat(c[0])%360+360)%360/360;var d=o(c[1]);var v=o(c[2]);var y=v<=.5?v*(d+1):v+d-v*d;var m=v*2-y;return[i(s(m,y,p+1/3)*255),i(s(m,y,p)*255),i(s(m,y,p-1/3)*255),h];default:return null}}return null}try{t.parseCSSColor=l}catch(e){}});var Ur=zr.parseCSSColor;var Nr=function e(t,r,i,n){if(n===void 0)n=1;this.r=t;this.g=r;this.b=i;this.a=n};Nr.parse=function e(t){if(!t){return undefined}if(t instanceof Nr){return t}if(typeof t!=="string"){return undefined}var r=Ur(t);if(!r){return undefined}return new Nr(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3])};Nr.prototype.toString=function e(){var t=this.toArray();var r=t[0];var i=t[1];var n=t[2];var a=t[3];return"rgba("+Math.round(r)+","+Math.round(i)+","+Math.round(n)+","+a+")"};Nr.prototype.toArray=function e(){var t=this;var r=t.r;var i=t.g;var n=t.b;var a=t.a;return a===0?[0,0,0,0]:[r*255/a,i*255/a,n*255/a,a]};Nr.black=new Nr(0,0,0,1);Nr.white=new Nr(1,1,1,1);Nr.transparent=new Nr(0,0,0,0);Nr.red=new Nr(1,0,0,1);var jr=function e(t,r,i){if(t){this.sensitivity=r?"variant":"case"}else{this.sensitivity=r?"accent":"base"}this.locale=i;this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};jr.prototype.compare=function e(t,r){return this.collator.compare(t,r)};jr.prototype.resolvedLocale=function e(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Vr=function e(t,r,i){this.text=t;this.scale=r;this.fontStack=i};var Gr=function e(t){this.sections=t};Gr.fromString=function e(t){return new Gr([new Vr(t,null,null)])};Gr.prototype.toString=function e(){return this.sections.map(function(e){return e.text}).join("")};Gr.prototype.serialize=function e(){var t=this;var r=["format"];for(var i=0,n=t.sections;i<n.length;i+=1){var a=n[i];r.push(a.text);var o={};if(a.fontStack){o["text-font"]=["literal",a.fontStack.split(",")]}if(a.scale){o["font-scale"]=a.scale}r.push(o)}return r};function Zr(e,t,r,i){if(!(typeof e==="number"&&e>=0&&e<=255&&typeof t==="number"&&t>=0&&t<=255&&typeof r==="number"&&r>=0&&r<=255)){var n=typeof i==="number"?[e,t,r,i]:[e,t,r];return"Invalid rgba value ["+n.join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}if(!(typeof i==="undefined"||typeof i==="number"&&i>=0&&i<=1)){return"Invalid rgba value ["+[e,t,r,i].join(", ")+"]: 'a' must be between 0 and 1."}return null}function qr(e){if(e===null){return true}else if(typeof e==="string"){return true}else if(typeof e==="boolean"){return true}else if(typeof e==="number"){return true}else if(e instanceof Nr){return true}else if(e instanceof jr){return true}else if(e instanceof Gr){return true}else if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1){var i=r[t];if(!qr(i)){return false}}return true}else if((typeof e==="undefined"?"undefined":(0,z.default)(e))==="object"){for(var n in e){if(!qr(e[n])){return false}}return true}else{return false}}function Hr(e){if(e===null){return Cr}else if(typeof e==="string"){return Pr}else if(typeof e==="boolean"){return Mr}else if(typeof e==="number"){return Tr}else if(e instanceof Nr){return Ir}else if(e instanceof jr){return kr}else if(e instanceof Gr){return Dr}else if(Array.isArray(e)){var t=e.length;var r;for(var i=0,n=e;i<n.length;i+=1){var a=n[i];var o=Hr(a);if(!r){r=o}else if(r===o){continue}else{r=Lr;break}}return Br(r||Lr,t)}else{G((typeof e==="undefined"?"undefined":(0,z.default)(e))==="object");return Ar}}function Wr(e){var t=typeof e==="undefined"?"undefined":(0,z.default)(e);if(e===null){return""}else if(t==="string"||t==="number"||t==="boolean"){return String(e)}else if(e instanceof Nr||e instanceof Gr){return e.toString()}else{return(0,B.default)(e)}}var Xr=function e(t,r){this.type=t;this.value=r};Xr.parse=function e(t,r){if(t.length!==2){return r.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.")}if(!qr(t[1])){return r.error("invalid value")}var i=t[1];var n=Hr(i);var a=r.expectedType;if(n.kind==="array"&&n.N===0&&a&&a.kind==="array"&&(typeof a.N!=="number"||a.N===0)){n=a}return new Xr(n,i)};Xr.prototype.evaluate=function e(){return this.value};Xr.prototype.eachChild=function e(){};Xr.prototype.possibleOutputs=function e(){return[this.value]};Xr.prototype.serialize=function e(){if(this.type.kind==="array"||this.type.kind==="object"){return["literal",this.value]}else if(this.value instanceof Nr){return["rgba"].concat(this.value.toArray())}else if(this.value instanceof Gr){return this.value.serialize()}else{G(this.value===null||typeof this.value==="string"||typeof this.value==="number"||typeof this.value==="boolean");return this.value}};var Yr=function e(t){this.name="ExpressionEvaluationError";this.message=t};Yr.prototype.toJSON=function e(){return this.message};var Kr={string:Pr,number:Tr,boolean:Mr,object:Ar};var Jr=function e(t,r){this.type=t;this.args=r};Jr.parse=function e(t,r){if(t.length<2){return r.error("Expected at least one argument.")}var i=1;var n;var a=t[0];if(a==="array"){var o;if(t.length>2){var s=t[1];if(typeof s!=="string"||!(s in Kr)||s==="object"){return r.error('The item type argument of "array" must be one of string, number, boolean',1)}o=Kr[s];i++}else{o=Lr}var l;if(t.length>3){if(t[2]!==null&&(typeof t[2]!=="number"||t[2]<0||t[2]!==Math.floor(t[2]))){return r.error('The length argument to "array" must be a positive integer literal',2)}l=t[2];i++}n=Br(o,l)}else{G(Kr[a],a);n=Kr[a]}var u=[];for(;i<t.length;i++){var f=r.parse(t[i],i,Lr);if(!f){return null}u.push(f)}return new Jr(n,u)};Jr.prototype.evaluate=function e(t){var r=this;for(var i=0;i<this.args.length;i++){var n=r.args[i].evaluate(t);var a=Or(r.type,Hr(n));if(!a){return n}else if(i===r.args.length-1){throw new Yr("Expected value to be of type "+Rr(r.type)+", but found "+Rr(Hr(n))+" instead.")}}G(false);return null};Jr.prototype.eachChild=function e(t){this.args.forEach(t)};Jr.prototype.possibleOutputs=function e(){return(t=[]).concat.apply(t,this.args.map(function(e){return e.possibleOutputs()}));var t};Jr.prototype.serialize=function e(){var t=this.type;var r=[t.kind];if(t.kind==="array"){var i=t.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){r.push(i.kind);var n=t.N;if(typeof n==="number"||this.args.length>1){r.push(n)}}}return r.concat(this.args.map(function(e){return e.serialize()}))};var $r=function e(t){this.type=Dr;this.sections=t};$r.parse=function e(t,r){if(t.length<3){return r.error("Expected at least two arguments.")}if((t.length-1)%2!==0){return r.error("Expected an even number of arguments.")}var i=[];for(var n=1;n<t.length-1;n+=2){var a=r.parse(t[n],1,Lr);if(!a){return null}var o=a.type.kind;if(o!=="string"&&o!=="value"&&o!=="null"){return r.error("Formatted text type must be 'string', 'value', or 'null'.")}var s=t[n+1];if((typeof s==="undefined"?"undefined":(0,z.default)(s))!=="object"||Array.isArray(s)){return r.error("Format options argument must be an object.")}var l=null;if(s["font-scale"]){l=r.parse(s["font-scale"],1,Tr);if(!l){return null}}var u=null;if(s["text-font"]){u=r.parse(s["text-font"],1,Br(Pr));if(!u){return null}}i.push({text:a,scale:l,font:u})}return new $r(i)};$r.prototype.evaluate=function e(t){return new Gr(this.sections.map(function(e){return new Vr(Wr(e.text.evaluate(t)),e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null)}))};$r.prototype.eachChild=function e(t){var r=this;for(var i=0,n=r.sections;i<n.length;i+=1){var a=n[i];t(a.text);if(a.scale){t(a.scale)}if(a.font){t(a.font)}}};$r.prototype.possibleOutputs=function e(){return[undefined]};$r.prototype.serialize=function e(){var t=this;var r=["format"];for(var i=0,n=t.sections;i<n.length;i+=1){var a=n[i];r.push(a.text.serialize());var o={};if(a.scale){o["font-scale"]=a.scale.serialize()}if(a.font){o["text-font"]=a.font.serialize()}r.push(o)}return r};var Qr={"to-boolean":Mr,"to-color":Ir,"to-number":Tr,"to-string":Pr};var ei=function e(t,r){this.type=t;this.args=r};ei.parse=function e(t,r){if(t.length<2){return r.error("Expected at least one argument.")}var i=t[0];G(Qr[i],i);if((i==="to-boolean"||i==="to-string")&&t.length!==2){return r.error("Expected one argument.")}var n=Qr[i];var a=[];for(var o=1;o<t.length;o++){var s=r.parse(t[o],o,Lr);if(!s){return null}a.push(s)}return new ei(n,a)};ei.prototype.evaluate=function e(t){var r=this;if(this.type.kind==="boolean"){return Boolean(this.args[0].evaluate(t))}else if(this.type.kind==="color"){var i;var n;for(var a=0,o=r.args;a<o.length;a+=1){var s=o[a];i=s.evaluate(t);n=null;if(i instanceof Nr){return i}else if(typeof i==="string"){var l=t.parseColor(i);if(l){return l}}else if(Array.isArray(i)){if(i.length<3||i.length>4){n="Invalid rbga value "+(0,B.default)(i)+": expected an array containing either three or four numeric values."}else{n=Zr(i[0],i[1],i[2],i[3])}if(!n){return new Nr(i[0]/255,i[1]/255,i[2]/255,i[3])}}}throw new Yr(n||"Could not parse color from value '"+(typeof i==="string"?i:(0,B.default)(i))+"'")}else if(this.type.kind==="number"){var u=null;for(var f=0,c=r.args;f<c.length;f+=1){var h=c[f];u=h.evaluate(t);if(u===null){return 0}var p=Number(u);if(isNaN(p)){continue}return p}throw new Yr("Could not convert "+(0,B.default)(u)+" to number.")}else if(this.type.kind==="formatted"){return Gr.fromString(Wr(this.args[0].evaluate(t)))}else{return Wr(this.args[0].evaluate(t))}};ei.prototype.eachChild=function e(t){this.args.forEach(t)};ei.prototype.possibleOutputs=function e(){return(t=[]).concat.apply(t,this.args.map(function(e){return e.possibleOutputs()}));var t};ei.prototype.serialize=function e(){if(this.type.kind==="formatted"){return new $r([{text:this.args[0],scale:null,font:null}]).serialize()}var t=["to-"+this.type.kind];this.eachChild(function(e){t.push(e.serialize())});return t};var ti=["Unknown","Point","LineString","Polygon"];var ri=function e(){this.globals=null;this.feature=null;this.featureState=null;this._parseColorCache={}};ri.prototype.id=function e(){return this.feature&&"id"in this.feature?this.feature.id:null};ri.prototype.geometryType=function e(){return this.feature?typeof this.feature.type==="number"?ti[this.feature.type]:this.feature.type:null};ri.prototype.properties=function e(){return this.feature&&this.feature.properties||{}};ri.prototype.parseColor=function e(t){var r=this._parseColorCache[t];if(!r){r=this._parseColorCache[t]=Nr.parse(t)}return r};var ii=function e(t,r,i,n){this.name=t;this.type=r;this._evaluate=i;this.args=n};ii.prototype.evaluate=function e(t){return this._evaluate(t,this.args)};ii.prototype.eachChild=function e(t){this.args.forEach(t)};ii.prototype.possibleOutputs=function e(){return[undefined]};ii.prototype.serialize=function e(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))};ii.parse=function e(t,r){var i=t[0];var n=ii.definitions[i];if(!n){return r.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0)}var a=Array.isArray(n)?n[0]:n.type;var o=Array.isArray(n)?[[n[1],n[2]]]:n.overloads;var s=o.filter(function(e){var r=e[0];return!Array.isArray(r)||r.length===t.length-1});var l=null;for(var u=0,f=s;u<f.length;u+=1){var c=f[u];var h=c[0];var p=c[1];l=new fi(r.registry,r.path,null,r.scope);var d=[];var v=false;for(var y=1;y<t.length;y++){var m=t[y];var g=Array.isArray(h)?h[y-1]:h.type;var _=l.parse(m,1+d.length,g);if(!_){v=true;break}d.push(_)}if(v){continue}if(Array.isArray(h)){if(h.length!==d.length){l.error("Expected "+h.length+" arguments, but found "+d.length+" instead.");continue}}for(var x=0;x<d.length;x++){var b=Array.isArray(h)?h[x]:h.type;var w=d[x];l.concat(x+1).checkSubtype(b,w.type)}if(l.errors.length===0){return new ii(i,a,p,d)}}G(!l||l.errors.length>0);if(s.length===1){r.errors.push.apply(r.errors,l.errors)}else{var S=s.length?s:o;var C=S.map(function(e){var t=e[0];return ni(t)}).join(" | ");var T=[];for(var P=1;P<t.length;P++){var M=r.parse(t[P],1+T.length);if(!M){return null}T.push(Rr(M.type))}r.error("Expected arguments of type "+C+", but found ("+T.join(", ")+") instead.")}return null};ii.register=function e(t,r){G(!ii.definitions);ii.definitions=r;for(var i in r){t[i]=ii}};function ni(e){if(Array.isArray(e)){return"("+e.map(Rr).join(", ")+")"}else{return"("+Rr(e.type)+"...)"}}var ai=function e(t,r,i){this.type=kr;this.locale=i;this.caseSensitive=t;this.diacriticSensitive=r};ai.parse=function e(t,r){if(t.length!==2){return r.error("Expected one argument.")}var i=t[1];if((typeof i==="undefined"?"undefined":(0,z.default)(i))!=="object"||Array.isArray(i)){return r.error("Collator options argument must be an object.")}var n=r.parse(i["case-sensitive"]===undefined?false:i["case-sensitive"],1,Mr);if(!n){return null}var a=r.parse(i["diacritic-sensitive"]===undefined?false:i["diacritic-sensitive"],1,Mr);if(!a){return null}var o=null;if(i["locale"]){o=r.parse(i["locale"],1,Pr);if(!o){return null}}return new ai(n,a,o)};ai.prototype.evaluate=function e(t){return new jr(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)};ai.prototype.eachChild=function e(t){t(this.caseSensitive);t(this.diacriticSensitive);if(this.locale){t(this.locale)}};ai.prototype.possibleOutputs=function e(){return[undefined]};ai.prototype.serialize=function e(){var t={};t["case-sensitive"]=this.caseSensitive.serialize();t["diacritic-sensitive"]=this.diacriticSensitive.serialize();if(this.locale){t["locale"]=this.locale.serialize()}return["collator",t]};function oi(e){if(e instanceof ii){if(e.name==="get"&&e.args.length===1){return false}else if(e.name==="feature-state"){return false}else if(e.name==="has"&&e.args.length===1){return false}else if(e.name==="properties"||e.name==="geometry-type"||e.name==="id"){return false}else if(/^filter-/.test(e.name)){return false}}var t=true;e.eachChild(function(e){if(t&&!oi(e)){t=false}});return t}function si(e){if(e instanceof ii){if(e.name==="feature-state"){return false}}var t=true;e.eachChild(function(e){if(t&&!si(e)){t=false}});return t}function li(e,t){if(e instanceof ii&&t.indexOf(e.name)>=0){return false}var r=true;e.eachChild(function(e){if(r&&!li(e,t)){r=false}});return r}var ui=function e(t,r){this.type=r.type;this.name=t;this.boundExpression=r};ui.parse=function e(t,r){if(t.length!==2||typeof t[1]!=="string"){return r.error("'var' expression requires exactly one string literal argument.")}var i=t[1];if(!r.scope.has(i)){return r.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)}return new ui(i,r.scope.get(i))};ui.prototype.evaluate=function e(t){return this.boundExpression.evaluate(t)};ui.prototype.eachChild=function e(){};ui.prototype.possibleOutputs=function e(){return[undefined]};ui.prototype.serialize=function e(){return["var",this.name]};var fi=function e(t,r,i,n,a){if(r===void 0)r=[];if(n===void 0)n=new Sr;if(a===void 0)a=[];this.registry=t;this.path=r;this.key=r.map(function(e){return"["+e+"]"}).join("");this.scope=n;this.errors=a;this.expectedType=i};fi.prototype.parse=function e(t,r,i,n,a){if(a===void 0)a={};if(r){return this.concat(r,i,n)._parse(t,a)}return this._parse(t,a)};fi.prototype._parse=function e(t,r){if(t===null||typeof t==="string"||typeof t==="boolean"||typeof t==="number"){t=["literal",t]}function i(e,t,r){if(r==="assert"){return new Jr(t,[e])}else if(r==="coerce"){return new ei(t,[e])}else{return e}}if(Array.isArray(t)){if(t.length===0){return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].')}var n=t[0];if(typeof n!=="string"){this.error("Expression name must be a string, but found "+(typeof n==="undefined"?"undefined":(0,z.default)(n))+' instead. If you wanted a literal array, use ["literal", [...]].',0);return null}var a=this.registry[n];if(a){var o=a.parse(t,this);if(!o){return null}if(this.expectedType){var s=this.expectedType;var l=o.type;if((s.kind==="string"||s.kind==="number"||s.kind==="boolean"||s.kind==="object"||s.kind==="array")&&l.kind==="value"){o=i(o,s,r.typeAnnotation||"assert")}else if((s.kind==="color"||s.kind==="formatted")&&(l.kind==="value"||l.kind==="string")){o=i(o,s,r.typeAnnotation||"coerce")}else if(this.checkSubtype(s,l)){return null}}if(!(o instanceof Xr)&&ci(o)){var u=new ri;try{o=new Xr(o.type,o.evaluate(u))}catch(e){this.error(e.message);return null}}return o}return this.error('Unknown expression "'+n+'". If you wanted a literal array, use ["literal", [...]].',0)}else if(typeof t==="undefined"){return this.error("'undefined' value invalid. Use null instead.")}else if((typeof t==="undefined"?"undefined":(0,z.default)(t))==="object"){return this.error('Bare objects invalid. Use ["literal", {...}] instead.')}else{return this.error("Expected an array, but found "+(typeof t==="undefined"?"undefined":(0,z.default)(t))+" instead.")}};fi.prototype.concat=function e(t,r,i){var n=typeof t==="number"?this.path.concat(t):this.path;var a=i?this.scope.concat(i):this.scope;return new fi(this.registry,n,r||null,a,this.errors)};fi.prototype.error=function e(t){var r=[],i=arguments.length-1;while(i-- >0){r[i]=arguments[i+1]}var n=""+this.key+r.map(function(e){return"["+e+"]"}).join("");this.errors.push(new wr(n,t))};fi.prototype.checkSubtype=function e(t,r){var i=Or(t,r);if(i){this.error(i)}return i};function ci(e){if(e instanceof ui){return ci(e.boundExpression)}else if(e instanceof ii&&e.name==="error"){return false}else if(e instanceof ai){return false}var t=e instanceof ei||e instanceof Jr;var r=true;e.eachChild(function(e){if(t){r=r&&ci(e)}else{r=r&&e instanceof Xr}});if(!r){return false}return oi(e)&&li(e,["zoom","heatmap-density","line-progress","is-supported-script"])}function hi(e,t){var r=e.length;var i=0;var n=r-1;var a=0;var o,s;while(i<=n){a=Math.floor((i+n)/2);o=e[a];s=e[a+1];if(t===o||t>o&&t<s){return a}else if(o<t){i=a+1}else if(o>t){n=a-1}else{throw new Yr("Input is not a number.")}}return Math.max(a-1,0)}var pi=function e(t,r,i){var n=this;this.type=t;this.input=r;this.labels=[];this.outputs=[];for(var a=0,o=i;a<o.length;a+=1){var s=o[a];var l=s[0];var u=s[1];n.labels.push(l);n.outputs.push(u)}};pi.parse=function e(t,r){var i=t[1];var n=t.slice(2);if(t.length-1<4){return r.error("Expected at least 4 arguments, but found only "+(t.length-1)+".")}if((t.length-1)%2!==0){return r.error("Expected an even number of arguments.")}i=r.parse(i,1,Tr);if(!i){return null}var a=[];var o=null;if(r.expectedType&&r.expectedType.kind!=="value"){o=r.expectedType}n.unshift(-Infinity);for(var s=0;s<n.length;s+=2){var l=n[s];var u=n[s+1];var f=s+1;var c=s+2;if(typeof l!=="number"){return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',f)}if(a.length&&a[a.length-1][0]>=l){return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',f)}var h=r.parse(u,c,o);if(!h){return null}o=o||h.type;a.push([l,h])}return new pi(o,i,a)};pi.prototype.evaluate=function e(t){var r=this.labels;var i=this.outputs;if(r.length===1){return i[0].evaluate(t)}var n=this.input.evaluate(t);if(n<=r[0]){return i[0].evaluate(t)}var a=r.length;if(n>=r[a-1]){return i[a-1].evaluate(t)}var o=hi(r,n);return i[o].evaluate(t)};pi.prototype.eachChild=function e(t){var r=this;t(this.input);for(var i=0,n=r.outputs;i<n.length;i+=1){var a=n[i];t(a)}};pi.prototype.possibleOutputs=function e(){return(t=[]).concat.apply(t,this.outputs.map(function(e){return e.possibleOutputs()}));var t};pi.prototype.serialize=function e(){var t=this;var r=["step",this.input.serialize()];for(var i=0;i<this.labels.length;i++){if(i>0){r.push(t.labels[i])}r.push(t.outputs[i].serialize())}return r};function di(e,t,r){return e*(1-r)+t*r}function vi(e,t,r){return new Nr(di(e.r,t.r,r),di(e.g,t.g,r),di(e.b,t.b,r),di(e.a,t.a,r))}function yi(e,t,r){return e.map(function(e,i){return di(e,t[i],r)})}var mi=(0,C.default)({number:di,color:vi,array:yi});var gi=.95047,_i=1,xi=1.08883,bi=4/29,wi=6/29,Si=3*wi*wi,Ci=wi*wi*wi,Ti=Math.PI/180,Pi=180/Math.PI;function Mi(e){return e>Ci?Math.pow(e,1/3):e/Si+bi}function Ii(e){return e>wi?e*e*e:Si*(e-bi)}function Ai(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Li(e){e/=255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Ei(e){var t=Li(e.r),r=Li(e.g),i=Li(e.b),n=Mi((.4124564*t+.3575761*r+.1804375*i)/gi),a=Mi((.2126729*t+.7151522*r+.072175*i)/_i),o=Mi((.0193339*t+.119192*r+.9503041*i)/xi);return{l:116*a-16,a:500*(n-a),b:200*(a-o),alpha:e.a}}function ki(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,i=isNaN(e.b)?t:t-e.b/200;t=_i*Ii(t);r=gi*Ii(r);i=xi*Ii(i);return new Nr(Ai(3.2404542*r-1.5371385*t-.4985314*i),Ai(-.969266*r+1.8760108*t+.041556*i),Ai(.0556434*r-.2040259*t+1.0572252*i),e.alpha)}function Di(e,t,r){return{l:di(e.l,t.l,r),a:di(e.a,t.a,r),b:di(e.b,t.b,r),alpha:di(e.alpha,t.alpha,r)}}function Bi(e){var t=Ei(e);var r=t.l;var i=t.a;var n=t.b;var a=Math.atan2(n,i)*Pi;return{h:a<0?a+360:a,c:Math.sqrt(i*i+n*n),l:r,alpha:e.a}}function Ri(e){var t=e.h*Ti,r=e.c,i=e.l;return ki({l:i,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})}function Fi(e,t,r){var i=t-e;return e+r*(i>180||i<-180?i-360*Math.round(i/360):i)}function Oi(e,t,r){return{h:Fi(e.h,t.h,r),c:di(e.c,t.c,r),l:di(e.l,t.l,r),alpha:di(e.alpha,t.alpha,r)}}var zi={forward:Ei,reverse:ki,interpolate:Di};var Ui={forward:Bi,reverse:Ri,interpolate:Oi};var Ni=(0,C.default)({lab:zi,hcl:Ui});var ji=function e(t,r,i,n,a){var o=this;this.type=t;this.operator=r;this.interpolation=i;this.input=n;this.labels=[];this.outputs=[];for(var s=0,l=a;s<l.length;s+=1){var u=l[s];var f=u[0];var c=u[1];o.labels.push(f);o.outputs.push(c)}};ji.interpolationFactor=function e(t,r,i,n){var a=0;if(t.name==="exponential"){a=Vi(r,t.base,i,n)}else if(t.name==="linear"){a=Vi(r,1,i,n)}else if(t.name==="cubic-bezier"){var o=t.controlPoints;var s=new ae(o[0],o[1],o[2],o[3]);a=s.solve(Vi(r,1,i,n))}return a};ji.parse=function e(t,r){var i=t[0];var n=t[1];var a=t[2];var o=t.slice(3);if(!Array.isArray(n)||n.length===0){return r.error("Expected an interpolation type expression.",1)}if(n[0]==="linear"){n={name:"linear"}}else if(n[0]==="exponential"){var s=n[1];if(typeof s!=="number"){return r.error("Exponential interpolation requires a numeric base.",1,1)}n={name:"exponential",base:s}}else if(n[0]==="cubic-bezier"){var l=n.slice(1);if(l.length!==4||l.some(function(e){return typeof e!=="number"||e<0||e>1})){return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1)}n={name:"cubic-bezier",controlPoints:l}}else{return r.error("Unknown interpolation type "+String(n[0]),1,0)}if(t.length-1<4){return r.error("Expected at least 4 arguments, but found only "+(t.length-1)+".")}if((t.length-1)%2!==0){return r.error("Expected an even number of arguments.")}a=r.parse(a,2,Tr);if(!a){return null}var u=[];var f=null;if(i==="interpolate-hcl"||i==="interpolate-lab"){f=Ir}else if(r.expectedType&&r.expectedType.kind!=="value"){f=r.expectedType}for(var c=0;c<o.length;c+=2){var h=o[c];var p=o[c+1];var d=c+3;var v=c+4;if(typeof h!=="number"){return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d)}if(u.length&&u[u.length-1][0]>=h){return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d)}var y=r.parse(p,v,f);if(!y){return null}f=f||y.type;u.push([h,y])}if(f.kind!=="number"&&f.kind!=="color"&&!(f.kind==="array"&&f.itemType.kind==="number"&&typeof f.N==="number")){return r.error("Type "+Rr(f)+" is not interpolatable.")}return new ji(f,i,n,a,u)};ji.prototype.evaluate=function e(t){var r=this.labels;var i=this.outputs;if(r.length===1){return i[0].evaluate(t)}var n=this.input.evaluate(t);if(n<=r[0]){return i[0].evaluate(t)}var a=r.length;if(n>=r[a-1]){return i[a-1].evaluate(t)}var o=hi(r,n);var s=r[o];var l=r[o+1];var u=ji.interpolationFactor(this.interpolation,n,s,l);var f=i[o].evaluate(t);var c=i[o+1].evaluate(t);if(this.operator==="interpolate"){return mi[this.type.kind.toLowerCase()](f,c,u)}else if(this.operator==="interpolate-hcl"){return Ui.reverse(Ui.interpolate(Ui.forward(f),Ui.forward(c),u))}else{return zi.reverse(zi.interpolate(zi.forward(f),zi.forward(c),u))}};ji.prototype.eachChild=function e(t){var r=this;t(this.input);for(var i=0,n=r.outputs;i<n.length;i+=1){var a=n[i];t(a)}};ji.prototype.possibleOutputs=function e(){return(t=[]).concat.apply(t,this.outputs.map(function(e){return e.possibleOutputs()}));var t};ji.prototype.serialize=function e(){var t=this;var r;if(this.interpolation.name==="linear"){r=["linear"]}else if(this.interpolation.name==="exponential"){if(this.interpolation.base===1){r=["linear"]}else{r=["exponential",this.interpolation.base]}}else{r=["cubic-bezier"].concat(this.interpolation.controlPoints)}var i=[this.operator,r,this.input.serialize()];for(var n=0;n<this.labels.length;n++){i.push(t.labels[n],t.outputs[n].serialize())}return i};function Vi(e,t,r,i){var n=i-r;var a=e-r;if(n===0){return 0}else if(t===1){return a/n}else{return(Math.pow(t,a)-1)/(Math.pow(t,n)-1)}}var Gi=function e(t,r){this.type=t;this.args=r};Gi.parse=function e(t,r){if(t.length<2){return r.error("Expectected at least one argument.")}var i=null;var n=r.expectedType;if(n&&n.kind!=="value"){i=n}var a=[];for(var o=0,s=t.slice(1);o<s.length;o+=1){var l=s[o];var u=r.parse(l,1+a.length,i,undefined,{typeAnnotation:"omit"});if(!u){return null}i=i||u.type;a.push(u)}G(i);var f=n&&a.some(function(e){return Or(n,e.type)});return f?new Gi(Lr,a):new Gi(i,a)};Gi.prototype.evaluate=function e(t){var r=this;var i=null;for(var n=0,a=r.args;n<a.length;n+=1){var o=a[n];i=o.evaluate(t);if(i!==null){break}}return i};Gi.prototype.eachChild=function e(t){this.args.forEach(t)};Gi.prototype.possibleOutputs=function e(){return(t=[]).concat.apply(t,this.args.map(function(e){return e.possibleOutputs()}));var t};Gi.prototype.serialize=function e(){var t=["coalesce"];this.eachChild(function(e){t.push(e.serialize())});return t};var Zi=function e(t,r){this.type=r.type;this.bindings=[].concat(t);this.result=r};Zi.prototype.evaluate=function e(t){return this.result.evaluate(t)};Zi.prototype.eachChild=function e(t){var r=this;for(var i=0,n=r.bindings;i<n.length;i+=1){var a=n[i];t(a[1])}t(this.result)};Zi.parse=function e(t,r){if(t.length<4){return r.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.")}var i=[];for(var n=1;n<t.length-1;n+=2){var a=t[n];if(typeof a!=="string"){return r.error("Expected string, but found "+(typeof a==="undefined"?"undefined":(0,z.default)(a))+" instead.",n)}if(/[^a-zA-Z0-9_]/.test(a)){return r.error("Variable names must contain only alphanumeric characters or '_'.",n)}var o=r.parse(t[n+1],n+1);if(!o){return null}i.push([a,o])}var s=r.parse(t[t.length-1],t.length-1,r.expectedType,i);if(!s){return null}return new Zi(i,s)};Zi.prototype.possibleOutputs=function e(){return this.result.possibleOutputs()};Zi.prototype.serialize=function e(){var t=this;var r=["let"];for(var i=0,n=t.bindings;i<n.length;i+=1){var a=n[i];var o=a[0];var s=a[1];r.push(o,s.serialize())}r.push(this.result.serialize());return r};var qi=function e(t,r,i){this.type=t;this.index=r;this.input=i};qi.parse=function e(t,r){if(t.length!==3){return r.error("Expected 2 arguments, but found "+(t.length-1)+" instead.")}var i=r.parse(t[1],1,Tr);var n=r.parse(t[2],2,Br(r.expectedType||Lr));if(!i||!n){return null}var a=n.type;return new qi(a.itemType,i,n)};qi.prototype.evaluate=function e(t){var r=this.index.evaluate(t);var i=this.input.evaluate(t);if(r<0){throw new Yr("Array index out of bounds: "+r+" < 0.")}if(r>=i.length){throw new Yr("Array index out of bounds: "+r+" > "+(i.length-1)+".")}if(r!==Math.floor(r)){throw new Yr("Array index must be an integer, but found "+r+" instead.")}return i[r]};qi.prototype.eachChild=function e(t){t(this.index);t(this.input)};qi.prototype.possibleOutputs=function e(){return[undefined]};qi.prototype.serialize=function e(){return["at",this.index.serialize(),this.input.serialize()]};var Hi=function e(t,r,i,n,a,o){this.inputType=t;this.type=r;this.input=i;this.cases=n;this.outputs=a;this.otherwise=o};Hi.parse=function e(t,r){if(t.length<5){return r.error("Expected at least 4 arguments, but found only "+(t.length-1)+".")}if(t.length%2!==1){return r.error("Expected an even number of arguments.")}var i;var n;if(r.expectedType&&r.expectedType.kind!=="value"){n=r.expectedType}var a={};var o=[];for(var s=2;s<t.length-1;s+=2){var l=t[s];var u=t[s+1];if(!Array.isArray(l)){l=[l]}var f=r.concat(s);if(l.length===0){return f.error("Expected at least one branch label.")}for(var c=0,h=l;c<h.length;c+=1){var p=h[c];if(typeof p!=="number"&&typeof p!=="string"){return f.error("Branch labels must be numbers or strings.")}else if(typeof p==="number"&&Math.abs(p)>w.default){return f.error("Branch labels must be integers no larger than "+w.default+".")}else if(typeof p==="number"&&Math.floor(p)!==p){return f.error("Numeric branch labels must be integer values.")}else if(!i){i=Hr(p)}else if(f.checkSubtype(i,Hr(p))){return null}if(typeof a[String(p)]!=="undefined"){return f.error("Branch labels must be unique.")}a[String(p)]=o.length}var d=r.parse(u,s,n);if(!d){return null}n=n||d.type;o.push(d)}var v=r.parse(t[1],1,Lr);if(!v){return null}var y=r.parse(t[t.length-1],t.length-1,n);if(!y){return null}G(i&&n);if(v.type.kind!=="value"&&r.concat(1).checkSubtype(i,v.type)){return null}return new Hi(i,n,v,a,o,y)};Hi.prototype.evaluate=function e(t){var r=this.input.evaluate(t);var i=Hr(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise;return i.evaluate(t)};Hi.prototype.eachChild=function e(t){t(this.input);this.outputs.forEach(t);t(this.otherwise)};Hi.prototype.possibleOutputs=function e(){return(t=[]).concat.apply(t,this.outputs.map(function(e){return e.possibleOutputs()})).concat(this.otherwise.possibleOutputs());var t};Hi.prototype.serialize=function e(){var t=this;var r=["match",this.input.serialize()];var i=(0,k.default)(this.cases).sort();var n=[];var a={};for(var o=0,s=i;o<s.length;o+=1){var l=s[o];var u=a[t.cases[l]];if(u===undefined){a[t.cases[l]]=n.length;n.push([t.cases[l],[l]])}else{n[u][1].push(l)}}var f=function e(r){return t.inputType.kind==="number"?Number(r):r};for(var c=0,h=n;c<h.length;c+=1){var p=h[c];var d=p[0];var v=p[1];if(v.length===1){r.push(f(v[0]))}else{r.push(v.map(f))}r.push(t.outputs[d].serialize())}r.push(this.otherwise.serialize());return r};var Wi=function e(t,r,i){this.type=t;this.branches=r;this.otherwise=i};Wi.parse=function e(t,r){if(t.length<4){return r.error("Expected at least 3 arguments, but found only "+(t.length-1)+".")}if(t.length%2!==0){return r.error("Expected an odd number of arguments.")}var i;if(r.expectedType&&r.expectedType.kind!=="value"){i=r.expectedType}var n=[];for(var a=1;a<t.length-1;a+=2){var o=r.parse(t[a],a,Mr);if(!o){return null}var s=r.parse(t[a+1],a+1,i);if(!s){return null}n.push([o,s]);i=i||s.type}var l=r.parse(t[t.length-1],t.length-1,i);if(!l){return null}G(i);return new Wi(i,n,l)};Wi.prototype.evaluate=function e(t){var r=this;for(var i=0,n=r.branches;i<n.length;i+=1){var a=n[i];var o=a[0];var s=a[1];if(o.evaluate(t)){return s.evaluate(t)}}return this.otherwise.evaluate(t)};Wi.prototype.eachChild=function e(t){var r=this;for(var i=0,n=r.branches;i<n.length;i+=1){var a=n[i];var o=a[0];var s=a[1];t(o);t(s)}t(this.otherwise)};Wi.prototype.possibleOutputs=function e(){return(t=[]).concat.apply(t,this.branches.map(function(e){var t=e[0];var r=e[1];return r.possibleOutputs()})).concat(this.otherwise.possibleOutputs());var t};Wi.prototype.serialize=function e(){var t=["case"];this.eachChild(function(e){t.push(e.serialize())});return t};function Xi(e,t){if(e==="=="||e==="!="){return t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value"}else{return t.kind==="string"||t.kind==="number"||t.kind==="value"}}function Yi(e,t,r){return t===r}function Ki(e,t,r){return t!==r}function Ji(e,t,r){return t<r}function $i(e,t,r){return t>r}function Qi(e,t,r){return t<=r}function en(e,t,r){return t>=r}function tn(e,t,r,i){return i.compare(t,r)===0}function rn(e,t,r,i){return!tn(e,t,r,i)}function nn(e,t,r,i){return i.compare(t,r)<0}function an(e,t,r,i){return i.compare(t,r)>0}function on(e,t,r,i){return i.compare(t,r)<=0}function sn(e,t,r,i){return i.compare(t,r)>=0}function ln(e,t,r){var i=e!=="=="&&e!=="!=";return function(){function n(e,t,r){this.type=Mr;this.lhs=e;this.rhs=t;this.collator=r;this.hasUntypedArgument=e.type.kind==="value"||t.type.kind==="value"}n.parse=function e(t,r){if(t.length!==3&&t.length!==4){return r.error("Expected two or three arguments.")}var a=t[0];var o=r.parse(t[1],1,Lr);if(!o){return null}if(!Xi(a,o.type)){return r.concat(1).error('"'+a+"\" comparisons are not supported for type '"+Rr(o.type)+"'.")}var s=r.parse(t[2],2,Lr);if(!s){return null}if(!Xi(a,s.type)){return r.concat(2).error('"'+a+"\" comparisons are not supported for type '"+Rr(s.type)+"'.")}if(o.type.kind!==s.type.kind&&o.type.kind!=="value"&&s.type.kind!=="value"){return r.error("Cannot compare types '"+Rr(o.type)+"' and '"+Rr(s.type)+"'.")}if(i){if(o.type.kind==="value"&&s.type.kind!=="value"){o=new Jr(s.type,[o])}else if(o.type.kind!=="value"&&s.type.kind==="value"){s=new Jr(o.type,[s])}}var l=null;if(t.length===4){if(o.type.kind!=="string"&&s.type.kind!=="string"&&o.type.kind!=="value"&&s.type.kind!=="value"){return r.error("Cannot use collator to compare non-string types.")}l=r.parse(t[3],3,kr);if(!l){return null}}return new n(o,s,l)};n.prototype.evaluate=function n(a){var o=this.lhs.evaluate(a);var s=this.rhs.evaluate(a);if(i&&this.hasUntypedArgument){var l=Hr(o);var u=Hr(s);if(l.kind!==u.kind||!(l.kind==="string"||l.kind==="number")){throw new Yr('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+l.kind+", "+u.kind+") instead.")}}if(this.collator&&!i&&this.hasUntypedArgument){var f=Hr(o);var c=Hr(s);if(f.kind!=="string"||c.kind!=="string"){return t(a,o,s)}}return this.collator?r(a,o,s,this.collator.evaluate(a)):t(a,o,s)};n.prototype.eachChild=function e(t){t(this.lhs);t(this.rhs);if(this.collator){t(this.collator)}};n.prototype.possibleOutputs=function e(){return[true,false]};n.prototype.serialize=function t(){var r=[e];this.eachChild(function(e){r.push(e.serialize())});return r};return n}()}var un=ln("==",Yi,tn);var fn=ln("!=",Ki,rn);var cn=ln("<",Ji,nn);var hn=ln(">",$i,an);var pn=ln("<=",Qi,on);var dn=ln(">=",en,sn);var vn=function e(t){this.type=Tr;this.input=t};vn.parse=function e(t,r){if(t.length!==2){return r.error("Expected 1 argument, but found "+(t.length-1)+" instead.")}var i=r.parse(t[1],1);if(!i){return null}if(i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"){return r.error("Expected argument of type string or array, but found "+Rr(i.type)+" instead.")}return new vn(i)};vn.prototype.evaluate=function e(t){var r=this.input.evaluate(t);if(typeof r==="string"){return r.length}else if(Array.isArray(r)){return r.length}else{throw new Yr("Expected value to be of type string or array, but found "+Rr(Hr(r))+" instead.")}};vn.prototype.eachChild=function e(t){t(this.input)};vn.prototype.possibleOutputs=function e(){return[undefined]};vn.prototype.serialize=function e(){var t=["length"];this.eachChild(function(e){t.push(e.serialize())});return t};var yn={"==":un,"!=":fn,">":hn,"<":cn,">=":dn,"<=":pn,array:Jr,at:qi,boolean:Jr,case:Wi,coalesce:Gi,collator:ai,format:$r,interpolate:ji,"interpolate-hcl":ji,"interpolate-lab":ji,length:vn,let:Zi,literal:Xr,match:Hi,number:Jr,object:Jr,step:pi,string:Jr,"to-boolean":ei,"to-color":ei,"to-number":ei,"to-string":ei,var:ui};function mn(e,t){var r=t[0];var i=t[1];var n=t[2];var a=t[3];r=r.evaluate(e);i=i.evaluate(e);n=n.evaluate(e);var o=a?a.evaluate(e):1;var s=Zr(r,i,n,o);if(s){throw new Yr(s)}return new Nr(r/255*o,i/255*o,n/255*o,o)}function gn(e,t){return e in t}function _n(e,t){var r=t[e];return typeof r==="undefined"?null:r}function xn(e,t,r,i){while(r<=i){var n=r+i>>1;if(t[n]===e){return true}if(t[n]>e){i=n-1}else{r=n+1}}return false}function bn(e){return{type:e}}ii.register(yn,{error:[Er,[Pr],function(e,t){var r=t[0];throw new Yr(r.evaluate(e))}],typeof:[Pr,[Lr],function(e,t){var r=t[0];return Rr(Hr(r.evaluate(e)))}],"to-rgba":[Br(Tr,4),[Ir],function(e,t){var r=t[0];return r.evaluate(e).toArray()}],rgb:[Ir,[Tr,Tr,Tr],mn],rgba:[Ir,[Tr,Tr,Tr,Tr],mn],has:{type:Mr,overloads:[[[Pr],function(e,t){var r=t[0];return gn(r.evaluate(e),e.properties())}],[[Pr,Ar],function(e,t){var r=t[0];var i=t[1];return gn(r.evaluate(e),i.evaluate(e))}]]},get:{type:Lr,overloads:[[[Pr],function(e,t){var r=t[0];return _n(r.evaluate(e),e.properties())}],[[Pr,Ar],function(e,t){var r=t[0];var i=t[1];return _n(r.evaluate(e),i.evaluate(e))}]]},"feature-state":[Lr,[Pr],function(e,t){var r=t[0];return _n(r.evaluate(e),e.featureState||{})}],properties:[Ar,[],function(e){return e.properties()}],"geometry-type":[Pr,[],function(e){return e.geometryType()}],id:[Lr,[],function(e){return e.id()}],zoom:[Tr,[],function(e){return e.globals.zoom}],"heatmap-density":[Tr,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[Tr,[],function(e){return e.globals.lineProgress||0}],"+":[Tr,bn(Tr),function(e,t){var r=0;for(var i=0,n=t;i<n.length;i+=1){var a=n[i];r+=a.evaluate(e)}return r}],"*":[Tr,bn(Tr),function(e,t){var r=1;for(var i=0,n=t;i<n.length;i+=1){var a=n[i];r*=a.evaluate(e)}return r}],"-":{type:Tr,overloads:[[[Tr,Tr],function(e,t){var r=t[0];var i=t[1];return r.evaluate(e)-i.evaluate(e)}],[[Tr],function(e,t){var r=t[0];return-r.evaluate(e)}]]},"/":[Tr,[Tr,Tr],function(e,t){var r=t[0];var i=t[1];return r.evaluate(e)/i.evaluate(e)}],"%":[Tr,[Tr,Tr],function(e,t){var r=t[0];var i=t[1];return r.evaluate(e)%i.evaluate(e)}],ln2:[Tr,[],function(){return Math.LN2}],pi:[Tr,[],function(){return Math.PI}],e:[Tr,[],function(){return Math.E}],"^":[Tr,[Tr,Tr],function(e,t){var r=t[0];var i=t[1];return Math.pow(r.evaluate(e),i.evaluate(e))}],sqrt:[Tr,[Tr],function(e,t){var r=t[0];return Math.sqrt(r.evaluate(e))}],log10:[Tr,[Tr],function(e,t){var r=t[0];return Math.log(r.evaluate(e))/Math.LN10}],ln:[Tr,[Tr],function(e,t){var r=t[0];return Math.log(r.evaluate(e))}],log2:[Tr,[Tr],function(e,t){var r=t[0];return Math.log(r.evaluate(e))/Math.LN2}],sin:[Tr,[Tr],function(e,t){var r=t[0];return Math.sin(r.evaluate(e))}],cos:[Tr,[Tr],function(e,t){var r=t[0];return Math.cos(r.evaluate(e))}],tan:[Tr,[Tr],function(e,t){var r=t[0];return Math.tan(r.evaluate(e))}],asin:[Tr,[Tr],function(e,t){var r=t[0];return Math.asin(r.evaluate(e))}],acos:[Tr,[Tr],function(e,t){var r=t[0];return Math.acos(r.evaluate(e))}],atan:[Tr,[Tr],function(e,t){var r=t[0];return Math.atan(r.evaluate(e))}],min:[Tr,bn(Tr),function(e,t){return Math.min.apply(Math,t.map(function(t){return t.evaluate(e)}))}],max:[Tr,bn(Tr),function(e,t){return Math.max.apply(Math,t.map(function(t){return t.evaluate(e)}))}],abs:[Tr,[Tr],function(e,t){var r=t[0];return Math.abs(r.evaluate(e))}],round:[Tr,[Tr],function(e,t){var r=t[0];var i=r.evaluate(e);return i<0?-Math.round(-i):Math.round(i)}],floor:[Tr,[Tr],function(e,t){var r=t[0];return Math.floor(r.evaluate(e))}],ceil:[Tr,[Tr],function(e,t){var r=t[0];return Math.ceil(r.evaluate(e))}],"filter-==":[Mr,[Pr,Lr],function(e,t){var r=t[0];var i=t[1];return e.properties()[r.value]===i.value}],"filter-id-==":[Mr,[Lr],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[Mr,[Pr],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[Mr,[Pr,Lr],function(e,t){var r=t[0];var i=t[1];var n=e.properties()[r.value];var a=i.value;return(typeof n==="undefined"?"undefined":(0,z.default)(n))===(typeof a==="undefined"?"undefined":(0,z.default)(a))&&n<a}],"filter-id-<":[Mr,[Lr],function(e,t){var r=t[0];var i=e.id();var n=r.value;return(typeof i==="undefined"?"undefined":(0,z.default)(i))===(typeof n==="undefined"?"undefined":(0,z.default)(n))&&i<n}],"filter->":[Mr,[Pr,Lr],function(e,t){var r=t[0];var i=t[1];var n=e.properties()[r.value];var a=i.value;return(typeof n==="undefined"?"undefined":(0,z.default)(n))===(typeof a==="undefined"?"undefined":(0,z.default)(a))&&n>a}],"filter-id->":[Mr,[Lr],function(e,t){var r=t[0];var i=e.id();var n=r.value;return(typeof i==="undefined"?"undefined":(0,z.default)(i))===(typeof n==="undefined"?"undefined":(0,z.default)(n))&&i>n}],"filter-<=":[Mr,[Pr,Lr],function(e,t){var r=t[0];var i=t[1];var n=e.properties()[r.value];var a=i.value;return(typeof n==="undefined"?"undefined":(0,z.default)(n))===(typeof a==="undefined"?"undefined":(0,z.default)(a))&&n<=a}],"filter-id-<=":[Mr,[Lr],function(e,t){var r=t[0];var i=e.id();var n=r.value;return(typeof i==="undefined"?"undefined":(0,z.default)(i))===(typeof n==="undefined"?"undefined":(0,z.default)(n))&&i<=n}],"filter->=":[Mr,[Pr,Lr],function(e,t){var r=t[0];var i=t[1];var n=e.properties()[r.value];var a=i.value;return(typeof n==="undefined"?"undefined":(0,z.default)(n))===(typeof a==="undefined"?"undefined":(0,z.default)(a))&&n>=a}],"filter-id->=":[Mr,[Lr],function(e,t){var r=t[0];var i=e.id();var n=r.value;return(typeof i==="undefined"?"undefined":(0,z.default)(i))===(typeof n==="undefined"?"undefined":(0,z.default)(n))&&i>=n}],"filter-has":[Mr,[Lr],function(e,t){var r=t[0];return r.value in e.properties()}],"filter-has-id":[Mr,[],function(e){return e.id()!==null}],"filter-type-in":[Mr,[Br(Pr)],function(e,t){var r=t[0];return r.value.indexOf(e.geometryType())>=0}],"filter-id-in":[Mr,[Br(Lr)],function(e,t){var r=t[0];return r.value.indexOf(e.id())>=0}],"filter-in-small":[Mr,[Pr,Br(Lr)],function(e,t){var r=t[0];var i=t[1];return i.value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[Mr,[Pr,Br(Lr)],function(e,t){var r=t[0];var i=t[1];return xn(e.properties()[r.value],i.value,0,i.value.length-1)}],all:{type:Mr,overloads:[[[Mr,Mr],function(e,t){var r=t[0];var i=t[1];return r.evaluate(e)&&i.evaluate(e)}],[bn(Mr),function(e,t){for(var r=0,i=t;r<i.length;r+=1){var n=i[r];if(!n.evaluate(e)){return false}}return true}]]},any:{type:Mr,overloads:[[[Mr,Mr],function(e,t){var r=t[0];var i=t[1];return r.evaluate(e)||i.evaluate(e)}],[bn(Mr),function(e,t){for(var r=0,i=t;r<i.length;r+=1){var n=i[r];if(n.evaluate(e)){return true}}return false}]]},"!":[Mr,[Mr],function(e,t){var r=t[0];return!r.evaluate(e)}],"is-supported-script":[Mr,[Pr],function(e,t){var r=t[0];var i=e.globals&&e.globals.isSupportedScript;if(i){return i(r.evaluate(e))}return true}],upcase:[Pr,[Pr],function(e,t){var r=t[0];return r.evaluate(e).toUpperCase()}],downcase:[Pr,[Pr],function(e,t){var r=t[0];return r.evaluate(e).toLowerCase()}],concat:[Pr,bn(Lr),function(e,t){return t.map(function(t){return Wr(t.evaluate(e))}).join("")}],"resolved-locale":[Pr,[kr],function(e,t){var r=t[0];return r.evaluate(e).resolvedLocale()}]});function wn(e){return{result:"success",value:e}}function Sn(e){return{result:"error",value:e}}function Cn(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Tn(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Pn(e){return!!e.expression&&e.expression.interpolated}function Mn(e){if(e instanceof Number){return"number"}else if(e instanceof String){return"string"}else if(e instanceof Boolean){return"boolean"}else if(Array.isArray(e)){return"array"}else if(e===null){return"null"}else{return typeof e==="undefined"?"undefined":(0,z.default)(e)}}function In(e){return(typeof e==="undefined"?"undefined":(0,z.default)(e))==="object"&&e!==null&&!Array.isArray(e)}function An(e){return e}function Ln(e,t){var r=t.type==="color";var i=e.stops&&(0,z.default)(e.stops[0][0])==="object";var n=i||e.property!==undefined;var a=i||!n;var o=e.type||(Pn(t)?"exponential":"interval");if(r){e=_r({},e);if(e.stops){e.stops=e.stops.map(function(e){return[e[0],Nr.parse(e[1])]})}if(e.default){e.default=Nr.parse(e.default)}else{e.default=Nr.parse(t.default)}}if(e.colorSpace&&e.colorSpace!=="rgb"&&!Ni[e.colorSpace]){throw new Error("Unknown color space: "+e.colorSpace)}var s;var l;var u;if(o==="exponential"){s=Bn}else if(o==="interval"){s=Dn}else if(o==="categorical"){s=kn;l=(0,F.default)(null);for(var f=0,c=e.stops;f<c.length;f+=1){var h=c[f];l[h[0]]=h[1]}u=(0,z.default)(e.stops[0][0])}else if(o==="identity"){s=Rn}else{throw new Error('Unknown function type "'+o+'"')}if(i){var p={};var d=[];for(var v=0;v<e.stops.length;v++){var y=e.stops[v];var m=y[0].zoom;if(p[m]===undefined){p[m]={zoom:m,type:e.type,property:e.property,default:e.default,stops:[]};d.push(m)}p[m].stops.push([y[0].value,y[1]])}var g=[];for(var _=0,x=d;_<x.length;_+=1){var b=x[_];g.push([p[b].zoom,Ln(p[b],t)])}return{kind:"composite",interpolationFactor:ji.interpolationFactor.bind(undefined,{name:"linear"}),zoomStops:g.map(function(e){return e[0]}),evaluate:function r(i,n){var a=i.zoom;return Bn({stops:g,base:e.base},t,a).evaluate(a,n)}}}else if(a){return{kind:"camera",interpolationFactor:o==="exponential"?ji.interpolationFactor.bind(undefined,{name:"exponential",base:e.base!==undefined?e.base:1}):function(){return 0},zoomStops:e.stops.map(function(e){return e[0]}),evaluate:function r(i){var n=i.zoom;return s(e,t,n,l,u)}}}else{return{kind:"source",evaluate:function r(i,n){var a=n&&n.properties?n.properties[e.property]:undefined;if(a===undefined){return En(e.default,t.default)}return s(e,t,a,l,u)}}}}function En(e,t,r){if(e!==undefined){return e}if(t!==undefined){return t}if(r!==undefined){return r}}function kn(e,t,r,i,n){var a=(typeof r==="undefined"?"undefined":(0,z.default)(r))===n?i[r]:undefined;return En(a,e.default,t.default)}function Dn(e,t,r){if(Mn(r)!=="number"){return En(e.default,t.default)}var i=e.stops.length;if(i===1){return e.stops[0][1]}if(r<=e.stops[0][0]){return e.stops[0][1]}if(r>=e.stops[i-1][0]){return e.stops[i-1][1]}var n=Fn(e.stops,r);return e.stops[n][1]}function Bn(e,t,r){var i=e.base!==undefined?e.base:1;if(Mn(r)!=="number"){return En(e.default,t.default)}var n=e.stops.length;if(n===1){return e.stops[0][1]}if(r<=e.stops[0][0]){return e.stops[0][1]}if(r>=e.stops[n-1][0]){return e.stops[n-1][1]}var a=Fn(e.stops,r);var o=On(r,i,e.stops[a][0],e.stops[a+1][0]);var s=e.stops[a][1];var l=e.stops[a+1][1];var u=mi[t.type]||An;if(e.colorSpace&&e.colorSpace!=="rgb"){var f=Ni[e.colorSpace];u=function e(t,r){return f.reverse(f.interpolate(f.forward(t),f.forward(r),o))}}if(typeof s.evaluate==="function"){return{evaluate:function e(){var t=[],r=arguments.length;while(r--){t[r]=arguments[r]}var i=s.evaluate.apply(undefined,t);var n=l.evaluate.apply(undefined,t);if(i===undefined||n===undefined){return undefined}return u(i,n,o)}}}return u(s,l,o)}function Rn(e,t,r){if(t.type==="color"){r=Nr.parse(r)}else if(t.type==="formatted"){r=Gr.fromString(r.toString())}else if(Mn(r)!==t.type&&(t.type!=="enum"||!t.values[r])){r=undefined}return En(r,e.default,t.default)}function Fn(e,t){var r=e.length;var i=0;var n=r-1;var a=0;var o,s;while(i<=n){a=Math.floor((i+n)/2);o=e[a][0];s=e[a+1][0];if(t===o||t>o&&t<s){return a}else if(o<t){i=a+1}else if(o>t){n=a-1}}return Math.max(a-1,0)}function On(e,t,r,i){var n=i-r;var a=e-r;if(n===0){return 0}else if(t===1){return a/n}else{return(Math.pow(t,a)-1)/(Math.pow(t,n)-1)}}var zn=function e(t,r){this.expression=t;this._warningHistory={};this._evaluator=new ri;this._defaultValue=Xn(r);this._enumValues=r.type==="enum"?r.values:null};zn.prototype.evaluateWithoutErrorHandling=function e(t,r,i){this._evaluator.globals=t;this._evaluator.feature=r;this._evaluator.featureState=i;return this.expression.evaluate(this._evaluator)};zn.prototype.evaluate=function e(t,r,i){this._evaluator.globals=t;this._evaluator.feature=r||null;this._evaluator.featureState=i||null;try{var n=this.expression.evaluate(this._evaluator);if(n===null||n===undefined){return this._defaultValue}if(this._enumValues&&!(n in this._enumValues)){throw new Yr("Expected value to be one of "+(0,k.default)(this._enumValues).map(function(e){return(0,B.default)(e)}).join(", ")+", but found "+(0,B.default)(n)+" instead.")}return n}catch(e){if(!this._warningHistory[e.message]){this._warningHistory[e.message]=true;if(typeof console!=="undefined"){console.warn(e.message)}}return this._defaultValue}};function Un(e){return Array.isArray(e)&&e.length>0&&typeof e[0]==="string"&&e[0]in yn}function Nn(e,t){var r=new fi(yn,[],Wn(t));var i=r.parse(e,undefined,undefined,undefined,t.type==="string"?{typeAnnotation:"coerce"}:undefined);if(!i){G(r.errors.length>0);return Sn(r.errors)}return wn(new zn(i,t))}var jn=function e(t,r){this.kind=t;this._styleExpression=r;this.isStateDependent=t!=="constant"&&!si(r.expression)};jn.prototype.evaluateWithoutErrorHandling=function e(t,r,i){return this._styleExpression.evaluateWithoutErrorHandling(t,r,i)};jn.prototype.evaluate=function e(t,r,i){return this._styleExpression.evaluate(t,r,i)};var Vn=function e(t,r,i){this.kind=t;this.zoomStops=i.labels;this._styleExpression=r;this.isStateDependent=t!=="camera"&&!si(r.expression);if(i instanceof ji){this._interpolationType=i.interpolation}};Vn.prototype.evaluateWithoutErrorHandling=function e(t,r,i){return this._styleExpression.evaluateWithoutErrorHandling(t,r,i)};Vn.prototype.evaluate=function e(t,r,i){return this._styleExpression.evaluate(t,r,i)};Vn.prototype.interpolationFactor=function e(t,r,i){if(this._interpolationType){return ji.interpolationFactor(this._interpolationType,t,r,i)}else{return 0}};function Gn(e,t){e=Nn(e,t);if(e.result==="error"){return e}var r=e.value.expression;var i=oi(r);if(!i&&!Cn(t)){return Sn([new wr("","data expressions not supported")])}var n=li(r,["zoom"]);if(!n&&!Tn(t)){return Sn([new wr("","zoom expressions not supported")])}var a=Hn(r);if(!a&&!n){return Sn([new wr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}else if(a instanceof wr){return Sn([a])}else if(a instanceof ji&&!Pn(t)){return Sn([new wr("",'"interpolate" expressions cannot be used with this property')])}if(!a){return wn(i?new jn("constant",e.value):new jn("source",e.value))}return wn(i?new Vn("camera",e.value,a):new Vn("composite",e.value,a))}var Zn=function e(t,r){this._parameters=t;this._specification=r;_r(this,Ln(this._parameters,this._specification))};Zn.deserialize=function e(t){return new Zn(t._parameters,t._specification)};Zn.serialize=function e(t){return{_parameters:t._parameters,_specification:t._specification}};function qn(e,t){if(In(e)){return new Zn(e,t)}else if(Un(e)){var r=Gn(e,t);if(r.result==="error"){throw new Error(r.value.map(function(e){return e.key+": "+e.message}).join(", "))}return r.value}else{var i=e;if(typeof e==="string"&&t.type==="color"){i=Nr.parse(e)}return{kind:"constant",evaluate:function e(){return i}}}}function Hn(e){var t=null;if(e instanceof Zi){t=Hn(e.result)}else if(e instanceof Gi){for(var r=0,i=e.args;r<i.length;r+=1){var n=i[r];t=Hn(n);if(t){break}}}else if((e instanceof pi||e instanceof ji)&&e.input instanceof ii&&e.input.name==="zoom"){t=e}if(t instanceof wr){return t}e.eachChild(function(e){var r=Hn(e);if(r instanceof wr){t=r}else if(!t&&r){t=new wr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')}else if(t&&r&&t!==r){t=new wr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.')}});return t}function Wn(e){var t={color:Ir,string:Pr,number:Tr,enum:Pr,boolean:Mr,formatted:Dr};if(e.type==="array"){return Br(t[e.value]||Lr,e.length)}return t[e.type]}function Xn(e){if(e.type==="color"&&In(e.default)){return new Nr(0,0,0,0)}else if(e.type==="color"){return Nr.parse(e.default)||null}else if(e.default===undefined){return null}else{return e.default}}function Yn(e){var t=e.key;var r=e.value;var i=e.valueSpec||{};var n=e.objectElementValidators||{};var a=e.style;var o=e.styleSpec;var s=[];var l=Mn(r);if(l!=="object"){return[new mr(t,r,"object expected, "+l+" found")]}for(var u in r){var f=u.split(".")[0];var c=i[f]||i["*"];var h=void 0;if(n[f]){h=n[f]}else if(i[f]){h=Ca}else if(n["*"]){h=n["*"]}else if(i["*"]){h=Ca}else{s.push(new mr(t,r[u],'unknown property "'+u+'"'));continue}s=s.concat(h({key:(t?t+".":t)+u,value:r[u],valueSpec:c,style:a,styleSpec:o,object:r,objectKey:u},r))}for(var p in i){if(n[p]){continue}if(i[p].required&&i[p]["default"]===undefined&&r[p]===undefined){s.push(new mr(t,r,'missing required property "'+p+'"'))}}return s}function Kn(e){var t=e.value;var r=e.valueSpec;var i=e.style;var n=e.styleSpec;var a=e.key;var o=e.arrayElementValidator||Ca;if(Mn(t)!=="array"){return[new mr(a,t,"array expected, "+Mn(t)+" found")]}if(r.length&&t.length!==r.length){return[new mr(a,t,"array length "+r.length+" expected, length "+t.length+" found")]}if(r["min-length"]&&t.length<r["min-length"]){return[new mr(a,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")]}var s={type:r.value};if(n.$version<7){s.function=r.function}if(Mn(r.value)==="object"){s=r.value}var l=[];for(var u=0;u<t.length;u++){l=l.concat(o({array:t,arrayIndex:u,value:t[u],valueSpec:s,style:i,styleSpec:n,key:a+"["+u+"]"}))}return l}function Jn(e){var t=e.key;var r=e.value;var i=e.valueSpec;var n=Mn(r);if(n!=="number"){return[new mr(t,r,"number expected, "+n+" found")]}if("minimum"in i&&r<i.minimum){return[new mr(t,r,r+" is less than the minimum value "+i.minimum)]}if("maximum"in i&&r>i.maximum){return[new mr(t,r,r+" is greater than the maximum value "+i.maximum)]}return[]}function $n(e){var t=e.valueSpec;var r=xr(e.value.type);var i;var n={};var a;var o;var s=r!=="categorical"&&e.value.property===undefined;var l=!s;var u=Mn(e.value.stops)==="array"&&Mn(e.value.stops[0])==="array"&&Mn(e.value.stops[0][0])==="object";var f=Yn({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:c,default:d}});if(r==="identity"&&s){f.push(new mr(e.key,e.value,'missing required property "property"'))}if(r!=="identity"&&!e.value.stops){f.push(new mr(e.key,e.value,'missing required property "stops"'))}if(r==="exponential"&&e.valueSpec.expression&&!Pn(e.valueSpec)){f.push(new mr(e.key,e.value,"exponential functions not supported"))}if(e.styleSpec.$version>=8){if(l&&!Cn(e.valueSpec)){f.push(new mr(e.key,e.value,"property functions not supported"))}else if(s&&!Tn(e.valueSpec)){f.push(new mr(e.key,e.value,"zoom functions not supported"))}}if((r==="categorical"||u)&&e.value.property===undefined){f.push(new mr(e.key,e.value,'"property" property is required'))}return f;function c(e){if(r==="identity"){return[new mr(e.key,e.value,'identity function may not have a "stops" property')]}var t=[];var i=e.value;t=t.concat(Kn({key:e.key,value:i,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:h}));if(Mn(i)==="array"&&i.length===0){t.push(new mr(e.key,i,"array must have at least one stop"))}return t}function h(e){var r=[];var i=e.value;var s=e.key;if(Mn(i)!=="array"){return[new mr(s,i,"array expected, "+Mn(i)+" found")]}if(i.length!==2){return[new mr(s,i,"array length 2 expected, length "+i.length+" found")]}if(u){if(Mn(i[0])!=="object"){return[new mr(s,i,"object expected, "+Mn(i[0])+" found")]}if(i[0].zoom===undefined){return[new mr(s,i,"object stop key must have zoom")]}if(i[0].value===undefined){return[new mr(s,i,"object stop key must have value")]}if(o&&o>xr(i[0].zoom)){return[new mr(s,i[0].zoom,"stop zoom values must appear in ascending order")]}if(xr(i[0].zoom)!==o){o=xr(i[0].zoom);a=undefined;n={}}r=r.concat(Yn({key:s+"[0]",value:i[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:Jn,value:p}}))}else{r=r.concat(p({key:s+"[0]",value:i[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},i))}if(Un(br(i[1]))){return r.concat([new mr(s+"[1]",i[1],"expressions are not allowed in function stops.")])}return r.concat(Ca({key:s+"[1]",value:i[1],valueSpec:t,style:e.style,styleSpec:e.styleSpec}))}function p(e,o){var s=Mn(e.value);var l=xr(e.value);var u=e.value!==null?e.value:o;if(!i){i=s}else if(s!==i){return[new mr(e.key,u,s+" stop domain type must match previous stop domain type "+i)]}if(s!=="number"&&s!=="string"&&s!=="boolean"){return[new mr(e.key,u,"stop domain value must be a number, string, or boolean")]}if(s!=="number"&&r!=="categorical"){var f="number expected, "+s+" found";if(Cn(t)&&r===undefined){f+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'}return[new mr(e.key,u,f)]}if(r==="categorical"&&s==="number"&&(!isFinite(l)||Math.floor(l)!==l)){return[new mr(e.key,u,"integer expected, found "+l)]}if(r!=="categorical"&&s==="number"&&a!==undefined&&l<a){return[new mr(e.key,u,"stop domain values must appear in ascending order")]}else{a=l}if(r==="categorical"&&l in n){return[new mr(e.key,u,"stop domain values must be unique")]}else{n[l]=true}return[]}function d(e){return Ca({key:e.key,value:e.value,valueSpec:t,style:e.style,styleSpec:e.styleSpec})}}function Qn(e){var t=(e.expressionContext==="property"?Gn:Nn)(br(e.value),e.valueSpec);if(t.result==="error"){return t.value.map(function(t){return new mr(""+e.key+t.key,e.value,t.message)})}if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&t.value._styleExpression.expression.possibleOutputs().indexOf(undefined)!==-1){return[new mr(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')]}if(e.expressionContext==="property"&&e.propertyType==="layout"&&!si(t.value._styleExpression.expression)){return[new mr(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')]}if(e.expressionContext==="filter"&&!si(t.value.expression)){return[new mr(e.key,e.value,'"feature-state" data expressions are not supported with filters.')]}return[]}function ea(e){var t=e.value;var r=e.key;var i=Mn(t);if(i!=="boolean"){return[new mr(r,t,"boolean expected, "+i+" found")]}return[]}function ta(e){var t=e.key;var r=e.value;var i=Mn(r);if(i!=="string"){return[new mr(t,r,"color expected, "+i+" found")]}if(Ur(r)===null){return[new mr(t,r,'color expected, "'+r+'" found')]}return[]}function ra(e){var t=e.key;var r=e.value;var i=e.valueSpec;var n=[];if(Array.isArray(i.values)){if(i.values.indexOf(xr(r))===-1){n.push(new mr(t,r,"expected one of ["+i.values.join(", ")+"], "+(0,B.default)(r)+" found"))}}else{if((0,k.default)(i.values).indexOf(xr(r))===-1){n.push(new mr(t,r,"expected one of ["+(0,k.default)(i.values).join(", ")+"], "+(0,B.default)(r)+" found"))}}return n}function ia(e){if(e===true||e===false){return true}if(!Array.isArray(e)||e.length===0){return false}switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":case"!in":case"!has":case"none":return false;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var i=r[t];if(!ia(i)&&typeof i!=="boolean"){return false}}return true;default:return true}}var na={type:"boolean",default:false,transition:false,"property-type":"data-driven",expression:{interpolated:false,parameters:["zoom","feature"]}};function aa(e){if(e===null||e===undefined){return function(){return true}}if(!ia(e)){e=sa(e)}var t=Nn(e,na);if(t.result==="error"){throw new Error(t.value.map(function(e){return e.key+": "+e.message}).join(", "))}else{return function(e,r){return t.value.evaluate(e,r)}}}function oa(e,t){return e<t?-1:e>t?1:0}function sa(e){if(!e){return true}var t=e[0];if(e.length<=1){return t!=="any"}var r=t==="=="?la(e[1],e[2],"=="):t==="!="?ha(la(e[1],e[2],"==")):t==="<"||t===">"||t==="<="||t===">="?la(e[1],e[2],t):t==="any"?ua(e.slice(1)):t==="all"?["all"].concat(e.slice(1).map(sa)):t==="none"?["all"].concat(e.slice(1).map(sa).map(ha)):t==="in"?fa(e[1],e.slice(2)):t==="!in"?ha(fa(e[1],e.slice(2))):t==="has"?ca(e[1]):t==="!has"?ha(ca(e[1])):true;return r}function la(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function ua(e){return["any"].concat(e.map(sa))}function fa(e,t){if(t.length===0){return false}switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:if(t.length>200&&!t.some(function(e){return(typeof e==="undefined"?"undefined":(0,z.default)(e))!==(0,z.default)(t[0])})){return["filter-in-large",e,["literal",t.sort(oa)]]}else{return["filter-in-small",e,["literal",t]]}}}function ca(e){switch(e){case"$type":return true;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function ha(e){return["!",e]}function pa(e){if(ia(br(e.value))){return Qn(_r({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}}))}else{return da(e)}}function da(e){var t=e.value;var r=e.key;if(Mn(t)!=="array"){return[new mr(r,t,"array expected, "+Mn(t)+" found")]}var i=e.styleSpec;var n;var a=[];if(t.length<1){return[new mr(r,t,"filter array must have at least 1 element")]}a=a.concat(ra({key:r+"[0]",value:t[0],valueSpec:i.filter_operator,style:e.style,styleSpec:e.styleSpec}));switch(xr(t[0])){case"<":case"<=":case">":case">=":if(t.length>=2&&xr(t[1])==="$type"){a.push(new mr(r,t,'"$type" cannot be use with operator "'+t[0]+'"'))}case"==":case"!=":if(t.length!==3){a.push(new mr(r,t,'filter array for operator "'+t[0]+'" must have 3 elements'))}case"in":case"!in":if(t.length>=2){n=Mn(t[1]);if(n!=="string"){a.push(new mr(r+"[1]",t[1],"string expected, "+n+" found"))}}for(var o=2;o<t.length;o++){n=Mn(t[o]);if(xr(t[1])==="$type"){a=a.concat(ra({key:r+"["+o+"]",value:t[o],valueSpec:i.geometry_type,style:e.style,styleSpec:e.styleSpec}))}else if(n!=="string"&&n!=="number"&&n!=="boolean"){a.push(new mr(r+"["+o+"]",t[o],"string, number, or boolean expected, "+n+" found"))}}break;case"any":case"all":case"none":for(var s=1;s<t.length;s++){a=a.concat(da({key:r+"["+s+"]",value:t[s],style:e.style,styleSpec:e.styleSpec}))}break;case"has":case"!has":n=Mn(t[1]);if(t.length!==2){a.push(new mr(r,t,'filter array for "'+t[0]+'" operator must have 2 elements'))}else if(n!=="string"){a.push(new mr(r+"[1]",t[1],"string expected, "+n+" found"))}break}return a}function va(e,t){var r=e.key;var i=e.style;var n=e.styleSpec;var a=e.value;var o=e.objectKey;var s=n[t+"_"+e.layerType];if(!s){return[]}var l=o.match(/^(.*)-transition$/);if(t==="paint"&&l&&s[l[1]]&&s[l[1]].transition){return Ca({key:r,value:a,valueSpec:n.transition,style:i,styleSpec:n})}var u=e.valueSpec||s[o];if(!u){return[new mr(r,a,'unknown property "'+o+'"')]}var f;if(Mn(a)==="string"&&Cn(u)&&!u.tokens&&(f=/^{([^}]+)}$/.exec(a))){return[new mr(r,a,'"'+o+'" does not support interpolation syntax\n'+'Use an identity property function instead: `{ "type": "identity", "property": '+(0,B.default)(f[1])+" }`.")]}var c=[];if(e.layerType==="symbol"){if(o==="text-field"&&i&&!i.glyphs){c.push(new mr(r,a,'use of "text-field" requires a style "glyphs" property'))}if(o==="text-font"&&In(br(a))&&xr(a.type)==="identity"){c.push(new mr(r,a,'"text-font" does not support identity functions'))}}return c.concat(Ca({key:e.key,value:a,valueSpec:u,style:i,styleSpec:n,expressionContext:"property",propertyType:t,propertyKey:o}))}function ya(e){return va(e,"paint")}function ma(e){return va(e,"layout")}function ga(e){var t=[];var r=e.value;var i=e.key;var n=e.style;var a=e.styleSpec;if(!r.type&&!r.ref){t.push(new mr(i,r,'either "type" or "ref" is required'))}var o=xr(r.type);var s=xr(r.ref);if(r.id){var l=xr(r.id);for(var u=0;u<e.arrayIndex;u++){var f=n.layers[u];if(xr(f.id)===l){t.push(new mr(i,r.id,'duplicate layer id "'+r.id+'", previously used at line '+f.id.__line__))}}}if("ref"in r){["type","source","source-layer","filter","layout"].forEach(function(e){if(e in r){t.push(new mr(i,r[e],'"'+e+'" is prohibited for ref layers'))}});var c;n.layers.forEach(function(e){if(xr(e.id)===s){c=e}});if(!c){t.push(new mr(i,r.ref,'ref layer "'+s+'" not found'))}else if(c.ref){t.push(new mr(i,r.ref,"ref cannot reference another ref layer"))}else{o=xr(c.type)}}else if(o!=="background"){if(!r.source){t.push(new mr(i,r,'missing required property "source"'))}else{var h=n.sources&&n.sources[r.source];var p=h&&xr(h.type);if(!h){t.push(new mr(i,r.source,'source "'+r.source+'" not found'))}else if(p==="vector"&&o==="raster"){t.push(new mr(i,r.source,'layer "'+r.id+'" requires a raster source'))}else if(p==="raster"&&o!=="raster"){t.push(new mr(i,r.source,'layer "'+r.id+'" requires a vector source'))}else if(p==="vector"&&!r["source-layer"]){t.push(new mr(i,r,'layer "'+r.id+'" must specify a "source-layer"'))}else if(p==="raster-dem"&&o!=="hillshade"){t.push(new mr(i,r.source,"raster-dem source can only be used with layer type 'hillshade'."))}else if(o==="line"&&r.paint&&r.paint["line-gradient"]&&(p!=="geojson"||!h.lineMetrics)){t.push(new mr(i,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))}}}t=t.concat(Yn({key:i,value:r,valueSpec:a.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function e(){return[]},type:function t(){return Ca({key:i+".type",value:r.type,valueSpec:a.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:pa,layout:function e(t){return Yn({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function e(t){return ma(_r({layerType:o},t))}}})},paint:function e(t){return Yn({layer:r,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function e(t){return ya(_r({layerType:o},t))}}})}}}));return t}function _a(e){var t=e.value;var r=e.key;var i=e.styleSpec;var n=e.style;if(!t.type){return[new mr(r,t,'"type" is required')]}var a=xr(t.type);var o=[];switch(a){case"vector":case"raster":case"raster-dem":o=o.concat(Yn({key:r,value:t,valueSpec:i["source_"+a.replace("-","_")],style:e.style,styleSpec:i}));if("url"in t){for(var s in t){if(["type","url","tileSize"].indexOf(s)<0){o.push(new mr(r+"."+s,t[s],'a source with a "url" property may not include a "'+s+'" property'))}}}return o;case"geojson":return Yn({key:r,value:t,valueSpec:i.source_geojson,style:n,styleSpec:i});case"video":return Yn({key:r,value:t,valueSpec:i.source_video,style:n,styleSpec:i});case"image":return Yn({key:r,value:t,valueSpec:i.source_image,style:n,styleSpec:i});case"canvas":o.push(new mr(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas"));return o;default:return ra({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:n,styleSpec:i})}}function xa(e){var t=e.value;var r=e.styleSpec;var i=r.light;var n=e.style;var a=[];var o=Mn(t);if(t===undefined){return a}else if(o!=="object"){a=a.concat([new mr("light",t,"object expected, "+o+" found")]);return a}for(var s in t){var l=s.match(/^(.*)-transition$/);if(l&&i[l[1]]&&i[l[1]].transition){a=a.concat(Ca({key:s,value:t[s],valueSpec:r.transition,style:n,styleSpec:r}))}else if(i[s]){a=a.concat(Ca({key:s,value:t[s],valueSpec:i[s],style:n,styleSpec:r}))}else{a=a.concat([new mr(s,t[s],'unknown property "'+s+'"')])}}return a}function ba(e){var t=e.value;var r=e.key;var i=Mn(t);if(i!=="string"){return[new mr(r,t,"string expected, "+i+" found")]}return[]}function wa(e){if(ba(e).length===0){return[]}return Qn(e)}var Sa={"*":function e(){return[]},array:Kn,boolean:ea,number:Jn,color:ta,constants:gr,enum:ra,filter:pa,function:$n,layer:ga,object:Yn,source:_a,light:xa,string:ba,formatted:wa};function Ca(e){var t=e.value;var r=e.valueSpec;var i=e.styleSpec;if(r.expression&&In(xr(t))){return $n(e)}else if(r.expression&&Un(br(t))){return Qn(e)}else if(r.type&&Sa[r.type]){return Sa[r.type](e)}else{var n=Yn(_r({},e,{valueSpec:r.type?i[r.type]:r}));return n}}function Ta(e){var t=e.value;var r=e.key;var i=ba(e);if(i.length){return i}if(t.indexOf("{fontstack}")===-1){i.push(new mr(r,t,'"glyphs" url must include a "{fontstack}" token'))}if(t.indexOf("{range}")===-1){i.push(new mr(r,t,'"glyphs" url must include a "{range}" token'))}return i}function Pa(e,t){t=t||yr;var r=[];r=r.concat(Ca({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Ta,"*":function e(){return[]}}}));if(e.constants){r=r.concat(gr({key:"constants",value:e.constants,style:e,styleSpec:t}))}return Ma(r)}Pa.source=Ia(_a);Pa.light=Ia(xa);Pa.layer=Ia(ga);Pa.filter=Ia(pa);Pa.paintProperty=Ia(ya);Pa.layoutProperty=Ia(ma);function Ma(e){return[].concat(e).sort(function(e,t){return e.line-t.line})}function Ia(e){return function(){return Ma(e.apply(this,arguments))}}var Aa=Pa;var La=Pa.source;var Ea=Pa.light;var ka=Pa.filter;var Da=Pa.paintProperty;var Ba=Pa.layoutProperty;function Ra(e,t){var r=false;if(t&&t.length){for(var i=0,n=t;i<n.length;i+=1){var a=n[i];e.fire(new Et(new Error(a.message)));r=true}}return r}"use strict";var Fa=za;var Oa=3;function za(e,t,r){var i=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var n=new Int32Array(this.arrayBuffer);e=n[0];t=n[1];r=n[2];this.d=t+2*r;for(var a=0;a<this.d*this.d;a++){var o=n[Oa+a];var s=n[Oa+a+1];i.push(o===s?null:n.subarray(o,s))}var l=n[Oa+i.length];var u=n[Oa+i.length+1];this.keys=n.subarray(l,u);this.bboxes=n.subarray(u);this.insert=this._insertReadonly}else{this.d=t+2*r;for(var f=0;f<this.d*this.d;f++){i.push([])}this.keys=[];this.bboxes=[]}this.n=t;this.extent=e;this.padding=r;this.scale=t/e;this.uid=0;var c=r/t*e;this.min=-c;this.max=e+c}za.prototype.insert=function(e,t,r,i,n){this._forEachCell(t,r,i,n,this._insertCell,this.uid++);this.keys.push(e);this.bboxes.push(t);this.bboxes.push(r);this.bboxes.push(i);this.bboxes.push(n)};za.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."};za.prototype._insertCell=function(e,t,r,i,n,a){this.cells[n].push(a)};za.prototype.query=function(e,t,r,i,n){var a=this.min;var o=this.max;if(e<=a&&t<=a&&o<=r&&o<=i&&!n){return Array.prototype.slice.call(this.keys)}else{var s=[];var l={};this._forEachCell(e,t,r,i,this._queryCell,s,l,n);return s}};za.prototype._queryCell=function(e,t,r,i,n,a,o,s){var l=this.cells[n];if(l!==null){var u=this.keys;var f=this.bboxes;for(var c=0;c<l.length;c++){var h=l[c];if(o[h]===undefined){var p=h*4;if(s?s(f[p+0],f[p+1],f[p+2],f[p+3]):e<=f[p+2]&&t<=f[p+3]&&r>=f[p+0]&&i>=f[p+1]){o[h]=true;a.push(u[h])}else{o[h]=false}}}}};za.prototype._forEachCell=function(e,t,r,i,n,a,o,s){var l=this;var u=this._convertToCellCoord(e);var f=this._convertToCellCoord(t);var c=this._convertToCellCoord(r);var h=this._convertToCellCoord(i);for(var p=u;p<=c;p++){for(var d=f;d<=h;d++){var v=l.d*d+p;if(s&&!s(l._convertFromCellCoord(p),l._convertFromCellCoord(d),l._convertFromCellCoord(p+1),l._convertFromCellCoord(d+1))){continue}if(n.call(l,e,t,r,i,v,a,o,s)){return}}}};za.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale};za.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))};za.prototype.toArrayBuffer=function(){var e=this;if(this.arrayBuffer){return this.arrayBuffer}var t=this.cells;var r=Oa+this.cells.length+1+1;var i=0;for(var n=0;n<this.cells.length;n++){i+=e.cells[n].length}var a=new Int32Array(r+i+this.keys.length+this.bboxes.length);a[0]=this.extent;a[1]=this.n;a[2]=this.padding;var o=r;for(var s=0;s<t.length;s++){var l=t[s];a[Oa+s]=o;a.set(l,o);o+=l.length}a[Oa+t.length]=o;a.set(this.keys,o);o+=this.keys.length;a[Oa+t.length+1]=o;a.set(this.bboxes,o);o+=this.bboxes.length;return a.buffer};var Ua=self.ImageData;var Na={};function ja(e,t,r){if(r===void 0)r={};G(!Na[e],e+" is already registered.");Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:false});Na[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}ja("Object",Object);Fa.serialize=function e(t,r){var i=t.toArrayBuffer();if(r){r.push(i)}return{buffer:i}};Fa.deserialize=function e(t){return new Fa(t.buffer)};ja("Grid",Fa);ja("Color",Nr);ja("Error",Error);ja("StylePropertyFunction",Zn);ja("StyleExpression",zn,{omit:["_evaluator"]});ja("ZoomDependentExpression",Vn);ja("ZoomConstantExpression",jn);ja("CompoundExpression",ii,{omit:["_evaluate"]});for(var Va in yn){if(yn[Va]._classRegistryKey){continue}ja("Expression_"+Va,yn[Va])}function Ga(e,t){if(e===null||e===undefined||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp){return e}if(e instanceof ArrayBuffer){if(t){t.push(e)}return e}if(ArrayBuffer.isView(e)){var r=e;if(t){t.push(r.buffer)}return r}if(e instanceof Ua){if(t){t.push(e.data.buffer)}return e}if(Array.isArray(e)){var i=[];for(var n=0,a=e;n<a.length;n+=1){var o=a[n];i.push(Ga(o,t))}return i}if((typeof e==="undefined"?"undefined":(0,z.default)(e))==="object"){var s=e.constructor;var l=s._classRegistryKey;if(!l){throw new Error("can't serialize object of unregistered class")}G(Na[l]);var u=s.serialize?s.serialize(e,t):{};if(!s.serialize){for(var f in e){if(!e.hasOwnProperty(f)){continue}if(Na[l].omit.indexOf(f)>=0){continue}var c=e[f];u[f]=Na[l].shallow.indexOf(f)>=0?c:Ga(c,t)}if(e instanceof Error){u.message=e.message}}else{G(!t||u!==t[t.length-1])}if(u.$name){throw new Error("$name property is reserved for worker serialization logic.")}if(l!=="Object"){u.$name=l}return u}throw new Error("can't serialize object of type "+(typeof e==="undefined"?"undefined":(0,z.default)(e)))}function Za(e){if(e===null||e===undefined||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof ArrayBuffer||ArrayBuffer.isView(e)||e instanceof Ua){return e}if(Array.isArray(e)){return e.map(Za)}if((typeof e==="undefined"?"undefined":(0,z.default)(e))==="object"){var t=e.$name||"Object";var r=Na[t];var i=r.klass;if(!i){throw new Error("can't deserialize unregistered class "+t)}if(i.deserialize){return i.deserialize(e)}var n=(0,F.default)(i.prototype);for(var a=0,o=(0,k.default)(e);a<o.length;a+=1){var s=o[a];if(s==="$name"){continue}var l=e[s];n[s]=Na[t].shallow.indexOf(s)>=0?l:Za(l)}return n}throw new Error("can't deserialize object of type "+(typeof e==="undefined"?"undefined":(0,z.default)(e)))}var qa=function e(){this.first=true};qa.prototype.update=function e(t,r){var i=Math.floor(t);if(this.first){this.first=false;this.lastIntegerZoom=i;this.lastIntegerZoomTime=0;this.lastZoom=t;this.lastFloorZoom=i;return true}if(this.lastFloorZoom>i){this.lastIntegerZoom=i+1;this.lastIntegerZoomTime=r}else if(this.lastFloorZoom<i){this.lastIntegerZoom=i;this.lastIntegerZoomTime=r}if(t!==this.lastZoom){this.lastZoom=t;this.lastFloorZoom=i;return true}return false};var Ha={"Latin-1 Supplement":function e(t){return t>=128&&t<=255},Arabic:function e(t){return t>=1536&&t<=1791},"Arabic Supplement":function e(t){return t>=1872&&t<=1919},"Arabic Extended-A":function e(t){return t>=2208&&t<=2303},"Hangul Jamo":function e(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function e(t){return t>=5120&&t<=5759},Khmer:function e(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function e(t){return t>=6320&&t<=6399},"General Punctuation":function e(t){return t>=8192&&t<=8303},"Letterlike Symbols":function e(t){return t>=8448&&t<=8527},"Number Forms":function e(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function e(t){return t>=8960&&t<=9215},"Control Pictures":function e(t){return t>=9216&&t<=9279},"Optical Character Recognition":function e(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function e(t){return t>=9312&&t<=9471},"Geometric Shapes":function e(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function e(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function e(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function e(t){return t>=11904&&t<=12031},"Kangxi Radicals":function e(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function e(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function e(t){return t>=12288&&t<=12351},Hiragana:function e(t){return t>=12352&&t<=12447},Katakana:function e(t){return t>=12448&&t<=12543},Bopomofo:function e(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function e(t){return t>=12592&&t<=12687},Kanbun:function e(t){return t>=12688&&t<=12703},"Bopomofo Extended":function e(t){return t>=12704&&t<=12735},"CJK Strokes":function e(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function e(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function e(t){return t>=12800&&t<=13055},"CJK Compatibility":function e(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function e(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function e(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function e(t){return t>=19968&&t<=40959},"Yi Syllables":function e(t){return t>=40960&&t<=42127},"Yi Radicals":function e(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function e(t){return t>=43360&&t<=43391},"Hangul Syllables":function e(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function e(t){return t>=55216&&t<=55295},"Private Use Area":function e(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function e(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function e(t){return t>=64336&&t<=65023},"Vertical Forms":function e(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function e(t){return t>=65072&&t<=65103},"Small Form Variants":function e(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function e(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function e(t){return t>=65280&&t<=65519}};function Wa(e){for(var t=0,r=e;t<r.length;t+=1){var i=r[t];if(!Ja(i.charCodeAt(0))){return false}}return true}function Xa(e){for(var t=0,r=e;t<r.length;t+=1){var i=r[t];if($a(i.charCodeAt(0))){return true}}return false}function Ya(e){for(var t=0,r=e;t<r.length;t+=1){var i=r[t];if(!Ka(i.charCodeAt(0))){return false}}return true}function Ka(e){if(Ha["Arabic"](e)){return false}if(Ha["Arabic Supplement"](e)){return false}if(Ha["Arabic Extended-A"](e)){return false}if(Ha["Arabic Presentation Forms-A"](e)){return false}if(Ha["Arabic Presentation Forms-B"](e)){return false}return true}function Ja(e){if(e<11904){return false}if(Ha["Bopomofo Extended"](e)){return true}if(Ha["Bopomofo"](e)){return true}if(Ha["CJK Compatibility Forms"](e)){return true}if(Ha["CJK Compatibility Ideographs"](e)){return true}if(Ha["CJK Compatibility"](e)){return true}if(Ha["CJK Radicals Supplement"](e)){return true}if(Ha["CJK Strokes"](e)){return true}if(Ha["CJK Symbols and Punctuation"](e)){return true}if(Ha["CJK Unified Ideographs Extension A"](e)){return true}if(Ha["CJK Unified Ideographs"](e)){return true}if(Ha["Enclosed CJK Letters and Months"](e)){return true}if(Ha["Halfwidth and Fullwidth Forms"](e)){return true}if(Ha["Hiragana"](e)){return true}if(Ha["Ideographic Description Characters"](e)){return true}if(Ha["Kangxi Radicals"](e)){return true}if(Ha["Katakana Phonetic Extensions"](e)){return true}if(Ha["Katakana"](e)){return true}if(Ha["Vertical Forms"](e)){return true}if(Ha["Yi Radicals"](e)){return true}if(Ha["Yi Syllables"](e)){return true}return false}function $a(e){if(e===746||e===747){return true}if(e<4352){return false}if(Ha["Bopomofo Extended"](e)){return true}if(Ha["Bopomofo"](e)){return true}if(Ha["CJK Compatibility Forms"](e)){if(!(e>=65097&&e<=65103)){return true}}if(Ha["CJK Compatibility Ideographs"](e)){return true}if(Ha["CJK Compatibility"](e)){return true}if(Ha["CJK Radicals Supplement"](e)){return true}if(Ha["CJK Strokes"](e)){return true}if(Ha["CJK Symbols and Punctuation"](e)){if(!(e>=12296&&e<=12305)&&!(e>=12308&&e<=12319)&&e!==12336){return true}}if(Ha["CJK Unified Ideographs Extension A"](e)){return true}if(Ha["CJK Unified Ideographs"](e)){return true}if(Ha["Enclosed CJK Letters and Months"](e)){return true}if(Ha["Hangul Compatibility Jamo"](e)){return true}if(Ha["Hangul Jamo Extended-A"](e)){return true}if(Ha["Hangul Jamo Extended-B"](e)){return true}if(Ha["Hangul Jamo"](e)){return true}if(Ha["Hangul Syllables"](e)){return true}if(Ha["Hiragana"](e)){return true}if(Ha["Ideographic Description Characters"](e)){return true}if(Ha["Kanbun"](e)){return true}if(Ha["Kangxi Radicals"](e)){return true}if(Ha["Katakana Phonetic Extensions"](e)){return true}if(Ha["Katakana"](e)){if(e!==12540){return true}}if(Ha["Halfwidth and Fullwidth Forms"](e)){if(e!==65288&&e!==65289&&e!==65293&&!(e>=65306&&e<=65310)&&e!==65339&&e!==65341&&e!==65343&&!(e>=65371&&e<=65503)&&e!==65507&&!(e>=65512&&e<=65519)){return true}}if(Ha["Small Form Variants"](e)){if(!(e>=65112&&e<=65118)&&!(e>=65123&&e<=65126)){return true}}if(Ha["Unified Canadian Aboriginal Syllabics"](e)){return true}if(Ha["Unified Canadian Aboriginal Syllabics Extended"](e)){return true}if(Ha["Vertical Forms"](e)){return true}if(Ha["Yijing Hexagram Symbols"](e)){return true}if(Ha["Yi Syllables"](e)){return true}if(Ha["Yi Radicals"](e)){return true}return false}function Qa(e){if(Ha["Latin-1 Supplement"](e)){if(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247){return true}}if(Ha["General Punctuation"](e)){if(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273){return true}}if(Ha["Letterlike Symbols"](e)){return true}if(Ha["Number Forms"](e)){return true}if(Ha["Miscellaneous Technical"](e)){if(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215){return true}}if(Ha["Control Pictures"](e)&&e!==9251){return true}if(Ha["Optical Character Recognition"](e)){return true}if(Ha["Enclosed Alphanumerics"](e)){return true}if(Ha["Geometric Shapes"](e)){return true}if(Ha["Miscellaneous Symbols"](e)){if(!(e>=9754&&e<=9759)){return true}}if(Ha["Miscellaneous Symbols and Arrows"](e)){if(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243){return true}}if(Ha["CJK Symbols and Punctuation"](e)){return true}if(Ha["Katakana"](e)){return true}if(Ha["Private Use Area"](e)){return true}if(Ha["CJK Compatibility Forms"](e)){return true}if(Ha["Small Form Variants"](e)){return true}if(Ha["Halfwidth and Fullwidth Forms"](e)){return true}if(e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533){return true}return false}function eo(e){return!($a(e)||Qa(e))}function to(e,t){if(!t&&(e>=1424&&e<=2303||Ha["Arabic Presentation Forms-A"](e)||Ha["Arabic Presentation Forms-B"](e))){return false}if(e>=2304&&e<=3583||e>=3840&&e<=4255||Ha["Khmer"](e)){return false}return true}function ro(e,t){for(var r=0,i=e;r<i.length;r+=1){var n=i[r];if(!to(n.charCodeAt(0),t)){return false}}return true}var io=false;var no=null;var ao=false;var oo=new kt;var so;var lo=function e(t){if(no){t({pluginURL:no,completionCallback:so})}else{oo.once("pluginAvailable",t)}return t};var uo=function e(){io=false;no=null};var fo=function e(t,r){if(io){throw new Error("setRTLTextPlugin cannot be called multiple times.")}io=true;no=je.resolveURL(t);so=function e(t){if(t){uo();if(r){r(t)}}else{ao=true}};oo.fire(new Lt("pluginAvailable",{pluginURL:no,completionCallback:so}))};var co={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function e(){return ao||co.applyArabicShaping!=null}};var ho=function e(t,r){this.zoom=t;if(r){this.now=r.now;this.fadeDuration=r.fadeDuration;this.zoomHistory=r.zoomHistory;this.transition=r.transition}else{this.now=0;this.fadeDuration=0;this.zoomHistory=new qa;this.transition={}}};ho.prototype.isSupportedScript=function e(t){return ro(t,co.isLoaded())};ho.prototype.crossFadingFactor=function e(){if(this.fadeDuration===0){return 1}else{return Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}};ho.prototype.getCrossfadeParameters=function e(){var t=this.zoom;var r=t-Math.floor(t);var i=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*r}};var po=function e(t,r){this.property=t;this.value=r;this.expression=qn(r===undefined?t.specification.default:r,t.specification)};po.prototype.isDataDriven=function e(){return this.expression.kind==="source"||this.expression.kind==="composite"};po.prototype.possiblyEvaluate=function e(t){return this.property.possiblyEvaluate(this,t)};var vo=function e(t){this.property=t;this.value=new po(t,undefined)};vo.prototype.transitioned=function e(t,r){return new mo(this.property,this.value,r,ge({},t.transition,this.transition),t.now)};vo.prototype.untransitioned=function e(){return new mo(this.property,this.value,null,{},0)};var yo=function e(t){this._properties=t;this._values=(0,F.default)(t.defaultTransitionablePropertyValues)};yo.prototype.getValue=function e(t){return Ie(this._values[t].value.value)};yo.prototype.setValue=function e(t,r){if(!this._values.hasOwnProperty(t)){this._values[t]=new vo(this._values[t].property)}this._values[t].value=new po(this._values[t].property,r===null?undefined:Ie(r))};yo.prototype.getTransition=function e(t){return Ie(this._values[t].transition)};yo.prototype.setTransition=function e(t,r){if(!this._values.hasOwnProperty(t)){this._values[t]=new vo(this._values[t].property)}this._values[t].transition=Ie(r)||undefined};yo.prototype.serialize=function e(){var t=this;var r={};for(var i=0,n=(0,k.default)(t._values);i<n.length;i+=1){var a=n[i];var o=t.getValue(a);if(o!==undefined){r[a]=o}var s=t.getTransition(a);if(s!==undefined){r[a+"-transition"]=s}}return r};yo.prototype.transitioned=function e(t,r){var i=this;var n=new go(this._properties);for(var a=0,o=(0,k.default)(i._values);a<o.length;a+=1){var s=o[a];n._values[s]=i._values[s].transitioned(t,r._values[s])}return n};yo.prototype.untransitioned=function e(){var t=this;var r=new go(this._properties);for(var i=0,n=(0,k.default)(t._values);i<n.length;i+=1){var a=n[i];r._values[a]=t._values[a].untransitioned()}return r};var mo=function e(t,r,i,n,a){this.property=t;this.value=r;this.begin=a+n.delay||0;this.end=this.begin+n.duration||0;if(t.specification.transition&&(n.delay||n.duration)){this.prior=i}};mo.prototype.possiblyEvaluate=function e(t){var r=t.now||0;var i=this.value.possiblyEvaluate(t);var n=this.prior;if(!n){return i}else if(r>this.end){this.prior=null;return i}else if(this.value.isDataDriven()){this.prior=null;return i}else if(r<this.begin){return n.possiblyEvaluate(t)}else{var a=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(n.possiblyEvaluate(t),i,fe(a))}};var go=function e(t){this._properties=t;this._values=(0,F.default)(t.defaultTransitioningPropertyValues)};go.prototype.possiblyEvaluate=function e(t){var r=this;var i=new bo(this._properties);for(var n=0,a=(0,k.default)(r._values);n<a.length;n+=1){var o=a[n];i._values[o]=r._values[o].possiblyEvaluate(t)}return i};go.prototype.hasTransition=function e(){var t=this;for(var r=0,i=(0,k.default)(t._values);r<i.length;r+=1){var n=i[r];if(t._values[n].prior){return true}}return false};var _o=function e(t){this._properties=t;this._values=(0,F.default)(t.defaultPropertyValues)};_o.prototype.getValue=function e(t){return Ie(this._values[t].value)};_o.prototype.setValue=function e(t,r){this._values[t]=new po(this._values[t].property,r===null?undefined:Ie(r))};_o.prototype.serialize=function e(){var t=this;var r={};for(var i=0,n=(0,k.default)(t._values);i<n.length;i+=1){var a=n[i];var o=t.getValue(a);if(o!==undefined){r[a]=o}}return r};_o.prototype.possiblyEvaluate=function e(t){var r=this;var i=new bo(this._properties);for(var n=0,a=(0,k.default)(r._values);n<a.length;n+=1){var o=a[n];i._values[o]=r._values[o].possiblyEvaluate(t)}return i};var xo=function e(t,r,i){this.property=t;this.value=r;this.parameters=i};xo.prototype.isConstant=function e(){return this.value.kind==="constant"};xo.prototype.constantOr=function e(t){if(this.value.kind==="constant"){return this.value.value}else{return t}};xo.prototype.evaluate=function e(t,r){return this.property.evaluate(this.value,this.parameters,t,r)};var bo=function e(t){this._properties=t;this._values=(0,F.default)(t.defaultPossiblyEvaluatedValues)};bo.prototype.get=function e(t){return this._values[t]};var wo=function e(t){this.specification=t};wo.prototype.possiblyEvaluate=function e(t,r){G(!t.isDataDriven());return t.expression.evaluate(r)};wo.prototype.interpolate=function e(t,r,i){var n=mi[this.specification.type];if(n){return n(t,r,i)}else{return t}};var So=function e(t){this.specification=t};So.prototype.possiblyEvaluate=function e(t,r){if(t.expression.kind==="constant"||t.expression.kind==="camera"){return new xo(this,{kind:"constant",value:t.expression.evaluate(r)},r)}else{return new xo(this,t.expression,r)}};So.prototype.interpolate=function e(t,r,i){if(t.value.kind!=="constant"||r.value.kind!=="constant"){return t}if(t.value.value===undefined||r.value.value===undefined){return new xo(this,{kind:"constant",value:undefined},t.parameters)}var n=mi[this.specification.type];if(n){return new xo(this,{kind:"constant",value:n(t.value.value,r.value.value,i)},t.parameters)}else{return t}};So.prototype.evaluate=function e(t,r,i,n){if(t.kind==="constant"){return t.value}else{return t.evaluate(r,i,n)}};var Co=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.possiblyEvaluate=function e(t,r){if(t.value===undefined){return new xo(this,{kind:"constant",value:undefined},r)}else if(t.expression.kind==="constant"){var i=t.expression.evaluate(r);var n=this._calculate(i,i,i,r);return new xo(this,{kind:"constant",value:n},r)}else if(t.expression.kind==="camera"){var a=this._calculate(t.expression.evaluate({zoom:r.zoom-1}),t.expression.evaluate({zoom:r.zoom}),t.expression.evaluate({zoom:r.zoom+1}),r);return new xo(this,{kind:"constant",value:a},r)}else{return new xo(this,t.expression,r)}};t.prototype.evaluate=function e(t,r,i,n){if(t.kind==="source"){var a=t.evaluate(r,i,n);return this._calculate(a,a,a,r)}else if(t.kind==="composite"){return this._calculate(t.evaluate({zoom:Math.floor(r.zoom)-1},i,n),t.evaluate({zoom:Math.floor(r.zoom)},i,n),t.evaluate({zoom:Math.floor(r.zoom)+1},i,n),r)}else{return t.value}};t.prototype._calculate=function e(t,r,i,n){var a=n.zoom;return a>n.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:i,to:r}};t.prototype.interpolate=function e(t){return t};return t}(So);var To=function e(t){this.specification=t};To.prototype.possiblyEvaluate=function e(t,r){if(t.value===undefined){return undefined}else if(t.expression.kind==="constant"){var i=t.expression.evaluate(r);return this._calculate(i,i,i,r)}else{G(!t.isDataDriven());return this._calculate(t.expression.evaluate(new ho(Math.floor(r.zoom-1),r)),t.expression.evaluate(new ho(Math.floor(r.zoom),r)),t.expression.evaluate(new ho(Math.floor(r.zoom+1),r)),r)}};To.prototype._calculate=function e(t,r,i,n){var a=n.zoom;return a>n.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:i,to:r}};To.prototype.interpolate=function e(t){return t};var Po=function e(t){this.specification=t};Po.prototype.possiblyEvaluate=function e(t,r){return!!t.expression.evaluate(r)};Po.prototype.interpolate=function e(){return false};var Mo=function e(t){var r=this;this.properties=t;this.defaultPropertyValues={};this.defaultTransitionablePropertyValues={};this.defaultTransitioningPropertyValues={};this.defaultPossiblyEvaluatedValues={};for(var i in t){var n=t[i];var a=r.defaultPropertyValues[i]=new po(n,undefined);var o=r.defaultTransitionablePropertyValues[i]=new vo(n);r.defaultTransitioningPropertyValues[i]=o.untransitioned();r.defaultPossiblyEvaluatedValues[i]=a.possiblyEvaluate({})}};ja("DataDrivenProperty",So);ja("DataConstantProperty",wo);ja("CrossFadedDataDrivenProperty",Co);ja("CrossFadedProperty",To);ja("ColorRampProperty",Po);var Io="-transition";var Ao=function(e){function t(t,r){var i=this;e.call(this);this.id=t.id;this.type=t.type;this.visibility="visible";this._featureFilter=function(){return true};if(t.type==="custom"){return}t=t;this.metadata=t.metadata;this.minzoom=t.minzoom;this.maxzoom=t.maxzoom;if(t.type!=="background"){this.source=t.source;this.sourceLayer=t["source-layer"];this.filter=t.filter}if(r.layout){this._unevaluatedLayout=new _o(r.layout)}if(r.paint){this._transitionablePaint=new yo(r.paint);for(var n in t.paint){i.setPaintProperty(n,t.paint[n],{validate:false})}for(var a in t.layout){i.setLayoutProperty(a,t.layout[a],{validate:false})}this._transitioningPaint=this._transitionablePaint.untransitioned()}}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getCrossfadeParameters=function e(){return this._crossfadeParameters};t.prototype.getLayoutProperty=function e(t){if(t==="visibility"){return this.visibility}return this._unevaluatedLayout.getValue(t)};t.prototype.setLayoutProperty=function e(t,r,i){if(r!==null&&r!==undefined){var n="layers."+this.id+".layout."+t;if(this._validate(Ba,n,t,r,i)){return}}if(t==="visibility"){this.visibility=r==="none"?r:"visible";return}this._unevaluatedLayout.setValue(t,r)};t.prototype.getPaintProperty=function e(t){if(Te(t,Io)){return this._transitionablePaint.getTransition(t.slice(0,-Io.length))}else{return this._transitionablePaint.getValue(t)}};t.prototype.setPaintProperty=function e(t,r,i){if(r!==null&&r!==undefined){var n="layers."+this.id+".paint."+t;if(this._validate(Da,n,t,r,i)){return false}}if(Te(t,Io)){this._transitionablePaint.setTransition(t.slice(0,-Io.length),r||undefined);return false}else{var a=this._transitionablePaint._values[t];var o=a.property.specification["property-type"]==="cross-faded-data-driven"&&!a.value.value&&r;var s=this._transitionablePaint._values[t].value.isDataDriven();this._transitionablePaint.setValue(t,r);var l=this._transitionablePaint._values[t].value.isDataDriven();this._handleSpecialPaintPropertyUpdate(t);return l||s||o}};t.prototype._handleSpecialPaintPropertyUpdate=function e(t){};t.prototype.isHidden=function e(t){if(this.minzoom&&t<this.minzoom){return true}if(this.maxzoom&&t>=this.maxzoom){return true}return this.visibility==="none"};t.prototype.updateTransitions=function e(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)};t.prototype.hasTransition=function e(){return this._transitioningPaint.hasTransition()};t.prototype.recalculate=function e(t){if(t.getCrossfadeParameters){this._crossfadeParameters=t.getCrossfadeParameters()}if(this._unevaluatedLayout){this.layout=this._unevaluatedLayout.possiblyEvaluate(t)}this.paint=this._transitioningPaint.possiblyEvaluate(t)};t.prototype.serialize=function e(){var t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};if(this.visibility==="none"){t.layout=t.layout||{};t.layout.visibility="none"}return Me(t,function(e,t){return e!==undefined&&!(t==="layout"&&!(0,k.default)(e).length)&&!(t==="paint"&&!(0,k.default)(e).length)})};t.prototype._validate=function e(t,r,i,n,a){if(a&&a.validate===false){return false}return Ra(this,t.call(Aa,{key:r,layerType:this.type,objectKey:i,value:n,styleSpec:yr,style:{glyphs:true,sprite:true}}))};t.prototype.hasOffscreenPass=function e(){return false};t.prototype.resize=function e(){};t.prototype.isStateDependent=function e(){var t=this;for(var r in t.paint._values){var i=t.paint.get(r);if(!(i instanceof xo)||!Cn(i.property.specification)){continue}if((i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent){return true}}return false};return t}(kt);var Lo={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};var Eo=function e(t,r){this._structArray=t;this._pos1=r*this.size;this._pos2=this._pos1/2;this._pos4=this._pos1/4;this._pos8=this._pos1/8};var ko=128;var Do=5;var Bo=function e(){this.isTransferred=false;this.capacity=-1;this.resize(0)};Bo.serialize=function e(t,r){G(!t.isTransferred);t._trim();if(r){t.isTransferred=true;r.push(t.arrayBuffer)}return{length:t.length,arrayBuffer:t.arrayBuffer}};Bo.deserialize=function e(t){var r=(0,F.default)(this.prototype);r.arrayBuffer=t.arrayBuffer;r.length=t.length;r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement;r._refreshViews();return r};Bo.prototype._trim=function e(){if(this.length!==this.capacity){this.capacity=this.length;this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement);this._refreshViews()}};Bo.prototype.clear=function e(){this.length=0};Bo.prototype.resize=function e(t){G(!this.isTransferred);this.reserve(t);this.length=t};Bo.prototype.reserve=function e(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(this.capacity*Do),ko);this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var r=this.uint8;this._refreshViews();if(r){this.uint8.set(r)}}};Bo.prototype._refreshViews=function e(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};function Ro(e,t){if(t===void 0)t=1;var r=0;var i=0;var n=e.map(function(e){G(e.name.length);var n=Fo(e.type);var a=r=Oo(r,Math.max(t,n));var o=e.components||1;i=Math.max(i,n);r+=n*o;return{name:e.name,type:e.type,components:o,offset:a}});var a=Oo(r,Math.max(i,t));return{members:n,size:a,alignment:t}}function Fo(e){return Lo[e].BYTES_PER_ELEMENT}function Oo(e,t){return Math.ceil(e/t)*t}var zo=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r){var i=this.length;this.resize(i+1);return this.emplace(i,t,r)};t.prototype.emplace=function e(t,r,i){var n=t*2;this.int16[n+0]=r;this.int16[n+1]=i;return t};return t}(Bo);zo.prototype.bytesPerElement=4;ja("StructArrayLayout2i4",zo);var Uo=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,i,n){var a=this.length;this.resize(a+1);return this.emplace(a,t,r,i,n)};t.prototype.emplace=function e(t,r,i,n,a){var o=t*4;this.int16[o+0]=r;this.int16[o+1]=i;this.int16[o+2]=n;this.int16[o+3]=a;return t};return t}(Bo);Uo.prototype.bytesPerElement=8;ja("StructArrayLayout4i8",Uo);var No=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,i,n,a,o){var s=this.length;this.resize(s+1);return this.emplace(s,t,r,i,n,a,o)};t.prototype.emplace=function e(t,r,i,n,a,o,s){var l=t*6;this.int16[l+0]=r;this.int16[l+1]=i;this.int16[l+2]=n;this.int16[l+3]=a;this.int16[l+4]=o;this.int16[l+5]=s;return t};return t}(Bo);No.prototype.bytesPerElement=12;ja("StructArrayLayout2i4i12",No);var jo=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,i,n,a,o,s,l){var u=this.length;this.resize(u+1);return this.emplace(u,t,r,i,n,a,o,s,l)};t.prototype.emplace=function e(t,r,i,n,a,o,s,l,u){var f=t*6;var c=t*12;this.int16[f+0]=r;this.int16[f+1]=i;this.int16[f+2]=n;this.int16[f+3]=a;this.uint8[c+8]=o;this.uint8[c+9]=s;this.uint8[c+10]=l;this.uint8[c+11]=u;return t};return t}(Bo);jo.prototype.bytesPerElement=12;ja("StructArrayLayout4i4ub12",jo);var Vo=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,i,n,a,o,s,l){var u=this.length;this.resize(u+1);return this.emplace(u,t,r,i,n,a,o,s,l)};t.prototype.emplace=function e(t,r,i,n,a,o,s,l,u){var f=t*8;this.uint16[f+0]=r;this.uint16[f+1]=i;this.uint16[f+2]=n;this.uint16[f+3]=a;this.uint16[f+4]=o;this.uint16[f+5]=s;this.uint16[f+6]=l;this.uint16[f+7]=u;return t};return t}(Bo);Vo.prototype.bytesPerElement=16;ja("StructArrayLayout8ui16",Vo);var Go=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,i,n,a,o,s,l){var u=this.length;this.resize(u+1);return this.emplace(u,t,r,i,n,a,o,s,l)};t.prototype.emplace=function e(t,r,i,n,a,o,s,l,u){var f=t*8;this.int16[f+0]=r;this.int16[f+1]=i;this.int16[f+2]=n;this.int16[f+3]=a;this.uint16[f+4]=o;this.uint16[f+5]=s;this.uint16[f+6]=l;this.uint16[f+7]=u;return t};return t}(Bo);Go.prototype.bytesPerElement=16;ja("StructArrayLayout4i4ui16",Go);var Zo=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,i){var n=this.length;this.resize(n+1);return this.emplace(n,t,r,i)};t.prototype.emplace=function e(t,r,i,n){var a=t*3;this.float32[a+0]=r;this.float32[a+1]=i;this.float32[a+2]=n;return t};return t}(Bo);Zo.prototype.bytesPerElement=12;ja("StructArrayLayout3f12",Zo);var qo=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t){var r=this.length;this.resize(r+1);return this.emplace(r,t)};t.prototype.emplace=function e(t,r){var i=t*1;this.uint32[i+0]=r;return t};return t}(Bo);qo.prototype.bytesPerElement=4;ja("StructArrayLayout1ul4",qo);var Ho=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,i,n,a,o,s,l,u,f,c){var h=this.length;this.resize(h+1);return this.emplace(h,t,r,i,n,a,o,s,l,u,f,c)};t.prototype.emplace=function e(t,r,i,n,a,o,s,l,u,f,c,h){var p=t*12;var d=t*6;this.int16[p+0]=r;this.int16[p+1]=i;this.int16[p+2]=n;this.int16[p+3]=a;this.int16[p+4]=o;this.int16[p+5]=s;this.uint32[d+3]=l;this.uint16[p+8]=u;this.uint16[p+9]=f;this.int16[p+10]=c;this.int16[p+11]=h;return t};return t}(Bo);Ho.prototype.bytesPerElement=24;ja("StructArrayLayout6i1ul2ui2i24",Ho);var Wo=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,i,n,a,o){var s=this.length;this.resize(s+1);return this.emplace(s,t,r,i,n,a,o)};t.prototype.emplace=function e(t,r,i,n,a,o,s){var l=t*6;this.int16[l+0]=r;this.int16[l+1]=i;this.int16[l+2]=n;this.int16[l+3]=a;this.int16[l+4]=o;this.int16[l+5]=s;return t};return t}(Bo);Wo.prototype.bytesPerElement=12;ja("StructArrayLayout2i2i2i12",Wo);var Xo=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r){var i=this.length;this.resize(i+1);return this.emplace(i,t,r)};t.prototype.emplace=function e(t,r,i){var n=t*4;this.uint8[n+0]=r;this.uint8[n+1]=i;return t};return t}(Bo);Xo.prototype.bytesPerElement=4;ja("StructArrayLayout2ub4",Xo);var Yo=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,i,n,a,o,s,l,u,f,c,h,p,d){var v=this.length;this.resize(v+1);return this.emplace(v,t,r,i,n,a,o,s,l,u,f,c,h,p,d)};t.prototype.emplace=function e(t,r,i,n,a,o,s,l,u,f,c,h,p,d,v){var y=t*20;var m=t*10;var g=t*40;this.int16[y+0]=r;this.int16[y+1]=i;this.uint16[y+2]=n;this.uint16[y+3]=a;this.uint32[m+2]=o;this.uint32[m+3]=s;this.uint32[m+4]=l;this.uint16[y+10]=u;this.uint16[y+11]=f;this.uint16[y+12]=c;this.float32[m+7]=h;this.float32[m+8]=p;this.uint8[g+36]=d;this.uint8[g+37]=v;return t};return t}(Bo);Yo.prototype.bytesPerElement=40;ja("StructArrayLayout2i2ui3ul3ui2f2ub40",Yo);var Ko=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,i,n,a,o,s,l,u,f,c,h,p,d){var v=this.length;this.resize(v+1);return this.emplace(v,t,r,i,n,a,o,s,l,u,f,c,h,p,d)};t.prototype.emplace=function e(t,r,i,n,a,o,s,l,u,f,c,h,p,d,v){var y=t*16;var m=t*8;this.int16[y+0]=r;this.int16[y+1]=i;this.int16[y+2]=n;this.int16[y+3]=a;this.uint16[y+4]=o;this.uint16[y+5]=s;this.uint16[y+6]=l;this.uint16[y+7]=u;this.uint16[y+8]=f;this.uint16[y+9]=c;this.uint16[y+10]=h;this.uint16[y+11]=p;this.uint16[y+12]=d;this.uint32[m+7]=v;return t};return t}(Bo);Ko.prototype.bytesPerElement=32;ja("StructArrayLayout4i9ui1ul32",Ko);var Jo=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t){var r=this.length;this.resize(r+1);return this.emplace(r,t)};t.prototype.emplace=function e(t,r){var i=t*1;this.float32[i+0]=r;return t};return t}(Bo);Jo.prototype.bytesPerElement=4;ja("StructArrayLayout1f4",Jo);var $o=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,i){var n=this.length;this.resize(n+1);return this.emplace(n,t,r,i)};t.prototype.emplace=function e(t,r,i,n){var a=t*3;this.int16[a+0]=r;this.int16[a+1]=i;this.int16[a+2]=n;return t};return t}(Bo);$o.prototype.bytesPerElement=6;ja("StructArrayLayout3i6",$o);var Qo=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,i){var n=this.length;this.resize(n+1);return this.emplace(n,t,r,i)};t.prototype.emplace=function e(t,r,i,n){var a=t*2;var o=t*4;this.uint32[a+0]=r;this.uint16[o+2]=i;this.uint16[o+3]=n;return t};return t}(Bo);Qo.prototype.bytesPerElement=8;ja("StructArrayLayout1ul2ui8",Qo);var es=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,i){var n=this.length;this.resize(n+1);return this.emplace(n,t,r,i)};t.prototype.emplace=function e(t,r,i,n){var a=t*3;this.uint16[a+0]=r;this.uint16[a+1]=i;this.uint16[a+2]=n;return t};return t}(Bo);es.prototype.bytesPerElement=6;ja("StructArrayLayout3ui6",es);var ts=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r){var i=this.length;this.resize(i+1);return this.emplace(i,t,r)};t.prototype.emplace=function e(t,r,i){var n=t*2;this.uint16[n+0]=r;this.uint16[n+1]=i;return t};return t}(Bo);ts.prototype.bytesPerElement=4;ja("StructArrayLayout2ui4",ts);var rs=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t){var r=this.length;this.resize(r+1);return this.emplace(r,t)};t.prototype.emplace=function e(t,r){var i=t*1;this.uint16[i+0]=r;return t};return t}(Bo);rs.prototype.bytesPerElement=2;ja("StructArrayLayout1ui2",rs);var is=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r){var i=this.length;this.resize(i+1);return this.emplace(i,t,r)};t.prototype.emplace=function e(t,r,i){var n=t*2;this.float32[n+0]=r;this.float32[n+1]=i;return t};return t}(Bo);is.prototype.bytesPerElement=8;ja("StructArrayLayout2f8",is);var ns=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._refreshViews=function e(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};t.prototype.emplaceBack=function e(t,r,i,n){var a=this.length;this.resize(a+1);return this.emplace(a,t,r,i,n)};t.prototype.emplace=function e(t,r,i,n,a){var o=t*4;this.float32[o+0]=r;this.float32[o+1]=i;this.float32[o+2]=n;this.float32[o+3]=a;return t};return t}(Bo);ns.prototype.bytesPerElement=16;ja("StructArrayLayout4f16",ns);var as=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;var r={anchorPointX:{configurable:true},anchorPointY:{configurable:true},x1:{configurable:true},y1:{configurable:true},x2:{configurable:true},y2:{configurable:true},featureIndex:{configurable:true},sourceLayerIndex:{configurable:true},bucketIndex:{configurable:true},radius:{configurable:true},signedDistanceFromAnchor:{configurable:true},anchorPoint:{configurable:true}};r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]};r.anchorPointX.set=function(e){this._structArray.int16[this._pos2+0]=e};r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]};r.anchorPointY.set=function(e){this._structArray.int16[this._pos2+1]=e};r.x1.get=function(){return this._structArray.int16[this._pos2+2]};r.x1.set=function(e){this._structArray.int16[this._pos2+2]=e};r.y1.get=function(){return this._structArray.int16[this._pos2+3]};r.y1.set=function(e){this._structArray.int16[this._pos2+3]=e};r.x2.get=function(){return this._structArray.int16[this._pos2+4]};r.x2.set=function(e){this._structArray.int16[this._pos2+4]=e};r.y2.get=function(){return this._structArray.int16[this._pos2+5]};r.y2.set=function(e){this._structArray.int16[this._pos2+5]=e};r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]};r.featureIndex.set=function(e){this._structArray.uint32[this._pos4+3]=e};r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]};r.sourceLayerIndex.set=function(e){this._structArray.uint16[this._pos2+8]=e};r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]};r.bucketIndex.set=function(e){this._structArray.uint16[this._pos2+9]=e};r.radius.get=function(){return this._structArray.int16[this._pos2+10]};r.radius.set=function(e){this._structArray.int16[this._pos2+10]=e};r.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]};r.signedDistanceFromAnchor.set=function(e){this._structArray.int16[this._pos2+11]=e};r.anchorPoint.get=function(){return new se(this.anchorPointX,this.anchorPointY)};(0,x.default)(t.prototype,r);return t}(Eo);as.prototype.size=24;var os=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.get=function e(t){G(!this.isTransferred);return new as(this,t)};return t}(Ho);ja("CollisionBoxArray",os);var ss=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;var r={anchorX:{configurable:true},anchorY:{configurable:true},glyphStartIndex:{configurable:true},numGlyphs:{configurable:true},vertexStartIndex:{configurable:true},lineStartIndex:{configurable:true},lineLength:{configurable:true},segment:{configurable:true},lowerSize:{configurable:true},upperSize:{configurable:true},lineOffsetX:{configurable:true},lineOffsetY:{configurable:true},writingMode:{configurable:true},hidden:{configurable:true}};r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]};r.anchorX.set=function(e){this._structArray.int16[this._pos2+0]=e};r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]};r.anchorY.set=function(e){this._structArray.int16[this._pos2+1]=e};r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]};r.glyphStartIndex.set=function(e){this._structArray.uint16[this._pos2+2]=e};r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]};r.numGlyphs.set=function(e){this._structArray.uint16[this._pos2+3]=e};r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]};r.vertexStartIndex.set=function(e){this._structArray.uint32[this._pos4+2]=e};r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]};r.lineStartIndex.set=function(e){this._structArray.uint32[this._pos4+3]=e};r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]};r.lineLength.set=function(e){this._structArray.uint32[this._pos4+4]=e};r.segment.get=function(){return this._structArray.uint16[this._pos2+10]};r.segment.set=function(e){this._structArray.uint16[this._pos2+10]=e};r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]};r.lowerSize.set=function(e){this._structArray.uint16[this._pos2+11]=e};r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]};r.upperSize.set=function(e){this._structArray.uint16[this._pos2+12]=e};r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]};r.lineOffsetX.set=function(e){this._structArray.float32[this._pos4+7]=e};r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]};r.lineOffsetY.set=function(e){this._structArray.float32[this._pos4+8]=e};r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]};r.writingMode.set=function(e){this._structArray.uint8[this._pos1+36]=e};r.hidden.get=function(){return this._structArray.uint8[this._pos1+37]};r.hidden.set=function(e){this._structArray.uint8[this._pos1+37]=e};(0,x.default)(t.prototype,r);return t}(Eo);ss.prototype.size=40;var ls=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.get=function e(t){G(!this.isTransferred);return new ss(this,t)};return t}(Yo);ja("PlacedSymbolArray",ls);var us=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;var r={anchorX:{configurable:true},anchorY:{configurable:true},horizontalPlacedTextSymbolIndex:{configurable:true},verticalPlacedTextSymbolIndex:{configurable:true},key:{configurable:true},textBoxStartIndex:{configurable:true},textBoxEndIndex:{configurable:true},iconBoxStartIndex:{configurable:true},iconBoxEndIndex:{configurable:true},featureIndex:{configurable:true},numGlyphVertices:{configurable:true},numVerticalGlyphVertices:{configurable:true},numIconVertices:{configurable:true},crossTileID:{configurable:true}};r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]};r.anchorX.set=function(e){this._structArray.int16[this._pos2+0]=e};r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]};r.anchorY.set=function(e){this._structArray.int16[this._pos2+1]=e};r.horizontalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]};r.horizontalPlacedTextSymbolIndex.set=function(e){this._structArray.int16[this._pos2+2]=e};r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]};r.verticalPlacedTextSymbolIndex.set=function(e){this._structArray.int16[this._pos2+3]=e};r.key.get=function(){return this._structArray.uint16[this._pos2+4]};r.key.set=function(e){this._structArray.uint16[this._pos2+4]=e};r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+5]};r.textBoxStartIndex.set=function(e){this._structArray.uint16[this._pos2+5]=e};r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+6]};r.textBoxEndIndex.set=function(e){this._structArray.uint16[this._pos2+6]=e};r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+7]};r.iconBoxStartIndex.set=function(e){this._structArray.uint16[this._pos2+7]=e};r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+8]};r.iconBoxEndIndex.set=function(e){this._structArray.uint16[this._pos2+8]=e};r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+9]};r.featureIndex.set=function(e){this._structArray.uint16[this._pos2+9]=e};r.numGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+10]};r.numGlyphVertices.set=function(e){this._structArray.uint16[this._pos2+10]=e};r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+11]};r.numVerticalGlyphVertices.set=function(e){this._structArray.uint16[this._pos2+11]=e};r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+12]};r.numIconVertices.set=function(e){this._structArray.uint16[this._pos2+12]=e};r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+7]};r.crossTileID.set=function(e){this._structArray.uint32[this._pos4+7]=e};(0,x.default)(t.prototype,r);return t}(Eo);us.prototype.size=32;var fs=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.get=function e(t){G(!this.isTransferred);return new us(this,t)};return t}(Ko);ja("SymbolInstanceArray",fs);var cs=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;var r={offsetX:{configurable:true}};r.offsetX.get=function(){return this._structArray.float32[this._pos4+0]};r.offsetX.set=function(e){this._structArray.float32[this._pos4+0]=e};(0,x.default)(t.prototype,r);return t}(Eo);cs.prototype.size=4;var hs=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getoffsetX=function e(t){return this.float32[t*1+0]};t.prototype.get=function e(t){G(!this.isTransferred);return new cs(this,t)};return t}(Jo);ja("GlyphOffsetArray",hs);var ps=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;var r={x:{configurable:true},y:{configurable:true},tileUnitDistanceFromAnchor:{configurable:true}};r.x.get=function(){return this._structArray.int16[this._pos2+0]};r.x.set=function(e){this._structArray.int16[this._pos2+0]=e};r.y.get=function(){return this._structArray.int16[this._pos2+1]};r.y.set=function(e){this._structArray.int16[this._pos2+1]=e};r.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]};r.tileUnitDistanceFromAnchor.set=function(e){this._structArray.int16[this._pos2+2]=e};(0,x.default)(t.prototype,r);return t}(Eo);ps.prototype.size=6;var ds=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getx=function e(t){return this.int16[t*3+0]};t.prototype.gety=function e(t){return this.int16[t*3+1]};t.prototype.gettileUnitDistanceFromAnchor=function e(t){return this.int16[t*3+2]};t.prototype.get=function e(t){G(!this.isTransferred);return new ps(this,t)};return t}($o);ja("SymbolLineVertexArray",ds);var vs=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;var r={featureIndex:{configurable:true},sourceLayerIndex:{configurable:true},bucketIndex:{configurable:true}};r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]};r.featureIndex.set=function(e){this._structArray.uint32[this._pos4+0]=e};r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]};r.sourceLayerIndex.set=function(e){this._structArray.uint16[this._pos2+2]=e};r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]};r.bucketIndex.set=function(e){this._structArray.uint16[this._pos2+3]=e};(0,x.default)(t.prototype,r);return t}(Eo);vs.prototype.size=8;var ys=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.get=function e(t){G(!this.isTransferred);return new vs(this,t)};return t}(Qo);ja("FeatureIndexArray",ys);var ms=Ro([{name:"a_pos",components:2,type:"Int16"}],4);var gs=ms.members;var _s=ms.size;var xs=ms.alignment;var bs=function e(t){if(t===void 0)t=[];this.segments=t};bs.prototype.prepareSegment=function e(t,r,i){var n=this.segments[this.segments.length-1];if(t>bs.MAX_VERTEX_ARRAY_LENGTH){Ee("Max vertices per segment is "+bs.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t)}if(!n||n.vertexLength+t>bs.MAX_VERTEX_ARRAY_LENGTH){n={vertexOffset:r.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0};this.segments.push(n)}return n};bs.prototype.get=function e(){return this.segments};bs.prototype.destroy=function e(){var t=this;for(var r=0,i=t.segments;r<i.length;r+=1){var n=i[r];for(var a in n.vaos){n.vaos[a].destroy()}}};bs.simpleSegment=function e(t,r,i,n){return new bs([{vertexOffset:t,primitiveOffset:r,vertexLength:i,primitiveLength:n,vaos:{}}])};bs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;ja("SegmentVector",bs);var ws=function e(t,r){t=pe(Math.floor(t),0,255);r=pe(Math.floor(r),0,255);return 256*t+r};var Ss=function e(){this.ids=[];this.positions=[];this.indexed=false};Ss.prototype.add=function e(t,r,i,n){this.ids.push(t);this.positions.push(r,i,n)};Ss.prototype.getPositions=function e(t){var r=this;G(this.indexed);var i=0;var n=this.ids.length-1;while(i<n){var a=i+n>>1;if(r.ids[a]>=t){n=a}else{i=a+1}}var o=[];while(this.ids[i]===t){var s=r.positions[3*i];var l=r.positions[3*i+1];var u=r.positions[3*i+2];o.push({index:s,start:l,end:u});i++}return o};Ss.serialize=function e(t,r){var i=new Float64Array(t.ids);var n=new Uint32Array(t.positions);Cs(i,n,0,i.length-1);r.push(i.buffer,n.buffer);return{ids:i,positions:n}};Ss.deserialize=function e(t){var r=new Ss;r.ids=t.ids;r.positions=t.positions;r.indexed=true;return r};function Cs(e,t,r,i){if(r>=i){return}var n=e[r+i>>1];var a=r-1;var o=i+1;while(true){do{a++}while(e[a]<n);do{o--}while(e[o]>n);if(a>=o){break}Ts(e,a,o);Ts(t,3*a,3*o);Ts(t,3*a+1,3*o+1);Ts(t,3*a+2,3*o+2)}Cs(e,t,r,o);Cs(e,t,o+1,i)}function Ts(e,t,r){var i=e[t];e[t]=e[r];e[r]=i}ja("FeaturePositionMap",Ss);var Ps=function e(t,r){this.gl=t.gl;this.location=r};var Ms=function(e){function t(t,r){e.call(this,t,r);this.current=0}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.set=function e(t){if(this.current!==t){this.current=t;this.gl.uniform1i(this.location,t)}};return t}(Ps);var Is=function(e){function t(t,r){e.call(this,t,r);this.current=0}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.set=function e(t){if(this.current!==t){this.current=t;this.gl.uniform1f(this.location,t)}};return t}(Ps);var As=function(e){function t(t,r){e.call(this,t,r);this.current=[0,0]}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.set=function e(t){if(t[0]!==this.current[0]||t[1]!==this.current[1]){this.current=t;this.gl.uniform2f(this.location,t[0],t[1])}};return t}(Ps);var Ls=function(e){function t(t,r){e.call(this,t,r);this.current=[0,0,0]}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.set=function e(t){if(t[0]!==this.current[0]||t[1]!==this.current[1]||t[2]!==this.current[2]){this.current=t;this.gl.uniform3f(this.location,t[0],t[1],t[2])}};return t}(Ps);var Es=function(e){function t(t,r){e.call(this,t,r);this.current=[0,0,0,0]}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.set=function e(t){if(t[0]!==this.current[0]||t[1]!==this.current[1]||t[2]!==this.current[2]||t[3]!==this.current[3]){this.current=t;this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3])}};return t}(Ps);var ks=function(e){function t(t,r){e.call(this,t,r);this.current=Nr.transparent}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.set=function e(t){if(t.r!==this.current.r||t.g!==this.current.g||t.b!==this.current.b||t.a!==this.current.a){this.current=t;this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a)}};return t}(Ps);var Ds=new Float32Array(16);var Bs=function(e){function t(t,r){e.call(this,t,r);this.current=Ds}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.set=function e(t){var r=this;if(t[12]!==this.current[12]||t[0]!==this.current[0]){this.current=t;this.gl.uniformMatrix4fv(this.location,false,t);return}for(var i=1;i<16;i++){if(t[i]!==r.current[i]){r.current=t;r.gl.uniformMatrix4fv(r.location,false,t);break}}};return t}(Ps);function Rs(e){return[ws(255*e.r,255*e.g),ws(255*e.b,255*e.a)]}var Fs=function e(t,r,i){this.value=t;this.names=r;this.uniformNames=this.names.map(function(e){return"u_"+e});this.type=i;this.maxValue=-Infinity};Fs.prototype.defines=function e(){return this.names.map(function(e){return"#define HAS_UNIFORM_u_"+e})};Fs.prototype.setConstantPatternPositions=function e(){};Fs.prototype.populatePaintArray=function e(){};Fs.prototype.updatePaintArray=function e(){};Fs.prototype.upload=function e(){};Fs.prototype.destroy=function e(){};Fs.prototype.setUniforms=function e(t,r,i,n){r.set(n.constantOr(this.value))};Fs.prototype.getBinding=function e(t,r){return this.type==="color"?new ks(t,r):new Is(t,r)};Fs.serialize=function e(t){var r=t.value;var i=t.names;var n=t.type;return{value:Ga(r),names:i,type:n}};Fs.deserialize=function e(t){var r=t.value;var i=t.names;var n=t.type;return new Fs(Za(r),i,n)};var Os=function e(t,r,i){this.value=t;this.names=r;this.uniformNames=this.names.map(function(e){return"u_"+e});this.type=i;this.maxValue=-Infinity;this.patternPositions={patternTo:null,patternFrom:null}};Os.prototype.defines=function e(){return this.names.map(function(e){return"#define HAS_UNIFORM_u_"+e})};Os.prototype.populatePaintArray=function e(){};Os.prototype.updatePaintArray=function e(){};Os.prototype.upload=function e(){};Os.prototype.destroy=function e(){};Os.prototype.setConstantPatternPositions=function e(t,r){this.patternPositions.patternTo=t.tlbr;this.patternPositions.patternFrom=r.tlbr};Os.prototype.setUniforms=function e(t,r,i,n,a){var o=this.patternPositions;if(a==="u_pattern_to"&&o.patternTo){r.set(o.patternTo)}if(a==="u_pattern_from"&&o.patternFrom){r.set(o.patternFrom)}};Os.prototype.getBinding=function e(t,r){return new Es(t,r)};var zs=function e(t,r,i,n){this.expression=t;this.names=r;this.type=i;this.uniformNames=this.names.map(function(e){return"a_"+e});this.maxValue=-Infinity;this.paintVertexAttributes=r.map(function(e){return{name:"a_"+e,type:"Float32",components:i==="color"?2:1,offset:0}});this.paintVertexArray=new n};zs.prototype.defines=function e(){return[]};zs.prototype.setConstantPatternPositions=function e(){};zs.prototype.populatePaintArray=function e(t,r){var i=this.paintVertexArray;var n=i.length;i.reserve(t);var a=this.expression.evaluate(new ho(0),r,{});if(this.type==="color"){var o=Rs(a);for(var s=n;s<t;s++){i.emplaceBack(o[0],o[1])}}else{for(var l=n;l<t;l++){i.emplaceBack(a)}this.maxValue=Math.max(this.maxValue,a)}};zs.prototype.updatePaintArray=function e(t,r,i,n){var a=this.paintVertexArray;var o=this.expression.evaluate({zoom:0},i,n);if(this.type==="color"){var s=Rs(o);for(var l=t;l<r;l++){a.emplace(l,s[0],s[1])}}else{for(var u=t;u<r;u++){a.emplace(u,o)}this.maxValue=Math.max(this.maxValue,o)}};zs.prototype.upload=function e(t){if(this.paintVertexArray&&this.paintVertexArray.arrayBuffer){if(this.paintVertexBuffer&&this.paintVertexBuffer.buffer){this.paintVertexBuffer.updateData(this.paintVertexArray)}else{this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent)}}};zs.prototype.destroy=function e(){if(this.paintVertexBuffer){this.paintVertexBuffer.destroy()}};zs.prototype.setUniforms=function e(t,r){r.set(0)};zs.prototype.getBinding=function e(t,r){return new Is(t,r)};var Us=function e(t,r,i,n,a,o){this.expression=t;this.names=r;this.uniformNames=this.names.map(function(e){return"a_"+e+"_t"});this.type=i;this.useIntegerZoom=n;this.zoom=a;this.maxValue=-Infinity;var s=o;this.paintVertexAttributes=r.map(function(e){return{name:"a_"+e,type:"Float32",components:i==="color"?4:2,offset:0}});this.paintVertexArray=new s};Us.prototype.defines=function e(){return[]};Us.prototype.setConstantPatternPositions=function e(){};Us.prototype.populatePaintArray=function e(t,r){var i=this.paintVertexArray;var n=i.length;i.reserve(t);var a=this.expression.evaluate(new ho(this.zoom),r,{});var o=this.expression.evaluate(new ho(this.zoom+1),r,{});if(this.type==="color"){var s=Rs(a);var l=Rs(o);for(var u=n;u<t;u++){i.emplaceBack(s[0],s[1],l[0],l[1])}}else{for(var f=n;f<t;f++){i.emplaceBack(a,o)}this.maxValue=Math.max(this.maxValue,a,o)}};Us.prototype.updatePaintArray=function e(t,r,i,n){var a=this.paintVertexArray;var o=this.expression.evaluate({zoom:this.zoom},i,n);var s=this.expression.evaluate({zoom:this.zoom+1},i,n);if(this.type==="color"){var l=Rs(o);var u=Rs(s);for(var f=t;f<r;f++){a.emplace(f,l[0],l[1],u[0],u[1])}}else{for(var c=t;c<r;c++){a.emplace(c,o,s)}this.maxValue=Math.max(this.maxValue,o,s)}};Us.prototype.upload=function e(t){if(this.paintVertexArray&&this.paintVertexArray.arrayBuffer){if(this.paintVertexBuffer&&this.paintVertexBuffer.buffer){this.paintVertexBuffer.updateData(this.paintVertexArray)}else{this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent)}}};Us.prototype.destroy=function e(){if(this.paintVertexBuffer){this.paintVertexBuffer.destroy()}};Us.prototype.interpolationFactor=function e(t){if(this.useIntegerZoom){return this.expression.interpolationFactor(Math.floor(t),this.zoom,this.zoom+1)}else{return this.expression.interpolationFactor(t,this.zoom,this.zoom+1)}};Us.prototype.setUniforms=function e(t,r,i){r.set(this.interpolationFactor(i.zoom))};Us.prototype.getBinding=function e(t,r){return new Is(t,r)};var Ns=function e(t,r,i,n,a,o,s){this.expression=t;this.names=r;this.type=i;this.uniformNames=this.names.map(function(e){return"a_"+e+"_t"});this.useIntegerZoom=n;this.zoom=a;this.maxValue=-Infinity;this.layerId=s;this.paintVertexAttributes=r.map(function(e){return{name:"a_"+e,type:"Uint16",components:4,offset:0}});this.zoomInPaintVertexArray=new o;this.zoomOutPaintVertexArray=new o};Ns.prototype.defines=function e(){return[]};Ns.prototype.setConstantPatternPositions=function e(){};Ns.prototype.populatePaintArray=function e(t,r,i){var n=this.zoomInPaintVertexArray;var a=this.zoomOutPaintVertexArray;var o=this;var s=o.layerId;var l=n.length;n.reserve(t);a.reserve(t);if(i&&r.patterns&&r.patterns[s]){var u=r.patterns[s];var f=u.min;var c=u.mid;var h=u.max;var p=i[f];var d=i[c];var v=i[h];if(!p||!d||!v){return}for(var y=l;y<t;y++){n.emplaceBack(d.tl[0],d.tl[1],d.br[0],d.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1]);a.emplaceBack(d.tl[0],d.tl[1],d.br[0],d.br[1],v.tl[0],v.tl[1],v.br[0],v.br[1])}}};Ns.prototype.updatePaintArray=function e(t,r,i,n,a){var o=this.zoomInPaintVertexArray;var s=this.zoomOutPaintVertexArray;var l=this;var u=l.layerId;if(a&&i.patterns&&i.patterns[u]){var f=i.patterns[u];var c=f.min;var h=f.mid;var p=f.max;var d=a[c];var v=a[h];var y=a[p];if(!d||!v||!y){return}for(var m=t;m<r;m++){o.emplace(m,v.tl[0],v.tl[1],v.br[0],v.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1]);s.emplace(m,v.tl[0],v.tl[1],v.br[0],v.br[1],y.tl[0],y.tl[1],y.br[0],y.br[1])}}};Ns.prototype.upload=function e(t){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent);this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent)}};Ns.prototype.destroy=function e(){if(this.zoomOutPaintVertexBuffer){this.zoomOutPaintVertexBuffer.destroy()}if(this.zoomInPaintVertexBuffer){this.zoomInPaintVertexBuffer.destroy()}};Ns.prototype.setUniforms=function e(t,r){r.set(0)};Ns.prototype.getBinding=function e(t,r){return new Is(t,r)};var js=function e(){this.binders={};this.cacheKey="";this._buffers=[];this._featureMap=new Ss;this._bufferOffset=0};js.createDynamic=function e(t,r,i){var n=new js;var a=[];for(var o in t.paint._values){if(!i(o)){continue}var s=t.paint.get(o);if(!(s instanceof xo)||!Cn(s.property.specification)){continue}var l=Gs(o,t.type);var u=s.property.specification.type;var f=s.property.useIntegerZoom;var c=s.property.specification["property-type"]==="cross-faded"||s.property.specification["property-type"]==="cross-faded-data-driven";if(c){if(s.value.kind==="constant"){n.binders[o]=new Os(s.value.value,l,u);a.push("/u_"+o)}else{var h=qs(o,u,"source");n.binders[o]=new Ns(s.value,l,u,f,r,h,t.id);a.push("/a_"+o)}}else if(s.value.kind==="constant"){n.binders[o]=new Fs(s.value.value,l,u);a.push("/u_"+o)}else if(s.value.kind==="source"){var p=qs(o,u,"source");n.binders[o]=new zs(s.value,l,u,p);a.push("/a_"+o)}else{var d=qs(o,u,"composite");n.binders[o]=new Us(s.value,l,u,f,r,d);a.push("/z_"+o)}}n.cacheKey=a.sort().join("");return n};js.prototype.populatePaintArrays=function e(t,r,i,n){var a=this;for(var o in a.binders){var s=a.binders[o];s.populatePaintArray(t,r,n)}if(r.id!==undefined){this._featureMap.add(+r.id,i,this._bufferOffset,t)}this._bufferOffset=t};js.prototype.setConstantPatternPositions=function e(t,r){var i=this;for(var n in i.binders){var a=i.binders[n];a.setConstantPatternPositions(t,r)}};js.prototype.updatePaintArrays=function e(t,r,i,n){var a=this;var o=false;for(var s in t){var l=a._featureMap.getPositions(+s);for(var u=0,f=l;u<f.length;u+=1){var c=f[u];var h=r.feature(c.index);for(var p in a.binders){var d=a.binders[p];if(d instanceof Fs||d instanceof Os){continue}if(d.expression.isStateDependent===true){var v=i.paint.get(p);d.expression=v.value;d.updatePaintArray(c.start,c.end,h,t[s],n);o=true}}}}return o};js.prototype.defines=function e(){var t=this;var r=[];for(var i in t.binders){r.push.apply(r,t.binders[i].defines())}return r};js.prototype.getPaintVertexBuffers=function e(){return this._buffers};js.prototype.getUniforms=function e(t,r){var i=this;var n={};for(var a in i.binders){var o=i.binders[a];for(var s=0,l=o.uniformNames;s<l.length;s+=1){var u=l[s];n[u]=o.getBinding(t,r[u])}}return n};js.prototype.setUniforms=function e(t,r,i,n){var a=this;for(var o in a.binders){var s=a.binders[o];for(var l=0,u=s.uniformNames;l<u.length;l+=1){var f=u[l];s.setUniforms(t,r[f],n,i.get(o),f)}}};js.prototype.updatePatternPaintBuffers=function e(t){var r=this;var i=[];for(var n in r.binders){var a=r.binders[n];if(a instanceof Ns){var o=t.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;if(o){i.push(o)}}else if((a instanceof zs||a instanceof Us)&&a.paintVertexBuffer){i.push(a.paintVertexBuffer)}}this._buffers=i};js.prototype.upload=function e(t){var r=this;for(var i in r.binders){r.binders[i].upload(t)}var n=[];for(var a in r.binders){var o=r.binders[a];if((o instanceof zs||o instanceof Us)&&o.paintVertexBuffer){n.push(o.paintVertexBuffer)}}this._buffers=n};js.prototype.destroy=function e(){var t=this;for(var r in t.binders){t.binders[r].destroy()}};var Vs=function e(t,r,i,n){var a=this;if(n===void 0)n=function e(){return true};this.programConfigurations={};for(var o=0,s=r;o<s.length;o+=1){var l=s[o];a.programConfigurations[l.id]=js.createDynamic(l,i,n);a.programConfigurations[l.id].layoutAttributes=t}this.needsUpload=false};Vs.prototype.populatePaintArrays=function e(t,r,i,n){var a=this;for(var o in a.programConfigurations){a.programConfigurations[o].populatePaintArrays(t,r,i,n)}this.needsUpload=true};Vs.prototype.updatePaintArrays=function e(t,r,i,n){var a=this;for(var o=0,s=i;o<s.length;o+=1){var l=s[o];a.needsUpload=a.programConfigurations[l.id].updatePaintArrays(t,r,l,n)||a.needsUpload}};Vs.prototype.get=function e(t){return this.programConfigurations[t]};Vs.prototype.upload=function e(t){var r=this;if(!this.needsUpload){return}for(var i in r.programConfigurations){r.programConfigurations[i].upload(t)}this.needsUpload=false};Vs.prototype.destroy=function e(){var t=this;for(var r in t.programConfigurations){t.programConfigurations[r].destroy()}};function Gs(e,t){var r={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from"],"fill-pattern":["pattern_to","pattern_from"],"fill-extrusion-pattern":["pattern_to","pattern_from"]};return r[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function Zs(e){var t={"line-pattern":{source:Vo,composite:Vo},"fill-pattern":{source:Vo,composite:Vo},"fill-extrusion-pattern":{source:Vo,composite:Vo}};return t[e]}function qs(e,t,r){var i={color:{source:is,composite:ns},number:{source:Jo,composite:is}};var n=Zs(e);return n&&n[r]||i[t][r]}ja("ConstantBinder",Fs);ja("CrossFadedConstantBinder",Os);ja("SourceExpressionBinder",zs);ja("CrossFadedCompositeBinder",Ns);ja("CompositeExpressionBinder",Us);ja("ProgramConfiguration",js,{omit:["_buffers"]});ja("ProgramConfigurationSet",Vs);var Hs=8192;function Ws(e){return{min:-1*Math.pow(2,e-1),max:Math.pow(2,e-1)-1}}var Xs=Ws(16);function Ys(e){var t=Hs/e.extent;var r=e.loadGeometry();for(var i=0;i<r.length;i++){var n=r[i];for(var a=0;a<n.length;a++){var o=n[a];o.x=Math.round(o.x*t);o.y=Math.round(o.y*t);if(o.x<Xs.min||o.x>Xs.max||o.y<Xs.min||o.y>Xs.max){Ee("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}}return r}function Ks(e,t,r,i,n){e.emplaceBack(t*2+(i+1)/2,r*2+(n+1)/2)}var Js=function e(t){this.zoom=t.zoom;this.overscaling=t.overscaling;this.layers=t.layers;this.layerIds=this.layers.map(function(e){return e.id});this.index=t.index;this.hasPattern=false;this.layoutVertexArray=new zo;this.indexArray=new es;this.segments=new bs;this.programConfigurations=new Vs(gs,t.layers,t.zoom)};Js.prototype.populate=function e(t,r){var i=this;for(var n=0,a=t;n<a.length;n+=1){var o=a[n];var s=o.feature;var l=o.index;var u=o.sourceLayerIndex;if(i.layers[0]._featureFilter(new ho(i.zoom),s)){var f=Ys(s);i.addFeature(s,f,l);r.featureIndex.insert(s,f,l,u,i.index)}}};Js.prototype.update=function e(t,r,i){if(!this.stateDependentLayers.length){return}this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,i)};Js.prototype.isEmpty=function e(){return this.layoutVertexArray.length===0};Js.prototype.uploadPending=function e(){return!this.uploaded||this.programConfigurations.needsUpload};Js.prototype.upload=function e(t){if(!this.uploaded){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,gs);this.indexBuffer=t.createIndexBuffer(this.indexArray)}this.programConfigurations.upload(t);this.uploaded=true};Js.prototype.destroy=function e(){if(!this.layoutVertexBuffer){return}this.layoutVertexBuffer.destroy();this.indexBuffer.destroy();this.programConfigurations.destroy();this.segments.destroy()};Js.prototype.addFeature=function e(t,r,i){var n=this;for(var a=0,o=r;a<o.length;a+=1){var s=o[a];for(var l=0,u=s;l<u.length;l+=1){var f=u[l];var c=f.x;var h=f.y;if(c<0||c>=Hs||h<0||h>=Hs){continue}var p=n.segments.prepareSegment(4,n.layoutVertexArray,n.indexArray);var d=p.vertexLength;Ks(n.layoutVertexArray,c,h,-1,-1);Ks(n.layoutVertexArray,c,h,1,-1);Ks(n.layoutVertexArray,c,h,1,1);Ks(n.layoutVertexArray,c,h,-1,1);n.indexArray.emplaceBack(d,d+1,d+2);n.indexArray.emplaceBack(d,d+3,d+2);p.vertexLength+=4;p.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,{})};ja("CircleBucket",Js,{omit:["layers"]});function $s(e,t){for(var r=0;r<e.length;r++){if(ul(t,e[r])){return true}}for(var i=0;i<t.length;i++){if(ul(e,t[i])){return true}}if(nl(e,t)){return true}return false}function Qs(e,t,r){for(var i=0;i<e.length;i++){var n=e[i];if(ul(n,t)){return true}if(ol(t,n,r)){return true}}return false}function el(e,t,r){for(var i=0;i<t.length;i++){var n=t[i];for(var a=0;a<n.length;a++){if(Qs(e,n[a],r)){return true}}}return false}function tl(e,t){if(e.length===1&&e[0].length===1){return ll(t,e[0][0])}for(var r=0;r<t.length;r++){var i=t[r];for(var n=0;n<i.length;n++){if(ll(e,i[n])){return true}}}for(var a=0;a<e.length;a++){var o=e[a];for(var s=0;s<o.length;s++){if(ll(t,o[s])){return true}}for(var l=0;l<t.length;l++){if(nl(o,t[l])){return true}}}return false}function rl(e,t,r){for(var i=0;i<t.length;i++){var n=t[i];for(var a=0;a<e.length;a++){var o=e[a];if(o.length>=3){for(var s=0;s<n.length;s++){if(ul(o,n[s])){return true}}}if(il(o,n,r)){return true}}}return false}function il(e,t,r){if(e.length>1){if(nl(e,t)){return true}for(var i=0;i<t.length;i++){if(ol(t[i],e,r)){return true}}}for(var n=0;n<e.length;n++){if(ol(e[n],t,r)){return true}}return false}function nl(e,t){if(e.length===0||t.length===0){return false}for(var r=0;r<e.length-1;r++){var i=e[r];var n=e[r+1];for(var a=0;a<t.length-1;a++){var o=t[a];var s=t[a+1];if(al(i,n,o,s)){return true}}}return false}function al(e,t,r,i){return ke(e,r,i)!==ke(t,r,i)&&ke(e,t,r)!==ke(e,t,i)}function ol(e,t,r){var i=r*r;if(t.length===1){return e.distSqr(t[0])<i}for(var n=1;n<t.length;n++){var a=t[n-1],o=t[n];if(sl(e,a,o)<i){return true}}return false}function sl(e,t,r){var i=t.distSqr(r);if(i===0){return e.distSqr(t)}var n=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/i;if(n<0){return e.distSqr(t)}if(n>1){return e.distSqr(r)}return e.distSqr(r.sub(t)._mult(n)._add(t))}function ll(e,t){var r=false,i,n,a;for(var o=0;o<e.length;o++){i=e[o];for(var s=0,l=i.length-1;s<i.length;l=s++){n=i[s];a=i[l];if(n.y>t.y!==a.y>t.y&&t.x<(a.x-n.x)*(t.y-n.y)/(a.y-n.y)+n.x){r=!r}}}return r}function ul(e,t){var r=false;for(var i=0,n=e.length-1;i<e.length;n=i++){var a=e[i];var o=e[n];if(a.y>t.y!==o.y>t.y&&t.x<(o.x-a.x)*(t.y-a.y)/(o.y-a.y)+a.x){r=!r}}return r}function fl(e,t,r){var i=t.paint.get(e).value;if(i.kind==="constant"){return i.value}else{var n=r.programConfigurations.get(t.id).binders;return n[e].maxValue}}function cl(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function hl(e,t,r,i,n){if(!t[0]&&!t[1]){return e}var a=se.convert(t);if(r==="viewport"){a._rotate(-i)}var o=[];for(var s=0;s<e.length;s++){var l=e[s];var u=[];for(var f=0;f<l.length;f++){u.push(l[f].sub(a._mult(n)))}o.push(u)}return o}var pl=new Mo({"circle-radius":new So(yr["paint_circle"]["circle-radius"]),"circle-color":new So(yr["paint_circle"]["circle-color"]),"circle-blur":new So(yr["paint_circle"]["circle-blur"]),"circle-opacity":new So(yr["paint_circle"]["circle-opacity"]),"circle-translate":new wo(yr["paint_circle"]["circle-translate"]),"circle-translate-anchor":new wo(yr["paint_circle"]["circle-translate-anchor"]),"circle-pitch-scale":new wo(yr["paint_circle"]["circle-pitch-scale"]),"circle-pitch-alignment":new wo(yr["paint_circle"]["circle-pitch-alignment"]),"circle-stroke-width":new So(yr["paint_circle"]["circle-stroke-width"]),"circle-stroke-color":new So(yr["paint_circle"]["circle-stroke-color"]),"circle-stroke-opacity":new So(yr["paint_circle"]["circle-stroke-opacity"])});var dl={paint:pl};var vl=1e-6;var yl=typeof Float32Array!=="undefined"?Float32Array:Array;var ml=Math.random;function gl(e){yl=e}var _l=Math.PI/180;function xl(e){return e*_l}function bl(e,t){return Math.abs(e-t)<=vl*Math.max(1,Math.abs(e),Math.abs(t))}function wl(){var e=new yl(4);if(yl!=Float32Array){e[1]=0;e[2]=0}e[0]=1;e[3]=1;return e}function Sl(e){var t=new yl(4);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];return t}function Cl(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];return e}function Tl(e){e[0]=1;e[1]=0;e[2]=0;e[3]=1;return e}function Pl(e,t,r,i){var n=new yl(4);n[0]=e;n[1]=t;n[2]=r;n[3]=i;return n}function Ml(e,t,r,i,n){e[0]=t;e[1]=r;e[2]=i;e[3]=n;return e}function Il(e,t){if(e===t){var r=t[1];e[1]=t[2];e[2]=r}else{e[0]=t[0];e[1]=t[2];e[2]=t[1];e[3]=t[3]}return e}function Al(e,t){var r=t[0],i=t[1],n=t[2],a=t[3];var o=r*a-n*i;if(!o){return null}o=1/o;e[0]=a*o;e[1]=-i*o;e[2]=-n*o;e[3]=r*o;return e}function Ll(e,t){var r=t[0];e[0]=t[3];e[1]=-t[1];e[2]=-t[2];e[3]=r;return e}function El(e){return e[0]*e[3]-e[2]*e[1]}function kl(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3];var s=r[0],l=r[1],u=r[2],f=r[3];e[0]=i*s+a*l;e[1]=n*s+o*l;e[2]=i*u+a*f;e[3]=n*u+o*f;return e}function Dl(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3];var s=Math.sin(r);var l=Math.cos(r);e[0]=i*l+a*s;e[1]=n*l+o*s;e[2]=i*-s+a*l;e[3]=n*-s+o*l;return e}function Bl(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3];var s=r[0],l=r[1];e[0]=i*s;e[1]=n*s;e[2]=a*l;e[3]=o*l;return e}function Rl(e,t){var r=Math.sin(t);var i=Math.cos(t);e[0]=i;e[1]=r;e[2]=-r;e[3]=i;return e}function Fl(e,t){e[0]=t[0];e[1]=0;e[2]=0;e[3]=t[1];return e}function Ol(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function zl(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))}function Ul(e,t,r,i){e[2]=i[2]/i[0];r[0]=i[0];r[1]=i[1];r[3]=i[3]-e[2]*r[1];return[e,t,r]}function Nl(e,t,r){e[0]=t[0]+r[0];e[1]=t[1]+r[1];e[2]=t[2]+r[2];e[3]=t[3]+r[3];return e}function jl(e,t,r){e[0]=t[0]-r[0];e[1]=t[1]-r[1];e[2]=t[2]-r[2];e[3]=t[3]-r[3];return e}function Vl(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function Gl(e,t){var r=e[0],i=e[1],n=e[2],a=e[3];var o=t[0],s=t[1],l=t[2],u=t[3];return Math.abs(r-o)<=vl*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=vl*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(n-l)<=vl*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-u)<=vl*Math.max(1,Math.abs(a),Math.abs(u))}function Zl(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;e[3]=t[3]*r;return e}function ql(e,t,r,i){e[0]=t[0]+r[0]*i;e[1]=t[1]+r[1]*i;e[2]=t[2]+r[2]*i;e[3]=t[3]+r[3]*i;return e}var Hl=kl;var Wl=jl;function Xl(){var e=new yl(6);if(yl!=Float32Array){e[1]=0;e[2]=0;e[4]=0;e[5]=0}e[0]=1;e[3]=1;return e}function Yl(e){var t=new yl(6);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];return t}function Kl(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];return e}function Jl(e){e[0]=1;e[1]=0;e[2]=0;e[3]=1;e[4]=0;e[5]=0;return e}function $l(e,t,r,i,n,a){var o=new yl(6);o[0]=e;o[1]=t;o[2]=r;o[3]=i;o[4]=n;o[5]=a;return o}function Ql(e,t,r,i,n,a,o){e[0]=t;e[1]=r;e[2]=i;e[3]=n;e[4]=a;e[5]=o;return e}function eu(e,t){var r=t[0],i=t[1],n=t[2],a=t[3];var o=t[4],s=t[5];var l=r*a-i*n;if(!l){return null}l=1/l;e[0]=a*l;e[1]=-i*l;e[2]=-n*l;e[3]=r*l;e[4]=(n*s-a*o)*l;e[5]=(i*o-r*s)*l;return e}function tu(e){return e[0]*e[3]-e[1]*e[2]}function ru(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5];var u=r[0],f=r[1],c=r[2],h=r[3],p=r[4],d=r[5];e[0]=i*u+a*f;e[1]=n*u+o*f;e[2]=i*c+a*h;e[3]=n*c+o*h;e[4]=i*p+a*d+s;e[5]=n*p+o*d+l;return e}function iu(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5];var u=Math.sin(r);var f=Math.cos(r);e[0]=i*f+a*u;e[1]=n*f+o*u;e[2]=i*-u+a*f;e[3]=n*-u+o*f;e[4]=s;e[5]=l;return e}function nu(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5];var u=r[0],f=r[1];e[0]=i*u;e[1]=n*u;e[2]=a*f;e[3]=o*f;e[4]=s;e[5]=l;return e}function au(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5];var u=r[0],f=r[1];e[0]=i;e[1]=n;e[2]=a;e[3]=o;e[4]=i*u+a*f+s;e[5]=n*u+o*f+l;return e}function ou(e,t){var r=Math.sin(t),i=Math.cos(t);e[0]=i;e[1]=r;e[2]=-r;e[3]=i;e[4]=0;e[5]=0;return e}function su(e,t){e[0]=t[0];e[1]=0;e[2]=0;e[3]=t[1];e[4]=0;e[5]=0;return e}function lu(e,t){e[0]=1;e[1]=0;e[2]=0;e[3]=1;e[4]=t[0];e[5]=t[1];return e}function uu(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function fu(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)}function cu(e,t,r){e[0]=t[0]+r[0];e[1]=t[1]+r[1];e[2]=t[2]+r[2];e[3]=t[3]+r[3];e[4]=t[4]+r[4];e[5]=t[5]+r[5];return e}function hu(e,t,r){e[0]=t[0]-r[0];e[1]=t[1]-r[1];e[2]=t[2]-r[2];e[3]=t[3]-r[3];e[4]=t[4]-r[4];e[5]=t[5]-r[5];return e}function pu(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;e[3]=t[3]*r;e[4]=t[4]*r;e[5]=t[5]*r;return e}function du(e,t,r,i){e[0]=t[0]+r[0]*i;e[1]=t[1]+r[1]*i;e[2]=t[2]+r[2]*i;e[3]=t[3]+r[3]*i;e[4]=t[4]+r[4]*i;e[5]=t[5]+r[5]*i;return e}function vu(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function yu(e,t){var r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],s=e[5];var l=t[0],u=t[1],f=t[2],c=t[3],h=t[4],p=t[5];return Math.abs(r-l)<=vl*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(i-u)<=vl*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(n-f)<=vl*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(a-c)<=vl*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(o-h)<=vl*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-p)<=vl*Math.max(1,Math.abs(s),Math.abs(p))}var mu=ru;var gu=hu;function _u(){var e=new yl(9);if(yl!=Float32Array){e[1]=0;e[2]=0;e[3]=0;e[5]=0;e[6]=0;e[7]=0}e[0]=1;e[4]=1;e[8]=1;return e}function xu(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[4];e[4]=t[5];e[5]=t[6];e[6]=t[8];e[7]=t[9];e[8]=t[10];return e}function bu(e){var t=new yl(9);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];return t}function wu(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[8]=t[8];return e}function Su(e,t,r,i,n,a,o,s,l){var u=new yl(9);u[0]=e;u[1]=t;u[2]=r;u[3]=i;u[4]=n;u[5]=a;u[6]=o;u[7]=s;u[8]=l;return u}function Cu(e,t,r,i,n,a,o,s,l,u){e[0]=t;e[1]=r;e[2]=i;e[3]=n;e[4]=a;e[5]=o;e[6]=s;e[7]=l;e[8]=u;return e}function Tu(e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=1;e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e}function Pu(e,t){if(e===t){var r=t[1],i=t[2],n=t[5];e[1]=t[3];e[2]=t[6];e[3]=r;e[5]=t[7];e[6]=i;e[7]=n}else{e[0]=t[0];e[1]=t[3];e[2]=t[6];e[3]=t[1];e[4]=t[4];e[5]=t[7];e[6]=t[2];e[7]=t[5];e[8]=t[8]}return e}function Mu(e,t){var r=t[0],i=t[1],n=t[2];var a=t[3],o=t[4],s=t[5];var l=t[6],u=t[7],f=t[8];var c=f*o-s*u;var h=-f*a+s*l;var p=u*a-o*l;var d=r*c+i*h+n*p;if(!d){return null}d=1/d;e[0]=c*d;e[1]=(-f*i+n*u)*d;e[2]=(s*i-n*o)*d;e[3]=h*d;e[4]=(f*r-n*l)*d;e[5]=(-s*r+n*a)*d;e[6]=p*d;e[7]=(-u*r+i*l)*d;e[8]=(o*r-i*a)*d;return e}function Iu(e,t){var r=t[0],i=t[1],n=t[2];var a=t[3],o=t[4],s=t[5];var l=t[6],u=t[7],f=t[8];e[0]=o*f-s*u;e[1]=n*u-i*f;e[2]=i*s-n*o;e[3]=s*l-a*f;e[4]=r*f-n*l;e[5]=n*a-r*s;e[6]=a*u-o*l;e[7]=i*l-r*u;e[8]=r*o-i*a;return e}function Au(e){var t=e[0],r=e[1],i=e[2];var n=e[3],a=e[4],o=e[5];var s=e[6],l=e[7],u=e[8];return t*(u*a-o*l)+r*(-u*n+o*s)+i*(l*n-a*s)}function Lu(e,t,r){var i=t[0],n=t[1],a=t[2];var o=t[3],s=t[4],l=t[5];var u=t[6],f=t[7],c=t[8];var h=r[0],p=r[1],d=r[2];var v=r[3],y=r[4],m=r[5];var g=r[6],_=r[7],x=r[8];e[0]=h*i+p*o+d*u;e[1]=h*n+p*s+d*f;e[2]=h*a+p*l+d*c;e[3]=v*i+y*o+m*u;e[4]=v*n+y*s+m*f;e[5]=v*a+y*l+m*c;e[6]=g*i+_*o+x*u;e[7]=g*n+_*s+x*f;e[8]=g*a+_*l+x*c;return e}function Eu(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],f=t[7],c=t[8],h=r[0],p=r[1];e[0]=i;e[1]=n;e[2]=a;e[3]=o;e[4]=s;e[5]=l;e[6]=h*i+p*o+u;e[7]=h*n+p*s+f;e[8]=h*a+p*l+c;return e}function ku(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],f=t[7],c=t[8],h=Math.sin(r),p=Math.cos(r);e[0]=p*i+h*o;e[1]=p*n+h*s;e[2]=p*a+h*l;e[3]=p*o-h*i;e[4]=p*s-h*n;e[5]=p*l-h*a;e[6]=u;e[7]=f;e[8]=c;return e}function Du(e,t,r){var i=r[0],n=r[1];e[0]=i*t[0];e[1]=i*t[1];e[2]=i*t[2];e[3]=n*t[3];e[4]=n*t[4];e[5]=n*t[5];e[6]=t[6];e[7]=t[7];e[8]=t[8];return e}function Bu(e,t){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=1;e[5]=0;e[6]=t[0];e[7]=t[1];e[8]=1;return e}function Ru(e,t){var r=Math.sin(t),i=Math.cos(t);e[0]=i;e[1]=r;e[2]=0;e[3]=-r;e[4]=i;e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e}function Fu(e,t){e[0]=t[0];e[1]=0;e[2]=0;e[3]=0;e[4]=t[1];e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e}function Ou(e,t){e[0]=t[0];e[1]=t[1];e[2]=0;e[3]=t[2];e[4]=t[3];e[5]=0;e[6]=t[4];e[7]=t[5];e[8]=1;return e}function zu(e,t){var r=t[0],i=t[1],n=t[2],a=t[3];var o=r+r;var s=i+i;var l=n+n;var u=r*o;var f=i*o;var c=i*s;var h=n*o;var p=n*s;var d=n*l;var v=a*o;var y=a*s;var m=a*l;e[0]=1-c-d;e[3]=f-m;e[6]=h+y;e[1]=f+m;e[4]=1-u-d;e[7]=p-v;e[2]=h-y;e[5]=p+v;e[8]=1-u-c;return e}function Uu(e,t){var r=t[0],i=t[1],n=t[2],a=t[3];var o=t[4],s=t[5],l=t[6],u=t[7];var f=t[8],c=t[9],h=t[10],p=t[11];var d=t[12],v=t[13],y=t[14],m=t[15];var g=r*s-i*o;var _=r*l-n*o;var x=r*u-a*o;var b=i*l-n*s;var w=i*u-a*s;var S=n*u-a*l;var C=f*v-c*d;var T=f*y-h*d;var P=f*m-p*d;var M=c*y-h*v;var I=c*m-p*v;var A=h*m-p*y;var L=g*A-_*I+x*M+b*P-w*T+S*C;if(!L){return null}L=1/L;e[0]=(s*A-l*I+u*M)*L;e[1]=(l*P-o*A-u*T)*L;e[2]=(o*I-s*P+u*C)*L;e[3]=(n*I-i*A-a*M)*L;e[4]=(r*A-n*P+a*T)*L;e[5]=(i*P-r*I-a*C)*L;e[6]=(v*S-y*w+m*b)*L;e[7]=(y*x-d*S-m*_)*L;e[8]=(d*w-v*x+m*g)*L;return e}function Nu(e,t,r){e[0]=2/t;e[1]=0;e[2]=0;e[3]=0;e[4]=-2/r;e[5]=0;e[6]=-1;e[7]=1;e[8]=1;return e}function ju(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Vu(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))}function Gu(e,t,r){e[0]=t[0]+r[0];e[1]=t[1]+r[1];e[2]=t[2]+r[2];e[3]=t[3]+r[3];e[4]=t[4]+r[4];e[5]=t[5]+r[5];e[6]=t[6]+r[6];e[7]=t[7]+r[7];e[8]=t[8]+r[8];return e}function Zu(e,t,r){e[0]=t[0]-r[0];e[1]=t[1]-r[1];e[2]=t[2]-r[2];e[3]=t[3]-r[3];e[4]=t[4]-r[4];e[5]=t[5]-r[5];e[6]=t[6]-r[6];e[7]=t[7]-r[7];e[8]=t[8]-r[8];return e}function qu(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;e[3]=t[3]*r;e[4]=t[4]*r;e[5]=t[5]*r;e[6]=t[6]*r;e[7]=t[7]*r;e[8]=t[8]*r;return e}function Hu(e,t,r,i){e[0]=t[0]+r[0]*i;e[1]=t[1]+r[1]*i;e[2]=t[2]+r[2]*i;e[3]=t[3]+r[3]*i;e[4]=t[4]+r[4]*i;e[5]=t[5]+r[5]*i;e[6]=t[6]+r[6]*i;e[7]=t[7]+r[7]*i;e[8]=t[8]+r[8]*i;return e}function Wu(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function Xu(e,t){var r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],f=e[8];var c=t[0],h=t[1],p=t[2],d=t[3],v=t[4],y=t[5],m=t[6],g=t[7],_=t[8];return Math.abs(r-c)<=vl*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-h)<=vl*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(n-p)<=vl*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(a-d)<=vl*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(o-v)<=vl*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(s-y)<=vl*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(l-m)<=vl*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(u-g)<=vl*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(f-_)<=vl*Math.max(1,Math.abs(f),Math.abs(_))}var Yu=Lu;var Ku=Zu;function Ju(){var e=new yl(16);if(yl!=Float32Array){e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[11]=0;e[12]=0;e[13]=0;e[14]=0}e[0]=1;e[5]=1;e[10]=1;e[15]=1;return e}function $u(e){var t=new yl(16);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t}function Qu(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e}function ef(e,t,r,i,n,a,o,s,l,u,f,c,h,p,d,v){var y=new yl(16);y[0]=e;y[1]=t;y[2]=r;y[3]=i;y[4]=n;y[5]=a;y[6]=o;y[7]=s;y[8]=l;y[9]=u;y[10]=f;y[11]=c;y[12]=h;y[13]=p;y[14]=d;y[15]=v;return y}function tf(e,t,r,i,n,a,o,s,l,u,f,c,h,p,d,v,y){e[0]=t;e[1]=r;e[2]=i;e[3]=n;e[4]=a;e[5]=o;e[6]=s;e[7]=l;e[8]=u;e[9]=f;e[10]=c;e[11]=h;e[12]=p;e[13]=d;e[14]=v;e[15]=y;return e}function rf(e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}function nf(e,t){if(e===t){var r=t[1],i=t[2],n=t[3];var a=t[6],o=t[7];var s=t[11];e[1]=t[4];e[2]=t[8];e[3]=t[12];e[4]=r;e[6]=t[9];e[7]=t[13];e[8]=i;e[9]=a;e[11]=t[14];e[12]=n;e[13]=o;e[14]=s}else{e[0]=t[0];e[1]=t[4];e[2]=t[8];e[3]=t[12];e[4]=t[1];e[5]=t[5];e[6]=t[9];e[7]=t[13];e[8]=t[2];e[9]=t[6];e[10]=t[10];e[11]=t[14];e[12]=t[3];e[13]=t[7];e[14]=t[11];e[15]=t[15]}return e}function af(e,t){var r=t[0],i=t[1],n=t[2],a=t[3];var o=t[4],s=t[5],l=t[6],u=t[7];var f=t[8],c=t[9],h=t[10],p=t[11];var d=t[12],v=t[13],y=t[14],m=t[15];var g=r*s-i*o;var _=r*l-n*o;var x=r*u-a*o;var b=i*l-n*s;var w=i*u-a*s;var S=n*u-a*l;var C=f*v-c*d;var T=f*y-h*d;var P=f*m-p*d;var M=c*y-h*v;var I=c*m-p*v;var A=h*m-p*y;var L=g*A-_*I+x*M+b*P-w*T+S*C;if(!L){return null}L=1/L;e[0]=(s*A-l*I+u*M)*L;e[1]=(n*I-i*A-a*M)*L;e[2]=(v*S-y*w+m*b)*L;e[3]=(h*w-c*S-p*b)*L;e[4]=(l*P-o*A-u*T)*L;e[5]=(r*A-n*P+a*T)*L;e[6]=(y*x-d*S-m*_)*L;e[7]=(f*S-h*x+p*_)*L;e[8]=(o*I-s*P+u*C)*L;e[9]=(i*P-r*I-a*C)*L;e[10]=(d*w-v*x+m*g)*L;e[11]=(c*x-f*w-p*g)*L;e[12]=(s*T-o*M-l*C)*L;e[13]=(r*M-i*T+n*C)*L;e[14]=(v*_-d*b-y*g)*L;e[15]=(f*b-c*_+h*g)*L;return e}function of(e,t){var r=t[0],i=t[1],n=t[2],a=t[3];var o=t[4],s=t[5],l=t[6],u=t[7];var f=t[8],c=t[9],h=t[10],p=t[11];var d=t[12],v=t[13],y=t[14],m=t[15];e[0]=s*(h*m-p*y)-c*(l*m-u*y)+v*(l*p-u*h);e[1]=-(i*(h*m-p*y)-c*(n*m-a*y)+v*(n*p-a*h));e[2]=i*(l*m-u*y)-s*(n*m-a*y)+v*(n*u-a*l);e[3]=-(i*(l*p-u*h)-s*(n*p-a*h)+c*(n*u-a*l));e[4]=-(o*(h*m-p*y)-f*(l*m-u*y)+d*(l*p-u*h));e[5]=r*(h*m-p*y)-f*(n*m-a*y)+d*(n*p-a*h);e[6]=-(r*(l*m-u*y)-o*(n*m-a*y)+d*(n*u-a*l));e[7]=r*(l*p-u*h)-o*(n*p-a*h)+f*(n*u-a*l);e[8]=o*(c*m-p*v)-f*(s*m-u*v)+d*(s*p-u*c);e[9]=-(r*(c*m-p*v)-f*(i*m-a*v)+d*(i*p-a*c));e[10]=r*(s*m-u*v)-o*(i*m-a*v)+d*(i*u-a*s);e[11]=-(r*(s*p-u*c)-o*(i*p-a*c)+f*(i*u-a*s));e[12]=-(o*(c*y-h*v)-f*(s*y-l*v)+d*(s*h-l*c));e[13]=r*(c*y-h*v)-f*(i*y-n*v)+d*(i*h-n*c);e[14]=-(r*(s*y-l*v)-o*(i*y-n*v)+d*(i*l-n*s));e[15]=r*(s*h-l*c)-o*(i*h-n*c)+f*(i*l-n*s);return e}function sf(e){var t=e[0],r=e[1],i=e[2],n=e[3];var a=e[4],o=e[5],s=e[6],l=e[7];var u=e[8],f=e[9],c=e[10],h=e[11];var p=e[12],d=e[13],v=e[14],y=e[15];var m=t*o-r*a;var g=t*s-i*a;var _=t*l-n*a;var x=r*s-i*o;var b=r*l-n*o;var w=i*l-n*s;var S=u*d-f*p;var C=u*v-c*p;var T=u*y-h*p;var P=f*v-c*d;var M=f*y-h*d;var I=c*y-h*v;return m*I-g*M+_*P+x*T-b*C+w*S}function lf(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3];var s=t[4],l=t[5],u=t[6],f=t[7];var c=t[8],h=t[9],p=t[10],d=t[11];var v=t[12],y=t[13],m=t[14],g=t[15];var _=r[0],x=r[1],b=r[2],w=r[3];e[0]=_*i+x*s+b*c+w*v;e[1]=_*n+x*l+b*h+w*y;e[2]=_*a+x*u+b*p+w*m;e[3]=_*o+x*f+b*d+w*g;_=r[4];x=r[5];b=r[6];w=r[7];e[4]=_*i+x*s+b*c+w*v;e[5]=_*n+x*l+b*h+w*y;e[6]=_*a+x*u+b*p+w*m;e[7]=_*o+x*f+b*d+w*g;_=r[8];x=r[9];b=r[10];w=r[11];e[8]=_*i+x*s+b*c+w*v;e[9]=_*n+x*l+b*h+w*y;e[10]=_*a+x*u+b*p+w*m;e[11]=_*o+x*f+b*d+w*g;_=r[12];x=r[13];b=r[14];w=r[15];e[12]=_*i+x*s+b*c+w*v;e[13]=_*n+x*l+b*h+w*y;e[14]=_*a+x*u+b*p+w*m;e[15]=_*o+x*f+b*d+w*g;return e}function uf(e,t,r){var i=r[0],n=r[1],a=r[2];var o=void 0,s=void 0,l=void 0,u=void 0;var f=void 0,c=void 0,h=void 0,p=void 0;var d=void 0,v=void 0,y=void 0,m=void 0;if(t===e){e[12]=t[0]*i+t[4]*n+t[8]*a+t[12];e[13]=t[1]*i+t[5]*n+t[9]*a+t[13];e[14]=t[2]*i+t[6]*n+t[10]*a+t[14];e[15]=t[3]*i+t[7]*n+t[11]*a+t[15]}else{o=t[0];s=t[1];l=t[2];u=t[3];f=t[4];c=t[5];h=t[6];p=t[7];d=t[8];v=t[9];y=t[10];m=t[11];e[0]=o;e[1]=s;e[2]=l;e[3]=u;e[4]=f;e[5]=c;e[6]=h;e[7]=p;e[8]=d;e[9]=v;e[10]=y;e[11]=m;e[12]=o*i+f*n+d*a+t[12];e[13]=s*i+c*n+v*a+t[13];e[14]=l*i+h*n+y*a+t[14];e[15]=u*i+p*n+m*a+t[15]}return e}function ff(e,t,r){var i=r[0],n=r[1],a=r[2];e[0]=t[0]*i;e[1]=t[1]*i;e[2]=t[2]*i;e[3]=t[3]*i;e[4]=t[4]*n;e[5]=t[5]*n;e[6]=t[6]*n;e[7]=t[7]*n;e[8]=t[8]*a;e[9]=t[9]*a;e[10]=t[10]*a;e[11]=t[11]*a;e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e}function cf(e,t,r,i){var n=i[0],a=i[1],o=i[2];var s=Math.sqrt(n*n+a*a+o*o);var l=void 0,u=void 0,f=void 0;var c=void 0,h=void 0,p=void 0,d=void 0;var v=void 0,y=void 0,m=void 0,g=void 0;var _=void 0,x=void 0,b=void 0,w=void 0;var S=void 0,C=void 0,T=void 0;var P=void 0,M=void 0,I=void 0;var A=void 0,L=void 0,E=void 0;if(s<vl){return null}s=1/s;n*=s;a*=s;o*=s;l=Math.sin(r);u=Math.cos(r);f=1-u;c=t[0];h=t[1];p=t[2];d=t[3];v=t[4];y=t[5];m=t[6];g=t[7];_=t[8];x=t[9];b=t[10];w=t[11];S=n*n*f+u;C=a*n*f+o*l;T=o*n*f-a*l;P=n*a*f-o*l;M=a*a*f+u;I=o*a*f+n*l;A=n*o*f+a*l;L=a*o*f-n*l;E=o*o*f+u;e[0]=c*S+v*C+_*T;e[1]=h*S+y*C+x*T;e[2]=p*S+m*C+b*T;e[3]=d*S+g*C+w*T;e[4]=c*P+v*M+_*I;e[5]=h*P+y*M+x*I;e[6]=p*P+m*M+b*I;e[7]=d*P+g*M+w*I;e[8]=c*A+v*L+_*E;e[9]=h*A+y*L+x*E;e[10]=p*A+m*L+b*E;e[11]=d*A+g*L+w*E;if(t!==e){e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}return e}function hf(e,t,r){var i=Math.sin(r);var n=Math.cos(r);var a=t[4];var o=t[5];var s=t[6];var l=t[7];var u=t[8];var f=t[9];var c=t[10];var h=t[11];if(t!==e){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[4]=a*n+u*i;e[5]=o*n+f*i;e[6]=s*n+c*i;e[7]=l*n+h*i;e[8]=u*n-a*i;e[9]=f*n-o*i;e[10]=c*n-s*i;e[11]=h*n-l*i;return e}function pf(e,t,r){var i=Math.sin(r);var n=Math.cos(r);var a=t[0];var o=t[1];var s=t[2];var l=t[3];var u=t[8];var f=t[9];var c=t[10];var h=t[11];if(t!==e){e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[0]=a*n-u*i;e[1]=o*n-f*i;e[2]=s*n-c*i;e[3]=l*n-h*i;e[8]=a*i+u*n;e[9]=o*i+f*n;e[10]=s*i+c*n;e[11]=l*i+h*n;return e}function df(e,t,r){var i=Math.sin(r);var n=Math.cos(r);var a=t[0];var o=t[1];var s=t[2];var l=t[3];var u=t[4];var f=t[5];var c=t[6];var h=t[7];if(t!==e){e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[0]=a*n+u*i;e[1]=o*n+f*i;e[2]=s*n+c*i;e[3]=l*n+h*i;e[4]=u*n-a*i;e[5]=f*n-o*i;e[6]=c*n-s*i;e[7]=h*n-l*i;return e}function vf(e,t){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=t[0];e[13]=t[1];e[14]=t[2];e[15]=1;return e}function yf(e,t){e[0]=t[0];e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=t[1];e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=t[2];e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}function mf(e,t,r){var i=r[0],n=r[1],a=r[2];var o=Math.sqrt(i*i+n*n+a*a);var s=void 0,l=void 0,u=void 0;if(o<vl){return null}o=1/o;i*=o;n*=o;a*=o;s=Math.sin(t);l=Math.cos(t);u=1-l;e[0]=i*i*u+l;e[1]=n*i*u+a*s;e[2]=a*i*u-n*s;e[3]=0;e[4]=i*n*u-a*s;e[5]=n*n*u+l;e[6]=a*n*u+i*s;e[7]=0;e[8]=i*a*u+n*s;e[9]=n*a*u-i*s;e[10]=a*a*u+l;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}function gf(e,t){var r=Math.sin(t);var i=Math.cos(t);e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=i;e[6]=r;e[7]=0;e[8]=0;e[9]=-r;e[10]=i;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}function _f(e,t){var r=Math.sin(t);var i=Math.cos(t);e[0]=i;e[1]=0;e[2]=-r;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=r;e[9]=0;e[10]=i;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}function xf(e,t){var r=Math.sin(t);var i=Math.cos(t);e[0]=i;e[1]=r;e[2]=0;e[3]=0;e[4]=-r;e[5]=i;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}function bf(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3];var s=i+i;var l=n+n;var u=a+a;var f=i*s;var c=i*l;var h=i*u;var p=n*l;var d=n*u;var v=a*u;var y=o*s;var m=o*l;var g=o*u;e[0]=1-(p+v);e[1]=c+g;e[2]=h-m;e[3]=0;e[4]=c-g;e[5]=1-(f+v);e[6]=d+y;e[7]=0;e[8]=h+m;e[9]=d-y;e[10]=1-(f+p);e[11]=0;e[12]=r[0];e[13]=r[1];e[14]=r[2];e[15]=1;return e}function wf(e,t){var r=new yl(3);var i=-t[0],n=-t[1],a=-t[2],o=t[3],s=t[4],l=t[5],u=t[6],f=t[7];var c=i*i+n*n+a*a+o*o;if(c>0){r[0]=(s*o+f*i+l*a-u*n)*2/c;r[1]=(l*o+f*n+u*i-s*a)*2/c;r[2]=(u*o+f*a+s*n-l*i)*2/c}else{r[0]=(s*o+f*i+l*a-u*n)*2;r[1]=(l*o+f*n+u*i-s*a)*2;r[2]=(u*o+f*a+s*n-l*i)*2}bf(e,t,r);return e}function Sf(e,t){e[0]=t[12];e[1]=t[13];e[2]=t[14];return e}function Cf(e,t){var r=t[0];var i=t[1];var n=t[2];var a=t[4];var o=t[5];var s=t[6];var l=t[8];var u=t[9];var f=t[10];e[0]=Math.sqrt(r*r+i*i+n*n);e[1]=Math.sqrt(a*a+o*o+s*s);e[2]=Math.sqrt(l*l+u*u+f*f);return e}function Tf(e,t){var r=t[0]+t[5]+t[10];var i=0;if(r>0){i=Math.sqrt(r+1)*2;e[3]=.25*i;e[0]=(t[6]-t[9])/i;e[1]=(t[8]-t[2])/i;e[2]=(t[1]-t[4])/i}else if(t[0]>t[5]&&t[0]>t[10]){i=Math.sqrt(1+t[0]-t[5]-t[10])*2;e[3]=(t[6]-t[9])/i;e[0]=.25*i;e[1]=(t[1]+t[4])/i;e[2]=(t[8]+t[2])/i}else if(t[5]>t[10]){i=Math.sqrt(1+t[5]-t[0]-t[10])*2;e[3]=(t[8]-t[2])/i;e[0]=(t[1]+t[4])/i;e[1]=.25*i;e[2]=(t[6]+t[9])/i}else{i=Math.sqrt(1+t[10]-t[0]-t[5])*2;e[3]=(t[1]-t[4])/i;e[0]=(t[8]+t[2])/i;e[1]=(t[6]+t[9])/i;e[2]=.25*i}return e}function Pf(e,t,r,i){var n=t[0],a=t[1],o=t[2],s=t[3];var l=n+n;var u=a+a;var f=o+o;var c=n*l;var h=n*u;var p=n*f;var d=a*u;var v=a*f;var y=o*f;var m=s*l;var g=s*u;var _=s*f;var x=i[0];var b=i[1];var w=i[2];e[0]=(1-(d+y))*x;e[1]=(h+_)*x;e[2]=(p-g)*x;e[3]=0;e[4]=(h-_)*b;e[5]=(1-(c+y))*b;e[6]=(v+m)*b;e[7]=0;e[8]=(p+g)*w;e[9]=(v-m)*w;e[10]=(1-(c+d))*w;e[11]=0;e[12]=r[0];e[13]=r[1];e[14]=r[2];e[15]=1;return e}function Mf(e,t,r,i,n){var a=t[0],o=t[1],s=t[2],l=t[3];var u=a+a;var f=o+o;var c=s+s;var h=a*u;var p=a*f;var d=a*c;var v=o*f;var y=o*c;var m=s*c;var g=l*u;var _=l*f;var x=l*c;var b=i[0];var w=i[1];var S=i[2];var C=n[0];var T=n[1];var P=n[2];var M=(1-(v+m))*b;var I=(p+x)*b;var A=(d-_)*b;var L=(p-x)*w;var E=(1-(h+m))*w;var k=(y+g)*w;var D=(d+_)*S;var B=(y-g)*S;var R=(1-(h+v))*S;e[0]=M;e[1]=I;e[2]=A;e[3]=0;e[4]=L;e[5]=E;e[6]=k;e[7]=0;e[8]=D;e[9]=B;e[10]=R;e[11]=0;e[12]=r[0]+C-(M*C+L*T+D*P);e[13]=r[1]+T-(I*C+E*T+B*P);e[14]=r[2]+P-(A*C+k*T+R*P);e[15]=1;return e}function If(e,t){var r=t[0],i=t[1],n=t[2],a=t[3];var o=r+r;var s=i+i;var l=n+n;var u=r*o;var f=i*o;var c=i*s;var h=n*o;var p=n*s;var d=n*l;var v=a*o;var y=a*s;var m=a*l;e[0]=1-c-d;e[1]=f+m;e[2]=h-y;e[3]=0;e[4]=f-m;e[5]=1-u-d;e[6]=p+v;e[7]=0;e[8]=h+y;e[9]=p-v;e[10]=1-u-c;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}function Af(e,t,r,i,n,a,o){var s=1/(r-t);var l=1/(n-i);var u=1/(a-o);e[0]=a*2*s;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=a*2*l;e[6]=0;e[7]=0;e[8]=(r+t)*s;e[9]=(n+i)*l;e[10]=(o+a)*u;e[11]=-1;e[12]=0;e[13]=0;e[14]=o*a*2*u;e[15]=0;return e}function Lf(e,t,r,i,n){var a=1/Math.tan(t/2),o=void 0;e[0]=a/r;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=a;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[11]=-1;e[12]=0;e[13]=0;e[15]=0;if(n!=null&&n!==Infinity){o=1/(i-n);e[10]=(n+i)*o;e[14]=2*n*i*o}else{e[10]=-1;e[14]=-2*i}return e}function Ef(e,t,r,i){var n=Math.tan(t.upDegrees*Math.PI/180);var a=Math.tan(t.downDegrees*Math.PI/180);var o=Math.tan(t.leftDegrees*Math.PI/180);var s=Math.tan(t.rightDegrees*Math.PI/180);var l=2/(o+s);var u=2/(n+a);e[0]=l;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=u;e[6]=0;e[7]=0;e[8]=-((o-s)*l*.5);e[9]=(n-a)*u*.5;e[10]=i/(r-i);e[11]=-1;e[12]=0;e[13]=0;e[14]=i*r/(r-i);e[15]=0;return e}function kf(e,t,r,i,n,a,o){var s=1/(t-r);var l=1/(i-n);var u=1/(a-o);e[0]=-2*s;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=-2*l;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=2*u;e[11]=0;e[12]=(t+r)*s;e[13]=(n+i)*l;e[14]=(o+a)*u;e[15]=1;return e}function Df(e,t,r,i){var n=void 0,a=void 0,o=void 0,s=void 0,l=void 0,u=void 0,f=void 0,c=void 0,h=void 0,p=void 0;var d=t[0];var v=t[1];var y=t[2];var m=i[0];var g=i[1];var _=i[2];var x=r[0];var b=r[1];var w=r[2];if(Math.abs(d-x)<vl&&Math.abs(v-b)<vl&&Math.abs(y-w)<vl){return rf(e)}f=d-x;c=v-b;h=y-w;p=1/Math.sqrt(f*f+c*c+h*h);f*=p;c*=p;h*=p;n=g*h-_*c;a=_*f-m*h;o=m*c-g*f;p=Math.sqrt(n*n+a*a+o*o);if(!p){n=0;a=0;o=0}else{p=1/p;n*=p;a*=p;o*=p}s=c*o-h*a;l=h*n-f*o;u=f*a-c*n;p=Math.sqrt(s*s+l*l+u*u);if(!p){s=0;l=0;u=0}else{p=1/p;s*=p;l*=p;u*=p}e[0]=n;e[1]=s;e[2]=f;e[3]=0;e[4]=a;e[5]=l;e[6]=c;e[7]=0;e[8]=o;e[9]=u;e[10]=h;e[11]=0;e[12]=-(n*d+a*v+o*y);e[13]=-(s*d+l*v+u*y);e[14]=-(f*d+c*v+h*y);e[15]=1;return e}function Bf(e,t,r,i){var n=t[0],a=t[1],o=t[2],s=i[0],l=i[1],u=i[2];var f=n-r[0],c=a-r[1],h=o-r[2];var p=f*f+c*c+h*h;if(p>0){p=1/Math.sqrt(p);f*=p;c*=p;h*=p}var d=l*h-u*c,v=u*f-s*h,y=s*c-l*f;p=d*d+v*v+y*y;if(p>0){p=1/Math.sqrt(p);d*=p;v*=p;y*=p}e[0]=d;e[1]=v;e[2]=y;e[3]=0;e[4]=c*y-h*v;e[5]=h*d-f*y;e[6]=f*v-c*d;e[7]=0;e[8]=f;e[9]=c;e[10]=h;e[11]=0;e[12]=n;e[13]=a;e[14]=o;e[15]=1;return e}function Rf(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Ff(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))}function Of(e,t,r){e[0]=t[0]+r[0];e[1]=t[1]+r[1];e[2]=t[2]+r[2];e[3]=t[3]+r[3];e[4]=t[4]+r[4];e[5]=t[5]+r[5];e[6]=t[6]+r[6];e[7]=t[7]+r[7];e[8]=t[8]+r[8];e[9]=t[9]+r[9];e[10]=t[10]+r[10];e[11]=t[11]+r[11];e[12]=t[12]+r[12];e[13]=t[13]+r[13];e[14]=t[14]+r[14];e[15]=t[15]+r[15];return e}function zf(e,t,r){e[0]=t[0]-r[0];e[1]=t[1]-r[1];e[2]=t[2]-r[2];e[3]=t[3]-r[3];e[4]=t[4]-r[4];e[5]=t[5]-r[5];e[6]=t[6]-r[6];e[7]=t[7]-r[7];e[8]=t[8]-r[8];e[9]=t[9]-r[9];e[10]=t[10]-r[10];e[11]=t[11]-r[11];e[12]=t[12]-r[12];e[13]=t[13]-r[13];e[14]=t[14]-r[14];e[15]=t[15]-r[15];return e}function Uf(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;e[3]=t[3]*r;e[4]=t[4]*r;e[5]=t[5]*r;e[6]=t[6]*r;e[7]=t[7]*r;e[8]=t[8]*r;e[9]=t[9]*r;e[10]=t[10]*r;e[11]=t[11]*r;e[12]=t[12]*r;e[13]=t[13]*r;e[14]=t[14]*r;e[15]=t[15]*r;return e}function Nf(e,t,r,i){e[0]=t[0]+r[0]*i;e[1]=t[1]+r[1]*i;e[2]=t[2]+r[2]*i;e[3]=t[3]+r[3]*i;e[4]=t[4]+r[4]*i;e[5]=t[5]+r[5]*i;e[6]=t[6]+r[6]*i;e[7]=t[7]+r[7]*i;e[8]=t[8]+r[8]*i;e[9]=t[9]+r[9]*i;e[10]=t[10]+r[10]*i;e[11]=t[11]+r[11]*i;e[12]=t[12]+r[12]*i;e[13]=t[13]+r[13]*i;e[14]=t[14]+r[14]*i;e[15]=t[15]+r[15]*i;return e}function jf(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Vf(e,t){var r=e[0],i=e[1],n=e[2],a=e[3];var o=e[4],s=e[5],l=e[6],u=e[7];var f=e[8],c=e[9],h=e[10],p=e[11];var d=e[12],v=e[13],y=e[14],m=e[15];var g=t[0],_=t[1],x=t[2],b=t[3];var w=t[4],S=t[5],C=t[6],T=t[7];var P=t[8],M=t[9],I=t[10],A=t[11];var L=t[12],E=t[13],k=t[14],D=t[15];return Math.abs(r-g)<=vl*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(i-_)<=vl*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(n-x)<=vl*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(a-b)<=vl*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(o-w)<=vl*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(s-S)<=vl*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(l-C)<=vl*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(u-T)<=vl*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(f-P)<=vl*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(c-M)<=vl*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(h-I)<=vl*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(p-A)<=vl*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(d-L)<=vl*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(v-E)<=vl*Math.max(1,Math.abs(v),Math.abs(E))&&Math.abs(y-k)<=vl*Math.max(1,Math.abs(y),Math.abs(k))&&Math.abs(m-D)<=vl*Math.max(1,Math.abs(m),Math.abs(D))}var Gf=lf;var Zf=zf;function qf(){var e=new yl(3);if(yl!=Float32Array){e[0]=0;e[1]=0;e[2]=0}return e}function Hf(e){var t=new yl(3);t[0]=e[0];t[1]=e[1];t[2]=e[2];return t}function Wf(e){var t=e[0];var r=e[1];var i=e[2];return Math.sqrt(t*t+r*r+i*i)}function Xf(e,t,r){var i=new yl(3);i[0]=e;i[1]=t;i[2]=r;return i}function Yf(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];return e}function Kf(e,t,r,i){e[0]=t;e[1]=r;e[2]=i;return e}function Jf(e,t,r){e[0]=t[0]+r[0];e[1]=t[1]+r[1];e[2]=t[2]+r[2];return e}function $f(e,t,r){e[0]=t[0]-r[0];e[1]=t[1]-r[1];e[2]=t[2]-r[2];return e}function Qf(e,t,r){e[0]=t[0]*r[0];e[1]=t[1]*r[1];e[2]=t[2]*r[2];return e}function ec(e,t,r){e[0]=t[0]/r[0];e[1]=t[1]/r[1];e[2]=t[2]/r[2];return e}function tc(e,t){e[0]=Math.ceil(t[0]);e[1]=Math.ceil(t[1]);e[2]=Math.ceil(t[2]);return e}function rc(e,t){e[0]=Math.floor(t[0]);e[1]=Math.floor(t[1]);e[2]=Math.floor(t[2]);return e}function ic(e,t,r){e[0]=Math.min(t[0],r[0]);e[1]=Math.min(t[1],r[1]);e[2]=Math.min(t[2],r[2]);return e}function nc(e,t,r){e[0]=Math.max(t[0],r[0]);e[1]=Math.max(t[1],r[1]);e[2]=Math.max(t[2],r[2]);return e}function ac(e,t){e[0]=Math.round(t[0]);e[1]=Math.round(t[1]);e[2]=Math.round(t[2]);return e}function oc(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;return e}function sc(e,t,r,i){e[0]=t[0]+r[0]*i;e[1]=t[1]+r[1]*i;e[2]=t[2]+r[2]*i;return e}function lc(e,t){var r=t[0]-e[0];var i=t[1]-e[1];var n=t[2]-e[2];return Math.sqrt(r*r+i*i+n*n)}function uc(e,t){var r=t[0]-e[0];var i=t[1]-e[1];var n=t[2]-e[2];return r*r+i*i+n*n}function fc(e){var t=e[0];var r=e[1];var i=e[2];return t*t+r*r+i*i}function cc(e,t){e[0]=-t[0];e[1]=-t[1];e[2]=-t[2];return e}function hc(e,t){e[0]=1/t[0];e[1]=1/t[1];e[2]=1/t[2];return e}function pc(e,t){var r=t[0];var i=t[1];var n=t[2];var a=r*r+i*i+n*n;if(a>0){a=1/Math.sqrt(a);e[0]=t[0]*a;e[1]=t[1]*a;e[2]=t[2]*a}return e}function dc(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function vc(e,t,r){var i=t[0],n=t[1],a=t[2];var o=r[0],s=r[1],l=r[2];e[0]=n*l-a*s;e[1]=a*o-i*l;e[2]=i*s-n*o;return e}function yc(e,t,r,i){var n=t[0];var a=t[1];var o=t[2];e[0]=n+i*(r[0]-n);e[1]=a+i*(r[1]-a);e[2]=o+i*(r[2]-o);return e}function mc(e,t,r,i,n,a){var o=a*a;var s=o*(2*a-3)+1;var l=o*(a-2)+a;var u=o*(a-1);var f=o*(3-2*a);e[0]=t[0]*s+r[0]*l+i[0]*u+n[0]*f;e[1]=t[1]*s+r[1]*l+i[1]*u+n[1]*f;e[2]=t[2]*s+r[2]*l+i[2]*u+n[2]*f;return e}function gc(e,t,r,i,n,a){var o=1-a;var s=o*o;var l=a*a;var u=s*o;var f=3*a*s;var c=3*l*o;var h=l*a;e[0]=t[0]*u+r[0]*f+i[0]*c+n[0]*h;e[1]=t[1]*u+r[1]*f+i[1]*c+n[1]*h;e[2]=t[2]*u+r[2]*f+i[2]*c+n[2]*h;return e}function _c(e,t){t=t||1;var r=ml()*2*Math.PI;var i=ml()*2-1;var n=Math.sqrt(1-i*i)*t;e[0]=Math.cos(r)*n;e[1]=Math.sin(r)*n;e[2]=i*t;return e}function xc(e,t,r){var i=t[0],n=t[1],a=t[2];var o=r[3]*i+r[7]*n+r[11]*a+r[15];o=o||1;e[0]=(r[0]*i+r[4]*n+r[8]*a+r[12])/o;e[1]=(r[1]*i+r[5]*n+r[9]*a+r[13])/o;e[2]=(r[2]*i+r[6]*n+r[10]*a+r[14])/o;return e}function bc(e,t,r){var i=t[0],n=t[1],a=t[2];e[0]=i*r[0]+n*r[3]+a*r[6];e[1]=i*r[1]+n*r[4]+a*r[7];e[2]=i*r[2]+n*r[5]+a*r[8];return e}function wc(e,t,r){var i=r[0],n=r[1],a=r[2],o=r[3];var s=t[0],l=t[1],u=t[2];var f=n*u-a*l,c=a*s-i*u,h=i*l-n*s;var p=n*h-a*c,d=a*f-i*h,v=i*c-n*f;var y=o*2;f*=y;c*=y;h*=y;p*=2;d*=2;v*=2;e[0]=s+f+p;e[1]=l+c+d;e[2]=u+h+v;return e}function Sc(e,t,r,i){var n=[],a=[];n[0]=t[0]-r[0];n[1]=t[1]-r[1];n[2]=t[2]-r[2];a[0]=n[0];a[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i);a[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i);e[0]=a[0]+r[0];e[1]=a[1]+r[1];e[2]=a[2]+r[2];return e}function Cc(e,t,r,i){var n=[],a=[];n[0]=t[0]-r[0];n[1]=t[1]-r[1];n[2]=t[2]-r[2];a[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i);a[1]=n[1];a[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i);e[0]=a[0]+r[0];e[1]=a[1]+r[1];e[2]=a[2]+r[2];return e}function Tc(e,t,r,i){var n=[],a=[];n[0]=t[0]-r[0];n[1]=t[1]-r[1];n[2]=t[2]-r[2];a[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i);a[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i);a[2]=n[2];e[0]=a[0]+r[0];e[1]=a[1]+r[1];e[2]=a[2]+r[2];return e}function Pc(e,t){var r=Xf(e[0],e[1],e[2]);var i=Xf(t[0],t[1],t[2]);pc(r,r);pc(i,i);var n=dc(r,i);if(n>1){return 0}else if(n<-1){return Math.PI}else{return Math.acos(n)}}function Mc(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Ic(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Ac(e,t){var r=e[0],i=e[1],n=e[2];var a=t[0],o=t[1],s=t[2];return Math.abs(r-a)<=vl*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=vl*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-s)<=vl*Math.max(1,Math.abs(n),Math.abs(s))}var Lc=$f;var Ec=Qf;var kc=ec;var Dc=lc;var Bc=uc;var Rc=Wf;var Fc=fc;var Oc=function(){var e=qf();return function(t,r,i,n,a,o){var s=void 0,l=void 0;if(!r){r=3}if(!i){i=0}if(n){l=Math.min(n*r+i,t.length)}else{l=t.length}for(s=i;s<l;s+=r){e[0]=t[s];e[1]=t[s+1];e[2]=t[s+2];a(e,e,o);t[s]=e[0];t[s+1]=e[1];t[s+2]=e[2]}return t}}();function zc(){var e=new yl(4);if(yl!=Float32Array){e[0]=0;e[1]=0;e[2]=0;e[3]=0}return e}function Uc(e){var t=new yl(4);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];return t}function Nc(e,t,r,i){var n=new yl(4);n[0]=e;n[1]=t;n[2]=r;n[3]=i;return n}function jc(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];return e}function Vc(e,t,r,i,n){e[0]=t;e[1]=r;e[2]=i;e[3]=n;return e}function Gc(e,t,r){e[0]=t[0]+r[0];e[1]=t[1]+r[1];e[2]=t[2]+r[2];e[3]=t[3]+r[3];return e}function Zc(e,t,r){e[0]=t[0]-r[0];e[1]=t[1]-r[1];e[2]=t[2]-r[2];e[3]=t[3]-r[3];return e}function qc(e,t,r){e[0]=t[0]*r[0];e[1]=t[1]*r[1];e[2]=t[2]*r[2];e[3]=t[3]*r[3];return e}function Hc(e,t,r){e[0]=t[0]/r[0];e[1]=t[1]/r[1];e[2]=t[2]/r[2];e[3]=t[3]/r[3];return e}function Wc(e,t){e[0]=Math.ceil(t[0]);e[1]=Math.ceil(t[1]);e[2]=Math.ceil(t[2]);e[3]=Math.ceil(t[3]);return e}function Xc(e,t){e[0]=Math.floor(t[0]);e[1]=Math.floor(t[1]);e[2]=Math.floor(t[2]);e[3]=Math.floor(t[3]);return e}function Yc(e,t,r){e[0]=Math.min(t[0],r[0]);e[1]=Math.min(t[1],r[1]);e[2]=Math.min(t[2],r[2]);e[3]=Math.min(t[3],r[3]);return e}function Kc(e,t,r){e[0]=Math.max(t[0],r[0]);e[1]=Math.max(t[1],r[1]);e[2]=Math.max(t[2],r[2]);e[3]=Math.max(t[3],r[3]);return e}function Jc(e,t){e[0]=Math.round(t[0]);e[1]=Math.round(t[1]);e[2]=Math.round(t[2]);e[3]=Math.round(t[3]);return e}function $c(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;e[3]=t[3]*r;return e}function Qc(e,t,r,i){e[0]=t[0]+r[0]*i;e[1]=t[1]+r[1]*i;e[2]=t[2]+r[2]*i;e[3]=t[3]+r[3]*i;return e}function eh(e,t){var r=t[0]-e[0];var i=t[1]-e[1];var n=t[2]-e[2];var a=t[3]-e[3];return Math.sqrt(r*r+i*i+n*n+a*a)}function th(e,t){var r=t[0]-e[0];var i=t[1]-e[1];var n=t[2]-e[2];var a=t[3]-e[3];return r*r+i*i+n*n+a*a}function rh(e){var t=e[0];var r=e[1];var i=e[2];var n=e[3];return Math.sqrt(t*t+r*r+i*i+n*n)}function ih(e){var t=e[0];var r=e[1];var i=e[2];var n=e[3];return t*t+r*r+i*i+n*n}function nh(e,t){e[0]=-t[0];e[1]=-t[1];e[2]=-t[2];e[3]=-t[3];return e}function ah(e,t){e[0]=1/t[0];e[1]=1/t[1];e[2]=1/t[2];e[3]=1/t[3];return e}function oh(e,t){var r=t[0];var i=t[1];var n=t[2];var a=t[3];var o=r*r+i*i+n*n+a*a;if(o>0){o=1/Math.sqrt(o);e[0]=r*o;e[1]=i*o;e[2]=n*o;e[3]=a*o}return e}function sh(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function lh(e,t,r,i){var n=t[0];var a=t[1];var o=t[2];var s=t[3];e[0]=n+i*(r[0]-n);e[1]=a+i*(r[1]-a);e[2]=o+i*(r[2]-o);e[3]=s+i*(r[3]-s);return e}function uh(e,t){t=t||1;var r,i,n,a;var o,s;do{r=ml()*2-1;i=ml()*2-1;o=r*r+i*i}while(o>=1);do{n=ml()*2-1;a=ml()*2-1;s=n*n+a*a}while(s>=1);var l=Math.sqrt((1-o)/s);e[0]=t*r;e[1]=t*i;e[2]=t*n*l;e[3]=t*a*l;return e}function fh(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3];e[0]=r[0]*i+r[4]*n+r[8]*a+r[12]*o;e[1]=r[1]*i+r[5]*n+r[9]*a+r[13]*o;e[2]=r[2]*i+r[6]*n+r[10]*a+r[14]*o;e[3]=r[3]*i+r[7]*n+r[11]*a+r[15]*o;return e}function ch(e,t,r){var i=t[0],n=t[1],a=t[2];var o=r[0],s=r[1],l=r[2],u=r[3];var f=u*i+s*a-l*n;var c=u*n+l*i-o*a;var h=u*a+o*n-s*i;var p=-o*i-s*n-l*a;e[0]=f*u+p*-o+c*-l-h*-s;e[1]=c*u+p*-s+h*-o-f*-l;e[2]=h*u+p*-l+f*-s-c*-o;e[3]=t[3];return e}function hh(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function ph(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function dh(e,t){var r=e[0],i=e[1],n=e[2],a=e[3];var o=t[0],s=t[1],l=t[2],u=t[3];return Math.abs(r-o)<=vl*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=vl*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(n-l)<=vl*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-u)<=vl*Math.max(1,Math.abs(a),Math.abs(u))}var vh=Zc;var yh=qc;var mh=Hc;var gh=eh;var _h=th;var xh=rh;var bh=ih;var wh=function(){var e=zc();return function(t,r,i,n,a,o){var s=void 0,l=void 0;if(!r){r=4}if(!i){i=0}if(n){l=Math.min(n*r+i,t.length)}else{l=t.length}for(s=i;s<l;s+=r){e[0]=t[s];e[1]=t[s+1];e[2]=t[s+2];e[3]=t[s+3];a(e,e,o);t[s]=e[0];t[s+1]=e[1];t[s+2]=e[2];t[s+3]=e[3]}return t}}();function Sh(){var e=new yl(4);if(yl!=Float32Array){e[0]=0;e[1]=0;e[2]=0}e[3]=1;return e}function Ch(e){e[0]=0;e[1]=0;e[2]=0;e[3]=1;return e}function Th(e,t,r){r=r*.5;var i=Math.sin(r);e[0]=i*t[0];e[1]=i*t[1];e[2]=i*t[2];e[3]=Math.cos(r);return e}function Ph(e,t){var r=Math.acos(t[3])*2;var i=Math.sin(r/2);if(i>vl){e[0]=t[0]/i;e[1]=t[1]/i;e[2]=t[2]/i}else{e[0]=1;e[1]=0;e[2]=0}return r}function Mh(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3];var s=r[0],l=r[1],u=r[2],f=r[3];e[0]=i*f+o*s+n*u-a*l;e[1]=n*f+o*l+a*s-i*u;e[2]=a*f+o*u+i*l-n*s;e[3]=o*f-i*s-n*l-a*u;return e}function Ih(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],o=t[3];var s=Math.sin(r),l=Math.cos(r);e[0]=i*l+o*s;e[1]=n*l+a*s;e[2]=a*l-n*s;e[3]=o*l-i*s;return e}function Ah(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],o=t[3];var s=Math.sin(r),l=Math.cos(r);e[0]=i*l-a*s;e[1]=n*l+o*s;e[2]=a*l+i*s;e[3]=o*l-n*s;return e}function Lh(e,t,r){r*=.5;var i=t[0],n=t[1],a=t[2],o=t[3];var s=Math.sin(r),l=Math.cos(r);e[0]=i*l+n*s;e[1]=n*l-i*s;e[2]=a*l+o*s;e[3]=o*l-a*s;return e}function Eh(e,t){var r=t[0],i=t[1],n=t[2];e[0]=r;e[1]=i;e[2]=n;e[3]=Math.sqrt(Math.abs(1-r*r-i*i-n*n));return e}function kh(e,t,r,i){var n=t[0],a=t[1],o=t[2],s=t[3];var l=r[0],u=r[1],f=r[2],c=r[3];var h=void 0,p=void 0,d=void 0,v=void 0,y=void 0;p=n*l+a*u+o*f+s*c;if(p<0){p=-p;l=-l;u=-u;f=-f;c=-c}if(1-p>vl){h=Math.acos(p);d=Math.sin(h);v=Math.sin((1-i)*h)/d;y=Math.sin(i*h)/d}else{v=1-i;y=i}e[0]=v*n+y*l;e[1]=v*a+y*u;e[2]=v*o+y*f;e[3]=v*s+y*c;return e}function Dh(e){var t=ml();var r=ml();var i=ml();var n=Math.sqrt(1-t);var a=Math.sqrt(t);e[0]=n*Math.sin(2*Math.PI*r);e[1]=n*Math.cos(2*Math.PI*r);e[2]=a*Math.sin(2*Math.PI*i);e[3]=a*Math.cos(2*Math.PI*i);return e}function Bh(e,t){var r=t[0],i=t[1],n=t[2],a=t[3];var o=r*r+i*i+n*n+a*a;var s=o?1/o:0;e[0]=-r*s;e[1]=-i*s;e[2]=-n*s;e[3]=a*s;return e}function Rh(e,t){e[0]=-t[0];e[1]=-t[1];e[2]=-t[2];e[3]=t[3];return e}function Fh(e,t){var r=t[0]+t[4]+t[8];var i=void 0;if(r>0){i=Math.sqrt(r+1);e[3]=.5*i;i=.5/i;e[0]=(t[5]-t[7])*i;e[1]=(t[6]-t[2])*i;e[2]=(t[1]-t[3])*i}else{var n=0;if(t[4]>t[0]){n=1}if(t[8]>t[n*3+n]){n=2}var a=(n+1)%3;var o=(n+2)%3;i=Math.sqrt(t[n*3+n]-t[a*3+a]-t[o*3+o]+1);e[n]=.5*i;i=.5/i;e[3]=(t[a*3+o]-t[o*3+a])*i;e[a]=(t[a*3+n]+t[n*3+a])*i;e[o]=(t[o*3+n]+t[n*3+o])*i}return e}function Oh(e,t,r,i){var n=.5*Math.PI/180;t*=n;r*=n;i*=n;var a=Math.sin(t);var o=Math.cos(t);var s=Math.sin(r);var l=Math.cos(r);var u=Math.sin(i);var f=Math.cos(i);e[0]=a*l*f-o*s*u;e[1]=o*s*f+a*l*u;e[2]=o*l*u-a*s*f;e[3]=o*l*f+a*s*u;return e}function zh(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var Uh=Uc;var Nh=Nc;var jh=jc;var Vh=Vc;var Gh=Gc;var Zh=Mh;var qh=$c;var Hh=sh;var Wh=lh;var Xh=rh;var Yh=Xh;var Kh=ih;var Jh=Kh;var $h=oh;var Qh=ph;var ep=dh;var tp=function(){var e=qf();var t=Xf(1,0,0);var r=Xf(0,1,0);return function(i,n,a){var o=dc(n,a);if(o<-.999999){vc(e,t,n);if(Rc(e)<1e-6){vc(e,r,n)}pc(e,e);Th(i,e,Math.PI);return i}else if(o>.999999){i[0]=0;i[1]=0;i[2]=0;i[3]=1;return i}else{vc(e,n,a);i[0]=e[0];i[1]=e[1];i[2]=e[2];i[3]=1+o;return $h(i,i)}}}();var rp=function(){var e=Sh();var t=Sh();return function(r,i,n,a,o,s){kh(e,i,o,s);kh(t,n,a,s);kh(r,e,t,2*s*(1-s));return r}}();var ip=function(){var e=_u();return function(t,r,i,n){e[0]=i[0];e[3]=i[1];e[6]=i[2];e[1]=n[0];e[4]=n[1];e[7]=n[2];e[2]=-r[0];e[5]=-r[1];e[8]=-r[2];return $h(t,Fh(t,e))}}();function np(){var e=new yl(8);if(yl!=Float32Array){e[0]=0;e[1]=0;e[2]=0;e[4]=0;e[5]=0;e[6]=0;e[7]=0}e[3]=1;return e}function ap(e){var t=new yl(8);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];return t}function op(e,t,r,i,n,a,o,s){var l=new yl(8);l[0]=e;l[1]=t;l[2]=r;l[3]=i;l[4]=n;l[5]=a;l[6]=o;l[7]=s;return l}function sp(e,t,r,i,n,a,o){var s=new yl(8);s[0]=e;s[1]=t;s[2]=r;s[3]=i;var l=n*.5,u=a*.5,f=o*.5;s[4]=l*i+u*r-f*t;s[5]=u*i+f*e-l*r;s[6]=f*i+l*t-u*e;s[7]=-l*e-u*t-f*r;return s}function lp(e,t,r){var i=r[0]*.5,n=r[1]*.5,a=r[2]*.5,o=t[0],s=t[1],l=t[2],u=t[3];e[0]=o;e[1]=s;e[2]=l;e[3]=u;e[4]=i*u+n*l-a*s;e[5]=n*u+a*o-i*l;e[6]=a*u+i*s-n*o;e[7]=-i*o-n*s-a*l;return e}function up(e,t){e[0]=0;e[1]=0;e[2]=0;e[3]=1;e[4]=t[0]*.5;e[5]=t[1]*.5;e[6]=t[2]*.5;e[7]=0;return e}function fp(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=0;e[5]=0;e[6]=0;e[7]=0;return e}function cp(e,t){var r=Sh();Tf(r,t);var i=new yl(3);Sf(i,t);lp(e,r,i);return e}function hp(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];return e}function pp(e){e[0]=0;e[1]=0;e[2]=0;e[3]=1;e[4]=0;e[5]=0;e[6]=0;e[7]=0;return e}function dp(e,t,r,i,n,a,o,s,l){e[0]=t;e[1]=r;e[2]=i;e[3]=n;e[4]=a;e[5]=o;e[6]=s;e[7]=l;return e}var vp=jh;function yp(e,t){e[0]=t[4];e[1]=t[5];e[2]=t[6];e[3]=t[7];return e}var mp=jh;function gp(e,t){e[4]=t[0];e[5]=t[1];e[6]=t[2];e[7]=t[3];return e}function _p(e,t){var r=t[4],i=t[5],n=t[6],a=t[7],o=-t[0],s=-t[1],l=-t[2],u=t[3];e[0]=(r*u+a*o+i*l-n*s)*2;e[1]=(i*u+a*s+n*o-r*l)*2;e[2]=(n*u+a*l+r*s-i*o)*2;return e}function xp(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=r[0]*.5,l=r[1]*.5,u=r[2]*.5,f=t[4],c=t[5],h=t[6],p=t[7];e[0]=i;e[1]=n;e[2]=a;e[3]=o;e[4]=o*s+n*u-a*l+f;e[5]=o*l+a*s-i*u+c;e[6]=o*u+i*l-n*s+h;e[7]=-i*s-n*l-a*u+p;return e}function bp(e,t,r){var i=-t[0],n=-t[1],a=-t[2],o=t[3],s=t[4],l=t[5],u=t[6],f=t[7],c=s*o+f*i+l*a-u*n,h=l*o+f*n+u*i-s*a,p=u*o+f*a+s*n-l*i,d=f*o-s*i-l*n-u*a;Ih(e,t,r);i=e[0];n=e[1];a=e[2];o=e[3];e[4]=c*o+d*i+h*a-p*n;e[5]=h*o+d*n+p*i-c*a;e[6]=p*o+d*a+c*n-h*i;e[7]=d*o-c*i-h*n-p*a;return e}function wp(e,t,r){var i=-t[0],n=-t[1],a=-t[2],o=t[3],s=t[4],l=t[5],u=t[6],f=t[7],c=s*o+f*i+l*a-u*n,h=l*o+f*n+u*i-s*a,p=u*o+f*a+s*n-l*i,d=f*o-s*i-l*n-u*a;Ah(e,t,r);i=e[0];n=e[1];a=e[2];o=e[3];e[4]=c*o+d*i+h*a-p*n;e[5]=h*o+d*n+p*i-c*a;e[6]=p*o+d*a+c*n-h*i;e[7]=d*o-c*i-h*n-p*a;return e}function Sp(e,t,r){var i=-t[0],n=-t[1],a=-t[2],o=t[3],s=t[4],l=t[5],u=t[6],f=t[7],c=s*o+f*i+l*a-u*n,h=l*o+f*n+u*i-s*a,p=u*o+f*a+s*n-l*i,d=f*o-s*i-l*n-u*a;Lh(e,t,r);i=e[0];n=e[1];a=e[2];o=e[3];e[4]=c*o+d*i+h*a-p*n;e[5]=h*o+d*n+p*i-c*a;e[6]=p*o+d*a+c*n-h*i;e[7]=d*o-c*i-h*n-p*a;return e}function Cp(e,t,r){var i=r[0],n=r[1],a=r[2],o=r[3],s=t[0],l=t[1],u=t[2],f=t[3];e[0]=s*o+f*i+l*a-u*n;e[1]=l*o+f*n+u*i-s*a;e[2]=u*o+f*a+s*n-l*i;e[3]=f*o-s*i-l*n-u*a;s=t[4];l=t[5];u=t[6];f=t[7];e[4]=s*o+f*i+l*a-u*n;e[5]=l*o+f*n+u*i-s*a;e[6]=u*o+f*a+s*n-l*i;e[7]=f*o-s*i-l*n-u*a;return e}function Tp(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=r[0],l=r[1],u=r[2],f=r[3];e[0]=i*f+o*s+n*u-a*l;e[1]=n*f+o*l+a*s-i*u;e[2]=a*f+o*u+i*l-n*s;e[3]=o*f-i*s-n*l-a*u;s=r[4];l=r[5];u=r[6];f=r[7];e[4]=i*f+o*s+n*u-a*l;e[5]=n*f+o*l+a*s-i*u;e[6]=a*f+o*u+i*l-n*s;e[7]=o*f-i*s-n*l-a*u;return e}function Pp(e,t,r,i){if(Math.abs(i)<vl){return hp(e,t)}var n=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);i=i*.5;var a=Math.sin(i);var o=a*r[0]/n;var s=a*r[1]/n;var l=a*r[2]/n;var u=Math.cos(i);var f=t[0],c=t[1],h=t[2],p=t[3];e[0]=f*u+p*o+c*l-h*s;e[1]=c*u+p*s+h*o-f*l;e[2]=h*u+p*l+f*s-c*o;e[3]=p*u-f*o-c*s-h*l;var d=t[4],v=t[5],y=t[6],m=t[7];e[4]=d*u+m*o+v*l-y*s;e[5]=v*u+m*s+y*o-d*l;e[6]=y*u+m*l+d*s-v*o;e[7]=m*u-d*o-v*s-y*l;return e}function Mp(e,t,r){e[0]=t[0]+r[0];e[1]=t[1]+r[1];e[2]=t[2]+r[2];e[3]=t[3]+r[3];e[4]=t[4]+r[4];e[5]=t[5]+r[5];e[6]=t[6]+r[6];e[7]=t[7]+r[7];return e}function Ip(e,t,r){var i=t[0],n=t[1],a=t[2],o=t[3],s=r[4],l=r[5],u=r[6],f=r[7],c=t[4],h=t[5],p=t[6],d=t[7],v=r[0],y=r[1],m=r[2],g=r[3];e[0]=i*g+o*v+n*m-a*y;e[1]=n*g+o*y+a*v-i*m;e[2]=a*g+o*m+i*y-n*v;e[3]=o*g-i*v-n*y-a*m;e[4]=i*f+o*s+n*u-a*l+c*g+d*v+h*m-p*y;e[5]=n*f+o*l+a*s-i*u+h*g+d*y+p*v-c*m;e[6]=a*f+o*u+i*l-n*s+p*g+d*m+c*y-h*v;e[7]=o*f-i*s-n*l-a*u+d*g-c*v-h*y-p*m;return e}var Ap=Ip;function Lp(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;e[3]=t[3]*r;e[4]=t[4]*r;e[5]=t[5]*r;e[6]=t[6]*r;e[7]=t[7]*r;return e}var Ep=Hh;function kp(e,t,r,i){var n=1-i;if(Ep(t,r)<0){i=-i}e[0]=t[0]*n+r[0]*i;e[1]=t[1]*n+r[1]*i;e[2]=t[2]*n+r[2]*i;e[3]=t[3]*n+r[3]*i;e[4]=t[4]*n+r[4]*i;e[5]=t[5]*n+r[5]*i;e[6]=t[6]*n+r[6]*i;e[7]=t[7]*n+r[7]*i;return e}function Dp(e,t){var r=Op(t);e[0]=-t[0]/r;e[1]=-t[1]/r;e[2]=-t[2]/r;e[3]=t[3]/r;e[4]=-t[4]/r;e[5]=-t[5]/r;e[6]=-t[6]/r;e[7]=t[7]/r;return e}function Bp(e,t){e[0]=-t[0];e[1]=-t[1];e[2]=-t[2];e[3]=t[3];e[4]=-t[4];e[5]=-t[5];e[6]=-t[6];e[7]=t[7];return e}var Rp=Xh;var Fp=Rp;var Op=Kh;var zp=Op;function Up(e,t){var r=Op(t);if(r>0){r=Math.sqrt(r);var i=t[0]/r;var n=t[1]/r;var a=t[2]/r;var o=t[3]/r;var s=t[4];var l=t[5];var u=t[6];var f=t[7];var c=i*s+n*l+a*u+o*f;e[0]=i;e[1]=n;e[2]=a;e[3]=o;e[4]=(s-i*c)/r;e[5]=(l-n*c)/r;e[6]=(u-a*c)/r;e[7]=(f-o*c)/r}return e}function Np(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function jp(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]}function Vp(e,t){var r=e[0],i=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7];var f=t[0],c=t[1],h=t[2],p=t[3],d=t[4],v=t[5],y=t[6],m=t[7];return Math.abs(r-f)<=vl*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-c)<=vl*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(n-h)<=vl*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(a-p)<=vl*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-d)<=vl*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(s-v)<=vl*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(l-y)<=vl*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(u-m)<=vl*Math.max(1,Math.abs(u),Math.abs(m))}function Gp(){var e=new yl(2);if(yl!=Float32Array){e[0]=0;e[1]=0}return e}function Zp(e){var t=new yl(2);t[0]=e[0];t[1]=e[1];return t}function qp(e,t){var r=new yl(2);r[0]=e;r[1]=t;return r}function Hp(e,t){e[0]=t[0];e[1]=t[1];return e}function Wp(e,t,r){e[0]=t;e[1]=r;return e}function Xp(e,t,r){e[0]=t[0]+r[0];e[1]=t[1]+r[1];return e}function Yp(e,t,r){e[0]=t[0]-r[0];e[1]=t[1]-r[1];return e}function Kp(e,t,r){e[0]=t[0]*r[0];e[1]=t[1]*r[1];return e}function Jp(e,t,r){e[0]=t[0]/r[0];e[1]=t[1]/r[1];return e}function $p(e,t){e[0]=Math.ceil(t[0]);e[1]=Math.ceil(t[1]);return e}function Qp(e,t){e[0]=Math.floor(t[0]);e[1]=Math.floor(t[1]);return e}function ed(e,t,r){e[0]=Math.min(t[0],r[0]);e[1]=Math.min(t[1],r[1]);return e}function td(e,t,r){e[0]=Math.max(t[0],r[0]);e[1]=Math.max(t[1],r[1]);return e}function rd(e,t){e[0]=Math.round(t[0]);e[1]=Math.round(t[1]);return e}function id(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;return e}function nd(e,t,r,i){e[0]=t[0]+r[0]*i;e[1]=t[1]+r[1]*i;return e}function ad(e,t){var r=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(r*r+i*i)}function od(e,t){var r=t[0]-e[0],i=t[1]-e[1];return r*r+i*i}function sd(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function ld(e){var t=e[0],r=e[1];return t*t+r*r}function ud(e,t){e[0]=-t[0];e[1]=-t[1];return e}function fd(e,t){e[0]=1/t[0];e[1]=1/t[1];return e}function cd(e,t){var r=t[0],i=t[1];var n=r*r+i*i;if(n>0){n=1/Math.sqrt(n);e[0]=t[0]*n;e[1]=t[1]*n}return e}function hd(e,t){return e[0]*t[0]+e[1]*t[1]}function pd(e,t,r){var i=t[0]*r[1]-t[1]*r[0];e[0]=e[1]=0;e[2]=i;return e}function dd(e,t,r,i){var n=t[0],a=t[1];e[0]=n+i*(r[0]-n);e[1]=a+i*(r[1]-a);return e}function vd(e,t){t=t||1;var r=ml()*2*Math.PI;e[0]=Math.cos(r)*t;e[1]=Math.sin(r)*t;return e}function yd(e,t,r){var i=t[0],n=t[1];e[0]=r[0]*i+r[2]*n;e[1]=r[1]*i+r[3]*n;return e}function md(e,t,r){var i=t[0],n=t[1];e[0]=r[0]*i+r[2]*n+r[4];e[1]=r[1]*i+r[3]*n+r[5];return e}function gd(e,t,r){var i=t[0],n=t[1];e[0]=r[0]*i+r[3]*n+r[6];e[1]=r[1]*i+r[4]*n+r[7];return e}function _d(e,t,r){var i=t[0];var n=t[1];e[0]=r[0]*i+r[4]*n+r[12];e[1]=r[1]*i+r[5]*n+r[13];return e}function xd(e,t,r,i){var n=t[0]-r[0],a=t[1]-r[1],o=Math.sin(i),s=Math.cos(i);e[0]=n*s-a*o+r[0];e[1]=n*o+a*s+r[1];return e}function bd(e,t){var r=e[0],i=e[1],n=t[0],a=t[1];var o=r*r+i*i;if(o>0){o=1/Math.sqrt(o)}var s=n*n+a*a;if(s>0){s=1/Math.sqrt(s)}var l=(r*n+i*a)*o*s;if(l>1){return 0}else if(l<-1){return Math.PI}else{return Math.acos(l)}}function wd(e){return"vec2("+e[0]+", "+e[1]+")"}function Sd(e,t){return e[0]===t[0]&&e[1]===t[1]}function Cd(e,t){var r=e[0],i=e[1];var n=t[0],a=t[1];return Math.abs(r-n)<=vl*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-a)<=vl*Math.max(1,Math.abs(i),Math.abs(a))}var Td=sd;var Pd=Yp;var Md=Kp;var Id=Jp;var Ad=ad;var Ld=od;var Ed=ld;var kd=function(){var e=Gp();return function(t,r,i,n,a,o){var s=void 0,l=void 0;if(!r){r=2}if(!i){i=0}if(n){l=Math.min(n*r+i,t.length)}else{l=t.length}for(s=i;s<l;s+=r){e[0]=t[s];e[1]=t[s+1];a(e,e,o);t[s]=e[0];t[s+1]=e[1]}return t}}();var Dd=function(e){function t(t){e.call(this,t,dl)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.createBucket=function e(t){return new Js(t)};t.prototype.queryRadius=function e(t){var r=t;return fl("circle-radius",this,r)+fl("circle-stroke-width",this,r)+cl(this.paint.get("circle-translate"))};t.prototype.queryIntersectsFeature=function e(t,r,i,n,a,o,s,l){var u=this;var f=hl(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,s);var c=this.paint.get("circle-radius").evaluate(r,i);var h=this.paint.get("circle-stroke-width").evaluate(r,i);var p=c+h;var d=this.paint.get("circle-pitch-alignment")==="map";var v=d?f:Rd(f,l,o);var y=d?p*s:p;for(var m=0,g=n;m<g.length;m+=1){var _=g[m];for(var x=0,b=_;x<b.length;x+=1){var w=b[x];var S=d?w:Bd(w,l,o);var C=y;var T=fh([],[w.x,w.y,0,1],l);if(u.paint.get("circle-pitch-scale")==="viewport"&&u.paint.get("circle-pitch-alignment")==="map"){C*=T[3]/o.cameraToCenterDistance}else if(u.paint.get("circle-pitch-scale")==="map"&&u.paint.get("circle-pitch-alignment")==="viewport"){C*=o.cameraToCenterDistance/T[3]}if(Qs(v,S,C)){return true}}}return false};return t}(Ao);function Bd(e,t,r){var i=fh([],[e.x,e.y,0,1],t);return new se((i[0]/i[3]+1)*r.width*.5,(i[1]/i[3]+1)*r.height*.5)}function Rd(e,t,r){return e.map(function(e){return e.map(function(e){return Bd(e,t,r)})})}var Fd=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;return t}(Js);ja("HeatmapBucket",Fd,{omit:["layers"]});function Od(e,t,r,i){var n=t.width;var a=t.height;if(!i){i=new Uint8Array(n*a*r)}else if(i.length!==n*a*r){throw new RangeError("mismatched image size")}e.width=n;e.height=a;e.data=i;return e}function zd(e,t,r){var i=t.width;var n=t.height;if(i===e.width&&n===e.height){return}var a=Od({},{width:i,height:n},r);Ud(e,a,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,i),height:Math.min(e.height,n)},r);e.width=i;e.height=n;e.data=a.data}function Ud(e,t,r,i,n,a){if(n.width===0||n.height===0){return t}if(n.width>e.width||n.height>e.height||r.x>e.width-n.width||r.y>e.height-n.height){throw new RangeError("out of range source coordinates for image copy")}if(n.width>t.width||n.height>t.height||i.x>t.width-n.width||i.y>t.height-n.height){throw new RangeError("out of range destination coordinates for image copy")}var o=e.data;var s=t.data;G(o!==s);for(var l=0;l<n.height;l++){var u=((r.y+l)*e.width+r.x)*a;var f=((i.y+l)*t.width+i.x)*a;for(var c=0;c<n.width*a;c++){s[f+c]=o[u+c]}}return t}var Nd=function e(t,r){Od(this,t,1,r)};Nd.prototype.resize=function e(t){zd(this,t,1)};Nd.prototype.clone=function e(){return new Nd({width:this.width,height:this.height},new Uint8Array(this.data))};Nd.copy=function e(t,r,i,n,a){Ud(t,r,i,n,a,1)};var jd=function e(t,r){Od(this,t,4,r)};jd.prototype.resize=function e(t){zd(this,t,4)};jd.prototype.clone=function e(){return new jd({width:this.width,height:this.height},new Uint8Array(this.data))};jd.copy=function e(t,r,i,n,a){Ud(t,r,i,n,a,4)};ja("AlphaImage",Nd);ja("RGBAImage",jd);var Vd=new Mo({"heatmap-radius":new So(yr["paint_heatmap"]["heatmap-radius"]),"heatmap-weight":new So(yr["paint_heatmap"]["heatmap-weight"]),"heatmap-intensity":new wo(yr["paint_heatmap"]["heatmap-intensity"]),"heatmap-color":new Po(yr["paint_heatmap"]["heatmap-color"]),"heatmap-opacity":new wo(yr["paint_heatmap"]["heatmap-opacity"])});var Gd={paint:Vd};function Zd(e,t){var r=new Uint8Array(256*4);var i={};for(var n=0,a=0;n<256;n++,a+=4){i[t]=n/255;var o=e.evaluate(i);r[a+0]=Math.floor(o.r*255/o.a);r[a+1]=Math.floor(o.g*255/o.a);r[a+2]=Math.floor(o.b*255/o.a);r[a+3]=Math.floor(o.a*255)}return new jd({width:256,height:1},r)}var qd=function(e){function t(t){e.call(this,t,Gd);this._updateColorRamp()}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.createBucket=function e(t){return new Fd(t)};t.prototype._handleSpecialPaintPropertyUpdate=function e(t){if(t==="heatmap-color"){this._updateColorRamp()}};t.prototype._updateColorRamp=function e(){var t=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Zd(t,"heatmapDensity");this.colorRampTexture=null};t.prototype.resize=function e(){if(this.heatmapFbo){this.heatmapFbo.destroy();this.heatmapFbo=null}};t.prototype.queryRadius=function e(){return 0};t.prototype.queryIntersectsFeature=function e(){return false};t.prototype.hasOffscreenPass=function e(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"};return t}(Ao);var Hd=new Mo({"hillshade-illumination-direction":new wo(yr["paint_hillshade"]["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new wo(yr["paint_hillshade"]["hillshade-illumination-anchor"]),"hillshade-exaggeration":new wo(yr["paint_hillshade"]["hillshade-exaggeration"]),"hillshade-shadow-color":new wo(yr["paint_hillshade"]["hillshade-shadow-color"]),"hillshade-highlight-color":new wo(yr["paint_hillshade"]["hillshade-highlight-color"]),"hillshade-accent-color":new wo(yr["paint_hillshade"]["hillshade-accent-color"])});var Wd={paint:Hd};var Xd=function(e){function t(t){e.call(this,t,Wd)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.hasOffscreenPass=function e(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"};return t}(Ao);var Yd=Ro([{name:"a_pos",components:2,type:"Int16"}],4);var Kd=Yd.members;var Jd=Yd.size;var $d=Yd.alignment;"use strict";var Qd=tv;var ev=tv;function tv(e,t,r){r=r||2;var i=t&&t.length,n=i?t[0]*r:e.length,a=rv(e,0,n,r,true),o=[];if(!a||a.next===a.prev){return o}var s,l,u,f,c,h,p;if(i){a=uv(e,t,a,r)}if(e.length>80*r){s=u=e[0];l=f=e[1];for(var d=r;d<n;d+=r){c=e[d];h=e[d+1];if(c<s){s=c}if(h<l){l=h}if(c>u){u=c}if(h>f){f=h}}p=Math.max(u-s,f-l);p=p!==0?1/p:0}nv(a,o,r,s,l,p);return o}function rv(e,t,r,i,n){var a,o;if(n===Av(e,t,r,i)>0){for(a=t;a<r;a+=i){o=Pv(a,e[a],e[a+1],o)}}else{for(a=r-i;a>=t;a-=i){o=Pv(a,e[a],e[a+1],o)}}if(o&&xv(o,o.next)){Mv(o);o=o.next}return o}function iv(e,t){if(!e){return e}if(!t){t=e}var r=e,i;do{i=false;if(!r.steiner&&(xv(r,r.next)||_v(r.prev,r,r.next)===0)){Mv(r);r=t=r.prev;if(r===r.next){break}i=true}else{r=r.next}}while(i||r!==t);return t}function nv(e,t,r,i,n,a,o){if(!e){return}if(!o&&a){pv(e,i,n,a)}var s=e,l,u;while(e.prev!==e.next){l=e.prev;u=e.next;if(a?ov(e,i,n,a):av(e)){t.push(l.i/r);t.push(e.i/r);t.push(u.i/r);Mv(e);e=u.next;s=u.next;continue}e=u;if(e===s){if(!o){nv(iv(e),t,r,i,n,a,1)}else if(o===1){e=sv(e,t,r);nv(e,t,r,i,n,a,2)}else if(o===2){lv(e,t,r,i,n,a)}break}}}function av(e){var t=e.prev,r=e,i=e.next;if(_v(t,r,i)>=0){return false}var n=e.next.next;while(n!==e.prev){if(mv(t.x,t.y,r.x,r.y,i.x,i.y,n.x,n.y)&&_v(n.prev,n,n.next)>=0){return false}n=n.next}return true}function ov(e,t,r,i){var n=e.prev,a=e,o=e.next;if(_v(n,a,o)>=0){return false}var s=n.x<a.x?n.x<o.x?n.x:o.x:a.x<o.x?a.x:o.x,l=n.y<a.y?n.y<o.y?n.y:o.y:a.y<o.y?a.y:o.y,u=n.x>a.x?n.x>o.x?n.x:o.x:a.x>o.x?a.x:o.x,f=n.y>a.y?n.y>o.y?n.y:o.y:a.y>o.y?a.y:o.y;var c=vv(s,l,t,r,i),h=vv(u,f,t,r,i);var p=e.prevZ,d=e.nextZ;while(p&&p.z>=c&&d&&d.z<=h){if(p!==e.prev&&p!==e.next&&mv(n.x,n.y,a.x,a.y,o.x,o.y,p.x,p.y)&&_v(p.prev,p,p.next)>=0){return false}p=p.prevZ;if(d!==e.prev&&d!==e.next&&mv(n.x,n.y,a.x,a.y,o.x,o.y,d.x,d.y)&&_v(d.prev,d,d.next)>=0){return false}d=d.nextZ}while(p&&p.z>=c){if(p!==e.prev&&p!==e.next&&mv(n.x,n.y,a.x,a.y,o.x,o.y,p.x,p.y)&&_v(p.prev,p,p.next)>=0){return false}p=p.prevZ}while(d&&d.z<=h){if(d!==e.prev&&d!==e.next&&mv(n.x,n.y,a.x,a.y,o.x,o.y,d.x,d.y)&&_v(d.prev,d,d.next)>=0){return false}d=d.nextZ}return true}function sv(e,t,r){var i=e;do{var n=i.prev,a=i.next.next;if(!xv(n,a)&&bv(n,i,i.next,a)&&Sv(n,a)&&Sv(a,n)){t.push(n.i/r);t.push(i.i/r);t.push(a.i/r);Mv(i);Mv(i.next);i=e=a}i=i.next}while(i!==e);return i}function lv(e,t,r,i,n,a){var o=e;do{var s=o.next.next;while(s!==o.prev){if(o.i!==s.i&&gv(o,s)){var l=Tv(o,s);o=iv(o,o.next);l=iv(l,l.next);nv(o,t,r,i,n,a);nv(l,t,r,i,n,a);return}s=s.next}o=o.next}while(o!==e)}function uv(e,t,r,i){var n=[],a,o,s,l,u;for(a=0,o=t.length;a<o;a++){s=t[a]*i;l=a<o-1?t[a+1]*i:e.length;u=rv(e,s,l,i,false);if(u===u.next){u.steiner=true}n.push(yv(u))}n.sort(fv);for(a=0;a<n.length;a++){cv(n[a],r);r=iv(r,r.next)}return r}function fv(e,t){return e.x-t.x}function cv(e,t){t=hv(e,t);if(t){var r=Tv(t,e);iv(r,r.next)}}function hv(e,t){var r=t,i=e.x,n=e.y,a=-Infinity,o;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){var s=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){a=s;if(s===i){if(n===r.y){return r}if(n===r.next.y){return r.next}}o=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!o){return null}if(i===a){return o.prev}var l=o,u=o.x,f=o.y,c=Infinity,h;r=o.next;while(r!==l){if(i>=r.x&&r.x>=u&&i!==r.x&&mv(n<f?i:a,n,u,f,n<f?a:i,n,r.x,r.y)){h=Math.abs(n-r.y)/(i-r.x);if((h<c||h===c&&r.x>o.x)&&Sv(r,e)){o=r;c=h}}r=r.next}return o}function pv(e,t,r,i){var n=e;do{if(n.z===null){n.z=vv(n.x,n.y,t,r,i)}n.prevZ=n.prev;n.nextZ=n.next;n=n.next}while(n!==e);n.prevZ.nextZ=null;n.prevZ=null;dv(n)}function dv(e){var t,r,i,n,a,o,s,l,u=1;do{r=e;e=null;a=null;o=0;while(r){o++;i=r;s=0;for(t=0;t<u;t++){s++;i=i.nextZ;if(!i){break}}l=u;while(s>0||l>0&&i){if(s!==0&&(l===0||!i||r.z<=i.z)){n=r;r=r.nextZ;s--}else{n=i;i=i.nextZ;l--}if(a){a.nextZ=n}else{e=n}n.prevZ=a;a=n}r=i}a.nextZ=null;u*=2}while(o>1);return e}function vv(e,t,r,i,n){e=32767*(e-r)*n;t=32767*(t-i)*n;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;return e|t<<1}function yv(e){var t=e,r=e;do{if(t.x<r.x||t.x===r.x&&t.y<r.y){r=t}t=t.next}while(t!==e);return r}function mv(e,t,r,i,n,a,o,s){return(n-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(i-s)-(r-o)*(t-s)>=0&&(r-o)*(a-s)-(n-o)*(i-s)>=0}function gv(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!wv(e,t)&&Sv(e,t)&&Sv(t,e)&&Cv(e,t)}function _v(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function xv(e,t){return e.x===t.x&&e.y===t.y}function bv(e,t,r,i){if(xv(e,t)&&xv(r,i)||xv(e,i)&&xv(r,t)){return true}return _v(e,t,r)>0!==_v(e,t,i)>0&&_v(r,i,e)>0!==_v(r,i,t)>0}function wv(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&bv(r,r.next,e,t)){return true}r=r.next}while(r!==e);return false}function Sv(e,t){return _v(e.prev,e,e.next)<0?_v(e,t,e.next)>=0&&_v(e,e.prev,t)>=0:_v(e,t,e.prev)<0||_v(e,e.next,t)<0}function Cv(e,t){var r=e,i=false,n=(e.x+t.x)/2,a=(e.y+t.y)/2;do{if(r.y>a!==r.next.y>a&&r.next.y!==r.y&&n<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x){i=!i}r=r.next}while(r!==e);return i}function Tv(e,t){var r=new Iv(e.i,e.x,e.y),i=new Iv(t.i,t.x,t.y),n=e.next,a=t.prev;e.next=t;t.prev=e;r.next=n;n.prev=r;i.next=r;r.prev=i;a.next=i;i.prev=a;return i}function Pv(e,t,r,i){var n=new Iv(e,t,r);if(!i){n.prev=n;n.next=n}else{n.next=i.next;n.prev=i;i.next.prev=n;i.next=n}return n}function Mv(e){e.next.prev=e.prev;e.prev.next=e.next;if(e.prevZ){e.prevZ.nextZ=e.nextZ}if(e.nextZ){e.nextZ.prevZ=e.prevZ}}function Iv(e,t,r){this.i=e;this.x=t;this.y=r;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}tv.deviation=function(e,t,r,i){var n=t&&t.length;var a=n?t[0]*r:e.length;var o=Math.abs(Av(e,0,a,r));if(n){for(var s=0,l=t.length;s<l;s++){var u=t[s]*r;var f=s<l-1?t[s+1]*r:e.length;o-=Math.abs(Av(e,u,f,r))}}var c=0;for(s=0;s<i.length;s+=3){var h=i[s]*r;var p=i[s+1]*r;var d=i[s+2]*r;c+=Math.abs((e[h]-e[d])*(e[p+1]-e[h+1])-(e[h]-e[p])*(e[d+1]-e[h+1]))}return o===0&&c===0?0:Math.abs((c-o)/o)};function Av(e,t,r,i){var n=0;for(var a=t,o=r-i;a<r;a+=i){n+=(e[o]-e[a])*(e[a+1]+e[o+1]);o=a}return n}tv.flatten=function(e){var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0;for(var n=0;n<e.length;n++){for(var a=0;a<e[n].length;a++){for(var o=0;o<t;o++){r.vertices.push(e[n][a][o])}}if(n>0){i+=e[n-1].length;r.holes.push(i)}}return r};Qd.default=ev;var Lv=o(function(e,t){(function(t,r){true?e.exports=r():undefined})(this,function(){"use strict";function e(e,r,n,a,o){t(e,r,n||0,a||e.length-1,o||i)}function t(e,i,n,a,o){while(a>n){if(a-n>600){var s=a-n+1;var l=i-n+1;var u=Math.log(s);var f=.5*Math.exp(2*u/3);var c=.5*Math.sqrt(u*f*(s-f)/s)*(l-s/2<0?-1:1);var h=Math.max(n,Math.floor(i-l*f/s+c));var p=Math.min(a,Math.floor(i+(s-l)*f/s+c));t(e,i,h,p,o)}var d=e[i];var v=n;var y=a;r(e,n,i);if(o(e[a],d)>0){r(e,n,a)}while(v<y){r(e,v,y);v++;y--;while(o(e[v],d)<0){v++}while(o(e[y],d)>0){y--}}if(o(e[n],d)===0){r(e,n,y)}else{y++;r(e,y,a)}if(y<=i){n=y+1}if(i<=y){a=y-1}}}function r(e,t,r){var i=e[t];e[t]=e[r];e[r]=i}function i(e,t){return e<t?-1:e>t?1:0}return e})});function Ev(e,t){var r=e.length;if(r<=1){return[e]}var i=[];var n,a;for(var o=0;o<r;o++){var s=De(e[o]);if(s===0){continue}e[o].area=Math.abs(s);if(a===undefined){a=s<0}if(a===s<0){if(n){i.push(n)}n=[e[o]]}else{n.push(e[o])}}if(n){i.push(n)}if(t>1){for(var l=0;l<i.length;l++){if(i[l].length<=t){continue}Lv(i[l],t,1,i[l].length-1,kv);i[l]=i[l].slice(0,t)}}return i}function kv(e,t){return t.area-e.area}function Dv(e,t,r){var i=r.patternDependencies;var n=false;for(var a=0,o=t;a<o.length;a+=1){var s=o[a];var l=s.paint.get(e+"-pattern");if(!l.isConstant()){n=true}var u=l.constantOr(null);if(u){n=true;i[u.to]=true;i[u.from]=true}}return n}function Bv(e,t,r,i,n){var a=n.patternDependencies;for(var o=0,s=t;o<s.length;o+=1){var l=s[o];var u=l.paint.get(e+"-pattern");var f=u.value;if(f.kind!=="constant"){var c=f.evaluate({zoom:i-1},r,{});var h=f.evaluate({zoom:i},r,{});var p=f.evaluate({zoom:i+1},r,{});a[c]=true;a[h]=true;a[p]=true;r.patterns[l.id]={min:c,mid:h,max:p}}}return r}var Rv=500;var Fv=function e(t){this.zoom=t.zoom;this.overscaling=t.overscaling;this.layers=t.layers;this.layerIds=this.layers.map(function(e){return e.id});this.index=t.index;this.hasPattern=false;this.layoutVertexArray=new zo;this.indexArray=new es;this.indexArray2=new ts;this.programConfigurations=new Vs(Kd,t.layers,t.zoom);this.segments=new bs;this.segments2=new bs};Fv.prototype.populate=function e(t,r){var i=this;this.features=[];this.hasPattern=Dv("fill",this.layers,r);for(var n=0,a=t;n<a.length;n+=1){var o=a[n];var s=o.feature;var l=o.index;var u=o.sourceLayerIndex;if(!i.layers[0]._featureFilter(new ho(i.zoom),s)){continue}var f=Ys(s);var c={sourceLayerIndex:u,index:l,geometry:f,properties:s.properties,type:s.type,patterns:{}};if(typeof s.id!=="undefined"){c.id=s.id}if(i.hasPattern){i.features.push(Bv("fill",i.layers,c,i.zoom,r))}else{i.addFeature(c,f,l,{})}r.featureIndex.insert(s,f,l,u,i.index)}};Fv.prototype.update=function e(t,r,i){if(!this.stateDependentLayers.length){return}this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,i)};Fv.prototype.addFeatures=function e(t,r){var i=this;for(var n=0,a=i.features;n<a.length;n+=1){var o=a[n];var s=o.geometry;i.addFeature(o,s,o.index,r)}};Fv.prototype.isEmpty=function e(){return this.layoutVertexArray.length===0};Fv.prototype.uploadPending=function e(){return!this.uploaded||this.programConfigurations.needsUpload};Fv.prototype.upload=function e(t){if(!this.uploaded){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Kd);this.indexBuffer=t.createIndexBuffer(this.indexArray);this.indexBuffer2=t.createIndexBuffer(this.indexArray2)}this.programConfigurations.upload(t);this.uploaded=true};Fv.prototype.destroy=function e(){if(!this.layoutVertexBuffer){return}this.layoutVertexBuffer.destroy();this.indexBuffer.destroy();this.indexBuffer2.destroy();this.programConfigurations.destroy();this.segments.destroy();this.segments2.destroy()};Fv.prototype.addFeature=function e(t,r,i,n){var a=this;for(var o=0,s=Ev(r,Rv);o<s.length;o+=1){var l=s[o];var u=0;for(var f=0,c=l;f<c.length;f+=1){var h=c[f];u+=h.length}var p=a.segments.prepareSegment(u,a.layoutVertexArray,a.indexArray);var d=p.vertexLength;var v=[];var y=[];for(var m=0,g=l;m<g.length;m+=1){var _=g[m];if(_.length===0){continue}if(_!==l[0]){y.push(v.length/2)}var x=a.segments2.prepareSegment(_.length,a.layoutVertexArray,a.indexArray2);var b=x.vertexLength;a.layoutVertexArray.emplaceBack(_[0].x,_[0].y);a.indexArray2.emplaceBack(b+_.length-1,b);v.push(_[0].x);v.push(_[0].y);for(var w=1;w<_.length;w++){a.layoutVertexArray.emplaceBack(_[w].x,_[w].y);a.indexArray2.emplaceBack(b+w-1,b+w);v.push(_[w].x);v.push(_[w].y)}x.vertexLength+=_.length;x.primitiveLength+=_.length}var S=Qd(v,y);G(S.length%3===0);for(var C=0;C<S.length;C+=3){a.indexArray.emplaceBack(d+S[C],d+S[C+1],d+S[C+2])}p.vertexLength+=u;p.primitiveLength+=S.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,n)};ja("FillBucket",Fv,{omit:["layers","features"]});var Ov=new Mo({"fill-antialias":new wo(yr["paint_fill"]["fill-antialias"]),"fill-opacity":new So(yr["paint_fill"]["fill-opacity"]),"fill-color":new So(yr["paint_fill"]["fill-color"]),"fill-outline-color":new So(yr["paint_fill"]["fill-outline-color"]),"fill-translate":new wo(yr["paint_fill"]["fill-translate"]),"fill-translate-anchor":new wo(yr["paint_fill"]["fill-translate-anchor"]),"fill-pattern":new Co(yr["paint_fill"]["fill-pattern"])});var zv={paint:Ov};var Uv=function(e){function t(t){e.call(this,t,zv)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.recalculate=function t(r){e.prototype.recalculate.call(this,r);var i=this.paint._values["fill-outline-color"];if(i.value.kind==="constant"&&i.value.value===undefined){this.paint._values["fill-outline-color"]=this.paint._values["fill-color"]}};t.prototype.createBucket=function e(t){return new Fv(t)};t.prototype.queryRadius=function e(){return cl(this.paint.get("fill-translate"))};t.prototype.queryIntersectsFeature=function e(t,r,i,n,a,o,s){var l=hl(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,s);return tl(l,n)};return t}(Ao);var Nv=Ro([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4);var jv=Nv.members;var Vv=Nv.size;var Gv=Nv.alignment;var Zv=500;var qv=Math.pow(2,13);function Hv(e,t,r,i,n,a,o,s){e.emplaceBack(t,r,Math.floor(i*qv)*2+o,n*qv*2,a*qv*2,Math.round(s))}var Wv=function e(t){this.zoom=t.zoom;this.overscaling=t.overscaling;this.layers=t.layers;this.layerIds=this.layers.map(function(e){return e.id});this.index=t.index;this.hasPattern=false;this.layoutVertexArray=new No;this.indexArray=new es;this.programConfigurations=new Vs(jv,t.layers,t.zoom);this.segments=new bs};Wv.prototype.populate=function e(t,r){var i=this;this.features=[];this.hasPattern=Dv("fill-extrusion",this.layers,r);for(var n=0,a=t;n<a.length;n+=1){var o=a[n];var s=o.feature;var l=o.index;var u=o.sourceLayerIndex;if(!i.layers[0]._featureFilter(new ho(i.zoom),s)){continue}var f=Ys(s);var c={sourceLayerIndex:u,index:l,geometry:f,properties:s.properties,type:s.type,patterns:{}};if(typeof s.id!=="undefined"){c.id=s.id}if(i.hasPattern){i.features.push(Bv("fill-extrusion",i.layers,c,i.zoom,r))}else{i.addFeature(c,f,l,{})}r.featureIndex.insert(s,f,l,u,i.index)}};Wv.prototype.addFeatures=function e(t,r){var i=this;for(var n=0,a=i.features;n<a.length;n+=1){var o=a[n];var s=o.geometry;i.addFeature(o,s,o.index,r)}};Wv.prototype.update=function e(t,r,i){if(!this.stateDependentLayers.length){return}this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,i)};Wv.prototype.isEmpty=function e(){return this.layoutVertexArray.length===0};Wv.prototype.uploadPending=function e(){return!this.uploaded||this.programConfigurations.needsUpload};Wv.prototype.upload=function e(t){if(!this.uploaded){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,jv);this.indexBuffer=t.createIndexBuffer(this.indexArray)}this.programConfigurations.upload(t);this.uploaded=true};Wv.prototype.destroy=function e(){if(!this.layoutVertexBuffer){return}this.layoutVertexBuffer.destroy();this.indexBuffer.destroy();this.programConfigurations.destroy();this.segments.destroy()};Wv.prototype.addFeature=function e(t,r,i,n){var a=this;for(var o=0,s=Ev(r,Zv);o<s.length;o+=1){var l=s[o];var u=0;for(var f=0,c=l;f<c.length;f+=1){var h=c[f];u+=h.length}var p=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray);for(var d=0,v=l;d<v.length;d+=1){var y=v[d];if(y.length===0){continue}if(Yv(y)){continue}var m=0;for(var g=0;g<y.length;g++){var _=y[g];if(g>=1){var x=y[g-1];if(!Xv(_,x)){if(p.vertexLength+4>bs.MAX_VERTEX_ARRAY_LENGTH){p=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray)}var b=_.sub(x)._perp()._unit();var w=x.dist(_);if(m+w>32768){m=0}Hv(a.layoutVertexArray,_.x,_.y,b.x,b.y,0,0,m);Hv(a.layoutVertexArray,_.x,_.y,b.x,b.y,0,1,m);m+=w;Hv(a.layoutVertexArray,x.x,x.y,b.x,b.y,0,0,m);Hv(a.layoutVertexArray,x.x,x.y,b.x,b.y,0,1,m);var S=p.vertexLength;a.indexArray.emplaceBack(S,S+2,S+1);a.indexArray.emplaceBack(S+1,S+2,S+3);p.vertexLength+=4;p.primitiveLength+=2}}}}if(p.vertexLength+u>bs.MAX_VERTEX_ARRAY_LENGTH){p=a.segments.prepareSegment(u,a.layoutVertexArray,a.indexArray)}var C=[];var T=[];var P=p.vertexLength;for(var M=0,I=l;M<I.length;M+=1){var A=I[M];if(A.length===0){continue}if(A!==l[0]){T.push(C.length/2)}for(var L=0;L<A.length;L++){var E=A[L];Hv(a.layoutVertexArray,E.x,E.y,0,0,1,1,0);C.push(E.x);C.push(E.y)}}var k=Qd(C,T);G(k.length%3===0);for(var D=0;D<k.length;D+=3){a.indexArray.emplaceBack(P+k[D],P+k[D+2],P+k[D+1])}p.primitiveLength+=k.length/3;p.vertexLength+=u}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,n)};ja("FillExtrusionBucket",Wv,{omit:["layers","features"]});function Xv(e,t){return e.x===t.x&&(e.x<0||e.x>Hs)||e.y===t.y&&(e.y<0||e.y>Hs)}function Yv(e){return e.every(function(e){return e.x<0})||e.every(function(e){return e.x>Hs})||e.every(function(e){return e.y<0})||e.every(function(e){return e.y>Hs})}var Kv=new Mo({"fill-extrusion-opacity":new wo(yr["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new So(yr["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new wo(yr["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new wo(yr["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Co(yr["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new So(yr["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new So(yr["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new wo(yr["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])});var Jv={paint:Kv};var $v=function(e){function t(t){e.call(this,t,Jv)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.createBucket=function e(t){return new Wv(t)};t.prototype.queryRadius=function e(){return cl(this.paint.get("fill-extrusion-translate"))};t.prototype.queryIntersectsFeature=function e(t,r,i,n,a,o,s){var l=hl(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,s);return tl(l,n)};t.prototype.hasOffscreenPass=function e(){return this.paint.get("fill-extrusion-opacity")!==0&&this.visibility!=="none"};t.prototype.resize=function e(){if(this.viewportFrame){this.viewportFrame.destroy();this.viewportFrame=null}};return t}(Ao);var Qv=Ro([{name:"a_pos_normal",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4);var ey=Qv.members;var ty=Qv.size;var ry=Qv.alignment;"use strict";var iy=ny;function ny(e,t,r,i,n){this.properties={};this.extent=r;this.type=0;this._pbf=e;this._geometry=-1;this._keys=i;this._values=n;e.readFields(ay,this,t)}function ay(e,t,r){if(e==1){t.id=r.readVarint()}else if(e==2){oy(r,t)}else if(e==3){t.type=r.readVarint()}else if(e==4){t._geometry=r.pos}}function oy(e,t){var r=e.readVarint()+e.pos;while(e.pos<r){var i=t._keys[e.readVarint()],n=t._values[e.readVarint()];t.properties[i]=n}}ny.types=["Unknown","Point","LineString","Polygon"];ny.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;var t=e.readVarint()+e.pos,r=1,i=0,n=0,a=0,o=[],s;while(e.pos<t){if(i<=0){var l=e.readVarint();r=l&7;i=l>>3}i--;if(r===1||r===2){n+=e.readSVarint();a+=e.readSVarint();if(r===1){if(s){o.push(s)}s=[]}s.push(new se(n,a))}else if(r===7){if(s){s.push(s[0].clone())}}else{throw new Error("unknown command "+r)}}if(s){o.push(s)}return o};ny.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;var t=e.readVarint()+e.pos,r=1,i=0,n=0,a=0,o=Infinity,s=-Infinity,l=Infinity,u=-Infinity;while(e.pos<t){if(i<=0){var f=e.readVarint();r=f&7;i=f>>3}i--;if(r===1||r===2){n+=e.readSVarint();a+=e.readSVarint();if(n<o){o=n}if(n>s){s=n}if(a<l){l=a}if(a>u){u=a}}else if(r!==7){throw new Error("unknown command "+r)}}return[o,l,s,u]};ny.prototype.toGeoJSON=function(e,t,r){var i=this.extent*Math.pow(2,r),n=this.extent*e,a=this.extent*t,o=this.loadGeometry(),s=ny.types[this.type],l,u;function f(e){for(var t=0;t<e.length;t++){var r=e[t],o=180-(r.y+a)*360/i;e[t]=[(r.x+n)*360/i-180,360/Math.PI*Math.atan(Math.exp(o*Math.PI/180))-90]}}switch(this.type){case 1:var c=[];for(l=0;l<o.length;l++){c[l]=o[l][0]}o=c;f(o);break;case 2:for(l=0;l<o.length;l++){f(o[l])}break;case 3:o=sy(o);for(l=0;l<o.length;l++){for(u=0;u<o[l].length;u++){f(o[l][u])}}break}if(o.length===1){o=o[0]}else{s="Multi"+s}var h={type:"Feature",geometry:{type:s,coordinates:o},properties:this.properties};if("id"in this){h.id=this.id}return h};function sy(e){var t=e.length;if(t<=1){return[e]}var r=[],i,n;for(var a=0;a<t;a++){var o=ly(e[a]);if(o===0){continue}if(n===undefined){n=o<0}if(n===o<0){if(i){r.push(i)}i=[e[a]]}else{i.push(e[a])}}if(i){r.push(i)}return r}function ly(e){var t=0;for(var r=0,i=e.length,n=i-1,a,o;r<i;n=r++){a=e[r];o=e[n];t+=(o.x-a.x)*(a.y+o.y)}return t}"use strict";var uy=fy;function fy(e,t){this.version=1;this.name=null;this.extent=4096;this.length=0;this._pbf=e;this._keys=[];this._values=[];this._features=[];e.readFields(cy,this,t);this.length=this._features.length}function cy(e,t,r){if(e===15){t.version=r.readVarint()}else if(e===1){t.name=r.readString()}else if(e===5){t.extent=r.readVarint()}else if(e===2){t._features.push(r.pos)}else if(e===3){t._keys.push(r.readString())}else if(e===4){t._values.push(hy(r))}}function hy(e){var t=null,r=e.readVarint()+e.pos;while(e.pos<r){var i=e.readVarint()>>3;t=i===1?e.readString():i===2?e.readFloat():i===3?e.readDouble():i===4?e.readVarint64():i===5?e.readVarint():i===6?e.readSVarint():i===7?e.readBoolean():null}return t}fy.prototype.feature=function(e){if(e<0||e>=this._features.length){throw new Error("feature index out of bounds")}this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new iy(this._pbf,t,this.extent,this._keys,this._values)};"use strict";var py=dy;function dy(e,t){this.layers=e.readFields(vy,{},t)}function vy(e,t,r){if(e===3){var i=new uy(r,r.readVarint()+r.pos);if(i.length){t[i.name]=i}}}var yy=py;var my=iy;var gy=uy;var _y={VectorTile:yy,VectorTileFeature:my,VectorTileLayer:gy};var xy=_y.VectorTileFeature.types;var by=63;var wy=Math.cos(75/2*(Math.PI/180));var Sy=15;var Cy=15;var Ty=1/2;var Py=Math.pow(2,Cy-1)/Ty;function My(e,t,r,i,n,a,o){e.emplaceBack(t.x,t.y,i?1:0,n?1:-1,Math.round(by*r.x)+128,Math.round(by*r.y)+128,(a===0?0:a<0?-1:1)+1|(o*Ty&63)<<2,o*Ty>>6)}var Iy=function e(t){this.zoom=t.zoom;this.overscaling=t.overscaling;this.layers=t.layers;this.layerIds=this.layers.map(function(e){return e.id});this.index=t.index;this.features=[];this.hasPattern=false;this.layoutVertexArray=new jo;this.indexArray=new es;this.programConfigurations=new Vs(ey,t.layers,t.zoom);this.segments=new bs};Iy.prototype.populate=function e(t,r){var i=this;this.features=[];this.hasPattern=Dv("line",this.layers,r);for(var n=0,a=t;n<a.length;n+=1){var o=a[n];var s=o.feature;var l=o.index;var u=o.sourceLayerIndex;if(!i.layers[0]._featureFilter(new ho(i.zoom),s)){continue}var f=Ys(s);var c={sourceLayerIndex:u,index:l,geometry:f,properties:s.properties,type:s.type,patterns:{}};if(typeof s.id!=="undefined"){c.id=s.id}if(i.hasPattern){i.features.push(Bv("line",i.layers,c,i.zoom,r))}else{i.addFeature(c,f,l,{})}r.featureIndex.insert(s,f,l,u,i.index)}};Iy.prototype.update=function e(t,r,i){if(!this.stateDependentLayers.length){return}this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,i)};Iy.prototype.addFeatures=function e(t,r){var i=this;for(var n=0,a=i.features;n<a.length;n+=1){var o=a[n];var s=o.geometry;i.addFeature(o,s,o.index,r)}};Iy.prototype.isEmpty=function e(){return this.layoutVertexArray.length===0};Iy.prototype.uploadPending=function e(){return!this.uploaded||this.programConfigurations.needsUpload};Iy.prototype.upload=function e(t){if(!this.uploaded){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ey);this.indexBuffer=t.createIndexBuffer(this.indexArray)}this.programConfigurations.upload(t);this.uploaded=true};Iy.prototype.destroy=function e(){if(!this.layoutVertexBuffer){return}this.layoutVertexBuffer.destroy();this.indexBuffer.destroy();this.programConfigurations.destroy();this.segments.destroy()};Iy.prototype.addFeature=function e(t,r,i,n){var a=this;var o=this.layers[0].layout;var s=o.get("line-join").evaluate(t,{});var l=o.get("line-cap");var u=o.get("line-miter-limit");var f=o.get("line-round-limit");for(var c=0,h=r;c<h.length;c+=1){var p=h[c];a.addLine(p,t,s,l,u,f,i,n)}};Iy.prototype.addLine=function e(t,r,i,n,a,o,s,l){var u=this;var f=null;if(!!r.properties&&r.properties.hasOwnProperty("mapbox_clip_start")&&r.properties.hasOwnProperty("mapbox_clip_end")){f={start:r.properties.mapbox_clip_start,end:r.properties.mapbox_clip_end,tileTotal:undefined}}var c=xy[r.type]==="Polygon";var h=t.length;while(h>=2&&t[h-1].equals(t[h-2])){h--}var p=0;while(p<h-1&&t[p].equals(t[p+1])){p++}if(h<(c?3:2)){return}if(f){f.tileTotal=Ly(t,p,h)}if(i==="bevel"){a=1.05}var d=Sy*(Hs/(512*this.overscaling));var v=t[p];var y=this.segments.prepareSegment(h*10,this.layoutVertexArray,this.indexArray);this.distance=0;var m=n,g=c?"butt":n;var _=true;var x;var b=undefined;var w=undefined;var S=undefined;var C=undefined;var T;var P;this.e1=this.e2=this.e3=-1;if(c){x=t[h-2];C=v.sub(x)._unit()._perp()}for(var M=p;M<h;M++){w=c&&M===h-1?t[p+1]:t[M+1];if(w&&t[M].equals(w)){continue}if(C){S=C}if(x){b=x}x=t[M];C=w?w.sub(x)._unit()._perp():S;S=S||C;var I=S.add(C);if(I.x!==0||I.y!==0){I._unit()}var A=I.x*C.x+I.y*C.y;var L=A!==0?1/A:Infinity;var E=A<wy&&b&&w;if(E&&M>p){var k=x.dist(b);if(k>2*d){var D=x.sub(x.sub(b)._mult(d/k)._round());u.distance+=D.dist(b);u.addCurrentVertex(D,u.distance,S.mult(1),0,0,false,y,f);b=D}}var B=b&&w;var R=B?i:w?m:g;if(B&&R==="round"){if(L<o){R="miter"}else if(L<=2){R="fakeround"}}if(R==="miter"&&L>a){R="bevel"}if(R==="bevel"){if(L>2){R="flipbevel"}if(L<a){R="miter"}}if(b){u.distance+=x.dist(b)}if(R==="miter"){I._mult(L);u.addCurrentVertex(x,u.distance,I,0,0,false,y,f)}else if(R==="flipbevel"){if(L>100){I=C.clone().mult(-1)}else{var F=S.x*C.y-S.y*C.x>0?-1:1;var O=L*S.add(C).mag()/S.sub(C).mag();I._perp()._mult(O*F)}u.addCurrentVertex(x,u.distance,I,0,0,false,y,f);u.addCurrentVertex(x,u.distance,I.mult(-1),0,0,false,y,f)}else if(R==="bevel"||R==="fakeround"){var z=S.x*C.y-S.y*C.x>0;var U=-Math.sqrt(L*L-1);if(z){P=0;T=U}else{T=0;P=U}if(!_){u.addCurrentVertex(x,u.distance,S,T,P,false,y,f)}if(R==="fakeround"){var N=Math.floor((.5-(A-.5))*8);var j=void 0;for(var V=0;V<N;V++){j=C.mult((V+1)/(N+1))._add(S)._unit();u.addPieSliceVertex(x,u.distance,j,z,y,f)}u.addPieSliceVertex(x,u.distance,I,z,y,f);for(var G=N-1;G>=0;G--){j=S.mult((G+1)/(N+1))._add(C)._unit();u.addPieSliceVertex(x,u.distance,j,z,y,f)}}if(w){u.addCurrentVertex(x,u.distance,C,-T,-P,false,y,f)}}else if(R==="butt"){if(!_){u.addCurrentVertex(x,u.distance,S,0,0,false,y,f)}if(w){u.addCurrentVertex(x,u.distance,C,0,0,false,y,f)}}else if(R==="square"){if(!_){u.addCurrentVertex(x,u.distance,S,1,1,false,y,f);u.e1=u.e2=-1}if(w){u.addCurrentVertex(x,u.distance,C,-1,-1,false,y,f)}}else if(R==="round"){if(!_){u.addCurrentVertex(x,u.distance,S,0,0,false,y,f);u.addCurrentVertex(x,u.distance,S,1,1,true,y,f);u.e1=u.e2=-1}if(w){u.addCurrentVertex(x,u.distance,C,-1,-1,true,y,f);u.addCurrentVertex(x,u.distance,C,0,0,false,y,f)}}if(E&&M<h-1){var Z=x.dist(w);if(Z>2*d){var q=x.add(w.sub(x)._mult(d/Z)._round());u.distance+=q.dist(x);u.addCurrentVertex(q,u.distance,C.mult(1),0,0,false,y,f);x=q}}_=false}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,s,l)};Iy.prototype.addCurrentVertex=function e(t,r,i,n,a,o,s,l){var u;var f=this.layoutVertexArray;var c=this.indexArray;if(l){r=Ay(r,l)}u=i.clone();if(n){u._sub(i.perp()._mult(n))}My(f,t,u,o,false,n,r);this.e3=s.vertexLength++;if(this.e1>=0&&this.e2>=0){c.emplaceBack(this.e1,this.e2,this.e3);s.primitiveLength++}this.e1=this.e2;this.e2=this.e3;u=i.mult(-1);if(a){u._sub(i.perp()._mult(a))}My(f,t,u,o,true,-a,r);this.e3=s.vertexLength++;if(this.e1>=0&&this.e2>=0){c.emplaceBack(this.e1,this.e2,this.e3);s.primitiveLength++}this.e1=this.e2;this.e2=this.e3;if(r>Py/2&&!l){this.distance=0;this.addCurrentVertex(t,this.distance,i,n,a,o,s)}};Iy.prototype.addPieSliceVertex=function e(t,r,i,n,a,o){i=i.mult(n?-1:1);var s=this.layoutVertexArray;var l=this.indexArray;if(o){r=Ay(r,o)}My(s,t,i,false,n,0,r);this.e3=a.vertexLength++;if(this.e1>=0&&this.e2>=0){l.emplaceBack(this.e1,this.e2,this.e3);a.primitiveLength++}if(n){this.e2=this.e3}else{this.e1=this.e3}};function Ay(e,t){return(e/t.tileTotal*(t.end-t.start)+t.start)*(Py-1)}function Ly(e,t,r){var i,n;var a=0;for(var o=t;o<r-1;o++){i=e[o];n=e[o+1];a+=i.dist(n)}return a}ja("LineBucket",Iy,{omit:["layers","features"]});var Ey=new Mo({"line-cap":new wo(yr["layout_line"]["line-cap"]),"line-join":new So(yr["layout_line"]["line-join"]),"line-miter-limit":new wo(yr["layout_line"]["line-miter-limit"]),"line-round-limit":new wo(yr["layout_line"]["line-round-limit"])});var ky=new Mo({"line-opacity":new So(yr["paint_line"]["line-opacity"]),"line-color":new So(yr["paint_line"]["line-color"]),"line-translate":new wo(yr["paint_line"]["line-translate"]),"line-translate-anchor":new wo(yr["paint_line"]["line-translate-anchor"]),"line-width":new So(yr["paint_line"]["line-width"]),"line-gap-width":new So(yr["paint_line"]["line-gap-width"]),"line-offset":new So(yr["paint_line"]["line-offset"]),"line-blur":new So(yr["paint_line"]["line-blur"]),"line-dasharray":new To(yr["paint_line"]["line-dasharray"]),"line-pattern":new Co(yr["paint_line"]["line-pattern"]),"line-gradient":new Po(yr["paint_line"]["line-gradient"])});var Dy={paint:ky,layout:Ey};var By=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.possiblyEvaluate=function t(r,i){i=new ho(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition});return e.prototype.possiblyEvaluate.call(this,r,i)};t.prototype.evaluate=function t(r,i,n,a){i=ge({},i,{zoom:Math.floor(i.zoom)});return e.prototype.evaluate.call(this,r,i,n,a)};return t}(So);var Ry=new By(Dy.paint.properties["line-width"].specification);Ry.useIntegerZoom=true;var Fy=function(e){function t(t){e.call(this,t,Dy)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype._handleSpecialPaintPropertyUpdate=function e(t){if(t==="line-gradient"){this._updateGradient()}};t.prototype._updateGradient=function e(){var t=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=Zd(t,"lineProgress");this.gradientTexture=null};t.prototype.recalculate=function t(r){e.prototype.recalculate.call(this,r);this.paint._values["line-floorwidth"]=Ry.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)};t.prototype.createBucket=function e(t){return new Iy(t)};t.prototype.queryRadius=function e(t){var r=t;var i=Oy(fl("line-width",this,r),fl("line-gap-width",this,r));var n=fl("line-offset",this,r);return i/2+Math.abs(n)+cl(this.paint.get("line-translate"))};t.prototype.queryIntersectsFeature=function e(t,r,i,n,a,o,s){var l=hl(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,s);var u=s/2*Oy(this.paint.get("line-width").evaluate(r,i),this.paint.get("line-gap-width").evaluate(r,i));var f=this.paint.get("line-offset").evaluate(r,i);if(f){n=zy(n,f*s)}return rl(l,n,u)};return t}(Ao);function Oy(e,t){if(t>0){return t+2*e}else{return e}}function zy(e,t){var r=[];var i=new se(0,0);for(var n=0;n<e.length;n++){var a=e[n];var o=[];for(var s=0;s<a.length;s++){var l=a[s-1];var u=a[s];var f=a[s+1];var c=s===0?i:u.sub(l)._unit()._perp();var h=s===a.length-1?i:f.sub(u)._unit()._perp();var p=c._add(h)._unit();var d=p.x*h.x+p.y*h.y;p._mult(1/d);o.push(p._mult(t)._add(u))}r.push(o)}return r}var Uy=Ro([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]);var Ny=Ro([{name:"a_projected_pos",components:3,type:"Float32"}],4);var jy=Ro([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var Vy=Ro([{name:"a_placed",components:2,type:"Uint8"}],4);var Gy=Ro([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]);var Zy=Ro([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);var qy=Ro([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);var Hy=Ro([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"hidden"}]);var Wy=Ro([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"horizontalPlacedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint32",name:"crossTileID"}]);var Xy=Ro([{type:"Float32",name:"offsetX"}]);var Yy=Ro([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function Ky(e,t,r){var i=t.layout.get("text-transform").evaluate(r,{});if(i==="uppercase"){e=e.toLocaleUpperCase()}else if(i==="lowercase"){e=e.toLocaleLowerCase()}if(co.applyArabicShaping){e=co.applyArabicShaping(e)}return e}function Jy(e,t,r){e.sections.forEach(function(e){e.text=Ky(e.text,t,r)});return e}function $y(e){var t={};var r={};var i=[];var n=0;function a(t){i.push(e[t]);n++}function o(e,t,n){var a=r[e];delete r[e];r[t]=a;i[a].geometry[0].pop();i[a].geometry[0]=i[a].geometry[0].concat(n[0]);return a}function s(e,r,n){var a=t[r];delete t[r];t[e]=a;i[a].geometry[0].shift();i[a].geometry[0]=n[0].concat(i[a].geometry[0]);return a}function l(e,t,r){var i=r?t[0][t[0].length-1]:t[0][0];return e+":"+i.x+":"+i.y}for(var u=0;u<e.length;u++){var f=e[u];var c=f.geometry;var h=f.text?f.text.toString():null;if(!h){a(u);continue}var p=l(h,c),d=l(h,c,true);if(p in r&&d in t&&r[p]!==t[d]){var v=s(p,d,c);var y=o(p,d,i[v].geometry);delete t[p];delete r[d];r[l(h,i[y].geometry,true)]=y;i[v].geometry=null}else if(p in r){o(p,d,c)}else if(d in t){s(p,d,c)}else{a(u);t[p]=n-1;r[d]=n-1}}return i.filter(function(e){return e.geometry})}var Qy={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};function em(e){var t="";for(var r=0;r<e.length;r++){var i=e.charCodeAt(r+1)||null;var n=e.charCodeAt(r-1)||null;var a=(!i||!eo(i)||Qy[e[r+1]])&&(!n||!eo(n)||Qy[e[r-1]]);if(a&&Qy[e[r]]){t+=Qy[e[r]]}else{t+=e[r]}}return t}var tm=function(e){function t(t,r,i,n){e.call(this,t,r);this.angle=i;if(n!==undefined){this.segment=n}}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.clone=function e(){return new t(this.x,this.y,this.angle,this.segment)};return t}(se);ja("Anchor",tm);var rm=256;function im(e,t){var r=t.expression;if(r.kind==="constant"){return{functionType:"constant",layoutSize:r.evaluate(new ho(e+1))}}else if(r.kind==="source"){return{functionType:"source"}}else{var i=r.zoomStops;var n=0;while(n<i.length&&i[n]<=e){n++}n=Math.max(0,n-1);var a=n;while(a<i.length&&i[a]<e+1){a++}a=Math.min(i.length-1,a);var o={min:i[n],max:i[a]};if(r.kind==="composite"){return{functionType:"composite",zoomRange:o,propertyValue:t.value}}else{return{functionType:"camera",layoutSize:r.evaluate(new ho(e+1)),zoomRange:o,sizeRange:{min:r.evaluate(new ho(o.min)),max:r.evaluate(new ho(o.max))},propertyValue:t.value}}}}function nm(e,t,r){var i=t;if(e.functionType==="source"){return r.lowerSize/rm}else if(e.functionType==="composite"){return di(r.lowerSize/rm,r.upperSize/rm,i.uSizeT)}else{return i.uSize}}function am(e,t,r){if(e.functionType==="constant"){return{uSizeT:0,uSize:e.layoutSize}}else if(e.functionType==="source"){return{uSizeT:0,uSize:0}}else if(e.functionType==="camera"){var i=e.propertyValue;var n=e.zoomRange;var a=e.sizeRange;var o=qn(i,r.specification);var s=pe(o.interpolationFactor(t,n.min,n.max),0,1);return{uSizeT:0,uSize:a.min+s*(a.max-a.min)}}else{var l=e.propertyValue;var u=e.zoomRange;var f=qn(l,r.specification);return{uSizeT:pe(f.interpolationFactor(t,u.min,u.max),0,1),uSize:0}}}var om=_y.VectorTileFeature.types;var sm=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function lm(e,t,r,i,n,a,o,s){e.emplaceBack(t,r,Math.round(i*32),Math.round(n*32),a,o,s?s[0]:0,s?s[1]:0)}function um(e,t,r){e.emplaceBack(t.x,t.y,r);e.emplaceBack(t.x,t.y,r);e.emplaceBack(t.x,t.y,r);e.emplaceBack(t.x,t.y,r)}var fm=function e(t){this.layoutVertexArray=new Go;this.indexArray=new es;this.programConfigurations=t;this.segments=new bs;this.dynamicLayoutVertexArray=new Zo;this.opacityVertexArray=new qo;this.placedSymbolArray=new ls};fm.prototype.upload=function e(t,r,i,n){if(i){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Uy.members);this.indexBuffer=t.createIndexBuffer(this.indexArray,r);this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Ny.members,true);this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,sm,true);this.opacityVertexBuffer.itemSize=1}if(i||n){this.programConfigurations.upload(t)}};fm.prototype.destroy=function e(){if(!this.layoutVertexBuffer){return}this.layoutVertexBuffer.destroy();this.indexBuffer.destroy();this.programConfigurations.destroy();this.segments.destroy();this.dynamicLayoutVertexBuffer.destroy();this.opacityVertexBuffer.destroy()};ja("SymbolBuffers",fm);var cm=function e(t,r,i){this.layoutVertexArray=new t;this.layoutAttributes=r;this.indexArray=new i;this.segments=new bs;this.collisionVertexArray=new Xo};cm.prototype.upload=function e(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes);this.indexBuffer=t.createIndexBuffer(this.indexArray);this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Vy.members,true)};cm.prototype.destroy=function e(){if(!this.layoutVertexBuffer){return}this.layoutVertexBuffer.destroy();this.indexBuffer.destroy();this.segments.destroy();this.collisionVertexBuffer.destroy()};ja("CollisionBuffers",cm);var hm=function e(t){this.collisionBoxArray=t.collisionBoxArray;this.zoom=t.zoom;this.overscaling=t.overscaling;this.layers=t.layers;this.layerIds=this.layers.map(function(e){return e.id});this.index=t.index;this.pixelRatio=t.pixelRatio;this.sourceLayerIndex=t.sourceLayerIndex;this.hasPattern=false;var r=this.layers[0];var i=r._unevaluatedLayout._values;this.textSizeData=im(this.zoom,i["text-size"]);this.iconSizeData=im(this.zoom,i["icon-size"]);var n=this.layers[0].layout;var a=n.get("symbol-z-order")==="viewport-y";this.sortFeaturesByY=a&&(n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"));this.sourceID=t.sourceID};hm.prototype.createArrays=function e(){this.text=new fm(new Vs(Uy.members,this.layers,this.zoom,function(e){return/^text/.test(e)}));this.icon=new fm(new Vs(Uy.members,this.layers,this.zoom,function(e){return/^icon/.test(e)}));this.collisionBox=new cm(Wo,Zy.members,ts);this.collisionCircle=new cm(Wo,qy.members,es);this.glyphOffsetArray=new hs;this.lineVertexArray=new ds;this.symbolInstances=new fs};hm.prototype.calculateGlyphDependencies=function e(t,r,i,n){for(var a=0;a<t.length;a++){r[t.charCodeAt(a)]=true;if(i&&n){var o=Qy[t.charAt(a)];if(o){r[o.charCodeAt(0)]=true}}}};hm.prototype.populate=function e(t,r){var i=this;var n=this.layers[0];var a=n.layout;var o=a.get("text-font");var s=a.get("text-field");var l=a.get("icon-image");var u=(s.value.kind!=="constant"||s.value.value.toString().length>0)&&(o.value.kind!=="constant"||o.value.value.length>0);var f=l.value.kind!=="constant"||l.value.value&&l.value.value.length>0;this.features=[];if(!u&&!f){return}var c=r.iconDependencies;var h=r.glyphDependencies;var p=new ho(this.zoom);for(var d=0,v=t;d<v.length;d+=1){var y=v[d];var m=y.feature;var g=y.index;var _=y.sourceLayerIndex;if(!n._featureFilter(p,m)){continue}var x=void 0;if(u){var b=n.getValueAndResolveTokens("text-field",m);x=Jy(b instanceof Gr?b:Gr.fromString(b),n,m)}var w=void 0;if(f){w=n.getValueAndResolveTokens("icon-image",m)}if(!x&&!w){continue}var S={text:x,icon:w,index:g,sourceLayerIndex:_,geometry:Ys(m),properties:m.properties,type:om[m.type]};if(typeof m.id!=="undefined"){S.id=m.id}i.features.push(S);if(w){c[w]=true}if(x){var C=o.evaluate(m,{}).join(",");var T=a.get("text-rotation-alignment")==="map"&&a.get("symbol-placement")!=="point";for(var P=0,M=x.sections;P<M.length;P+=1){var I=M[P];var A=Xa(x.toString());var L=I.fontStack||C;var E=h[L]=h[L]||{};i.calculateGlyphDependencies(I.text,E,T,A)}}}if(a.get("symbol-placement")==="line"){this.features=$y(this.features)}};hm.prototype.update=function e(t,r,i){if(!this.stateDependentLayers.length){return}this.text.programConfigurations.updatePaintArrays(t,r,this.layers,i);this.icon.programConfigurations.updatePaintArrays(t,r,this.layers,i)};hm.prototype.isEmpty=function e(){return this.symbolInstances.length===0};hm.prototype.uploadPending=function e(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload};hm.prototype.upload=function e(t){if(!this.uploaded){this.collisionBox.upload(t);this.collisionCircle.upload(t)}this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload);this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload);this.uploaded=true};hm.prototype.destroy=function e(){this.text.destroy();this.icon.destroy();this.collisionBox.destroy();this.collisionCircle.destroy()};hm.prototype.addToLineVertexArray=function e(t,r){var i=this;var n=this.lineVertexArray.length;if(t.segment!==undefined){var a=t.dist(r[t.segment+1]);var o=t.dist(r[t.segment]);var s={};for(var l=t.segment+1;l<r.length;l++){s[l]={x:r[l].x,y:r[l].y,tileUnitDistanceFromAnchor:a};if(l<r.length-1){a+=r[l+1].dist(r[l])}}for(var u=t.segment||0;u>=0;u--){s[u]={x:r[u].x,y:r[u].y,tileUnitDistanceFromAnchor:o};if(u>0){o+=r[u-1].dist(r[u])}}for(var f=0;f<r.length;f++){var c=s[f];i.lineVertexArray.emplaceBack(c.x,c.y,c.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}};hm.prototype.addSymbols=function e(t,r,i,n,a,o,s,l,u,f){var c=this;var h=t.indexArray;var p=t.layoutVertexArray;var d=t.dynamicLayoutVertexArray;var v=t.segments.prepareSegment(4*r.length,t.layoutVertexArray,t.indexArray);var y=this.glyphOffsetArray.length;var m=v.vertexLength;for(var g=0,_=r;g<_.length;g+=1){var x=_[g];var b=x.tl,w=x.tr,S=x.bl,C=x.br,T=x.tex;var P=v.vertexLength;var M=x.glyphOffset[1];lm(p,l.x,l.y,b.x,M+b.y,T.x,T.y,i);lm(p,l.x,l.y,w.x,M+w.y,T.x+T.w,T.y,i);lm(p,l.x,l.y,S.x,M+S.y,T.x,T.y+T.h,i);lm(p,l.x,l.y,C.x,M+C.y,T.x+T.w,T.y+T.h,i);um(d,l,0);h.emplaceBack(P,P+1,P+2);h.emplaceBack(P+1,P+2,P+3);v.vertexLength+=4;v.primitiveLength+=2;c.glyphOffsetArray.emplaceBack(x.glyphOffset[0])}t.placedSymbolArray.emplaceBack(l.x,l.y,y,this.glyphOffsetArray.length-y,m,u,f,l.segment,i?i[0]:0,i?i[1]:0,n[0],n[1],s,false);t.programConfigurations.populatePaintArrays(t.layoutVertexArray.length,o,o.index,{})};hm.prototype._addCollisionDebugVertex=function e(t,r,i,n,a,o){r.emplaceBack(0,0);return t.emplaceBack(i.x,i.y,n,a,Math.round(o.x),Math.round(o.y))};hm.prototype.addCollisionDebugVertices=function e(t,r,i,n,a,o,s,l){var u=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray);var f=u.vertexLength;var c=a.layoutVertexArray;var h=a.collisionVertexArray;var p=s.anchorX;var d=s.anchorY;this._addCollisionDebugVertex(c,h,o,p,d,new se(t,r));this._addCollisionDebugVertex(c,h,o,p,d,new se(i,r));this._addCollisionDebugVertex(c,h,o,p,d,new se(i,n));this._addCollisionDebugVertex(c,h,o,p,d,new se(t,n));u.vertexLength+=4;if(l){var v=a.indexArray;v.emplaceBack(f,f+1,f+2);v.emplaceBack(f,f+2,f+3);u.primitiveLength+=2}else{var y=a.indexArray;y.emplaceBack(f,f+1);y.emplaceBack(f+1,f+2);y.emplaceBack(f+2,f+3);y.emplaceBack(f+3,f);u.primitiveLength+=4}};hm.prototype.addDebugCollisionBoxes=function e(t,r,i){var n=this;for(var a=t;a<r;a++){var o=n.collisionBoxArray.get(a);var s=o.x1;var l=o.y1;var u=o.x2;var f=o.y2;var c=o.radius>0;n.addCollisionDebugVertices(s,l,u,f,c?n.collisionCircle:n.collisionBox,o.anchorPoint,i,c)}};hm.prototype.generateCollisionDebugBuffers=function e(){var t=this;for(var r=0;r<this.symbolInstances.length;r++){var i=t.symbolInstances.get(r);t.addDebugCollisionBoxes(i.textBoxStartIndex,i.textBoxEndIndex,i);t.addDebugCollisionBoxes(i.iconBoxStartIndex,i.iconBoxEndIndex,i)}};hm.prototype._deserializeCollisionBoxesForSymbol=function e(t,r,i,n,a){var o={};for(var s=r;s<i;s++){var l=t.get(s);if(l.radius===0){o.textBox={x1:l.x1,y1:l.y1,x2:l.x2,y2:l.y2,anchorPointX:l.anchorPointX,anchorPointY:l.anchorPointY};o.textFeatureIndex=l.featureIndex;break}else{if(!o.textCircles){o.textCircles=[];o.textFeatureIndex=l.featureIndex}var u=1;o.textCircles.push(l.anchorPointX,l.anchorPointY,l.radius,l.signedDistanceFromAnchor,u)}}for(var f=n;f<a;f++){var c=t.get(f);if(c.radius===0){o.iconBox={x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2,anchorPointX:c.anchorPointX,anchorPointY:c.anchorPointY};o.iconFeatureIndex=c.featureIndex;break}}return o};hm.prototype.deserializeCollisionBoxes=function e(t){var r=this;this.collisionArrays=[];for(var i=0;i<this.symbolInstances.length;i++){var n=r.symbolInstances.get(i);r.collisionArrays.push(r._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex))}};hm.prototype.hasTextData=function e(){return this.text.segments.get().length>0};hm.prototype.hasIconData=function e(){return this.icon.segments.get().length>0};hm.prototype.hasCollisionBoxData=function e(){return this.collisionBox.segments.get().length>0};hm.prototype.hasCollisionCircleData=function e(){return this.collisionCircle.segments.get().length>0};hm.prototype.addIndicesForPlacedTextSymbol=function e(t){var r=this;var i=this.text.placedSymbolArray.get(t);var n=i.vertexStartIndex+i.numGlyphs*4;for(var a=i.vertexStartIndex;a<n;a+=4){r.text.indexArray.emplaceBack(a,a+1,a+2);r.text.indexArray.emplaceBack(a+1,a+2,a+3)}};hm.prototype.sortFeatures=function e(t){var r=this;if(!this.sortFeaturesByY){return}if(this.sortedAngle===t){return}this.sortedAngle=t;if(this.text.segments.get().length>1||this.icon.segments.get().length>1){return}var i=[];for(var n=0;n<this.symbolInstances.length;n++){i.push(n)}var a=Math.sin(t),o=Math.cos(t);var s=[];var l=[];for(var u=0;u<this.symbolInstances.length;u++){var f=r.symbolInstances.get(u);s.push(Math.round(a*f.anchorX+o*f.anchorY)|0);l.push(f.featureIndex)}i.sort(function(e,t){return s[e]-s[t]||l[t]-l[e]});this.text.indexArray.clear();this.icon.indexArray.clear();this.featureSortOrder=[];for(var c=0,h=i;c<h.length;c+=1){var p=h[c];var d=r.symbolInstances.get(p);r.featureSortOrder.push(d.featureIndex);if(d.horizontalPlacedTextSymbolIndex>=0){r.addIndicesForPlacedTextSymbol(d.horizontalPlacedTextSymbolIndex)}if(d.verticalPlacedTextSymbolIndex>=0){r.addIndicesForPlacedTextSymbol(d.verticalPlacedTextSymbolIndex)}var v=r.icon.placedSymbolArray.get(p);if(v.numGlyphs){var y=v.vertexStartIndex;r.icon.indexArray.emplaceBack(y,y+1,y+2);r.icon.indexArray.emplaceBack(y+1,y+2,y+3)}}if(this.text.indexBuffer){this.text.indexBuffer.updateData(this.text.indexArray)}if(this.icon.indexBuffer){this.icon.indexBuffer.updateData(this.icon.indexArray)}};ja("SymbolBucket",hm,{omit:["layers","collisionBoxArray","features","compareText"]});hm.MAX_GLYPHS=65535;hm.addDynamicAttributes=um;function pm(e,t){return t.replace(/{([^{}]+)}/g,function(t,r){return r in e?String(e[r]):""})}var dm=new Mo({"symbol-placement":new wo(yr["layout_symbol"]["symbol-placement"]),"symbol-spacing":new wo(yr["layout_symbol"]["symbol-spacing"]),"symbol-avoid-edges":new wo(yr["layout_symbol"]["symbol-avoid-edges"]),"symbol-z-order":new wo(yr["layout_symbol"]["symbol-z-order"]),"icon-allow-overlap":new wo(yr["layout_symbol"]["icon-allow-overlap"]),"icon-ignore-placement":new wo(yr["layout_symbol"]["icon-ignore-placement"]),"icon-optional":new wo(yr["layout_symbol"]["icon-optional"]),"icon-rotation-alignment":new wo(yr["layout_symbol"]["icon-rotation-alignment"]),"icon-size":new So(yr["layout_symbol"]["icon-size"]),"icon-text-fit":new wo(yr["layout_symbol"]["icon-text-fit"]),"icon-text-fit-padding":new wo(yr["layout_symbol"]["icon-text-fit-padding"]),"icon-image":new So(yr["layout_symbol"]["icon-image"]),"icon-rotate":new So(yr["layout_symbol"]["icon-rotate"]),"icon-padding":new wo(yr["layout_symbol"]["icon-padding"]),"icon-keep-upright":new wo(yr["layout_symbol"]["icon-keep-upright"]),"icon-offset":new So(yr["layout_symbol"]["icon-offset"]),"icon-anchor":new So(yr["layout_symbol"]["icon-anchor"]),"icon-pitch-alignment":new wo(yr["layout_symbol"]["icon-pitch-alignment"]),"text-pitch-alignment":new wo(yr["layout_symbol"]["text-pitch-alignment"]),"text-rotation-alignment":new wo(yr["layout_symbol"]["text-rotation-alignment"]),"text-field":new So(yr["layout_symbol"]["text-field"]),"text-font":new So(yr["layout_symbol"]["text-font"]),"text-size":new So(yr["layout_symbol"]["text-size"]),"text-max-width":new So(yr["layout_symbol"]["text-max-width"]),"text-line-height":new wo(yr["layout_symbol"]["text-line-height"]),"text-letter-spacing":new So(yr["layout_symbol"]["text-letter-spacing"]),"text-justify":new So(yr["layout_symbol"]["text-justify"]),"text-anchor":new So(yr["layout_symbol"]["text-anchor"]),"text-max-angle":new wo(yr["layout_symbol"]["text-max-angle"]),"text-rotate":new So(yr["layout_symbol"]["text-rotate"]),"text-padding":new wo(yr["layout_symbol"]["text-padding"]),"text-keep-upright":new wo(yr["layout_symbol"]["text-keep-upright"]),"text-transform":new So(yr["layout_symbol"]["text-transform"]),"text-offset":new So(yr["layout_symbol"]["text-offset"]),"text-allow-overlap":new wo(yr["layout_symbol"]["text-allow-overlap"]),"text-ignore-placement":new wo(yr["layout_symbol"]["text-ignore-placement"]),"text-optional":new wo(yr["layout_symbol"]["text-optional"])});var vm=new Mo({"icon-opacity":new So(yr["paint_symbol"]["icon-opacity"]),"icon-color":new So(yr["paint_symbol"]["icon-color"]),"icon-halo-color":new So(yr["paint_symbol"]["icon-halo-color"]),"icon-halo-width":new So(yr["paint_symbol"]["icon-halo-width"]),"icon-halo-blur":new So(yr["paint_symbol"]["icon-halo-blur"]),"icon-translate":new wo(yr["paint_symbol"]["icon-translate"]),"icon-translate-anchor":new wo(yr["paint_symbol"]["icon-translate-anchor"]),"text-opacity":new So(yr["paint_symbol"]["text-opacity"]),"text-color":new So(yr["paint_symbol"]["text-color"]),"text-halo-color":new So(yr["paint_symbol"]["text-halo-color"]),"text-halo-width":new So(yr["paint_symbol"]["text-halo-width"]),"text-halo-blur":new So(yr["paint_symbol"]["text-halo-blur"]),"text-translate":new wo(yr["paint_symbol"]["text-translate"]),"text-translate-anchor":new wo(yr["paint_symbol"]["text-translate-anchor"])});var ym={paint:vm,layout:dm};var mm=function(e){function t(t){e.call(this,t,ym)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.recalculate=function t(r){e.prototype.recalculate.call(this,r);if(this.layout.get("icon-rotation-alignment")==="auto"){if(this.layout.get("symbol-placement")!=="point"){this.layout._values["icon-rotation-alignment"]="map"}else{this.layout._values["icon-rotation-alignment"]="viewport"}}if(this.layout.get("text-rotation-alignment")==="auto"){if(this.layout.get("symbol-placement")!=="point"){this.layout._values["text-rotation-alignment"]="map"}else{this.layout._values["text-rotation-alignment"]="viewport"}}if(this.layout.get("text-pitch-alignment")==="auto"){this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")}if(this.layout.get("icon-pitch-alignment")==="auto"){this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")}};t.prototype.getValueAndResolveTokens=function e(t,r){var i=this.layout.get(t).evaluate(r,{});var n=this._unevaluatedLayout._values[t];if(!n.isDataDriven()&&!Un(n.value)){return pm(r.properties,i)}return i};t.prototype.createBucket=function e(t){return new hm(t)};t.prototype.queryRadius=function e(){return 0};t.prototype.queryIntersectsFeature=function e(){G(false);return false};return t}(Ao);var gm=new Mo({"background-color":new wo(yr["paint_background"]["background-color"]),"background-pattern":new To(yr["paint_background"]["background-pattern"]),"background-opacity":new wo(yr["paint_background"]["background-opacity"])});var _m={paint:gm};var xm=function(e){function t(t){e.call(this,t,_m)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;return t}(Ao);var bm=new Mo({"raster-opacity":new wo(yr["paint_raster"]["raster-opacity"]),"raster-hue-rotate":new wo(yr["paint_raster"]["raster-hue-rotate"]),"raster-brightness-min":new wo(yr["paint_raster"]["raster-brightness-min"]),"raster-brightness-max":new wo(yr["paint_raster"]["raster-brightness-max"]),"raster-saturation":new wo(yr["paint_raster"]["raster-saturation"]),"raster-contrast":new wo(yr["paint_raster"]["raster-contrast"]),"raster-resampling":new wo(yr["paint_raster"]["raster-resampling"]),"raster-fade-duration":new wo(yr["paint_raster"]["raster-fade-duration"])});var wm={paint:bm};var Sm=function(e){function t(t){e.call(this,t,wm)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;return t}(Ao);function Cm(e){var t=[];var r=e.id;if(r===undefined){t.push({message:"layers."+r+': missing required property "id"'})}if(e.render===undefined){t.push({message:"layers."+r+': missing required method "render"'})}if(e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"){t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'})}return t}var Tm=function(e){function t(t){e.call(this,t,{});this.implementation=t}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.hasOffscreenPass=function e(){return this.implementation.prerender!==undefined||this.implementation.renderingMode==="3d"};t.prototype.recalculate=function e(){};t.prototype.updateTransitions=function e(){};t.prototype.hasTransition=function e(){};t.prototype.serialize=function e(){G(false,"Custom layers cannot be serialized")};t.prototype.resize=function e(){if(this.viewportFrame){this.viewportFrame.destroy();this.viewportFrame=null}};t.prototype.onAdd=function e(t){if(this.implementation.onAdd){this.implementation.onAdd(t,t.painter.context.gl)}};t.prototype.onRemove=function e(t){if(this.implementation.onRemove){this.implementation.onRemove(t)}};return t}(Ao);var Pm={circle:Dd,heatmap:qd,hillshade:Xd,fill:Uv,"fill-extrusion":$v,line:Fy,symbol:mm,background:xm,raster:Sm};function Mm(e){if(e.type==="custom"){return new Tm(e)}else{return new Pm[e.type](e)}}function Im(e){var t=0;var r=0;for(var i=0,n=e;i<n.length;i+=1){var a=n[i];t+=a.w*a.h;r=Math.max(r,a.w)}e.sort(function(e,t){return t.h-e.h});var o=Math.max(Math.ceil(Math.sqrt(t/.95)),r);var s=[{x:0,y:0,w:o,h:Infinity}];var l=0;var u=0;for(var f=0,c=e;f<c.length;f+=1){var h=c[f];for(var p=s.length-1;p>=0;p--){var d=s[p];if(h.w>d.w||h.h>d.h){continue}h.x=d.x;h.y=d.y;u=Math.max(u,h.y+h.h);l=Math.max(l,h.x+h.w);if(h.w===d.w&&h.h===d.h){var v=s.pop();if(p<s.length){s[p]=v}}else if(h.h===d.h){d.x+=h.w;d.w-=h.w}else if(h.w===d.w){d.y+=h.h;d.h-=h.h}else{s.push({x:d.x+h.w,y:d.y,w:d.w-h.w,h:h.h});d.y+=h.h;d.h-=h.h}break}}return{w:l,h:u,fill:t/(l*u)||0}}var Am=1;var Lm=function e(t,r){var i=r.pixelRatio;this.paddedRect=t;this.pixelRatio=i};var Em={tl:{configurable:true},br:{configurable:true},tlbr:{configurable:true},displaySize:{configurable:true}};Em.tl.get=function(){return[this.paddedRect.x+Am,this.paddedRect.y+Am]};Em.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-Am,this.paddedRect.y+this.paddedRect.h-Am]};Em.tlbr.get=function(){return this.tl.concat(this.br)};Em.displaySize.get=function(){return[(this.paddedRect.w-Am*2)/this.pixelRatio,(this.paddedRect.h-Am*2)/this.pixelRatio]};(0,x.default)(Lm.prototype,Em);var km=function e(t,r){var i={},n={};var a=[];for(var o in t){var s=t[o];var l={x:0,y:0,w:s.data.width+2*Am,h:s.data.height+2*Am};a.push(l);i[o]=new Lm(l,s)}for(var u in r){var f=r[u];var c={x:0,y:0,w:f.data.width+2*Am,h:f.data.height+2*Am};a.push(c);n[u]=new Lm(c,f)}var h=Im(a);var p=h.w;var d=h.h;var v=new jd({width:p||1,height:d||1});for(var y in t){var m=t[y];var g=i[y].paddedRect;jd.copy(m.data,v,{x:0,y:0},{x:g.x+Am,y:g.y+Am},m.data)}for(var _ in r){var x=r[_];var b=n[_].paddedRect;var w=b.x+Am,S=b.y+Am,C=x.data.width,T=x.data.height;jd.copy(x.data,v,{x:0,y:0},{x:w,y:S},x.data);jd.copy(x.data,v,{x:0,y:T-1},{x:w,y:S-1},{width:C,height:1});jd.copy(x.data,v,{x:0,y:0},{x:w,y:S+T},{width:C,height:1});jd.copy(x.data,v,{x:C-1,y:0},{x:w-1,y:S},{width:1,height:T});jd.copy(x.data,v,{x:0,y:0},{x:w+C,y:S},{width:1,height:T})}this.image=v;this.iconPositions=i;this.patternPositions=n};ja("ImagePosition",Lm);ja("ImageAtlas",km);var Dm=self.HTMLImageElement;var Bm=self.HTMLCanvasElement;var Rm=self.HTMLVideoElement;var Fm=self.ImageData;var Om=function e(t,r,i,n){this.context=t;this.format=i;this.texture=t.gl.createTexture();this.update(r,n)};Om.prototype.update=function e(t,r){var i=t.width;var n=t.height;var a=!this.size||this.size[0]!==i||this.size[1]!==n;var o=this;var s=o.context;var l=s.gl;this.useMipmap=Boolean(r&&r.useMipmap);l.bindTexture(l.TEXTURE_2D,this.texture);s.pixelStoreUnpackFlipY.set(false);s.pixelStoreUnpack.set(1);s.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!r||r.premultiply!==false));if(a){this.size=[i,n];if(t instanceof Dm||t instanceof Bm||t instanceof Rm||t instanceof Fm){l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,t)}else{l.texImage2D(l.TEXTURE_2D,0,this.format,i,n,0,this.format,l.UNSIGNED_BYTE,t.data)}}else{if(t instanceof Dm||t instanceof Bm||t instanceof Rm||t instanceof Fm){l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,t)}else{l.texSubImage2D(l.TEXTURE_2D,0,0,0,i,n,l.RGBA,l.UNSIGNED_BYTE,t.data)}}if(this.useMipmap&&this.isSizePowerOfTwo()){l.generateMipmap(l.TEXTURE_2D)}};Om.prototype.bind=function e(t,r,i){var n=this;var a=n.context;var o=a.gl;o.bindTexture(o.TEXTURE_2D,this.texture);if(i===o.LINEAR_MIPMAP_NEAREST&&!this.isSizePowerOfTwo()){i=o.LINEAR}if(t!==this.filter){o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,t);o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,i||t);this.filter=t}if(r!==this.wrap){o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,r);o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,r);this.wrap=r}};Om.prototype.isSizePowerOfTwo=function e(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1===0};Om.prototype.destroy=function e(){var t=this.context;var r=t.gl;r.deleteTexture(this.texture);this.texture=null};var zm=function e(t,r,i,n,a){var o,s;var l=a*8-n-1;var u=(1<<l)-1;var f=u>>1;var c=-7;var h=i?a-1:0;var p=i?-1:1;var d=t[r+h];h+=p;o=d&(1<<-c)-1;d>>=-c;c+=l;for(;c>0;o=o*256+t[r+h],h+=p,c-=8){}s=o&(1<<-c)-1;o>>=-c;c+=n;for(;c>0;s=s*256+t[r+h],h+=p,c-=8){}if(o===0){o=1-f}else if(o===u){return s?NaN:(d?-1:1)*Infinity}else{s=s+Math.pow(2,n);o=o-f}return(d?-1:1)*s*Math.pow(2,o-n)};var Um=function e(t,r,i,n,a,o){var s,l,u;var f=o*8-a-1;var c=(1<<f)-1;var h=c>>1;var p=a===23?Math.pow(2,-24)-Math.pow(2,-77):0;var d=n?0:o-1;var v=n?1:-1;var y=r<0||r===0&&1/r<0?1:0;r=Math.abs(r);if(isNaN(r)||r===Infinity){l=isNaN(r)?1:0;s=c}else{s=Math.floor(Math.log(r)/Math.LN2);if(r*(u=Math.pow(2,-s))<1){s--;u*=2}if(s+h>=1){r+=p/u}else{r+=p*Math.pow(2,1-h)}if(r*u>=2){s++;u/=2}if(s+h>=c){l=0;s=c}else if(s+h>=1){l=(r*u-1)*Math.pow(2,a);s=s+h}else{l=r*Math.pow(2,h-1)*Math.pow(2,a);s=0}}for(;a>=8;t[i+d]=l&255,d+=v,l/=256,a-=8){}s=s<<a|l;f+=a;for(;f>0;t[i+d]=s&255,d+=v,s/=256,f-=8){}t[i+d-v]|=y*128};var Nm={read:zm,write:Um};"use strict";var jm=Vm;function Vm(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0);this.pos=0;this.type=0;this.length=this.buf.length}Vm.Varint=0;Vm.Fixed64=1;Vm.Bytes=2;Vm.Fixed32=5;var Gm=(1<<16)*(1<<16),Zm=1/Gm;Vm.prototype={destroy:function e(){this.buf=null},readFields:function e(t,r,i){var n=this;i=i||this.length;while(this.pos<i){var a=n.readVarint(),o=a>>3,s=n.pos;n.type=a&7;t(o,r,n);if(n.pos===s){n.skip(a)}}return r},readMessage:function e(t,r){return this.readFields(t,r,this.readVarint()+this.pos)},readFixed32:function e(){var t=sg(this.buf,this.pos);this.pos+=4;return t},readSFixed32:function e(){var t=ug(this.buf,this.pos);this.pos+=4;return t},readFixed64:function e(){var t=sg(this.buf,this.pos)+sg(this.buf,this.pos+4)*Gm;this.pos+=8;return t},readSFixed64:function e(){var t=sg(this.buf,this.pos)+ug(this.buf,this.pos+4)*Gm;this.pos+=8;return t},readFloat:function e(){var t=Nm.read(this.buf,this.pos,true,23,4);this.pos+=4;return t},readDouble:function e(){var t=Nm.read(this.buf,this.pos,true,52,8);this.pos+=8;return t},readVarint:function e(t){var r=this.buf,i,n;n=r[this.pos++];i=n&127;if(n<128){return i}n=r[this.pos++];i|=(n&127)<<7;if(n<128){return i}n=r[this.pos++];i|=(n&127)<<14;if(n<128){return i}n=r[this.pos++];i|=(n&127)<<21;if(n<128){return i}n=r[this.pos];i|=(n&15)<<28;return qm(i,t,this)},readVarint64:function e(){return this.readVarint(true)},readSVarint:function e(){var t=this.readVarint();return t%2===1?(t+1)/-2:t/2},readBoolean:function e(){return Boolean(this.readVarint())},readString:function e(){var t=this.readVarint()+this.pos,r=fg(this.buf,this.pos,t);this.pos=t;return r},readBytes:function e(){var t=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,t);this.pos=t;return r},readPackedVarint:function e(t,r){var i=this;var n=Hm(this);t=t||[];while(this.pos<n){t.push(i.readVarint(r))}return t},readPackedSVarint:function e(t){var r=this;var i=Hm(this);t=t||[];while(this.pos<i){t.push(r.readSVarint())}return t},readPackedBoolean:function e(t){var r=this;var i=Hm(this);t=t||[];while(this.pos<i){t.push(r.readBoolean())}return t},readPackedFloat:function e(t){var r=this;var i=Hm(this);t=t||[];while(this.pos<i){t.push(r.readFloat())}return t},readPackedDouble:function e(t){var r=this;var i=Hm(this);t=t||[];while(this.pos<i){t.push(r.readDouble())}return t},readPackedFixed32:function e(t){var r=this;var i=Hm(this);t=t||[];while(this.pos<i){t.push(r.readFixed32())}return t},readPackedSFixed32:function e(t){var r=this;var i=Hm(this);t=t||[];while(this.pos<i){t.push(r.readSFixed32())}return t},readPackedFixed64:function e(t){var r=this;var i=Hm(this);t=t||[];while(this.pos<i){t.push(r.readFixed64())}return t},readPackedSFixed64:function e(t){var r=this;var i=Hm(this);t=t||[];while(this.pos<i){t.push(r.readSFixed64())}return t},skip:function e(t){var r=t&7;if(r===Vm.Varint){while(this.buf[this.pos++]>127){}}else if(r===Vm.Bytes){this.pos=this.readVarint()+this.pos}else if(r===Vm.Fixed32){this.pos+=4}else if(r===Vm.Fixed64){this.pos+=8}else{throw new Error("Unimplemented type: "+r)}},writeTag:function e(t,r){this.writeVarint(t<<3|r)},realloc:function e(t){var r=this.length||16;while(r<this.pos+t){r*=2}if(r!==this.length){var i=new Uint8Array(r);i.set(this.buf);this.buf=i;this.length=r}},finish:function e(){this.length=this.pos;this.pos=0;return this.buf.subarray(0,this.length)},writeFixed32:function e(t){this.realloc(4);lg(this.buf,t,this.pos);this.pos+=4},writeSFixed32:function e(t){this.realloc(4);lg(this.buf,t,this.pos);this.pos+=4},writeFixed64:function e(t){this.realloc(8);lg(this.buf,t&-1,this.pos);lg(this.buf,Math.floor(t*Zm),this.pos+4);this.pos+=8},writeSFixed64:function e(t){this.realloc(8);lg(this.buf,t&-1,this.pos);lg(this.buf,Math.floor(t*Zm),this.pos+4);this.pos+=8},writeVarint:function e(t){t=+t||0;if(t>268435455||t<0){Xm(t,this);return}this.realloc(4);this.buf[this.pos++]=t&127|(t>127?128:0);if(t<=127){return}this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0);if(t<=127){return}this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0);if(t<=127){return}this.buf[this.pos++]=t>>>7&127},writeSVarint:function e(t){this.writeVarint(t<0?-t*2-1:t*2)},writeBoolean:function e(t){this.writeVarint(Boolean(t))},writeString:function e(t){t=String(t);this.realloc(t.length*4);this.pos++;var r=this.pos;this.pos=cg(this.buf,t,this.pos);var i=this.pos-r;if(i>=128){Jm(r,i,this)}this.pos=r-1;this.writeVarint(i);this.pos+=i},writeFloat:function e(t){this.realloc(4);Nm.write(this.buf,t,this.pos,true,23,4);this.pos+=4},writeDouble:function e(t){this.realloc(8);Nm.write(this.buf,t,this.pos,true,52,8);this.pos+=8},writeBytes:function e(t){var r=this;var i=t.length;this.writeVarint(i);this.realloc(i);for(var n=0;n<i;n++){r.buf[r.pos++]=t[n]}},writeRawMessage:function e(t,r){this.pos++;var i=this.pos;t(r,this);var n=this.pos-i;if(n>=128){Jm(i,n,this)}this.pos=i-1;this.writeVarint(n);this.pos+=n},writeMessage:function e(t,r,i){this.writeTag(t,Vm.Bytes);this.writeRawMessage(r,i)},writePackedVarint:function e(t,r){this.writeMessage(t,$m,r)},writePackedSVarint:function e(t,r){this.writeMessage(t,Qm,r)},writePackedBoolean:function e(t,r){this.writeMessage(t,rg,r)},writePackedFloat:function e(t,r){this.writeMessage(t,eg,r)},writePackedDouble:function e(t,r){this.writeMessage(t,tg,r)},writePackedFixed32:function e(t,r){this.writeMessage(t,ig,r)},writePackedSFixed32:function e(t,r){this.writeMessage(t,ng,r)},writePackedFixed64:function e(t,r){this.writeMessage(t,ag,r)},writePackedSFixed64:function e(t,r){this.writeMessage(t,og,r)},writeBytesField:function e(t,r){this.writeTag(t,Vm.Bytes);this.writeBytes(r)},writeFixed32Field:function e(t,r){this.writeTag(t,Vm.Fixed32);this.writeFixed32(r)},writeSFixed32Field:function e(t,r){this.writeTag(t,Vm.Fixed32);this.writeSFixed32(r)},writeFixed64Field:function e(t,r){this.writeTag(t,Vm.Fixed64);this.writeFixed64(r)},writeSFixed64Field:function e(t,r){this.writeTag(t,Vm.Fixed64);this.writeSFixed64(r)},writeVarintField:function e(t,r){this.writeTag(t,Vm.Varint);this.writeVarint(r)},writeSVarintField:function e(t,r){this.writeTag(t,Vm.Varint);this.writeSVarint(r)},writeStringField:function e(t,r){this.writeTag(t,Vm.Bytes);this.writeString(r)},writeFloatField:function e(t,r){this.writeTag(t,Vm.Fixed32);this.writeFloat(r)},writeDoubleField:function e(t,r){this.writeTag(t,Vm.Fixed64);this.writeDouble(r)},writeBooleanField:function e(t,r){this.writeVarintField(t,Boolean(r))}};function qm(e,t,r){var i=r.buf,n,a;a=i[r.pos++];n=(a&112)>>4;if(a<128){return Wm(e,n,t)}a=i[r.pos++];n|=(a&127)<<3;if(a<128){return Wm(e,n,t)}a=i[r.pos++];n|=(a&127)<<10;if(a<128){return Wm(e,n,t)}a=i[r.pos++];n|=(a&127)<<17;if(a<128){return Wm(e,n,t)}a=i[r.pos++];n|=(a&127)<<24;if(a<128){return Wm(e,n,t)}a=i[r.pos++];n|=(a&1)<<31;if(a<128){return Wm(e,n,t)}throw new Error("Expected varint not more than 10 bytes")}function Hm(e){return e.type===Vm.Bytes?e.readVarint()+e.pos:e.pos+1}function Wm(e,t,r){if(r){return t*4294967296+(e>>>0)}return(t>>>0)*4294967296+(e>>>0)}function Xm(e,t){var r,i;if(e>=0){r=e%4294967296|0;i=e/4294967296|0}else{r=~(-e%4294967296);i=~(-e/4294967296);if(r^4294967295){r=r+1|0}else{r=0;i=i+1|0}}if(e>=0x10000000000000000||e<-0x10000000000000000){throw new Error("Given varint doesn't fit into 10 bytes")}t.realloc(10);Ym(r,i,t);Km(i,t)}function Ym(e,t,r){r.buf[r.pos++]=e&127|128;e>>>=7;r.buf[r.pos++]=e&127|128;e>>>=7;r.buf[r.pos++]=e&127|128;e>>>=7;r.buf[r.pos++]=e&127|128;e>>>=7;r.buf[r.pos]=e&127}function Km(e,t){var r=(e&7)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0);if(!e){return}t.buf[t.pos++]=e&127|((e>>>=7)?128:0);if(!e){return}t.buf[t.pos++]=e&127|((e>>>=7)?128:0);if(!e){return}t.buf[t.pos++]=e&127|((e>>>=7)?128:0);if(!e){return}t.buf[t.pos++]=e&127|((e>>>=7)?128:0);if(!e){return}t.buf[t.pos++]=e&127}function Jm(e,t,r){var i=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.ceil(Math.log(t)/(Math.LN2*7));r.realloc(i);for(var n=r.pos-1;n>=e;n--){r.buf[n+i]=r.buf[n]}}function $m(e,t){for(var r=0;r<e.length;r++){t.writeVarint(e[r])}}function Qm(e,t){for(var r=0;r<e.length;r++){t.writeSVarint(e[r])}}function eg(e,t){for(var r=0;r<e.length;r++){t.writeFloat(e[r])}}function tg(e,t){for(var r=0;r<e.length;r++){t.writeDouble(e[r])}}function rg(e,t){for(var r=0;r<e.length;r++){t.writeBoolean(e[r])}}function ig(e,t){for(var r=0;r<e.length;r++){t.writeFixed32(e[r])}}function ng(e,t){for(var r=0;r<e.length;r++){t.writeSFixed32(e[r])}}function ag(e,t){for(var r=0;r<e.length;r++){t.writeFixed64(e[r])}}function og(e,t){for(var r=0;r<e.length;r++){t.writeSFixed64(e[r])}}function sg(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+e[t+3]*16777216}function lg(e,t,r){e[r]=t;e[r+1]=t>>>8;e[r+2]=t>>>16;e[r+3]=t>>>24}function ug(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function fg(e,t,r){var i="";var n=t;while(n<r){var a=e[n];var o=null;var s=a>239?4:a>223?3:a>191?2:1;if(n+s>r){break}var l,u,f;if(s===1){if(a<128){o=a}}else if(s===2){l=e[n+1];if((l&192)===128){o=(a&31)<<6|l&63;if(o<=127){o=null}}}else if(s===3){l=e[n+1];u=e[n+2];if((l&192)===128&&(u&192)===128){o=(a&15)<<12|(l&63)<<6|u&63;if(o<=2047||o>=55296&&o<=57343){o=null}}}else if(s===4){l=e[n+1];u=e[n+2];f=e[n+3];if((l&192)===128&&(u&192)===128&&(f&192)===128){o=(a&15)<<18|(l&63)<<12|(u&63)<<6|f&63;if(o<=65535||o>=1114112){o=null}}}if(o===null){o=65533;s=1}else if(o>65535){o-=65536;i+=String.fromCharCode(o>>>10&1023|55296);o=56320|o&1023}i+=String.fromCharCode(o);n+=s}return i}function cg(e,t,r){for(var i=0,n,a;i<t.length;i++){n=t.charCodeAt(i);if(n>55295&&n<57344){if(a){if(n<56320){e[r++]=239;e[r++]=191;e[r++]=189;a=n;continue}else{n=a-55296<<10|n-56320|65536;a=null}}else{if(n>56319||i+1===t.length){e[r++]=239;e[r++]=191;e[r++]=189}else{a=n}continue}}else if(a){e[r++]=239;e[r++]=191;e[r++]=189;a=null}if(n<128){e[r++]=n}else{if(n<2048){e[r++]=n>>6|192}else{if(n<65536){e[r++]=n>>12|224}else{e[r++]=n>>18|240;e[r++]=n>>12&63|128}e[r++]=n>>6&63|128}e[r++]=n&63|128}}return r}var hg=3;function pg(e,t,r){if(e===1){r.readMessage(dg,t)}}function dg(e,t,r){if(e===3){var i=r.readMessage(vg,{});var n=i.id;var a=i.bitmap;var o=i.width;var s=i.height;var l=i.left;var u=i.top;var f=i.advance;t.push({id:n,bitmap:new Nd({width:o+2*hg,height:s+2*hg},a),metrics:{width:o,height:s,left:l,top:u,advance:f}})}}function vg(e,t,r){if(e===1){t.id=r.readVarint()}else if(e===2){t.bitmap=r.readBytes()}else if(e===3){t.width=r.readVarint()}else if(e===4){t.height=r.readVarint()}else if(e===5){t.left=r.readSVarint()}else if(e===6){t.top=r.readSVarint()}else if(e===7){t.advance=r.readVarint()}}function yg(e){return new jm(e).readFields(pg,[])}var mg=hg;var gg=function e(t,r,i){this.target=t;this.parent=r;this.mapId=i;this.callbacks={};this.callbackID=0;Ce(["receive"],this);this.target.addEventListener("message",this.receive,false)};gg.prototype.send=function e(t,r,i,n){var a=i?this.mapId+":"+this.callbackID++:null;if(i){this.callbacks[a]=i}var o=[];this.target.postMessage({targetMapId:n,sourceMapId:this.mapId,type:t,id:String(a),data:Ga(r,o)},o)};gg.prototype.receive=function e(t){var r=this;var i=t.data,n=i.id;var a;if(i.targetMapId&&this.mapId!==i.targetMapId){return}var o=function e(t,i){var a=[];r.target.postMessage({sourceMapId:r.mapId,type:"<response>",id:String(n),error:t?Ga(t):null,data:Ga(i,a)},a)};if(i.type==="<response>"){a=this.callbacks[i.id];delete this.callbacks[i.id];if(a&&i.error){a(Za(i.error))}else if(a){a(null,Za(i.data))}}else if(typeof i.id!=="undefined"&&this.parent[i.type]){this.parent[i.type](i.sourceMapId,Za(i.data),o)}else if(typeof i.id!=="undefined"&&this.parent.getWorkerSource){var s=i.type.split(".");var l=Za(i.data);var u=this.parent.getWorkerSource(i.sourceMapId,s[0],l.source);u[s[1]](l,o)}else{this.parent[i.type](Za(i.data))}};gg.prototype.remove=function e(){this.target.removeEventListener("message",this.receive,false)};function _g(e,t,r,i,n,a){a=a||{};var o=e+"?"+["bbox="+xg(r,i,n),"format="+(a.format||"image/png"),"service="+(a.service||"WMS"),"version="+(a.version||"1.1.1"),"request="+(a.request||"GetMap"),"srs="+(a.srs||"EPSG:3857"),"width="+(a.width||256),"height="+(a.height||256),"layers="+t].join("&");return o}function xg(e,t,r){t=Math.pow(2,r)-t-1;var i=bg(e*256,t*256,r),n=bg((e+1)*256,(t+1)*256,r);return i[0]+","+i[1]+","+n[0]+","+n[1]}function bg(e,t,r){var i=2*Math.PI*6378137/256/Math.pow(2,r),n=e*i-2*Math.PI*6378137/2,a=t*i-2*Math.PI*6378137/2;return[n,a]}var wg=function e(t,r){if(!t){return}else if(r){this.setSouthWest(t).setNorthEast(r)}else if(t.length===4){this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]])}else{this.setSouthWest(t[0]).setNorthEast(t[1])}};wg.prototype.setNorthEast=function e(t){this._ne=t instanceof Sg?new Sg(t.lng,t.lat):Sg.convert(t);return this};wg.prototype.setSouthWest=function e(t){this._sw=t instanceof Sg?new Sg(t.lng,t.lat):Sg.convert(t);return this};wg.prototype.extend=function e(t){var r=this._sw,i=this._ne;var n,a;if(t instanceof Sg){n=t;a=t}else if(t instanceof wg){n=t._sw;a=t._ne;if(!n||!a){return this}}else{if(Array.isArray(t)){if(t.every(Array.isArray)){return this.extend(wg.convert(t))}else{return this.extend(Sg.convert(t))}}return this}if(!r&&!i){this._sw=new Sg(n.lng,n.lat);this._ne=new Sg(a.lng,a.lat)}else{r.lng=Math.min(n.lng,r.lng);r.lat=Math.min(n.lat,r.lat);i.lng=Math.max(a.lng,i.lng);i.lat=Math.max(a.lat,i.lat)}return this};wg.prototype.getCenter=function e(){return new Sg((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)};wg.prototype.getSouthWest=function e(){return this._sw};wg.prototype.getNorthEast=function e(){return this._ne};wg.prototype.getNorthWest=function e(){return new Sg(this.getWest(),this.getNorth())};wg.prototype.getSouthEast=function e(){return new Sg(this.getEast(),this.getSouth())};wg.prototype.getWest=function e(){return this._sw.lng};wg.prototype.getSouth=function e(){return this._sw.lat};wg.prototype.getEast=function e(){return this._ne.lng};wg.prototype.getNorth=function e(){return this._ne.lat};wg.prototype.toArray=function e(){return[this._sw.toArray(),this._ne.toArray()]};wg.prototype.toString=function e(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"};wg.prototype.isEmpty=function e(){return!(this._sw&&this._ne)};wg.convert=function e(t){if(!t||t instanceof wg){return t}return new wg(t)};var Sg=function e(t,r){if(isNaN(t)||isNaN(r)){throw new Error("Invalid LngLat object: ("+t+", "+r+")")}this.lng=+t;this.lat=+r};Sg.prototype.wrap=function e(){return new Sg(de(this.lng,-180,180),this.lat)};Sg.prototype.toArray=function e(){return[this.lng,this.lat]};Sg.prototype.toString=function e(){return"LngLat("+this.lng+", "+this.lat+")"};Sg.prototype.toBounds=function e(t){var r=40075017;var i=360*t/r,n=i/Math.cos(Math.PI/180*this.lat);return new wg(new Sg(this.lng-n,this.lat-i),new Sg(this.lng+n,this.lat+i))};Sg.convert=function e(t){if(t instanceof Sg){return t}if(Array.isArray(t)&&(t.length===2||t.length===3)){return new Sg(Number(t[0]),Number(t[1]))}if(!Array.isArray(t)&&(typeof t==="undefined"?"undefined":(0,z.default)(t))==="object"&&t!==null){return new Sg(Number("lng"in t?t.lng:t.lon),Number(t.lat))}throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};function Cg(e){var t=2*Math.PI*6378137;return t*Math.cos(e*Math.PI/180)}function Tg(e){return(180+e)/360}function Pg(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Mg(e,t){return e/Cg(t)}function Ig(e){return e*360-180}function Ag(e){var t=180-e*360;return 360/Math.PI*Math.atan(Math.exp(t*Math.PI/180))-90}function Lg(e,t){return e*Cg(Ag(t))}var Eg=function e(t,r,i){if(i===void 0)i=0;this.x=+t;this.y=+r;this.z=+i};Eg.fromLngLat=function e(t,r){if(r===void 0)r=0;var i=Sg.convert(t);return new Eg(Tg(i.lng),Pg(i.lat),Mg(r,i.lat))};Eg.prototype.toLngLat=function e(){return new Sg(Ig(this.x),Ag(this.y))};Eg.prototype.toAltitude=function e(){return Lg(this.z,this.y)};var kg=function e(t,r,i){G(t>=0&&t<=25);G(r>=0&&r<Math.pow(2,t));G(i>=0&&i<Math.pow(2,t));this.z=t;this.x=r;this.y=i;this.key=Rg(0,t,r,i)};kg.prototype.equals=function e(t){return this.z===t.z&&this.x===t.x&&this.y===t.y};kg.prototype.getTileBBox=function e(){var t=Math.pow(2,this.z)-this.y-1,r=bg(256*this.x,256*t,this.z),i=bg(256*(this.x+1),256*(t+1),this.z);return r[0]+","+r[1]+","+i[0]+","+i[1]};kg.prototype.url=function e(t,r){var i=this.getTileBBox();var n=Fg(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",n).replace("{bbox}",i)};kg.prototype.getTilePoint=function e(t){var r=Math.pow(2,this.z);return new se((t.x*r-this.x)*Hs,(t.y*r-this.y)*Hs)};var Dg=function e(t,r){this.wrap=t;this.canonical=r;this.key=Rg(t,r.z,r.x,r.y)};var Bg=function e(t,r,i,n,a){G(t>=i);this.overscaledZ=t;this.wrap=r;this.canonical=new kg(i,+n,+a);this.key=Rg(r,t,n,a)};Bg.prototype.equals=function e(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)};Bg.prototype.scaledTo=function e(t){G(t<=this.overscaledZ);var r=this.canonical.z-t;if(t>this.canonical.z){return new Bg(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}else{return new Bg(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}};Bg.prototype.isChildOf=function e(t){var r=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r};Bg.prototype.children=function e(t){if(this.overscaledZ>=t){return[new Bg(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)]}var r=this.canonical.z+1;var i=this.canonical.x*2;var n=this.canonical.y*2;return[new Bg(r,this.wrap,r,i,n),new Bg(r,this.wrap,r,i+1,n),new Bg(r,this.wrap,r,i,n+1),new Bg(r,this.wrap,r,i+1,n+1)]};Bg.prototype.isLessThan=function e(t){if(this.wrap<t.wrap){return true}if(this.wrap>t.wrap){return false}if(this.overscaledZ<t.overscaledZ){return true}if(this.overscaledZ>t.overscaledZ){return false}if(this.canonical.x<t.canonical.x){return true}if(this.canonical.x>t.canonical.x){return false}if(this.canonical.y<t.canonical.y){return true}return false};Bg.prototype.wrapped=function e(){return new Bg(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)};Bg.prototype.unwrapTo=function e(t){return new Bg(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)};Bg.prototype.overscaleFactor=function e(){return Math.pow(2,this.overscaledZ-this.canonical.z)};Bg.prototype.toUnwrapped=function e(){return new Dg(this.wrap,this.canonical)};Bg.prototype.toString=function e(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y};Bg.prototype.getTilePoint=function e(t){return this.canonical.getTilePoint(new Eg(t.x-this.wrap,t.y))};function Rg(e,t,r,i){e*=2;if(e<0){e=e*-1-1}var n=1<<t;return(n*n*e+n*i+r)*32+t}function Fg(e,t,r){var i="",n;for(var a=e;a>0;a--){n=1<<a-1;i+=(t&n?1:0)+(r&n?2:0)}return i}ja("CanonicalTileID",kg);ja("OverscaledTileID",Bg,{omit:["posMatrix"]});var Og=function e(t,r,i){var n=this;this.uid=t;if(r.height!==r.width){throw new RangeError("DEM tiles must be square")}if(i&&i!=="mapbox"&&i!=="terrarium"){return Ee('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".')}var a=this.dim=r.height;this.border=Math.max(Math.ceil(r.height/2),1);this.stride=this.dim+2*this.border;this.data=new Int32Array(this.stride*this.stride);var o=r.data;var s=i==="terrarium"?this._unpackTerrarium:this._unpackMapbox;for(var l=0;l<a;l++){for(var u=0;u<a;u++){var f=l*a+u;var c=f*4;n.set(u,l,s(o[c],o[c+1],o[c+2]))}}for(var h=0;h<a;h++){n.set(-1,h,n.get(0,h));n.set(a,h,n.get(a-1,h));n.set(h,-1,n.get(h,0));n.set(h,a,n.get(h,a-1))}this.set(-1,-1,this.get(0,0));this.set(a,-1,this.get(a-1,0));this.set(-1,a,this.get(0,a-1));this.set(a,a,this.get(a-1,a-1))};Og.prototype.set=function e(t,r,i){this.data[this._idx(t,r)]=i+65536};Og.prototype.get=function e(t,r){return this.data[this._idx(t,r)]-65536};Og.prototype._idx=function e(t,r){if(t<-this.border||t>=this.dim+this.border||r<-this.border||r>=this.dim+this.border){throw new RangeError("out of range source coordinates for DEM data")}return(r+this.border)*this.stride+(t+this.border)};Og.prototype._unpackMapbox=function e(t,r,i){return(t*256*256+r*256+i)/10-1e4};Og.prototype._unpackTerrarium=function e(t,r,i){return t*256+r+i/256-32768};Og.prototype.getPixels=function e(){return new jd({width:this.dim+2*this.border,height:this.dim+2*this.border},new Uint8Array(this.data.buffer))};Og.prototype.backfillBorder=function e(t,r,i){var n=this;if(this.dim!==t.dim){throw new Error("dem dimension mismatch")}var a=r*this.dim,o=r*this.dim+this.dim,s=i*this.dim,l=i*this.dim+this.dim;switch(r){case-1:a=o-1;break;case 1:o=a+1;break}switch(i){case-1:s=l-1;break;case 1:l=s+1;break}var u=pe(a,-this.border,this.dim+this.border);var f=pe(o,-this.border,this.dim+this.border);var c=pe(s,-this.border,this.dim+this.border);var h=pe(l,-this.border,this.dim+this.border);var p=-r*this.dim;var d=-i*this.dim;for(var v=c;v<h;v++){for(var y=u;y<f;y++){n.set(y,v,t.get(y+p,v+d))}}};ja("DEMData",Og);var zg=Ro([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function Ug(e,t){var r={};if(!t){return r}for(var i=0,n=e;i<n.length;i+=1){var a=n[i];var o=a.layerIds.map(function(e){return t.getLayer(e)}).filter(Boolean);if(o.length===0){continue}a.layers=o;a.stateDependentLayers=o.filter(function(e){return e.isStateDependent()});for(var s=0,l=o;s<l.length;s+=1){var u=l[s];r[u.id]=a}}return r}var Ng=function e(t){var r=this;this._stringToNumber={};this._numberToString=[];for(var i=0;i<t.length;i++){var n=t[i];r._stringToNumber[n]=i;r._numberToString[i]=n}};Ng.prototype.encode=function e(t){G(t in this._stringToNumber);return this._stringToNumber[t]};Ng.prototype.decode=function e(t){G(t<this._numberToString.length);return this._numberToString[t]};var jg=function e(t,r,i,n){this.type="Feature";this._vectorTileFeature=t;t._z=r;t._x=i;t._y=n;this.properties=t.properties;if(t.id!=null){this.id=t.id}};var Vg={geometry:{configurable:true}};Vg.geometry.get=function(){if(this._geometry===undefined){this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry}return this._geometry};Vg.geometry.set=function(e){this._geometry=e};jg.prototype.toJSON=function e(){var t=this;var r={geometry:this.geometry};for(var i in t){if(i==="_geometry"||i==="_vectorTileFeature"){continue}r[i]=t[i]}return r};(0,x.default)(jg.prototype,Vg);var Gg=function e(){this.state={};this.stateChanges={}};Gg.prototype.updateState=function e(t,r,i){var n=String(r);this.stateChanges[t]=this.stateChanges[t]||{};this.stateChanges[t][n]=this.stateChanges[t][n]||{};ge(this.stateChanges[t][n],i)};Gg.prototype.getState=function e(t,r){var i=String(r);var n=this.state[t]||{};var a=this.stateChanges[t]||{};return ge({},n[i],a[i])};Gg.prototype.initializeTileState=function e(t,r){t.setFeatureState(this.state,r)};Gg.prototype.coalesceChanges=function e(t,r){var i=this;var n={};for(var a in i.stateChanges){i.state[a]=i.state[a]||{};var o={};for(var s in i.stateChanges[a]){if(!i.state[a][s]){i.state[a][s]={}}ge(i.state[a][s],i.stateChanges[a][s]);o[s]=i.state[a][s]}n[a]=o}this.stateChanges={};if((0,k.default)(n).length===0){return}for(var l in t){var u=t[l];u.setFeatureState(n,r)}};var Zg=function e(t,r,i){this.tileID=t;this.x=t.canonical.x;this.y=t.canonical.y;this.z=t.canonical.z;this.grid=r||new Fa(Hs,16,0);this.featureIndexArray=i||new ys};Zg.prototype.insert=function e(t,r,i,n,a){var o=this;var s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,n,a);for(var l=0;l<r.length;l++){var u=r[l];var f=[Infinity,Infinity,-Infinity,-Infinity];for(var c=0;c<u.length;c++){var h=u[c];f[0]=Math.min(f[0],h.x);f[1]=Math.min(f[1],h.y);f[2]=Math.max(f[2],h.x);f[3]=Math.max(f[3],h.y)}if(f[0]<Hs&&f[1]<Hs&&f[2]>=0&&f[3]>=0){o.grid.insert(s,f[0],f[1],f[2],f[3])}}};Zg.prototype.loadVTLayers=function e(){if(!this.vtLayers){this.vtLayers=new _y.VectorTile(new jm(this.rawTileData)).layers;this.sourceLayerCoder=new Ng(this.vtLayers?(0,k.default)(this.vtLayers).sort():["_geojsonTileLayer"])}return this.vtLayers};Zg.prototype.query=function e(t,r,i){var n=this;this.loadVTLayers();var a=t.params||{},o=Hs/t.tileSize/t.scale,s=aa(a.filter);var l=t.queryGeometry;var u=t.queryPadding*o;var f=Infinity;var c=Infinity;var h=-Infinity;var p=-Infinity;for(var d=0;d<l.length;d++){var v=l[d];for(var y=0;y<v.length;y++){var m=v[y];f=Math.min(f,m.x);c=Math.min(c,m.y);h=Math.max(h,m.x);p=Math.max(p,m.y)}}var g=this.grid.query(f-u,c-u,h+u,p+u);g.sort(qg);var _={};var x;var b=function e(u){var f=g[u];if(f===x){return}x=f;var c=n.featureIndexArray.get(f);var h=null;n.loadMatchingFeature(_,c.bucketIndex,c.sourceLayerIndex,c.featureIndex,s,a.layers,r,function(e,r){if(!h){h=Ys(e)}var a={};if(e.id){a=i.getState(r.sourceLayer||"_geojsonTileLayer",e.id)}return r.queryIntersectsFeature(l,e,a,h,n.z,t.transform,o,t.posMatrix)})};for(var w=0;w<g.length;w++){b(w)}return _};Zg.prototype.loadMatchingFeature=function e(t,r,i,n,a,o,s,l){var u=this;var f=this.bucketLayerIDs[r];if(o&&!Ae(o,f)){return}var c=this.sourceLayerCoder.decode(i);var h=this.vtLayers[c];var p=h.feature(n);if(!a(new ho(this.tileID.overscaledZ),p)){return}for(var d=0;d<f.length;d++){var v=f[d];if(o&&o.indexOf(v)<0){continue}var y=s[v];if(!y){continue}if(l&&!l(p,y)){continue}var m=new jg(p,u.z,u.x,u.y);m.layer=y.serialize();var g=t[v];if(g===undefined){g=t[v]=[]}g.push({featureIndex:n,feature:m})}};Zg.prototype.lookupSymbolFeatures=function e(t,r,i,n,a,o){var s=this;var l={};this.loadVTLayers();var u=aa(n);for(var f=0,c=t;f<c.length;f+=1){var h=c[f];s.loadMatchingFeature(l,r,i,h,u,a,o)}return l};Zg.prototype.hasLayer=function e(t){var r=this;for(var i=0,n=r.bucketLayerIDs;i<n.length;i+=1){var a=n[i];for(var o=0,s=a;o<s.length;o+=1){var l=s[o];if(t===l){return true}}}return false};ja("FeatureIndex",Zg,{omit:["rawTileData","sourceLayerCoder"]});function qg(e,t){return t-e}var Hg=3e4;var Wg=function e(t,r){this.tileID=t;this.uid=be();this.uses=0;this.tileSize=r;this.buckets={};this.expirationTime=null;this.queryPadding=0;this.hasSymbolBuckets=false;this.expiredRequestCount=0;this.state="loading"};Wg.prototype.registerFadeDuration=function e(t){var r=t+this.timeAdded;if(r<je.now()){return}if(this.fadeEndTime&&r<this.fadeEndTime){return}this.fadeEndTime=r};Wg.prototype.wasRequested=function e(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"};Wg.prototype.loadVectorData=function e(t,r,i){var n=this;if(this.hasData()){this.unloadVectorData()}this.state="loaded";if(!t){this.collisionBoxArray=new os;return}if(t.featureIndex){this.latestFeatureIndex=t.featureIndex;if(t.rawTileData){this.latestRawTileData=t.rawTileData;this.latestFeatureIndex.rawTileData=t.rawTileData}else if(this.latestRawTileData){this.latestFeatureIndex.rawTileData=this.latestRawTileData}}this.collisionBoxArray=t.collisionBoxArray;this.buckets=Ug(t.buckets,r.style);this.hasSymbolBuckets=false;for(var a in n.buckets){var o=n.buckets[a];if(o instanceof hm){n.hasSymbolBuckets=true;if(i){o.justReloaded=true}else{break}}}this.queryPadding=0;for(var s in n.buckets){var l=n.buckets[s];n.queryPadding=Math.max(n.queryPadding,r.style.getLayer(s).queryRadius(l))}if(t.imageAtlas){this.imageAtlas=t.imageAtlas}if(t.glyphAtlasImage){this.glyphAtlasImage=t.glyphAtlasImage}};Wg.prototype.unloadVectorData=function e(){var t=this;for(var r in t.buckets){t.buckets[r].destroy()}this.buckets={};if(this.imageAtlasTexture){this.imageAtlasTexture.destroy()}if(this.imageAtlas){this.imageAtlas=null}if(this.glyphAtlasTexture){this.glyphAtlasTexture.destroy()}this.latestFeatureIndex=null;this.state="unloaded"};Wg.prototype.unloadDEMData=function e(){this.dem=null;this.neighboringTiles=null;this.state="unloaded"};Wg.prototype.getBucket=function e(t){return this.buckets[t.id]};Wg.prototype.upload=function e(t){var r=this;for(var i in r.buckets){var n=r.buckets[i];if(n.uploadPending()){n.upload(t)}}var a=t.gl;if(this.imageAtlas&&!this.imageAtlas.uploaded){this.imageAtlasTexture=new Om(t,this.imageAtlas.image,a.RGBA);this.imageAtlas.uploaded=true}if(this.glyphAtlasImage){this.glyphAtlasTexture=new Om(t,this.glyphAtlasImage,a.ALPHA);this.glyphAtlasImage=null}};Wg.prototype.queryRenderedFeatures=function e(t,r,i,n,a,o,s,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData){return{}}return this.latestFeatureIndex.query({queryGeometry:i,scale:n,tileSize:this.tileSize,posMatrix:l,transform:o,params:a,queryPadding:this.queryPadding*s},t,r)};Wg.prototype.querySourceFeatures=function e(t,r){var i=this;if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData){return}var n=this.latestFeatureIndex.loadVTLayers();var a=r?r.sourceLayer:"";var o=n._geojsonTileLayer||n[a];if(!o){return}var s=aa(r&&r.filter);var l=this.tileID.canonical;var u=l.z;var f=l.x;var c=l.y;var h={z:u,x:f,y:c};for(var p=0;p<o.length;p++){var d=o.feature(p);if(s(new ho(i.tileID.overscaledZ),d)){var v=new jg(d,u,f,c);v.tile=h;t.push(v)}}};Wg.prototype.clearMask=function e(){if(this.segments){this.segments.destroy();delete this.segments}if(this.maskedBoundsBuffer){this.maskedBoundsBuffer.destroy();delete this.maskedBoundsBuffer}if(this.maskedIndexBuffer){this.maskedIndexBuffer.destroy();delete this.maskedIndexBuffer}};Wg.prototype.setMask=function e(t,r){var i=this;if(ue(this.mask,t)){return}this.mask=t;this.clearMask();if(ue(t,{0:true})){return}var n=new Uo;var a=new es;this.segments=new bs;this.segments.prepareSegment(0,n,a);var o=(0,k.default)(t);for(var s=0;s<o.length;s++){var l=t[o[s]];var u=Hs>>l.z;var f=new se(l.x*u,l.y*u);var c=new se(f.x+u,f.y+u);var h=i.segments.prepareSegment(4,n,a);n.emplaceBack(f.x,f.y,f.x,f.y);n.emplaceBack(c.x,f.y,c.x,f.y);n.emplaceBack(f.x,c.y,f.x,c.y);n.emplaceBack(c.x,c.y,c.x,c.y);var p=h.vertexLength;a.emplaceBack(p,p+1,p+2);a.emplaceBack(p+1,p+2,p+3);h.vertexLength+=4;h.primitiveLength+=2}this.maskedBoundsBuffer=r.createVertexBuffer(n,zg.members);this.maskedIndexBuffer=r.createIndexBuffer(a)};Wg.prototype.hasData=function e(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"};Wg.prototype.patternsLoaded=function e(){return this.imageAtlas&&!!(0,k.default)(this.imageAtlas.patternPositions).length};Wg.prototype.setExpiryData=function e(t){var r=this.expirationTime;if(t.cacheControl){var i=Fe(t.cacheControl);if(i["max-age"]){this.expirationTime=Date.now()+i["max-age"]*1e3}}else if(t.expires){this.expirationTime=new Date(t.expires).getTime()}if(this.expirationTime){var n=Date.now();var a=false;if(this.expirationTime>n){a=false}else if(!r){a=true}else if(this.expirationTime<r){a=true}else{var o=this.expirationTime-r;if(!o){a=true}else{this.expirationTime=n+Math.max(o,Hg)}}if(a){this.expiredRequestCount++;this.state="expired"}else{this.expiredRequestCount=0}}};Wg.prototype.getExpiryTimeout=function e(){if(this.expirationTime){if(this.expiredRequestCount){return 1e3*(1<<Math.min(this.expiredRequestCount-1,31))}else{return Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}}};Wg.prototype.setFeatureState=function e(t,r){var i=this;if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||(0,k.default)(t).length===0){return}var n=this.latestFeatureIndex.loadVTLayers();for(var a in i.buckets){var o=i.buckets[a];var s=o.layers[0]["sourceLayer"]||"_geojsonTileLayer";var l=n[s];var u=t[s];if(!l||!u||(0,k.default)(u).length===0){continue}o.update(u,l,i.imageAtlas&&i.imageAtlas.patternPositions||{});if(r&&r.style){i.queryPadding=Math.max(i.queryPadding,r.style.getLayer(a).queryRadius(o))}}};Wg.prototype.holdingForFade=function e(){return this.symbolFadeHoldUntil!==undefined};Wg.prototype.symbolFadeFinished=function e(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<je.now()};Wg.prototype.clearFadeHold=function e(){this.symbolFadeHoldUntil=undefined};Wg.prototype.setHoldDuration=function e(t){this.symbolFadeHoldUntil=je.now()+t};var Xg=["type","source","source-layer","minzoom","maxzoom","filter","layout"];var Yg={horizontal:1,vertical:2,horizontalOnly:3};var Kg=function e(){this.text="";this.sectionIndex=[];this.sections=[]};Kg.fromFeature=function e(t,r){var i=new Kg;for(var n=0;n<t.sections.length;n++){var a=t.sections[n];i.sections.push({scale:a.scale||1,fontStack:a.fontStack||r});i.text+=a.text;for(var o=0;o<a.text.length;o++){i.sectionIndex.push(n)}}return i};Kg.prototype.length=function e(){return this.text.length};Kg.prototype.getSection=function e(t){return this.sections[this.sectionIndex[t]]};Kg.prototype.getCharCode=function e(t){return this.text.charCodeAt(t)};Kg.prototype.verticalizePunctuation=function e(){this.text=em(this.text)};Kg.prototype.trim=function e(){var t=0;for(var r=0;r<this.text.length&&Qg[this.text.charCodeAt(r)];r++){t++}var i=this.text.length;for(var n=this.text.length-1;n>=0&&n>=t&&Qg[this.text.charCodeAt(n)];n--){i--}this.text=this.text.substring(t,i);this.sectionIndex=this.sectionIndex.slice(t,i)};Kg.prototype.substring=function e(t,r){var e=new Kg;e.text=this.text.substring(t,r);e.sectionIndex=this.sectionIndex.slice(t,r);e.sections=this.sections;return e};Kg.prototype.toString=function e(){return this.text};Kg.prototype.getMaxScale=function e(){var t=this;return this.sectionIndex.reduce(function(e,r){return Math.max(e,t.sections[r].scale)},0)};function Jg(e,t){var r=[];var i=e.text;var n=0;for(var a=0,o=t;a<o.length;a+=1){var s=o[a];r.push(e.substring(n,s));n=s}if(n<i.length){r.push(e.substring(n,i.length))}return r}function $g(e,t,r,i,n,a,o,s,l,u,f){var c=Kg.fromFeature(e,r);if(f===Yg.vertical){c.verticalizePunctuation()}var h=[];var p={positionedGlyphs:h,text:c,top:l[1],bottom:l[1],left:l[0],right:l[0],writingMode:f};var d;var v=co.processBidirectionalText;var y=co.processStyledBidirectionalText;if(v&&c.sections.length===1){d=[];var m=v(c.toString(),o_(c,s,i,t));for(var g=0,_=m;g<_.length;g+=1){var x=_[g];var b=new Kg;b.text=x;b.sections=c.sections;for(var w=0;w<x.length;w++){b.sectionIndex.push(0)}d.push(b)}}else if(y){d=[];var S=y(c.text,c.sectionIndex,o_(c,s,i,t));for(var C=0,T=S;C<T.length;C+=1){var P=T[C];var M=new Kg;M.text=P[0];M.sectionIndex=P[1];M.sections=c.sections;d.push(M)}}else{d=Jg(c,o_(c,s,i,t))}l_(p,t,d,n,a,o,f,s,u);if(!h.length){return false}p.text=p.text.toString();return p}var Qg={};Qg[9]=true;Qg[10]=true;Qg[11]=true;Qg[12]=true;Qg[13]=true;Qg[32]=true;var e_={};e_[10]=true;e_[32]=true;e_[38]=true;e_[40]=true;e_[41]=true;e_[43]=true;e_[45]=true;e_[47]=true;e_[173]=true;e_[183]=true;e_[8203]=true;e_[8208]=true;e_[8211]=true;e_[8231]=true;function t_(e,t,r,i){var n=0;for(var a=0;a<e.length();a++){var o=e.getSection(a);var s=i[o.fontStack];var l=s&&s[e.getCharCode(a)];if(!l){continue}n+=l.metrics.advance*o.scale+t}var u=Math.max(1,Math.ceil(n/r));return n/u}function r_(e,t,r,i){var n=Math.pow(e-t,2);if(i){if(e<t){return n/2}else{return n*2}}return n+Math.abs(r)*r}function i_(e,t){var r=0;if(e===10){r-=1e4}if(e===40||e===65288){r+=50}if(t===41||t===65289){r+=50}return r}function n_(e,t,r,i,n,a){var o=null;var s=r_(t,r,n,a);for(var l=0,u=i;l<u.length;l+=1){var f=u[l];var c=t-f.x;var h=r_(c,r,n,a)+f.badness;if(h<=s){o=f;s=h}}return{index:e,x:t,priorBreak:o,badness:s}}function a_(e){if(!e){return[]}return a_(e.priorBreak).concat(e.index)}function o_(e,t,r,i){if(!r){return[]}if(!e){return[]}var n=[];var a=t_(e,t,r,i);var o=0;for(var s=0;s<e.length();s++){var l=e.getSection(s);var u=e.getCharCode(s);var f=i[l.fontStack];var c=f&&f[u];if(c&&!Qg[u]){o+=c.metrics.advance*l.scale+t}if(s<e.length()-1&&(e_[u]||Ja(u))){n.push(n_(s+1,o,a,n,i_(u,e.getCharCode(s+1)),false))}}return a_(n_(e.length(),o,a,n,0,true))}function s_(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0;break}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break}return{horizontalAlign:t,verticalAlign:r}}function l_(e,t,r,i,n,a,o,s,l){var u=-17;var f=0;var c=u;var h=0;var p=e.positionedGlyphs;var d=a==="right"?1:a==="left"?0:.5;for(var v=0,y=r;v<y.length;v+=1){var m=y[v];m.trim();var g=m.getMaxScale();if(!m.length()){c+=i;continue}var _=p.length;for(var x=0;x<m.length();x++){var b=m.getSection(x);var w=m.getCharCode(x);var S=(g-b.scale)*24;var C=t[b.fontStack];var T=C&&C[w];if(!T){continue}if(!$a(w)||o===Yg.horizontal){p.push({glyph:w,x:f,y:c+S,vertical:false,scale:b.scale,fontStack:b.fontStack});f+=T.metrics.advance*b.scale+s}else{p.push({glyph:w,x:f,y:S,vertical:true,scale:b.scale,fontStack:b.fontStack});f+=l*b.scale+s}}if(p.length!==_){var P=f-s;h=Math.max(P,h);u_(p,t,_,p.length-1,d)}f=0;c+=i*g}var M=s_(n);var I=M.horizontalAlign;var A=M.verticalAlign;f_(p,d,I,A,h,i,r.length);var L=c-u;e.top+=-A*L;e.bottom=e.top+L;e.left+=-I*h;e.right=e.left+h}function u_(e,t,r,i,n){if(!n){return}var a=e[i];var o=t[a.fontStack];var s=o&&o[a.glyph];if(s){var l=s.metrics.advance*a.scale;var u=(e[i].x+l)*n;for(var f=r;f<=i;f++){e[f].x-=u}}}function f_(e,t,r,i,n,a,o){var s=(t-r)*n;var l=(-i*o+.5)*a;for(var u=0;u<e.length;u++){e[u].x+=s;e[u].y+=l}}function c_(e,t,r){var i=s_(r);var n=i.horizontalAlign;var a=i.verticalAlign;var o=t[0];var s=t[1];var l=o-e.displaySize[0]*n;var u=l+e.displaySize[0];var f=s-e.displaySize[1]*a;var c=f+e.displaySize[1];return{image:e,top:f,bottom:c,left:l,right:u}}e.commonjsGlobal=t;e.commonjsRequire=r;e.unwrapExports=a;e.createCommonjsModule=o;e.getCjsExportFromNamespace=s;e.Point=se;e.window=self;e.assert=G;e.getJSON=_t;e.getImage=Pt;e.ResourceType=pt;e.browser=je;e.normalizeSpriteURL=Qe;e.RGBAImage=jd;e.potpack=Im;e.ImagePosition=Lm;e.Texture=Om;e.normalizeGlyphsURL=Je;e.getArrayBuffer=xt;e.parseGlyphPBF=yg;e.isChar=Ha;e.asyncAll=ve;e.AlphaImage=Nd;e.styleSpec=yr;e.endsWith=Te;e.extend=ge;e.sphericalToCartesian=Re;e.Evented=kt;e.validateStyle=Aa;e.validateLight=Ea;e.emitValidationErrors=Ra;e.Color=Nr;e.number=di;e.Properties=Mo;e.Transitionable=yo;e.Transitioning=go;e.PossiblyEvaluated=bo;e.DataConstantProperty=wo;e.warnOnce=Ee;e.uniqueId=be;e.Actor=gg;e.pick=_e;e.normalizeSourceURL=$e;e.LngLatBounds=wg;e.clamp=pe;e.Event=Lt;e.ErrorEvent=Et;e.normalizeTileURL=tt;e.postTurnstileEvent=ft;e.postMapLoadEvent=ht;e.OverscaledTileID=Bg;e.EXTENT=Hs;e.CanonicalTileID=kg;e.StructArrayLayout4i8=Uo;e.rasterBoundsAttributes=zg;e.SegmentVector=bs;e.MercatorCoordinate=Eg;e.getVideo=Mt;e.ValidationError=mr;e.bindAll=Ce;e.isEqual=ue;e.Tile=Wg;e.keysDifference=me;e.SourceFeatureState=Gg;e.refProperties=Xg;e.create=Ju;e.clone=$u;e.copy=Qu;e.fromValues=ef;e.set=tf;e.identity=rf;e.transpose=nf;e.invert=af;e.adjoint=of;e.determinant=sf;e.multiply=lf;e.translate=uf;e.scale=ff;e.rotate=cf;e.rotateX=hf;e.rotateY=pf;e.rotateZ=df;e.fromTranslation=vf;e.fromScaling=yf;e.fromRotation=mf;e.fromXRotation=gf;e.fromYRotation=_f;e.fromZRotation=xf;e.fromRotationTranslation=bf;e.fromQuat2=wf;e.getTranslation=Sf;e.getScaling=Cf;e.getRotation=Tf;e.fromRotationTranslationScale=Pf;e.fromRotationTranslationScaleOrigin=Mf;e.fromQuat=If;e.frustum=Af;e.perspective=Lf;e.perspectiveFromFieldOfView=Ef;e.ortho=kf;e.lookAt=Df;e.targetTo=Bf;e.str=Rf;e.frob=Ff;e.add=Of;e.subtract=zf;e.multiplyScalar=Uf;e.multiplyScalarAndAdd=Nf;e.exactEquals=jf;e.equals=Vf;e.mul=Gf;e.sub=Zf;e.create$1=zc;e.clone$1=Uc;e.fromValues$1=Nc;e.copy$1=jc;e.set$1=Vc;e.add$1=Gc;e.subtract$1=Zc;e.multiply$1=qc;e.divide=Hc;e.ceil=Wc;e.floor=Xc;e.min=Yc;e.max=Kc;e.round=Jc;e.scale$1=$c;e.scaleAndAdd=Qc;e.distance=eh;e.squaredDistance=th;e.length=rh;e.squaredLength=ih;e.negate=nh;e.inverse=ah;e.normalize=oh;e.dot=sh;e.lerp=lh;e.random=uh;e.transformMat4=fh;e.transformQuat=ch;e.str$1=hh;e.exactEquals$1=ph;e.equals$1=dh;e.sub$1=vh;e.mul$1=yh;e.div=mh;e.dist=gh;e.sqrDist=_h;e.len=xh;e.sqrLen=bh;e.forEach=wh;e.getSizeData=im;e.evaluateSizeForFeature=nm;e.evaluateSizeForZoom=am;e.SIZE_PACK_FACTOR=rm;e.addDynamicAttributes=um;e.properties=ym;e.WritingMode=Yg;e.multiPolygonIntersectsBufferedPoint=Qs;e.multiPolygonIntersectsBufferedMultiPoint=el;e.multiPolygonIntersectsMultiPolygon=tl;e.multiPolygonIntersectsBufferedMultiLine=rl;e.polygonIntersectsPolygon=$s;e.distToSegmentSquared=sl;e.SymbolInstanceArray=fs;e.StyleLayer=Ao;e.createStyleLayer=Mm;e.clone$2=Ie;e.filterObject=Me;e.mapObject=Pe;e.getReferrer=vt;e.isMapboxURL=We;e.normalizeStyleURL=Ke;e.registerForPluginAvailability=lo;e.evented=oo;e.ZoomHistory=qa;e.validateCustomStyleLayer=Cm;e.createLayout=Ro;e.ProgramConfiguration=js;e.Uniform1i=Ms;e.Uniform1f=Is;e.Uniform2f=As;e.Uniform4f=Es;e.Uniform3f=Ls;e.UniformMatrix4f=Bs;e.create$2=_u;e.fromMat4=xu;e.clone$3=bu;e.copy$2=wu;e.fromValues$2=Su;e.set$2=Cu;e.identity$1=Tu;e.transpose$1=Pu;e.invert$1=Mu;e.adjoint$1=Iu;e.determinant$1=Au;e.multiply$2=Lu;e.translate$1=Eu;e.rotate$1=ku;e.scale$2=Du;e.fromTranslation$1=Bu;e.fromRotation$1=Ru;e.fromScaling$1=Fu;e.fromMat2d=Ou;e.fromQuat$1=zu;e.normalFromMat4=Uu;e.projection=Nu;e.str$2=ju;e.frob$1=Vu;e.add$2=Gu;e.subtract$2=Zu;e.multiplyScalar$1=qu;e.multiplyScalarAndAdd$1=Hu;e.exactEquals$2=Wu;e.equals$2=Xu;e.mul$2=Yu;e.sub$2=Ku;e.create$3=qf;e.clone$4=Hf;e.length$1=Wf;e.fromValues$3=Xf;e.copy$3=Yf;e.set$3=Kf;e.add$3=Jf;e.subtract$3=$f;e.multiply$3=Qf;e.divide$1=ec;e.ceil$1=tc;e.floor$1=rc;e.min$1=ic;e.max$1=nc;e.round$1=ac;e.scale$3=oc;e.scaleAndAdd$1=sc;e.distance$1=lc;e.squaredDistance$1=uc;e.squaredLength$1=fc;e.negate$1=cc;e.inverse$1=hc;e.normalize$1=pc;e.dot$1=dc;e.cross=vc;e.lerp$1=yc;e.hermite=mc;e.bezier=gc;e.random$1=_c;e.transformMat4$1=xc;e.transformMat3=bc;e.transformQuat$1=wc;e.rotateX$1=Sc;e.rotateY$1=Cc;e.rotateZ$1=Tc;e.angle=Pc;e.str$3=Mc;e.exactEquals$3=Ic;e.equals$3=Ac;e.sub$3=Lc;e.mul$3=Ec;e.div$1=kc;e.dist$1=Dc;e.sqrDist$1=Bc;e.len$1=Rc;e.sqrLen$1=Fc;e.forEach$1=Oc;e.UniformColor=ks;e.StructArrayLayout2i4=zo;e.StructArrayLayout2ui4=ts;e.StructArrayLayout3ui6=es;e.StructArrayLayout1ui2=rs;e.LngLat=Sg;e.wrap=de;e.UnwrappedTileID=Dg;e.create$4=wl;e.clone$5=Sl;e.copy$4=Cl;e.identity$2=Tl;e.fromValues$4=Pl;e.set$4=Ml;e.transpose$2=Il;e.invert$2=Al;e.adjoint$2=Ll;e.determinant$2=El;e.multiply$4=kl;e.rotate$2=Dl;e.scale$4=Bl;e.fromRotation$2=Rl;e.fromScaling$2=Fl;e.str$4=Ol;e.frob$2=zl;e.LDU=Ul;e.add$4=Nl;e.subtract$4=jl;e.exactEquals$4=Vl;e.equals$4=Gl;e.multiplyScalar$2=Zl;e.multiplyScalarAndAdd$2=ql;e.mul$4=Hl;e.sub$4=Wl;e.ease=he;e.bezier$1=ce;e.config=Ge;e.EvaluationParameters=ho;e.GeoJSONFeature=jg;e.mercatorZfromAltitude=Mg;e.version=H;e.CanonicalTileID$1=kg;e.setRTLTextPlugin=fo;e.values=ye;e.featureFilter=aa;e.Anchor=tm;e.GLYPH_PBF_BORDER=mg;e.shapeText=$g;e.shapeIcon=c_;e.allowsVerticalWritingMode=Xa;e.allowsLetterSpacing=Ya;e.classifyRings=Ev;e.SymbolBucket=hm;e.register=ja;e.FeatureIndex=Zg;e.CollisionBoxArray=os;e.DictionaryCoder=Ng;e.LineBucket=Iy;e.FillBucket=Fv;e.FillExtrusionBucket=Wv;e.ImageAtlas=km;e.mvt=_y;e.Protobuf=jm;e.DEMData=Og;e.vectorTile=_y;e.Point$1=se;e._pbf_3_1_0_pbf=jm;e.plugin=co});a(["./shared.js"],function(e){"use strict";function t(e){var r=typeof e==="undefined"?"undefined":(0,z.default)(e);if(r==="number"||r==="boolean"||r==="string"||e===undefined||e===null){return(0,B.default)(e)}if(Array.isArray(e)){var i="[";for(var n=0,a=e;n<a.length;n+=1){var o=a[n];i+=t(o)+","}return i+"]"}var s=(0,k.default)(e).sort();var l="{";for(var u=0;u<s.length;u++){l+=(0,B.default)(s[u])+":"+t(e[s[u]])+","}return l+"}"}function r(r){var i="";for(var n=0,a=e.refProperties;n<a.length;n+=1){var o=a[n];i+="/"+t(r[o])}return i}function i(e){var t={};for(var i=0;i<e.length;i++){var n=r(e[i]);var a=t[n];if(!a){a=t[n]=[]}a.push(e[i])}var o=[];for(var s in t){o.push(t[s])}return o}var n=function e(t){if(t){this.replace(t)}};n.prototype.replace=function e(t){this._layerConfigs={};this._layers={};this.update(t,[])};n.prototype.update=function t(r,n){var a=this;for(var o=0,s=r;o<s.length;o+=1){var l=s[o];a._layerConfigs[l.id]=l;var u=a._layers[l.id]=e.createStyleLayer(l);u._featureFilter=e.featureFilter(u.filter)}for(var f=0,c=n;f<c.length;f+=1){var h=c[f];delete a._layerConfigs[h];delete a._layers[h]}this.familiesBySource={};var p=i(e.values(this._layerConfigs));for(var d=0,v=p;d<v.length;d+=1){var y=v[d];var m=y.map(function(e){return a._layers[e.id]});var g=m[0];if(g.visibility==="none"){continue}var _=g.source||"";var x=a.familiesBySource[_];if(!x){x=a.familiesBySource[_]={}}var b=g.sourceLayer||"_geojsonTileLayer";var w=x[b];if(!w){w=x[b]=[]}w.push(m)}};function a(e,t,r,i,n){if(t.segment===undefined){return true}var a=t;var o=t.segment+1;var s=0;while(s>-r/2){o--;if(o<0){return false}s-=e[o].dist(a);a=e[o]}s+=e[o].dist(e[o+1]);o++;var l=[];var u=0;while(s<r/2){var f=e[o-1];var c=e[o];var h=e[o+1];if(!h){return false}var p=f.angleTo(c)-c.angleTo(h);p=Math.abs((p+3*Math.PI)%(Math.PI*2)-Math.PI);l.push({distance:s,angleDelta:p});u+=p;while(s-l[0].distance>i){u-=l.shift().angleDelta}if(u>n){return false}o++;s+=c.dist(h)}return true}function o(e){var t=0;for(var r=0;r<e.length-1;r++){t+=e[r].dist(e[r+1])}return t}function s(e,t,r){return e?3/5*t*r:0}function l(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function u(t,r,i,n,u,f){var c=s(i,u,f);var h=l(i,n)*f;var p=0;var d=o(t)/2;for(var v=0;v<t.length-1;v++){var y=t[v],m=t[v+1];var g=y.dist(m);if(p+g>d){var _=(d-p)/g,x=e.number(y.x,m.x,_),b=e.number(y.y,m.y,_);var w=new e.Anchor(x,b,m.angleTo(y),v);w._round();if(!c||a(t,w,h,c,r)){return w}else{return}}p+=g}}function f(e,t,r,i,n,a,o,u,f){var h=s(i,a,o);var p=l(i,n);var d=p*o;var v=e[0].x===0||e[0].x===f||e[0].y===0||e[0].y===f;if(t-d<t/4){t=d+t/4}var y=a*2;var m=!v?(p/2+y)*o*u%t:t/2*u%t;return c(e,m,t,h,r,d,v,false,f)}function c(t,r,i,n,s,l,u,f,h){var p=l/2;var d=o(t);var v=0,y=r-i;var m=[];for(var g=0;g<t.length-1;g++){var _=t[g],x=t[g+1];var b=_.dist(x),w=x.angleTo(_);while(y+i<v+b){y+=i;var S=(y-v)/b,C=e.number(_.x,x.x,S),T=e.number(_.y,x.y,S);if(C>=0&&C<h&&T>=0&&T<h&&y-p>=0&&y+p<=d){var P=new e.Anchor(C,T,w,g);P._round();if(!n||a(t,P,l,n,s)){m.push(P)}}}v+=b}if(!f&&!m.length&&!u){m=c(t,v/2,i,n,s,l,u,true,h)}return m}function h(t,r,i,n,a){var o=[];for(var s=0;s<t.length;s++){var l=t[s];var u=void 0;for(var f=0;f<l.length-1;f++){var c=l[f];var h=l[f+1];if(c.x<r&&h.x<r){continue}else if(c.x<r){c=new e.Point(r,c.y+(h.y-c.y)*((r-c.x)/(h.x-c.x)))._round()}else if(h.x<r){h=new e.Point(r,c.y+(h.y-c.y)*((r-c.x)/(h.x-c.x)))._round()}if(c.y<i&&h.y<i){continue}else if(c.y<i){c=new e.Point(c.x+(h.x-c.x)*((i-c.y)/(h.y-c.y)),i)._round()}else if(h.y<i){h=new e.Point(c.x+(h.x-c.x)*((i-c.y)/(h.y-c.y)),i)._round()}if(c.x>=n&&h.x>=n){continue}else if(c.x>=n){c=new e.Point(n,c.y+(h.y-c.y)*((n-c.x)/(h.x-c.x)))._round()}else if(h.x>=n){h=new e.Point(n,c.y+(h.y-c.y)*((n-c.x)/(h.x-c.x)))._round()}if(c.y>=a&&h.y>=a){continue}else if(c.y>=a){c=new e.Point(c.x+(h.x-c.x)*((a-c.y)/(h.y-c.y)),a)._round()}else if(h.y>=a){h=new e.Point(c.x+(h.x-c.x)*((a-c.y)/(h.y-c.y)),a)._round()}if(!u||!c.equals(u[u.length-1])){u=[c];o.push(u)}u.push(h)}}return o}function p(t,r,i,n,a,o){var s=r.image;var l=i.layout;var u=1;var f=r.top-u/s.pixelRatio;var c=r.left-u/s.pixelRatio;var h=r.bottom+u/s.pixelRatio;var p=r.right+u/s.pixelRatio;var d,v,y,m;if(l.get("icon-text-fit")!=="none"&&a){var g=p-c,_=h-f,x=l.get("text-size").evaluate(o,{})/24,b=a.left*x,w=a.right*x,S=a.top*x,C=a.bottom*x,T=w-b,P=C-S,M=l.get("icon-text-fit-padding")[0],I=l.get("icon-text-fit-padding")[1],A=l.get("icon-text-fit-padding")[2],L=l.get("icon-text-fit-padding")[3],E=l.get("icon-text-fit")==="width"?(P-_)*.5:0,k=l.get("icon-text-fit")==="height"?(T-g)*.5:0,D=l.get("icon-text-fit")==="width"||l.get("icon-text-fit")==="both"?T:g,B=l.get("icon-text-fit")==="height"||l.get("icon-text-fit")==="both"?P:_;d=new e.Point(b+k-L,S+E-M);v=new e.Point(b+k+I+D,S+E-M);y=new e.Point(b+k+I+D,S+E+A+B);m=new e.Point(b+k-L,S+E+A+B)}else{d=new e.Point(c,f);v=new e.Point(p,f);y=new e.Point(p,h);m=new e.Point(c,h)}var R=i.layout.get("icon-rotate").evaluate(o,{})*Math.PI/180;if(R){var F=Math.sin(R),O=Math.cos(R),z=[O,-F,F,O];d._matMult(z);v._matMult(z);m._matMult(z);y._matMult(z)}return[{tl:d,tr:v,bl:m,br:y,tex:s.paddedRect,writingMode:undefined,glyphOffset:[0,0]}]}function d(t,r,i,n,a,o){var s=24;var l=i.layout.get("text-rotate").evaluate(a,{})*Math.PI/180;var u=i.layout.get("text-offset").evaluate(a,{}).map(function(e){return e*s});var f=r.positionedGlyphs;var c=[];for(var h=0;h<f.length;h++){var p=f[h];var d=o[p.fontStack];var v=d&&d[p.glyph];if(!v){continue}var y=v.rect;if(!y){continue}var m=1;var g=e.GLYPH_PBF_BORDER+m;var _=v.metrics.advance*p.scale/2;var x=n?[p.x+_,p.y]:[0,0];var b=n?[0,0]:[p.x+_+u[0],p.y+u[1]];var w=(v.metrics.left-g)*p.scale-_+b[0];var S=(-v.metrics.top-g)*p.scale+b[1];var C=w+y.w*p.scale;var T=S+y.h*p.scale;var P=new e.Point(w,S);var M=new e.Point(C,S);var I=new e.Point(w,T);var A=new e.Point(C,T);if(n&&p.vertical){var L=new e.Point(-_,_);var E=-Math.PI/2;var k=new e.Point(5,0);P._rotateAround(E,L)._add(k);M._rotateAround(E,L)._add(k);I._rotateAround(E,L)._add(k);A._rotateAround(E,L)._add(k)}if(l){var D=Math.sin(l),B=Math.cos(l),R=[B,-D,D,B];P._matMult(R);M._matMult(R);I._matMult(R);A._matMult(R)}c.push({tl:P,tr:M,bl:I,br:A,tex:y,writingMode:r.writingMode,glyphOffset:x})}return c}var v=function t(r,i,n,a,o,s,l,u,f,c,h,p){var d=l.top*u-f;var v=l.bottom*u+f;var y=l.left*u-f;var m=l.right*u+f;this.boxStartIndex=r.length;if(c){var g=v-d;var _=m-y;if(g>0){g=Math.max(10*u,g);this._addLineCollisionCircles(r,i,n,n.segment,_,g,a,o,s,h)}}else{if(p){var x=new e.Point(y,d);var b=new e.Point(m,d);var w=new e.Point(y,v);var S=new e.Point(m,v);var C=p*Math.PI/180;x._rotate(C);b._rotate(C);w._rotate(C);S._rotate(C);y=Math.min(x.x,b.x,w.x,S.x);m=Math.max(x.x,b.x,w.x,S.x);d=Math.min(x.y,b.y,w.y,S.y);v=Math.max(x.y,b.y,w.y,S.y)}r.emplaceBack(n.x,n.y,y,d,m,v,a,o,s,0,0)}this.boxEndIndex=r.length};v.prototype._addLineCollisionCircles=function e(t,r,i,n,a,o,s,l,u,f){var c=o/2;var h=Math.floor(a/c)||1;var p=1+.4*Math.log(f)/Math.LN2;var d=Math.floor(h*p/2);var v=-o/2;var y=i;var m=n+1;var g=v;var _=-a/2;var x=_-a/4;do{m--;if(m<0){if(g>_){return}else{m=0;break}}else{g-=r[m].dist(y);y=r[m]}}while(g>x);var b=r[m].dist(r[m+1]);for(var w=-d;w<h+d;w++){var S=w*c;var C=_+S;if(S<0){C+=S}if(S>a){C+=S-a}if(C<g){continue}while(g+b<C){g+=b;m++;if(m+1>=r.length){return}b=r[m].dist(r[m+1])}var T=C-g;var P=r[m];var M=r[m+1];var I=M.sub(P)._unit()._mult(T)._add(P)._round();var A=Math.abs(C-v)<c?0:(C-v)*.8;t.emplaceBack(I.x,I.y,-o/2,-o/2,o/2,o/2,s,l,u,o/2,A)}};"use strict";var y=g;var m=g;function g(e,t){var r=this;if(!(this instanceof g)){return new g(e,t)}this.data=e||[];this.length=this.data.length;this.compare=t||_;if(this.length>0){for(var i=(this.length>>1)-1;i>=0;i--){r._down(i)}}}function _(e,t){return e<t?-1:e>t?1:0}g.prototype={push:function e(t){this.data.push(t);this.length++;this._up(this.length-1)},pop:function e(){if(this.length===0){return undefined}var t=this.data[0];this.length--;if(this.length>0){this.data[0]=this.data[this.length];this._down(0)}this.data.pop();return t},peek:function e(){return this.data[0]},_up:function e(t){var r=this.data;var i=this.compare;var n=r[t];while(t>0){var a=t-1>>1;var o=r[a];if(i(n,o)>=0){break}r[t]=o;t=a}r[t]=n},_down:function e(t){var r=this;var i=this.data;var n=this.compare;var a=this.length>>1;var o=i[t];while(t<a){var s=(t<<1)+1;var l=s+1;var u=i[s];if(l<r.length&&n(i[l],u)<0){s=l;u=i[l]}if(n(u,o)>=0){break}i[t]=u;t=s}i[t]=o}};y.default=m;function x(t,r,i){if(r===void 0)r=1;if(i===void 0)i=false;var n=Infinity,a=Infinity,o=-Infinity,s=-Infinity;var l=t[0];for(var u=0;u<l.length;u++){var f=l[u];if(!u||f.x<n){n=f.x}if(!u||f.y<a){a=f.y}if(!u||f.x>o){o=f.x}if(!u||f.y>s){s=f.y}}var c=o-n;var h=s-a;var p=Math.min(c,h);var d=p/2;var v=new y(null,b);if(p===0){return new e.Point(n,a)}for(var m=n;m<o;m+=p){for(var g=a;g<s;g+=p){v.push(new w(m+d,g+d,d,t))}}var _=C(t);var x=v.length;while(v.length){var S=v.pop();if(S.d>_.d||!_.d){_=S;if(i){console.log("found best %d after %d probes",Math.round(1e4*S.d)/1e4,x)}}if(S.max-_.d<=r){continue}d=S.h/2;v.push(new w(S.p.x-d,S.p.y-d,d,t));v.push(new w(S.p.x+d,S.p.y-d,d,t));v.push(new w(S.p.x-d,S.p.y+d,d,t));v.push(new w(S.p.x+d,S.p.y+d,d,t));x+=4}if(i){console.log("num probes: "+x);console.log("best distance: "+_.d)}return _.p}function b(e,t){return t.max-e.max}function w(t,r,i,n){this.p=new e.Point(t,r);this.h=i;this.d=S(this.p,n);this.max=this.d+this.h*Math.SQRT2}function S(t,r){var i=false;var n=Infinity;for(var a=0;a<r.length;a++){var o=r[a];for(var s=0,l=o.length,u=l-1;s<l;u=s++){var f=o[s];var c=o[u];if(f.y>t.y!==c.y>t.y&&t.x<(c.x-f.x)*(t.y-f.y)/(c.y-f.y)+f.x){i=!i}n=Math.min(n,e.distToSegmentSquared(t,f,c))}}return(i?1:-1)*Math.sqrt(n)}function C(e){var t=0;var r=0;var i=0;var n=e[0];for(var a=0,o=n.length,s=o-1;a<o;s=a++){var l=n[a];var u=n[s];var f=l.x*u.y-u.x*l.y;r+=(l.x+u.x)*f;i+=(l.y+u.y)*f;t+=f*3}return new w(r/t,i/t,0,e)}var T=e.createCommonjsModule(function(e){function t(e,t){var r,i,n,a,o,s,l,u,f,c;r=e.length&3;i=e.length-r;n=t;o=3432918353;l=461845907;c=0;while(c<i){f=e.charCodeAt(c)&255|(e.charCodeAt(++c)&255)<<8|(e.charCodeAt(++c)&255)<<16|(e.charCodeAt(++c)&255)<<24;++c;f=(f&65535)*o+(((f>>>16)*o&65535)<<16)&4294967295;f=f<<15|f>>>17;f=(f&65535)*l+(((f>>>16)*l&65535)<<16)&4294967295;n^=f;n=n<<13|n>>>19;a=(n&65535)*5+(((n>>>16)*5&65535)<<16)&4294967295;n=(a&65535)+27492+(((a>>>16)+58964&65535)<<16)}f=0;switch(r){case 3:f^=(e.charCodeAt(c+2)&255)<<16;case 2:f^=(e.charCodeAt(c+1)&255)<<8;case 1:f^=e.charCodeAt(c)&255;f=(f&65535)*o+(((f>>>16)*o&65535)<<16)&4294967295;f=f<<15|f>>>17;f=(f&65535)*l+(((f>>>16)*l&65535)<<16)&4294967295;n^=f}n^=e.length;n^=n>>>16;n=(n&65535)*2246822507+(((n>>>16)*2246822507&65535)<<16)&4294967295;n^=n>>>13;n=(n&65535)*3266489909+(((n>>>16)*3266489909&65535)<<16)&4294967295;n^=n>>>16;return n>>>0}if(true){e.exports=t}});var P=e.createCommonjsModule(function(e){function t(e,t){var r=e.length,i=t^r,n=0,a;while(r>=4){a=e.charCodeAt(n)&255|(e.charCodeAt(++n)&255)<<8|(e.charCodeAt(++n)&255)<<16|(e.charCodeAt(++n)&255)<<24;a=(a&65535)*1540483477+(((a>>>16)*1540483477&65535)<<16);a^=a>>>24;a=(a&65535)*1540483477+(((a>>>16)*1540483477&65535)<<16);i=(i&65535)*1540483477+(((i>>>16)*1540483477&65535)<<16)^a;r-=4;++n}switch(r){case 3:i^=(e.charCodeAt(n+2)&255)<<16;case 2:i^=(e.charCodeAt(n+1)&255)<<8;case 1:i^=e.charCodeAt(n)&255;i=(i&65535)*1540483477+(((i>>>16)*1540483477&65535)<<16)}i^=i>>>13;i=(i&65535)*1540483477+(((i>>>16)*1540483477&65535)<<16);i^=i>>>15;return i>>>0}if("object"!==undefined){e.exports=t}});var M=T;var I=T;var A=P;M.murmur3=I;M.murmur2=A;function L(t,r,i,n,a,o){t.createArrays();var s=512*t.overscaling;t.tilePixelRatio=e.EXTENT/s;t.compareText={};t.iconsNeedLinear=false;var l=t.layers[0].layout;var u=t.layers[0]._unevaluatedLayout._values;var f={};if(t.textSizeData.functionType==="composite"){var c=t.textSizeData.zoomRange;var h=c.min;var p=c.max;f.compositeTextSizes=[u["text-size"].possiblyEvaluate(new e.EvaluationParameters(h)),u["text-size"].possiblyEvaluate(new e.EvaluationParameters(p))]}if(t.iconSizeData.functionType==="composite"){var d=t.iconSizeData.zoomRange;var v=d.min;var y=d.max;f.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new e.EvaluationParameters(v)),u["icon-size"].possiblyEvaluate(new e.EvaluationParameters(y))]}f.layoutTextSize=u["text-size"].possiblyEvaluate(new e.EvaluationParameters(t.zoom+1));f.layoutIconSize=u["icon-size"].possiblyEvaluate(new e.EvaluationParameters(t.zoom+1));f.textMaxSize=u["text-size"].possiblyEvaluate(new e.EvaluationParameters(18));var m=24;var g=l.get("text-line-height")*m;var _=l.get("text-rotation-alignment")==="map"&&l.get("symbol-placement")!=="point";var x=l.get("text-keep-upright");for(var b=0,w=t.features;b<w.length;b+=1){var S=w[b];var C=l.get("text-font").evaluate(S,{}).join(",");var T=i;var P={};var M=S.text;if(M){var I=M.toString();var A=l.get("text-offset").evaluate(S,{}).map(function(e){return e*m});var L=l.get("text-letter-spacing").evaluate(S,{})*m;var k=e.allowsLetterSpacing(I)?L:0;var D=l.get("text-anchor").evaluate(S,{});var B=l.get("text-justify").evaluate(S,{});var R=l.get("symbol-placement")==="point"?l.get("text-max-width").evaluate(S,{})*m:0;P.horizontal=e.shapeText(M,r,C,R,g,D,B,k,A,m,e.WritingMode.horizontal);if(e.allowsVerticalWritingMode(I)&&_&&x){P.vertical=e.shapeText(M,r,C,R,g,D,B,k,A,m,e.WritingMode.vertical)}}var F=void 0;if(S.icon){var O=n[S.icon];if(O){F=e.shapeIcon(a[S.icon],l.get("icon-offset").evaluate(S,{}),l.get("icon-anchor").evaluate(S,{}));if(t.sdfIcons===undefined){t.sdfIcons=O.sdf}else if(t.sdfIcons!==O.sdf){e.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer")}if(O.pixelRatio!==t.pixelRatio){t.iconsNeedLinear=true}else if(l.get("icon-rotate").constantOr(1)!==0){t.iconsNeedLinear=true}}}if(P.horizontal||F){E(t,S,P,F,T,f)}}if(o){t.generateCollisionDebugBuffers()}}function E(t,r,i,n,a,o){var s=o.layoutTextSize.evaluate(r,{});var l=o.layoutIconSize.evaluate(r,{});var c=o.textMaxSize.evaluate(r,{});if(c===undefined){c=s}var p=t.layers[0].layout;var d=p.get("text-offset").evaluate(r,{});var v=p.get("icon-offset").evaluate(r,{});var y=24,m=s/y,g=t.tilePixelRatio*m,_=t.tilePixelRatio*c/y,b=t.tilePixelRatio*l,w=t.tilePixelRatio*p.get("symbol-spacing"),S=p.get("text-padding")*t.tilePixelRatio,C=p.get("icon-padding")*t.tilePixelRatio,T=p.get("text-max-angle")/180*Math.PI,P=p.get("text-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point",M=p.get("icon-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point",I=p.get("symbol-placement"),A=w/2;var L=function s(l,u){if(u.x<0||u.x>=e.EXTENT||u.y<0||u.y>=e.EXTENT){return}O(t,u,l,i,n,t.layers[0],t.collisionBoxArray,r.index,r.sourceLayerIndex,t.index,g,S,P,d,b,C,M,v,r,a,o)};if(I==="line"){for(var E=0,k=h(r.geometry,0,0,e.EXTENT,e.EXTENT);E<k.length;E+=1){var D=k[E];var B=f(D,w,T,i.vertical||i.horizontal,n,y,_,t.overscaling,e.EXTENT);for(var R=0,F=B;R<F.length;R+=1){var z=F[R];var N=i.horizontal;if(!N||!U(t,N.text,A,z)){L(D,z)}}}}else if(I==="line-center"){for(var j=0,V=r.geometry;j<V.length;j+=1){var G=V[j];if(G.length>1){var Z=u(G,T,i.vertical||i.horizontal,n,y,_);if(Z){L(G,Z)}}}}else if(r.type==="Polygon"){for(var q=0,H=e.classifyRings(r.geometry,0);q<H.length;q+=1){var W=H[q];var X=x(W,16);L(W[0],new e.Anchor(X.x,X.y,0))}}else if(r.type==="LineString"){for(var Y=0,K=r.geometry;Y<K.length;Y+=1){var J=K[Y];L(J,new e.Anchor(J[0].x,J[0].y,0))}}else if(r.type==="Point"){for(var $=0,Q=r.geometry;$<Q.length;$+=1){var ee=Q[$];for(var te=0,re=ee;te<re.length;te+=1){var ie=re[te];L([ie],new e.Anchor(ie.x,ie.y,0))}}}}var D=65535;function R(t,r,i,n,a,o,s,l,u,f,c,h){var p=d(r,i,n,a,o,c);var v=t.textSizeData;var y=null;if(v.functionType==="source"){y=[e.SIZE_PACK_FACTOR*n.layout.get("text-size").evaluate(o,{})];if(y[0]>D){e.warnOnce(t.layerIds[0]+': Value for "text-size" is >= 256. Reduce your "text-size".')}}else if(v.functionType==="composite"){y=[e.SIZE_PACK_FACTOR*h.compositeTextSizes[0].evaluate(o,{}),e.SIZE_PACK_FACTOR*h.compositeTextSizes[1].evaluate(o,{})];if(y[0]>D||y[1]>D){e.warnOnce(t.layerIds[0]+': Value for "text-size" is >= 256. Reduce your "text-size".')}}t.addSymbols(t.text,p,y,s,a,o,u,r,l.lineStartIndex,l.lineLength);f.push(t.text.placedSymbolArray.length-1);return p.length*4}function O(t,r,i,n,a,o,s,l,u,f,c,h,d,y,m,g,_,x,b,w,S){var C=t.addToLineVertexArray(r,i);var T,P;var I=0;var A=0;var L=0;var E=M(n.horizontal?n.horizontal.text:"");var k=[];if(n.horizontal){var B=o.layout.get("text-rotate").evaluate(b,{});T=new v(s,i,r,l,u,f,n.horizontal,c,h,d,t.overscaling,B);A+=R(t,r,n.horizontal,o,d,b,y,C,n.vertical?e.WritingMode.horizontal:e.WritingMode.horizontalOnly,k,w,S);if(n.vertical){L+=R(t,r,n.vertical,o,d,b,y,C,e.WritingMode.vertical,k,w,S)}}var F=T?T.boxStartIndex:t.collisionBoxArray.length;var O=T?T.boxEndIndex:t.collisionBoxArray.length;if(a){var z=p(r,a,o,_,n.horizontal,b);var U=o.layout.get("icon-rotate").evaluate(b,{});P=new v(s,i,r,l,u,f,a,m,g,false,t.overscaling,U);I=z.length*4;var N=t.iconSizeData;var j=null;if(N.functionType==="source"){j=[e.SIZE_PACK_FACTOR*o.layout.get("icon-size").evaluate(b,{})];if(j[0]>D){e.warnOnce(t.layerIds[0]+': Value for "icon-size" is >= 256. Reduce your "icon-size".')}}else if(N.functionType==="composite"){j=[e.SIZE_PACK_FACTOR*S.compositeIconSizes[0].evaluate(b,{}),e.SIZE_PACK_FACTOR*S.compositeIconSizes[1].evaluate(b,{})];if(j[0]>D||j[1]>D){e.warnOnce(t.layerIds[0]+': Value for "icon-size" is >= 256. Reduce your "icon-size".')}}t.addSymbols(t.icon,z,j,x,_,b,false,r,C.lineStartIndex,C.lineLength)}var V=P?P.boxStartIndex:t.collisionBoxArray.length;var G=P?P.boxEndIndex:t.collisionBoxArray.length;if(t.glyphOffsetArray.length>=e.SymbolBucket.MAX_GLYPHS){e.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907")}t.symbolInstances.emplaceBack(r.x,r.y,k.length>0?k[0]:-1,k.length>1?k[1]:-1,E,F,O,V,G,l,A,L,I,0)}function U(e,t,r,i){var n=e.compareText;if(!(t in n)){n[t]=[]}else{var a=n[t];for(var o=a.length-1;o>=0;o--){if(i.dist(a[o])<r){return true}}}n[t].push(i);return false}var N=1;var j=function t(r){var i={};var n=[];for(var a in r){var o=r[a];var s=i[a]={};for(var l in o){var u=o[+l];if(!u||u.bitmap.width===0||u.bitmap.height===0){continue}var f={x:0,y:0,w:u.bitmap.width+2*N,h:u.bitmap.height+2*N};n.push(f);s[l]={rect:f,metrics:u.metrics}}}var c=e.potpack(n);var h=c.w;var p=c.h;var d=new e.AlphaImage({width:h||1,height:p||1});for(var v in r){var y=r[v];for(var m in y){var g=y[+m];if(!g||g.bitmap.width===0||g.bitmap.height===0){continue}var _=i[v][m].rect;e.AlphaImage.copy(g.bitmap,d,{x:0,y:0},{x:_.x+N,y:_.y+N},g.bitmap)}}this.image=d;this.positions=i};e.register("GlyphAtlas",j);var V=function t(r){this.tileID=new e.OverscaledTileID(r.tileID.overscaledZ,r.tileID.wrap,r.tileID.canonical.z,r.tileID.canonical.x,r.tileID.canonical.y);this.uid=r.uid;this.zoom=r.zoom;this.pixelRatio=r.pixelRatio;this.tileSize=r.tileSize;this.source=r.source;this.overscaling=this.tileID.overscaleFactor();this.showCollisionBoxes=r.showCollisionBoxes;this.collectResourceTiming=!!r.collectResourceTiming;this.returnDependencies=!!r.returnDependencies};V.prototype.parse=function t(r,i,n,a){var o=this;this.status="parsing";this.data=r;this.collisionBoxArray=new e.CollisionBoxArray;var s=new e.DictionaryCoder((0,k.default)(r.layers).sort());var l=new e.FeatureIndex(this.tileID);l.bucketLayerIDs=[];var u={};var f={featureIndex:l,iconDependencies:{},patternDependencies:{},glyphDependencies:{}};var c=i.familiesBySource[this.source];for(var h in c){var p=r.layers[h];if(!p){continue}if(p.version===1){e.warnOnce('Vector tile source "'+o.source+'" layer "'+h+'" '+"does not use vector tile spec v2 and therefore may have some rendering errors.")}var d=s.encode(h);var v=[];for(var y=0;y<p.length;y++){var m=p.feature(y);v.push({feature:m,index:y,sourceLayerIndex:d})}for(var g=0,_=c[h];g<_.length;g+=1){var x=_[g];var b=x[0];e.assert(b.source===o.source);if(b.minzoom&&o.zoom<Math.floor(b.minzoom)){continue}if(b.maxzoom&&o.zoom>=b.maxzoom){continue}if(b.visibility==="none"){continue}G(x,o.zoom);var w=u[b.id]=b.createBucket({index:l.bucketLayerIDs.length,layers:x,zoom:o.zoom,pixelRatio:o.pixelRatio,overscaling:o.overscaling,collisionBoxArray:o.collisionBoxArray,sourceLayerIndex:d,sourceID:o.source});w.populate(v,f);l.bucketLayerIDs.push(x.map(function(e){return e.id}))}}var S;var C;var T;var P;var M=e.mapObject(f.glyphDependencies,function(e){return(0,k.default)(e).map(Number)});if((0,k.default)(M).length){n.send("getGlyphs",{uid:this.uid,stacks:M},function(e,t){if(!S){S=e;C=t;E.call(o)}})}else{C={}}var I=(0,k.default)(f.iconDependencies);if(I.length){n.send("getImages",{icons:I},function(e,t){if(!S){S=e;T=t;E.call(o)}})}else{T={}}var A=(0,k.default)(f.patternDependencies);if(A.length){n.send("getImages",{icons:A},function(e,t){if(!S){S=e;P=t;E.call(o)}})}else{P={}}E.call(this);function E(){var t=this;if(S){return a(S)}else if(C&&T&&P){var r=new j(C);var i=new e.ImageAtlas(T,P);for(var n in u){var o=u[n];if(o instanceof e.SymbolBucket){G(o.layers,t.zoom);L(o,C,r.positions,T,i.iconPositions,t.showCollisionBoxes)}else if(o.hasPattern&&(o instanceof e.LineBucket||o instanceof e.FillBucket||o instanceof e.FillExtrusionBucket)){G(o.layers,t.zoom);o.addFeatures(f,i.patternPositions)}}this.status="done";a(null,{buckets:e.values(u).filter(function(e){return!e.isEmpty()}),featureIndex:l,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:r.image,imageAtlas:i,glyphMap:this.returnDependencies?C:null,iconMap:this.returnDependencies?T:null,glyphPositions:this.returnDependencies?r.positions:null})}}};function G(t,r){var i=new e.EvaluationParameters(r);for(var n=0,a=t;n<a.length;n+=1){var o=a[n];o.recalculate(i)}}var Z=typeof performance!=="undefined";var q={};q.getEntriesByName=function(e){if(Z&&performance&&performance.getEntriesByName){return performance.getEntriesByName(e)}else{return false}};q.mark=function(e){if(Z&&performance&&performance.mark){return performance.mark(e)}else{return false}};q.measure=function(e,t,r){if(Z&&performance&&performance.measure){return performance.measure(e,t,r)}else{return false}};q.clearMarks=function(e){if(Z&&performance&&performance.clearMarks){return performance.clearMarks(e)}else{return false}};q.clearMeasures=function(e){if(Z&&performance&&performance.clearMeasures){return performance.clearMeasures(e)}else{return false}};var H=function e(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()};q.mark(this._marks.start)};H.prototype.finish=function e(){q.mark(this._marks.end);var t=q.getEntriesByName(this._marks.measure);if(t.length===0){q.measure(this._marks.measure,this._marks.start,this._marks.end);t=q.getEntriesByName(this._marks.measure);q.clearMarks(this._marks.start);q.clearMarks(this._marks.end);q.clearMeasures(this._marks.measure)}return t};q.Performance=H;function W(t,r){var i=e.getArrayBuffer(t.request,function(t,i,n,a){if(t){r(t)}else if(i){r(null,{vectorTile:new e.mvt.VectorTile(new e.Protobuf(i)),rawData:i,cacheControl:n,expires:a})}});return function(){i.cancel();r()}}var X=function e(t,r,i){this.actor=t;this.layerIndex=r;this.loadVectorData=i||W;this.loading={};this.loaded={}};X.prototype.loadTile=function t(r,i){var n=this;var a=r.uid;if(!this.loading){this.loading={}}var o=r&&r.request&&r.request.collectResourceTiming?new q.Performance(r.request):false;var s=this.loading[a]=new V(r);s.abort=this.loadVectorData(r,function(t,r){delete n.loading[a];if(t||!r){s.status="done";n.loaded[a]=s;return i(t)}var l=r.rawData;var u={};if(r.expires){u.expires=r.expires}if(r.cacheControl){u.cacheControl=r.cacheControl}var f={};if(o){var c=o.finish();if(c){f.resourceTiming=JSON.parse((0,B.default)(c))}}s.vectorTile=r.vectorTile;s.parse(r.vectorTile,n.layerIndex,n.actor,function(t,r){if(t||!r){return i(t)}i(null,e.extend({rawTileData:l.slice(0)},r,u,f))});n.loaded=n.loaded||{};n.loaded[a]=s})};X.prototype.reloadTile=function e(t,r){var i=this.loaded,n=t.uid,a=this;if(i&&i[n]){var o=i[n];o.showCollisionBoxes=t.showCollisionBoxes;var s=function e(t,i){var n=o.reloadCallback;if(n){delete o.reloadCallback;o.parse(o.vectorTile,a.layerIndex,a.actor,n)}r(t,i)};if(o.status==="parsing"){o.reloadCallback=s}else if(o.status==="done"){if(o.vectorTile){o.parse(o.vectorTile,this.layerIndex,this.actor,s)}else{s()}}}};X.prototype.abortTile=function e(t,r){var i=this.loading,n=t.uid;if(i&&i[n]&&i[n].abort){i[n].abort();delete i[n]}r()};X.prototype.removeTile=function e(t,r){var i=this.loaded,n=t.uid;if(i&&i[n]){delete i[n]}r()};var Y=function e(){this.loaded={}};Y.prototype.loadTile=function t(r,i){var n=r.uid;var a=r.encoding;var o=r.rawImageData;var s=new e.DEMData(n,o,a);this.loaded=this.loaded||{};this.loaded[n]=s;i(null,s)};Y.prototype.removeTile=function e(t){var r=this.loaded,i=t.uid;if(r&&r[i]){delete r[i]}};var K=6378137;var J=1/298.257223563;var $=6356752.3142;var Q={RADIUS:K,FLATTENING:J,POLAR_RADIUS:$};var ee=re;var te=ne;function re(e){var t=0,r;switch(e.type){case"Polygon":return ie(e.coordinates);case"MultiPolygon":for(r=0;r<e.coordinates.length;r++){t+=ie(e.coordinates[r])}return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(r=0;r<e.geometries.length;r++){t+=re(e.geometries[r])}return t}}function ie(e){var t=0;if(e&&e.length>0){t+=Math.abs(ne(e[0]));for(var r=1;r<e.length;r++){t-=Math.abs(ne(e[r]))}}return t}function ne(e){var t,r,i,n,a,o,s,l=0,u=e.length;if(u>2){for(s=0;s<u;s++){if(s===u-2){n=u-2;a=u-1;o=0}else if(s===u-1){n=u-1;a=0;o=1}else{n=s;a=s+1;o=s+2}t=e[n];r=e[a];i=e[o];l+=(ae(i[0])-ae(t[0]))*Math.sin(ae(r[1]))}l=l*Q.RADIUS*Q.RADIUS/2}return l}function ae(e){return e*Math.PI/180}var oe={geometry:ee,ring:te};var se=le;function le(e,t){switch(e&&e.type||null){case"FeatureCollection":e.features=e.features.map(ue(le,t));return e;case"Feature":e.geometry=le(e.geometry,t);return e;case"Polygon":case"MultiPolygon":return fe(e,t);default:return e}}function ue(e,t){return function(r){return e(r,t)}}function fe(e,t){if(e.type==="Polygon"){e.coordinates=ce(e.coordinates,t)}else if(e.type==="MultiPolygon"){e.coordinates=e.coordinates.map(ue(ce,t))}return e}function ce(e,t){t=!!t;e[0]=he(e[0],t);for(var r=1;r<e.length;r++){e[r]=he(e[r],!t)}return e}function he(e,t){return pe(e)===t?e:e.reverse()}function pe(e){return oe.ring(e)>=0}var de=e.mvt.VectorTileFeature.prototype.toGeoJSON;var ve=function t(r){this._feature=r;this.extent=e.EXTENT;this.type=r.type;this.properties=r.tags;if("id"in r&&!isNaN(r.id)){this.id=parseInt(r.id,10)}};ve.prototype.loadGeometry=function t(){var r=this;if(this._feature.type===1){var i=[];for(var n=0,a=r._feature.geometry;n<a.length;n+=1){var o=a[n];i.push([new e.Point(o[0],o[1])])}return i}else{var s=[];for(var l=0,u=r._feature.geometry;l<u.length;l+=1){var f=u[l];var c=[];for(var h=0,p=f;h<p.length;h+=1){var d=p[h];c.push(new e.Point(d[0],d[1]))}s.push(c)}return s}};ve.prototype.toGeoJSON=function e(t,r,i){return de.call(this,t,r,i)};var ye=function t(r){this.layers={_geojsonTileLayer:this};this.name="_geojsonTileLayer";this.extent=e.EXTENT;this.length=r.length;this._features=r};ye.prototype.feature=function e(t){return new ve(this._features[t])};"use strict";var me=e.vectorTile.VectorTileFeature;var ge=_e;function _e(e,t){this.options=t||{};this.features=e;this.length=e.length}_e.prototype.feature=function(e){return new xe(this.features[e],this.options.extent)};function xe(e,t){this.id=typeof e.id==="number"?e.id:undefined;this.type=e.type;this.rawGeometry=e.type===1?[e.geometry]:e.geometry;this.properties=e.tags;this.extent=t||4096}xe.prototype.loadGeometry=function(){var t=this;var r=this.rawGeometry;this.geometry=[];for(var i=0;i<r.length;i++){var n=r[i];var a=[];for(var o=0;o<n.length;o++){a.push(new e.Point$1(n[o][0],n[o][1]))}t.geometry.push(a)}return this.geometry};xe.prototype.bbox=function(){if(!this.geometry){this.loadGeometry()}var e=this.geometry;var t=Infinity;var r=-Infinity;var i=Infinity;var n=-Infinity;for(var a=0;a<e.length;a++){var o=e[a];for(var s=0;s<o.length;s++){var l=o[s];t=Math.min(t,l.x);r=Math.max(r,l.x);i=Math.min(i,l.y);n=Math.max(n,l.y)}}return[t,i,r,n]};xe.prototype.toGeoJSON=me.prototype.toGeoJSON;var be=Te;var we=Te;var Se=Pe;var Ce=ge;function Te(t){var r=new e._pbf_3_1_0_pbf;Me(t,r);return r.finish()}function Pe(e,t){t=t||{};var r={};for(var i in e){r[i]=new ge(e[i].features,t);r[i].name=i;r[i].version=t.version;r[i].extent=t.extent}return Te({layers:r})}function Me(e,t){for(var r in e.layers){t.writeMessage(3,Ie,e.layers[r])}}function Ie(e,t){t.writeVarintField(15,e.version||1);t.writeStringField(1,e.name||"");t.writeVarintField(5,e.extent||4096);var r;var i={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++){i.feature=e.feature(r);t.writeMessage(2,Ae,i)}var n=i.keys;for(r=0;r<n.length;r++){t.writeStringField(3,n[r])}var a=i.values;for(r=0;r<a.length;r++){t.writeMessage(4,Be,a[r])}}function Ae(e,t){var r=e.feature;if(r.id!==undefined){t.writeVarintField(1,r.id)}t.writeMessage(2,Le,e);t.writeVarintField(3,r.type);t.writeMessage(4,De,r)}function Le(e,t){var r=e.feature;var i=e.keys;var n=e.values;var a=e.keycache;var o=e.valuecache;for(var s in r.properties){var l=a[s];if(typeof l==="undefined"){i.push(s);l=i.length-1;a[s]=l}t.writeVarint(l);var u=r.properties[s];var f=typeof u==="undefined"?"undefined":(0,z.default)(u);if(f!=="string"&&f!=="boolean"&&f!=="number"){u=(0,B.default)(u)}var c=f+":"+u;var h=o[c];if(typeof h==="undefined"){n.push(u);h=n.length-1;o[c]=h}t.writeVarint(h)}}function Ee(e,t){return(t<<3)+(e&7)}function ke(e){return e<<1^e>>31}function De(e,t){var r=e.loadGeometry();var i=e.type;var n=0;var a=0;var o=r.length;for(var s=0;s<o;s++){var l=r[s];var u=1;if(i===1){u=l.length}t.writeVarint(Ee(1,u));var f=i===3?l.length-1:l.length;for(var c=0;c<f;c++){if(c===1&&i!==1){t.writeVarint(Ee(2,f-1))}var h=l[c].x-n;var p=l[c].y-a;t.writeVarint(ke(h));t.writeVarint(ke(p));n+=h;a+=p}if(i===3){t.writeVarint(Ee(7,1))}}}function Be(e,t){var r=typeof e==="undefined"?"undefined":(0,z.default)(e);if(r==="string"){t.writeStringField(1,e)}else if(r==="boolean"){t.writeBooleanField(7,e)}else if(r==="number"){if(e%1!==0){t.writeDoubleField(3,e)}else if(e<0){t.writeSVarintField(6,e)}else{t.writeVarintField(5,e)}}}be.fromVectorTileJs=we;be.fromGeojsonVt=Se;be.GeoJSONWrapper=Ce;function Re(e,t,r,i,n,a){if(n-i<=r){return}var o=Math.floor((i+n)/2);Fe(e,t,o,i,n,a%2);Re(e,t,r,i,o-1,a+1);Re(e,t,r,o+1,n,a+1)}function Fe(e,t,r,i,n,a){while(n>i){if(n-i>600){var o=n-i+1;var s=r-i+1;var l=Math.log(o);var u=.5*Math.exp(2*l/3);var f=.5*Math.sqrt(l*u*(o-u)/o)*(s-o/2<0?-1:1);var c=Math.max(i,Math.floor(r-s*u/o+f));var h=Math.min(n,Math.floor(r+(o-s)*u/o+f));Fe(e,t,r,c,h,a)}var p=t[2*r+a];var d=i;var v=n;Oe(e,t,i,r);if(t[2*n+a]>p){Oe(e,t,i,n)}while(d<v){Oe(e,t,d,v);d++;v--;while(t[2*d+a]<p){d++}while(t[2*v+a]>p){v--}}if(t[2*i+a]===p){Oe(e,t,i,v)}else{v++;Oe(e,t,v,n)}if(v<=r){i=v+1}if(r<=v){n=v-1}}}function Oe(e,t,r,i){ze(e,r,i);ze(t,2*r,2*i);ze(t,2*r+1,2*i+1)}function ze(e,t,r){var i=e[t];e[t]=e[r];e[r]=i}function Ue(e,t,r,i,n,a,o){var s=[0,e.length-1,0];var l=[];var u,f;while(s.length){var c=s.pop();var h=s.pop();var p=s.pop();if(h-p<=o){for(var d=p;d<=h;d++){u=t[2*d];f=t[2*d+1];if(u>=r&&u<=n&&f>=i&&f<=a){l.push(e[d])}}continue}var v=Math.floor((p+h)/2);u=t[2*v];f=t[2*v+1];if(u>=r&&u<=n&&f>=i&&f<=a){l.push(e[v])}var y=(c+1)%2;if(c===0?r<=u:i<=f){s.push(p);s.push(v-1);s.push(y)}if(c===0?n>=u:a>=f){s.push(v+1);s.push(h);s.push(y)}}return l}function Ne(e,t,r,i,n,a){var o=[0,e.length-1,0];var s=[];var l=n*n;while(o.length){var u=o.pop();var f=o.pop();var c=o.pop();if(f-c<=a){for(var h=c;h<=f;h++){if(je(t[2*h],t[2*h+1],r,i)<=l){s.push(e[h])}}continue}var p=Math.floor((c+f)/2);var d=t[2*p];var v=t[2*p+1];if(je(d,v,r,i)<=l){s.push(e[p])}var y=(u+1)%2;if(u===0?r-n<=d:i-n<=v){o.push(c);o.push(p-1);o.push(y)}if(u===0?r+n>=d:i+n>=v){o.push(p+1);o.push(f);o.push(y)}}return s}function je(e,t,r,i){var n=e-r;var a=t-i;return n*n+a*a}function Ve(e,t,r,i,n){return new Ge(e,t,r,i,n)}function Ge(e,t,r,i,n){var a=this;t=t||Ze;r=r||qe;n=n||Array;this.nodeSize=i||64;this.points=e;this.ids=new n(e.length);this.coords=new n(e.length*2);for(var o=0;o<e.length;o++){a.ids[o]=o;a.coords[2*o]=t(e[o]);a.coords[2*o+1]=r(e[o])}Re(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}Ge.prototype={range:function e(t,r,i,n){return Ue(this.ids,this.coords,t,r,i,n,this.nodeSize)},within:function e(t,r,i){return Ne(this.ids,this.coords,t,r,i,this.nodeSize)}};function Ze(e){return e[0]}function qe(e){return e[1]}function He(e){return new We(e)}function We(e){this.options=rt((0,F.default)(this.options),e);this.trees=new Array(this.options.maxZoom+1)}We.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:false,reduce:null,initial:function e(){return{}},map:function e(t){return t}},load:function e(t){var r=this;var i=this.options.log;if(i){console.time("total time")}var n="prepare "+t.length+" points";if(i){console.time(n)}this.points=t;var a=[];for(var o=0;o<t.length;o++){if(!t[o].geometry){continue}a.push(Ye(t[o],o))}this.trees[this.options.maxZoom+1]=Ve(a,it,nt,this.options.nodeSize,Float32Array);if(i){console.timeEnd(n)}for(var s=this.options.maxZoom;s>=this.options.minZoom;s--){var l=+Date.now();a=r._cluster(a,s);r.trees[s]=Ve(a,it,nt,r.options.nodeSize,Float32Array);if(i){console.log("z%d: %d clusters in %dms",s,a.length,+Date.now()-l)}}if(i){console.timeEnd("total time")}return this},getClusters:function e(t,r){var i=this;var n=((t[0]+180)%360+360)%360-180;var a=Math.max(-90,Math.min(90,t[1]));var o=t[2]===180?180:((t[2]+180)%360+360)%360-180;var s=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360){n=-180;o=180}else if(n>o){var l=this.getClusters([n,a,180,s],r);var u=this.getClusters([-180,a,o,s],r);return l.concat(u)}var f=this.trees[this._limitZoom(r)];var c=f.range($e(n),Qe(s),$e(o),Qe(a));var h=[];for(var p=0;p<c.length;p++){var d=f.points[c[p]];h.push(d.numPoints?Ke(d):i.points[d.index])}return h},getChildren:function e(t){var r=this;var i=t>>5;var n=t%32;var a="No cluster with the specified id.";var o=this.trees[n];if(!o){throw new Error(a)}var s=o.points[i];if(!s){throw new Error(a)}var l=this.options.radius/(this.options.extent*Math.pow(2,n-1));var u=o.within(s.x,s.y,l);var f=[];for(var c=0;c<u.length;c++){var h=o.points[u[c]];if(h.parentId===t){f.push(h.numPoints?Ke(h):r.points[h.index])}}if(f.length===0){throw new Error(a)}return f},getLeaves:function e(t,r,i){r=r||10;i=i||0;var n=[];this._appendLeaves(n,t,r,i,0);return n},getTile:function e(t,r,i){var n=this.trees[this._limitZoom(t)];var a=Math.pow(2,t);var o=this.options.extent;var s=this.options.radius;var l=s/o;var u=(i-l)/a;var f=(i+1+l)/a;var c={features:[]};this._addTileFeatures(n.range((r-l)/a,u,(r+1+l)/a,f),n.points,r,i,a,c);if(r===0){this._addTileFeatures(n.range(1-l/a,u,1,f),n.points,a,i,a,c)}if(r===a-1){this._addTileFeatures(n.range(0,u,l/a,f),n.points,-1,i,a,c)}return c.features.length?c:null},getClusterExpansionZoom:function e(t){var r=this;var i=t%32-1;while(i<this.options.maxZoom){var n=r.getChildren(t);i++;if(n.length!==1){break}t=n[0].properties.cluster_id}return i},_appendLeaves:function e(t,r,i,n,a){var o=this;var s=this.getChildren(r);for(var l=0;l<s.length;l++){var u=s[l].properties;if(u&&u.cluster){if(a+u.point_count<=n){a+=u.point_count}else{a=o._appendLeaves(t,u.cluster_id,i,n,a)}}else if(a<n){a++}else{t.push(s[l])}if(t.length===i){break}}return a},_addTileFeatures:function e(t,r,i,n,a,o){var s=this;for(var l=0;l<t.length;l++){var u=r[t[l]];var f={type:1,geometry:[[Math.round(s.options.extent*(u.x*a-i)),Math.round(s.options.extent*(u.y*a-n))]],tags:u.numPoints?Je(u):s.points[u.index].properties};var c=u.numPoints?u.id:s.points[u.index].id;if(c!==undefined){f.id=c}o.features.push(f)}},_limitZoom:function e(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function e(t,r){var i=this;var n=[];var a=this.options.radius/(this.options.extent*Math.pow(2,r));for(var o=0;o<t.length;o++){var s=t[o];if(s.zoom<=r){continue}s.zoom=r;var l=i.trees[r+1];var u=l.within(s.x,s.y,a);var f=s.numPoints||1;var c=s.x*f;var h=s.y*f;var p=null;if(i.options.reduce){p=i.options.initial();i._accumulate(p,s)}var d=(o<<5)+(r+1);for(var v=0;v<u.length;v++){var y=l.points[u[v]];if(y.zoom<=r){continue}y.zoom=r;var m=y.numPoints||1;c+=y.x*m;h+=y.y*m;f+=m;y.parentId=d;if(i.options.reduce){i._accumulate(p,y)}}if(f===1){n.push(s)}else{s.parentId=d;n.push(Xe(c/f,h/f,d,f,p))}}return n},_accumulate:function e(t,r){var i=r.numPoints?r.properties:this.options.map(this.points[r.index].properties);this.options.reduce(t,i)}};function Xe(e,t,r,i,n){return{x:e,y:t,zoom:Infinity,id:r,parentId:-1,numPoints:i,properties:n}}function Ye(e,t){var r=e.geometry.coordinates;return{x:$e(r[0]),y:Qe(r[1]),zoom:Infinity,index:t,parentId:-1}}function Ke(e){return{type:"Feature",id:e.id,properties:Je(e),geometry:{type:"Point",coordinates:[et(e.x),tt(e.y)]}}}function Je(e){var t=e.numPoints;var r=t>=1e4?Math.round(t/1e3)+"k":t>=1e3?Math.round(t/100)/10+"k":t;return rt(rt({},e.properties),{cluster:true,cluster_id:e.id,point_count:t,point_count_abbreviated:r})}function $e(e){return e/360+.5}function Qe(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function et(e){return(e-.5)*360}function tt(e){var t=(180-e*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function rt(e,t){for(var r in t){e[r]=t[r]}return e}function it(e){return e.x}function nt(e){return e.y}function at(e,t,r,i){var n=i;var a=r-t>>1;var o=r-t;var s;var l=e[t];var u=e[t+1];var f=e[r];var c=e[r+1];for(var h=t+3;h<r;h+=3){var p=ot(e[h],e[h+1],l,u,f,c);if(p>n){s=h;n=p}else if(p===n){var d=Math.abs(h-a);if(d<o){s=h;o=d}}}if(n>i){if(s-t>3){at(e,t,s,i)}e[s+2]=n;if(r-s>3){at(e,s,r,i)}}}function ot(e,t,r,i,n,a){var o=n-r;var s=a-i;if(o!==0||s!==0){var l=((e-r)*o+(t-i)*s)/(o*o+s*s);if(l>1){r=n;i=a}else if(l>0){r+=o*l;i+=s*l}}o=e-r;s=t-i;return o*o+s*s}function st(e,t,r,i){var n={id:typeof e==="undefined"?null:e,type:t,geometry:r,tags:i,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity};lt(n);return n}function lt(e){var t=e.geometry;var r=e.type;if(r==="Point"||r==="MultiPoint"||r==="LineString"){ut(e,t)}else if(r==="Polygon"||r==="MultiLineString"){for(var i=0;i<t.length;i++){ut(e,t[i])}}else if(r==="MultiPolygon"){for(i=0;i<t.length;i++){for(var n=0;n<t[i].length;n++){ut(e,t[i][n])}}}}function ut(e,t){for(var r=0;r<t.length;r+=3){e.minX=Math.min(e.minX,t[r]);e.minY=Math.min(e.minY,t[r+1]);e.maxX=Math.max(e.maxX,t[r]);e.maxY=Math.max(e.maxY,t[r+1])}}function ft(e,t){var r=[];if(e.type==="FeatureCollection"){for(var i=0;i<e.features.length;i++){ct(r,e.features[i],t,i)}}else if(e.type==="Feature"){ct(r,e,t)}else{ct(r,{geometry:e},t)}return r}function ct(e,t,r,i){if(!t.geometry){return}var n=t.geometry.coordinates;var a=t.geometry.type;var o=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2);var s=[];var l=t.id;if(r.promoteId){l=t.properties[r.promoteId]}else if(r.generateId){l=i||0}if(a==="Point"){ht(n,s)}else if(a==="MultiPoint"){for(var u=0;u<n.length;u++){ht(n[u],s)}}else if(a==="LineString"){pt(n,s,o,false)}else if(a==="MultiLineString"){if(r.lineMetrics){for(u=0;u<n.length;u++){s=[];pt(n[u],s,o,false);e.push(st(l,"LineString",s,t.properties))}return}else{dt(n,s,o,false)}}else if(a==="Polygon"){dt(n,s,o,true)}else if(a==="MultiPolygon"){for(u=0;u<n.length;u++){var f=[];dt(n[u],f,o,true);s.push(f)}}else if(a==="GeometryCollection"){for(u=0;u<t.geometry.geometries.length;u++){ct(e,{id:l,geometry:t.geometry.geometries[u],properties:t.properties},r,i)}return}else{throw new Error("Input data is not a valid GeoJSON object.")}e.push(st(l,a,s,t.properties))}function ht(e,t){t.push(vt(e[0]));t.push(yt(e[1]));t.push(0)}function pt(e,t,r,i){var n,a;var o=0;for(var s=0;s<e.length;s++){var l=vt(e[s][0]);var u=yt(e[s][1]);t.push(l);t.push(u);t.push(0);if(s>0){if(i){o+=(n*u-l*a)/2}else{o+=Math.sqrt(Math.pow(l-n,2)+Math.pow(u-a,2))}}n=l;a=u}var f=t.length-3;t[2]=1;at(t,0,f,r);t[f+2]=1;t.size=Math.abs(o);t.start=0;t.end=t.size}function dt(e,t,r,i){for(var n=0;n<e.length;n++){var a=[];pt(e[n],a,r,i);t.push(a)}}function vt(e){return e/360+.5}function yt(e){var t=Math.sin(e*Math.PI/180);var r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function mt(e,t,r,i,n,a,o,s){r/=t;i/=t;if(a>=r&&o<i){return e}else if(o<r||a>=i){return null}var l=[];for(var u=0;u<e.length;u++){var f=e[u];var c=f.geometry;var h=f.type;var p=n===0?f.minX:f.minY;var d=n===0?f.maxX:f.maxY;if(p>=r&&d<i){l.push(f);continue}else if(d<r||p>=i){continue}var v=[];if(h==="Point"||h==="MultiPoint"){gt(c,v,r,i,n)}else if(h==="LineString"){_t(c,v,r,i,n,false,s.lineMetrics)}else if(h==="MultiLineString"){bt(c,v,r,i,n,false)}else if(h==="Polygon"){bt(c,v,r,i,n,true)}else if(h==="MultiPolygon"){for(var y=0;y<c.length;y++){var m=[];bt(c[y],m,r,i,n,true);if(m.length){v.push(m)}}}if(v.length){if(s.lineMetrics&&h==="LineString"){for(y=0;y<v.length;y++){l.push(st(f.id,h,v[y],f.tags))}continue}if(h==="LineString"||h==="MultiLineString"){if(v.length===1){h="LineString";v=v[0]}else{h="MultiLineString"}}if(h==="Point"||h==="MultiPoint"){h=v.length===3?"Point":"MultiPoint"}l.push(st(f.id,h,v,f.tags))}}return l.length?l:null}function gt(e,t,r,i,n){for(var a=0;a<e.length;a+=3){var o=e[a+n];if(o>=r&&o<=i){t.push(e[a]);t.push(e[a+1]);t.push(e[a+2])}}}function _t(e,t,r,i,n,a,o){var s=xt(e);var l=n===0?St:Ct;var u=e.start;var f,c;for(var h=0;h<e.length-3;h+=3){var p=e[h];var d=e[h+1];var v=e[h+2];var y=e[h+3];var m=e[h+4];var g=n===0?p:d;var _=n===0?y:m;var x=false;if(o){f=Math.sqrt(Math.pow(p-y,2)+Math.pow(d-m,2))}if(g<r){if(_>r){c=l(s,p,d,y,m,r);if(o){s.start=u+f*c}}}else if(g>i){if(_<i){c=l(s,p,d,y,m,i);if(o){s.start=u+f*c}}}else{wt(s,p,d,v)}if(_<r&&g>=r){c=l(s,p,d,y,m,r);x=true}if(_>i&&g<=i){c=l(s,p,d,y,m,i);x=true}if(!a&&x){if(o){s.end=u+f*c}t.push(s);s=xt(e)}if(o){u+=f}}var b=e.length-3;p=e[b];d=e[b+1];v=e[b+2];g=n===0?p:d;if(g>=r&&g<=i){wt(s,p,d,v)}b=s.length-3;if(a&&b>=3&&(s[b]!==s[0]||s[b+1]!==s[1])){wt(s,s[0],s[1],s[2])}if(s.length){t.push(s)}}function xt(e){var t=[];t.size=e.size;t.start=e.start;t.end=e.end;return t}function bt(e,t,r,i,n,a){for(var o=0;o<e.length;o++){_t(e[o],t,r,i,n,a,false)}}function wt(e,t,r,i){e.push(t);e.push(r);e.push(i)}function St(e,t,r,i,n,a){var o=(a-t)/(i-t);e.push(a);e.push(r+(n-r)*o);e.push(1);return o}function Ct(e,t,r,i,n,a){var o=(a-r)/(n-r);e.push(t+(i-t)*o);e.push(a);e.push(1);return o}function Tt(e,t){var r=t.buffer/t.extent;var i=e;var n=mt(e,1,-1-r,r,0,-1,2,t);var a=mt(e,1,1-r,2+r,0,-1,2,t);if(n||a){i=mt(e,1,-r,1+r,0,-1,2,t)||[];if(n){i=Pt(n,1).concat(i)}if(a){i=i.concat(Pt(a,-1))}}return i}function Pt(e,t){var r=[];for(var i=0;i<e.length;i++){var n=e[i],a=n.type;var o;if(a==="Point"||a==="MultiPoint"||a==="LineString"){o=Mt(n.geometry,t)}else if(a==="MultiLineString"||a==="Polygon"){o=[];for(var s=0;s<n.geometry.length;s++){o.push(Mt(n.geometry[s],t))}}else if(a==="MultiPolygon"){o=[];for(s=0;s<n.geometry.length;s++){var l=[];for(var u=0;u<n.geometry[s].length;u++){l.push(Mt(n.geometry[s][u],t))}o.push(l)}}r.push(st(n.id,a,o,n.tags))}return r}function Mt(e,t){var r=[];r.size=e.size;if(e.start!==undefined){r.start=e.start;r.end=e.end}for(var i=0;i<e.length;i+=3){r.push(e[i]+t,e[i+1],e[i+2])}return r}function It(e,t){if(e.transformed){return e}var r=1<<e.z,i=e.x,n=e.y,a,o,s;for(a=0;a<e.features.length;a++){var l=e.features[a],u=l.geometry,f=l.type;l.geometry=[];if(f===1){for(o=0;o<u.length;o+=2){l.geometry.push(At(u[o],u[o+1],t,r,i,n))}}else{for(o=0;o<u.length;o++){var c=[];for(s=0;s<u[o].length;s+=2){c.push(At(u[o][s],u[o][s+1],t,r,i,n))}l.geometry.push(c)}}}e.transformed=true;return e}function At(e,t,r,i,n,a){return[Math.round(r*(e*i-n)),Math.round(r*(t*i-a))]}function Lt(e,t,r,i,n){var a=t===n.maxZoom?0:n.tolerance/((1<<t)*n.extent);var o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:i,z:t,transformed:false,minX:2,minY:1,maxX:-1,maxY:0};for(var s=0;s<e.length;s++){o.numFeatures++;Et(o,e[s],a,n);var l=e[s].minX;var u=e[s].minY;var f=e[s].maxX;var c=e[s].maxY;if(l<o.minX){o.minX=l}if(u<o.minY){o.minY=u}if(f>o.maxX){o.maxX=f}if(c>o.maxY){o.maxY=c}}return o}function Et(e,t,r,i){var n=t.geometry,a=t.type,o=[];if(a==="Point"||a==="MultiPoint"){for(var s=0;s<n.length;s+=3){o.push(n[s]);o.push(n[s+1]);e.numPoints++;e.numSimplified++}}else if(a==="LineString"){kt(o,n,e,r,false,false)}else if(a==="MultiLineString"||a==="Polygon"){for(s=0;s<n.length;s++){kt(o,n[s],e,r,a==="Polygon",s===0)}}else if(a==="MultiPolygon"){for(var l=0;l<n.length;l++){var u=n[l];for(s=0;s<u.length;s++){kt(o,u[s],e,r,true,s===0)}}}if(o.length){var f=t.tags||null;if(a==="LineString"&&i.lineMetrics){f={};for(var c in t.tags){f[c]=t.tags[c]}f["mapbox_clip_start"]=n.start/n.size;f["mapbox_clip_end"]=n.end/n.size}var h={geometry:o,type:a==="Polygon"||a==="MultiPolygon"?3:a==="LineString"||a==="MultiLineString"?2:1,tags:f};if(t.id!==null){h.id=t.id}e.features.push(h)}}function kt(e,t,r,i,n,a){var o=i*i;if(i>0&&t.size<(n?o:i)){r.numPoints+=t.length/3;return}var s=[];for(var l=0;l<t.length;l+=3){if(i===0||t[l+2]>o){r.numSimplified++;s.push(t[l]);s.push(t[l+1])}r.numPoints++}if(n){Dt(s,a)}e.push(s)}function Dt(e,t){var r=0;for(var i=0,n=e.length,a=n-2;i<n;a=i,i+=2){r+=(e[i]-e[a])*(e[i+1]+e[a+1])}if(r>0===t){for(i=0,n=e.length;i<n/2;i+=2){var o=e[i];var s=e[i+1];e[i]=e[n-2-i];e[i+1]=e[n-1-i];e[n-2-i]=o;e[n-1-i]=s}}}function Bt(e,t){return new Rt(e,t)}function Rt(e,t){t=this.options=Ot((0,F.default)(this.options),t);var r=t.debug;if(r){console.time("preprocess data")}if(t.maxZoom<0||t.maxZoom>24){throw new Error("maxZoom should be in the 0-24 range")}if(t.promoteId&&t.generateId){throw new Error("promoteId and generateId cannot be used together.")}var i=ft(e,t);this.tiles={};this.tileCoords=[];if(r){console.timeEnd("preprocess data");console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints);console.time("generate tiles");this.stats={};this.total=0}i=Tt(i,t);if(i.length){this.splitTile(i,0,0,0)}if(r){if(i.length){console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints)}console.timeEnd("generate tiles");console.log("tiles generated:",this.total,(0,B.default)(this.stats))}}Rt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:false,promoteId:null,generateId:false,debug:0};Rt.prototype.splitTile=function(e,t,r,i,n,a,o){var s=this;var l=[e,t,r,i],u=this.options,f=u.debug;while(l.length){i=l.pop();r=l.pop();t=l.pop();e=l.pop();var c=1<<t,h=Ft(t,r,i),p=s.tiles[h];if(!p){if(f>1){console.time("creation")}p=s.tiles[h]=Lt(e,t,r,i,u);s.tileCoords.push({z:t,x:r,y:i});if(f){if(f>1){console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,i,p.numFeatures,p.numPoints,p.numSimplified);console.timeEnd("creation")}var d="z"+t;s.stats[d]=(s.stats[d]||0)+1;s.total++}}p.source=e;if(!n){if(t===u.indexMaxZoom||p.numPoints<=u.indexMaxPoints){continue}}else{if(t===u.maxZoom||t===n){continue}var v=1<<n-t;if(r!==Math.floor(a/v)||i!==Math.floor(o/v)){continue}}p.source=null;if(e.length===0){continue}if(f>1){console.time("clipping")}var y=.5*u.buffer/u.extent,m=.5-y,g=.5+y,_=1+y,x,b,w,S,C,T;x=b=w=S=null;C=mt(e,c,r-y,r+g,0,p.minX,p.maxX,u);T=mt(e,c,r+m,r+_,0,p.minX,p.maxX,u);e=null;if(C){x=mt(C,c,i-y,i+g,1,p.minY,p.maxY,u);b=mt(C,c,i+m,i+_,1,p.minY,p.maxY,u);C=null}if(T){w=mt(T,c,i-y,i+g,1,p.minY,p.maxY,u);S=mt(T,c,i+m,i+_,1,p.minY,p.maxY,u);T=null}if(f>1){console.timeEnd("clipping")}l.push(x||[],t+1,r*2,i*2);l.push(b||[],t+1,r*2,i*2+1);l.push(w||[],t+1,r*2+1,i*2);l.push(S||[],t+1,r*2+1,i*2+1)}};Rt.prototype.getTile=function(e,t,r){var i=this;var n=this.options,a=n.extent,o=n.debug;if(e<0||e>24){return null}var s=1<<e;t=(t%s+s)%s;var l=Ft(e,t,r);if(this.tiles[l]){return It(this.tiles[l],a)}if(o>1){console.log("drilling down to z%d-%d-%d",e,t,r)}var u=e,f=t,c=r,h;while(!h&&u>0){u--;f=Math.floor(f/2);c=Math.floor(c/2);h=i.tiles[Ft(u,f,c)]}if(!h||!h.source){return null}if(o>1){console.log("found parent tile z%d-%d-%d",u,f,c)}if(o>1){console.time("drilling down")}this.splitTile(h.source,u,f,c,e,t,r);if(o>1){console.timeEnd("drilling down")}return this.tiles[l]?It(this.tiles[l],a):null};function Ft(e,t,r){return((1<<e)*r+t)*32+e}function Ot(e,t){for(var r in t){e[r]=t[r]}return e}function zt(e,t){var r=e.tileID.canonical;if(!this._geoJSONIndex){return t(null,null)}var i=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!i){return t(null,null)}var n=new ye(i.features);var a=be(n);if(a.byteOffset!==0||a.byteLength!==a.buffer.byteLength){a=new Uint8Array(a)}t(null,{vectorTile:n,rawData:a.buffer})}var Ut=function(t){function r(e,r,i){t.call(this,e,r,zt);if(i){this.loadGeoJSON=i}}if(t)r.__proto__=t;r.prototype=(0,F.default)(t&&t.prototype);r.prototype.constructor=r;r.prototype.loadData=function e(t,r){if(this._pendingCallback){this._pendingCallback(null,{abandoned:true})}this._pendingCallback=r;this._pendingLoadDataParams=t;if(this._state&&this._state!=="Idle"){this._state="NeedsLoadData"}else{this._state="Coalescing";this._loadData()}};r.prototype._loadData=function t(){var r=this;if(!this._pendingCallback||!this._pendingLoadDataParams){e.assert(false);return}var i=this._pendingCallback;var n=this._pendingLoadDataParams;delete this._pendingCallback;delete this._pendingLoadDataParams;var a=n&&n.request&&n.request.collectResourceTiming?new q.Performance(n.request):false;this.loadGeoJSON(n,function(e,t){if(e||!t){return i(e)}else if((typeof t==="undefined"?"undefined":(0,z.default)(t))!=="object"){return i(new Error("Input data is not a valid GeoJSON object."))}else{se(t,true);try{r._geoJSONIndex=n.cluster?He(n.superclusterOptions).load(t.features):Bt(t,n.geojsonVtOptions)}catch(e){return i(e)}r.loaded={};var o={};if(a){var s=a.finish();if(s){o.resourceTiming={};o.resourceTiming[n.source]=JSON.parse((0,B.default)(s))}}i(null,o)}})};r.prototype.coalesce=function e(){if(this._state==="Coalescing"){this._state="Idle"}else if(this._state==="NeedsLoadData"){this._state="Coalescing";this._loadData()}};r.prototype.reloadTile=function e(r,i){var n=this.loaded,a=r.uid;if(n&&n[a]){return t.prototype.reloadTile.call(this,r,i)}else{return this.loadTile(r,i)}};r.prototype.loadGeoJSON=function t(r,i){if(r.request){e.getJSON(r.request,i)}else if(typeof r.data==="string"){try{return i(null,JSON.parse(r.data))}catch(e){return i(new Error("Input data is not a valid GeoJSON object."))}}else{return i(new Error("Input data is not a valid GeoJSON object."))}};r.prototype.removeSource=function e(t,r){if(this._pendingCallback){this._pendingCallback(null,{abandoned:true})}r()};r.prototype.getClusterExpansionZoom=function e(t,r){r(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))};r.prototype.getClusterChildren=function e(t,r){r(null,this._geoJSONIndex.getChildren(t.clusterId))};r.prototype.getClusterLeaves=function e(t,r){r(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))};return r}(X);var Nt=function t(r){var i=this;this.self=r;this.actor=new e.Actor(r,this);this.layerIndexes={};this.workerSourceTypes={vector:X,geojson:Ut};this.workerSources={};this.demWorkerSources={};this.self.registerWorkerSource=function(e,t){if(i.workerSourceTypes[e]){throw new Error('Worker source with name "'+e+'" already registered.')}i.workerSourceTypes[e]=t};this.self.registerRTLTextPlugin=function(t){if(e.plugin.isLoaded()){throw new Error("RTL text plugin already registered.")}e.plugin["applyArabicShaping"]=t.applyArabicShaping;e.plugin["processBidirectionalText"]=t.processBidirectionalText;e.plugin["processStyledBidirectionalText"]=t.processStyledBidirectionalText}};Nt.prototype.setReferrer=function e(t,r){this.referrer=r};Nt.prototype.setLayers=function e(t,r,i){this.getLayerIndex(t).replace(r);i()};Nt.prototype.updateLayers=function e(t,r,i){this.getLayerIndex(t).update(r.layers,r.removedIds);i()};Nt.prototype.loadTile=function t(r,i,n){e.assert(i.type);this.getWorkerSource(r,i.type,i.source).loadTile(i,n)};Nt.prototype.loadDEMTile=function e(t,r,i){this.getDEMWorkerSource(t,r.source).loadTile(r,i)};Nt.prototype.reloadTile=function t(r,i,n){e.assert(i.type);this.getWorkerSource(r,i.type,i.source).reloadTile(i,n)};Nt.prototype.abortTile=function t(r,i,n){e.assert(i.type);this.getWorkerSource(r,i.type,i.source).abortTile(i,n)};Nt.prototype.removeTile=function t(r,i,n){e.assert(i.type);this.getWorkerSource(r,i.type,i.source).removeTile(i,n)};Nt.prototype.removeDEMTile=function e(t,r){this.getDEMWorkerSource(t,r.source).removeTile(r)};Nt.prototype.removeSource=function t(r,i,n){e.assert(i.type);e.assert(i.source);if(!this.workerSources[r]||!this.workerSources[r][i.type]||!this.workerSources[r][i.type][i.source]){return}var a=this.workerSources[r][i.type][i.source];delete this.workerSources[r][i.type][i.source];if(a.removeSource!==undefined){a.removeSource(i,n)}else{n()}};Nt.prototype.loadWorkerSource=function e(t,r,i){try{this.self.importScripts(r.url);i()}catch(e){i(e.toString())}};Nt.prototype.loadRTLTextPlugin=function t(r,i,n){try{if(!e.plugin.isLoaded()){this.self.importScripts(i);n(e.plugin.isLoaded()?null:new Error("RTL Text Plugin failed to import scripts from "+i))}}catch(e){n(e.toString())}};Nt.prototype.getLayerIndex=function e(t){var r=this.layerIndexes[t];if(!r){r=this.layerIndexes[t]=new n}return r};Nt.prototype.getWorkerSource=function e(t,r,i){var n=this;if(!this.workerSources[t]){this.workerSources[t]={}}if(!this.workerSources[t][r]){this.workerSources[t][r]={}}if(!this.workerSources[t][r][i]){var a={send:function e(r,i,a){n.actor.send(r,i,a,t)}};this.workerSources[t][r][i]=new this.workerSourceTypes[r](a,this.getLayerIndex(t))}return this.workerSources[t][r][i]};Nt.prototype.getDEMWorkerSource=function e(t,r){if(!this.demWorkerSources[t]){this.demWorkerSources[t]={}}if(!this.demWorkerSources[t][r]){this.demWorkerSources[t][r]=new Y}return this.demWorkerSources[t][r]};if(typeof WorkerGlobalScope!=="undefined"&&typeof self!=="undefined"&&self instanceof WorkerGlobalScope){self.worker=new Nt(self)}return Nt});a(["./shared.js"],function(e){"use strict";var t=e.createCommonjsModule(function(e){"use strict";if("object"!=="undefined"&&e.exports){e.exports=t}else if(window){window.mapboxgl=window.mapboxgl||{};window.mapboxgl.supported=t}function t(e){return!!(r()&&i()&&n()&&a()&&o()&&s()&&u()&&c()&&v(e&&e.failIfMajorPerformanceCaveat))}function r(){return typeof window!=="undefined"&&typeof document!=="undefined"}function i(){return Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray}function n(){return Function.prototype&&Function.prototype.bind}function a(){return k.default&&F.default&&P.default&&L.default&&g.default&&y.default&&d.default&&I.default&&h.default&&x.default&&f.default&&C.default&&l.default}function o(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON}function s(){if(!("Worker"in window&&"Blob"in window&&"URL"in window)){return false}var e=new Blob([""],{type:"text/javascript"});var t=URL.createObjectURL(e);var r;var i;try{i=new Worker(t);r=true}catch(e){r=false}if(i){i.terminate()}URL.revokeObjectURL(t);return r}function u(){return"Uint8ClampedArray"in window}function c(){return ArrayBuffer.isView}var p={};function v(e){if(p[e]===undefined){p[e]=m(e)}return p[e]}t.webGLContextAttributes={antialias:false,alpha:true,stencil:true,depth:true};function m(e){var r=document.createElement("canvas");var i=(0,F.default)(t.webGLContextAttributes);i.failIfMajorPerformanceCaveat=e;if(r.probablySupportsContext){return r.probablySupportsContext("webgl",i)||r.probablySupportsContext("experimental-webgl",i)}else if(r.supportsContext){return r.supportsContext("webgl",i)||r.supportsContext("experimental-webgl",i)}else{return r.getContext("webgl",i)||r.getContext("experimental-webgl",i)}}});var r={};r.create=function(t,r,i){var n=e.window.document.createElement(t);if(r){n.className=r}if(i){i.appendChild(n)}return n};r.createNS=function(t,r){var i=e.window.document.createElementNS(t,r);return i};var i=e.window.document?e.window.document.documentElement.style:null;function n(e){if(!i){return null}for(var t=0;t<e.length;t++){if(e[t]in i){return e[t]}}return e[0]}var a=n(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);var o;r.disableDrag=function(){if(i&&a){o=i[a];i[a]="none"}};r.enableDrag=function(){if(i&&a){i[a]=o}};var s=n(["transform","WebkitTransform"]);r.setTransform=function(e,t){e.style[s]=t};var u=false;try{var c=Object.defineProperty({},"passive",{get:function e(){u=true}});e.window.addEventListener("test",c,c);e.window.removeEventListener("test",c,c)}catch(e){u=false}r.addEventListener=function(e,t,r,i){if(i===void 0)i={};if("passive"in i&&u){e.addEventListener(t,r,i)}else{e.addEventListener(t,r,i.capture)}};r.removeEventListener=function(e,t,r,i){if(i===void 0)i={};if("passive"in i&&u){e.removeEventListener(t,r,i)}else{e.removeEventListener(t,r,i.capture)}};var p=function t(r){r.preventDefault();r.stopPropagation();e.window.removeEventListener("click",t,true)};r.suppressClick=function(){e.window.addEventListener("click",p,true);e.window.setTimeout(function(){e.window.removeEventListener("click",p,true)},0)};r.mousePos=function(t,r){var i=t.getBoundingClientRect();r=r.touches?r.touches[0]:r;return new e.Point(r.clientX-i.left-t.clientLeft,r.clientY-i.top-t.clientTop)};r.touchPos=function(t,r){var i=t.getBoundingClientRect(),n=[];var a=r.type==="touchend"?r.changedTouches:r.touches;for(var o=0;o<a.length;o++){n.push(new e.Point(a[o].clientX-i.left-t.clientLeft,a[o].clientY-i.top-t.clientTop))}return n};r.mouseButton=function(t){e.assert(t.type==="mousedown"||t.type==="mouseup");if(typeof e.window.InstallTrigger!=="undefined"&&t.button===2&&t.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0){return 0}return t.button};r.remove=function(e){if(e.parentNode){e.parentNode.removeChild(e)}};function v(t,r,i){var n,a,o;var s=e.browser.devicePixelRatio>1?"@2x":"";var l=e.getJSON(r(e.normalizeSpriteURL(t,s,".json"),e.ResourceType.SpriteJSON),function(e,t){l=null;if(!o){o=e;n=t;f()}});var u=e.getImage(r(e.normalizeSpriteURL(t,s,".png"),e.ResourceType.SpriteImage),function(e,t){u=null;if(!o){o=e;a=t;f()}});function f(){if(o){i(o)}else if(n&&a){var t=e.browser.getImageData(a);var r={};for(var s in n){var l=n[s];var u=l.width;var f=l.height;var c=l.x;var h=l.y;var p=l.sdf;var d=l.pixelRatio;var v=new e.RGBAImage({width:u,height:f});e.RGBAImage.copy(t,v,{x:c,y:h},{x:0,y:0},{width:u,height:f});r[s]={data:v,pixelRatio:d,sdf:p}}i(null,r)}}return{cancel:function e(){if(l){l.cancel();l=null}if(u){u.cancel();u=null}}}}var m=1;var _=function t(){this.images={};this.loaded=false;this.requestors=[];this.patterns={};this.atlasImage=new e.RGBAImage({width:1,height:1});this.dirty=true};_.prototype.isLoaded=function e(){return this.loaded};_.prototype.setLoaded=function e(t){var r=this;if(this.loaded===t){return}this.loaded=t;if(t){for(var i=0,n=r.requestors;i<n.length;i+=1){var a=n[i];var o=a.ids;var s=a.callback;r._notify(o,s)}this.requestors=[]}};_.prototype.getImage=function e(t){return this.images[t]};_.prototype.addImage=function t(r,i){e.assert(!this.images[r]);this.images[r]=i};_.prototype.removeImage=function t(r){e.assert(this.images[r]);delete this.images[r];delete this.patterns[r]};_.prototype.listImages=function e(){return(0,k.default)(this.images)};_.prototype.getImages=function e(t,r){var i=this;var n=true;if(!this.isLoaded()){for(var a=0,o=t;a<o.length;a+=1){var s=o[a];if(!i.images[s]){n=false}}}if(this.isLoaded()||n){this._notify(t,r)}else{this.requestors.push({ids:t,callback:r})}};_.prototype._notify=function e(t,r){var i=this;var n={};for(var a=0,o=t;a<o.length;a+=1){var s=o[a];var l=i.images[s];if(l){n[s]={data:l.data.clone(),pixelRatio:l.pixelRatio,sdf:l.sdf}}}r(null,n)};_.prototype.getPixelSize=function e(){var t=this.atlasImage;var r=t.width;var i=t.height;return{width:r,height:i}};_.prototype.getPattern=function t(r){var i=this.patterns[r];if(i){return i.position}var n=this.getImage(r);if(!n){return null}var a=n.data.width+m*2;var o=n.data.height+m*2;var s={w:a,h:o,x:0,y:0};var l=new e.ImagePosition(s,n);this.patterns[r]={bin:s,position:l};this._updatePatternAtlas();return l};_.prototype.bind=function t(r){var i=r.gl;if(!this.atlasTexture){this.atlasTexture=new e.Texture(r,this.atlasImage,i.RGBA)}else if(this.dirty){this.atlasTexture.update(this.atlasImage);this.dirty=false}this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)};_.prototype._updatePatternAtlas=function t(){var r=this;var i=[];for(var n in r.patterns){i.push(r.patterns[n].bin)}var a=e.potpack(i);var o=a.w;var s=a.h;var l=this.atlasImage;l.resize({width:o||1,height:s||1});for(var u in r.patterns){var f=r.patterns[u];var c=f.bin;var h=c.x+m;var p=c.y+m;var d=r.images[u].data;var v=d.width;var y=d.height;e.RGBAImage.copy(d,l,{x:0,y:0},{x:h,y:p},{width:v,height:y});e.RGBAImage.copy(d,l,{x:0,y:y-1},{x:h,y:p-1},{width:v,height:1});e.RGBAImage.copy(d,l,{x:0,y:0},{x:h,y:p+y},{width:v,height:1});e.RGBAImage.copy(d,l,{x:v-1,y:0},{x:h-1,y:p},{width:1,height:y});e.RGBAImage.copy(d,l,{x:0,y:0},{x:h+v,y:p},{width:1,height:y})}this.dirty=true};function b(t,r,i,n,a){var o=r*256;var s=o+255;var l=n(e.normalizeGlyphsURL(i).replace("{fontstack}",t).replace("{range}",o+"-"+s),e.ResourceType.Glyphs);e.getArrayBuffer(l,function(t,r){if(t){a(t)}else if(r){var i={};for(var n=0,o=e.parseGlyphPBF(r);n<o.length;n+=1){var s=o[n];i[s.id]=s}a(null,i)}})}"use strict";var w=T;var S=1e20;function T(e,t,r,i,n,a){this.fontSize=e||24;this.buffer=t===undefined?3:t;this.cutoff=i||.25;this.fontFamily=n||"sans-serif";this.fontWeight=a||"normal";this.radius=r||8;var o=this.size=this.fontSize+this.buffer*2;this.canvas=document.createElement("canvas");this.canvas.width=this.canvas.height=o;this.ctx=this.canvas.getContext("2d");this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily;this.ctx.textBaseline="middle";this.ctx.fillStyle="black";this.gridOuter=new Float64Array(o*o);this.gridInner=new Float64Array(o*o);this.f=new Float64Array(o);this.d=new Float64Array(o);this.z=new Float64Array(o+1);this.v=new Int16Array(o);this.middle=Math.round(o/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}T.prototype.draw=function(e){var t=this;this.ctx.clearRect(0,0,this.size,this.size);this.ctx.fillText(e,this.buffer,this.middle);var r=this.ctx.getImageData(0,0,this.size,this.size);var i=new Uint8ClampedArray(this.size*this.size);for(var n=0;n<this.size*this.size;n++){var a=r.data[n*4+3]/255;t.gridOuter[n]=a===1?0:a===0?S:Math.pow(Math.max(0,.5-a),2);t.gridInner[n]=a===1?S:a===0?0:Math.pow(Math.max(0,a-.5),2)}M(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z);M(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z);for(n=0;n<this.size*this.size;n++){var o=t.gridOuter[n]-t.gridInner[n];i[n]=Math.max(0,Math.min(255,Math.round(255-255*(o/t.radius+t.cutoff))))}return i};function M(e,t,r,i,n,a,o){for(var s=0;s<t;s++){for(var l=0;l<r;l++){i[l]=e[l*t+s]}A(i,n,a,o,r);for(l=0;l<r;l++){e[l*t+s]=n[l]}}for(l=0;l<r;l++){for(s=0;s<t;s++){i[s]=e[l*t+s]}A(i,n,a,o,t);for(s=0;s<t;s++){e[l*t+s]=Math.sqrt(n[s])}}}function A(e,t,r,i,n){r[0]=0;i[0]=-S;i[1]=+S;for(var a=1,o=0;a<n;a++){var s=(e[a]+a*a-(e[r[o]]+r[o]*r[o]))/(2*a-2*r[o]);while(s<=i[o]){o--;s=(e[a]+a*a-(e[r[o]]+r[o]*r[o]))/(2*a-2*r[o])}o++;r[o]=a;i[o]=s;i[o+1]=+S}for(a=0,o=0;a<n;a++){while(i[o+1]<a){o++}t[a]=(a-r[o])*(a-r[o])+e[r[o]]}}var E=function e(t,r){this.requestTransform=t;this.localIdeographFontFamily=r;this.entries={}};E.prototype.setURL=function e(t){this.url=t};E.prototype.getGlyphs=function t(r,i){var n=this;var a=[];for(var o in r){for(var s=0,l=r[o];s<l.length;s+=1){var u=l[s];a.push({stack:o,id:u})}}e.asyncAll(a,function(e,t){var r=e.stack;var i=e.id;var a=n.entries[r];if(!a){a=n.entries[r]={glyphs:{},requests:{}}}var o=a.glyphs[i];if(o!==undefined){t(null,{stack:r,id:i,glyph:o});return}o=n._tinySDF(a,r,i);if(o){t(null,{stack:r,id:i,glyph:o});return}var s=Math.floor(i/256);if(s*256>65535){t(new Error("glyphs > 65535 not supported"));return}var l=a.requests[s];if(!l){l=a.requests[s]=[];E.loadGlyphRange(r,s,n.url,n.requestTransform,function(e,t){if(t){for(var r in t){a.glyphs[+r]=t[+r]}}for(var i=0,n=l;i<n.length;i+=1){var o=n[i];o(e,t)}delete a.requests[s]})}l.push(function(e,n){if(e){t(e)}else if(n){t(null,{stack:r,id:i,glyph:n[i]||null})}})},function(e,t){if(e){i(e)}else if(t){var r={};for(var n=0,a=t;n<a.length;n+=1){var o=a[n];var s=o.stack;var l=o.id;var u=o.glyph;(r[s]||(r[s]={}))[l]=u&&{id:u.id,bitmap:u.bitmap.clone(),metrics:u.metrics}}i(null,r)}})};E.prototype._tinySDF=function t(r,i,n){var a=this.localIdeographFontFamily;if(!a){return}if(!e.isChar["CJK Unified Ideographs"](n)&&!e.isChar["Hangul Syllables"](n)){return}var o=r.tinySDF;if(!o){var s="400";if(/bold/i.test(i)){s="900"}else if(/medium/i.test(i)){s="500"}else if(/light/i.test(i)){s="200"}o=r.tinySDF=new E.TinySDF(24,3,8,.25,a,s)}return{id:n,bitmap:new e.AlphaImage({width:30,height:30},o.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}};E.loadGlyphRange=b;E.TinySDF=w;var D=function t(){this.specification=e.styleSpec.light.position};D.prototype.possiblyEvaluate=function t(r,i){return e.sphericalToCartesian(r.expression.evaluate(i))};D.prototype.interpolate=function t(r,i,n){return{x:e.number(r.x,i.x,n),y:e.number(r.y,i.y,n),z:e.number(r.z,i.z,n)}};var R=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new D,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)});var O="-transition";var U=function(t){function r(r){t.call(this);this._transitionable=new e.Transitionable(R);this.setLight(r);this._transitioning=this._transitionable.untransitioned()}if(t)r.__proto__=t;r.prototype=(0,F.default)(t&&t.prototype);r.prototype.constructor=r;r.prototype.getLight=function e(){return this._transitionable.serialize()};r.prototype.setLight=function t(r){var i=this;if(this._validate(e.validateLight,r)){return}for(var n in r){var a=r[n];if(e.endsWith(n,O)){i._transitionable.setTransition(n.slice(0,-O.length),a)}else{i._transitionable.setValue(n,a)}}};r.prototype.updateTransitions=function e(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)};r.prototype.hasTransition=function e(){return this._transitioning.hasTransition()};r.prototype.recalculate=function e(t){this.properties=this._transitioning.possiblyEvaluate(t)};r.prototype._validate=function t(r,i){return e.emitValidationErrors(this,r.call(e.validateStyle,e.extend({value:i,style:{glyphs:true,sprite:true},styleSpec:e.styleSpec})))};return r}(e.Evented);var N=function e(t,r){this.width=t;this.height=r;this.nextRow=0;this.bytes=4;this.data=new Uint8Array(this.width*this.height*this.bytes);this.positions={}};N.prototype.getDash=function e(t,r){var i=t.join(",")+String(r);if(!this.positions[i]){this.positions[i]=this.addDash(t,r)}return this.positions[i]};N.prototype.addDash=function t(r,i){var n=this;var a=i?7:0;var o=2*a+1;var s=128;if(this.nextRow+o>this.height){e.warnOnce("LineAtlas out of space");return null}var l=0;for(var u=0;u<r.length;u++){l+=r[u]}var f=this.width/l;var c=f/2;var h=r.length%2===1;for(var p=-a;p<=a;p++){var d=n.nextRow+a+p;var v=n.width*d;var y=h?-r[r.length-1]:0;var m=r[0];var g=1;for(var _=0;_<this.width;_++){while(m<_/f){y=m;m=m+r[g];if(h&&g===r.length-1){m+=r[0]}g++}var x=Math.abs(_-y*f);var b=Math.abs(_-m*f);var w=Math.min(x,b);var S=g%2===1;var C=void 0;if(i){var T=a?p/a*(c+1):0;if(S){var P=c-Math.abs(T);C=Math.sqrt(w*w+P*P)}else{C=c-Math.sqrt(w*w+T*T)}}else{C=(S?1:-1)*w}n.data[3+(v+_)*4]=Math.max(0,Math.min(255,C+s))}}var M={y:(this.nextRow+a+.5)/this.height,height:2*a/this.height,width:l};this.nextRow+=o;this.dirty=true;return M};N.prototype.bind=function e(t){var r=t.gl;if(!this.texture){this.texture=r.createTexture();r.bindTexture(r.TEXTURE_2D,this.texture);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR);r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,this.data)}else{r.bindTexture(r.TEXTURE_2D,this.texture);if(this.dirty){this.dirty=false;r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.width,this.height,r.RGBA,r.UNSIGNED_BYTE,this.data)}}};var j=function t(r,i){var n=this;this.workerPool=r;this.actors=[];this.currentActor=0;this.id=e.uniqueId();var a=this.workerPool.acquire(this.id);for(var o=0;o<a.length;o++){var s=a[o];var l=new t.Actor(s,i,n.id);l.name="Worker "+o;n.actors.push(l)}};j.prototype.broadcast=function t(r,i,n){n=n||function(){};e.asyncAll(this.actors,function(e,t){e.send(r,i,t)},n)};j.prototype.send=function e(t,r,i,n){if(typeof n!=="number"||isNaN(n)){n=this.currentActor=(this.currentActor+1)%this.actors.length}this.actors[n].send(t,r,i);return n};j.prototype.remove=function e(){this.actors.forEach(function(e){e.remove()});this.actors=[];this.workerPool.release(this.id)};j.Actor=e.Actor;function V(t,r,i){var n=function t(r,n){if(r){return i(r)}else if(n){var a=e.pick(n,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);if(n.vector_layers){a.vectorLayers=n.vector_layers;a.vectorLayerIds=a.vectorLayers.map(function(e){return e.id})}i(null,a)}};if(t.url){return e.getJSON(r(e.normalizeSourceURL(t.url),e.ResourceType.Source),n)}else{return e.browser.frame(function(){return n(null,t)})}}var G=function t(r,i,n){this.bounds=e.LngLatBounds.convert(this.validateBounds(r));this.minzoom=i||0;this.maxzoom=n||24};G.prototype.validateBounds=function e(t){if(!Array.isArray(t)||t.length!==4){return[-180,-90,180,90]}return[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]};G.prototype.contains=function e(t){var r={minX:Math.floor(this.lngX(this.bounds.getWest(),t.z)),minY:Math.floor(this.latY(this.bounds.getNorth(),t.z)),maxX:Math.ceil(this.lngX(this.bounds.getEast(),t.z)),maxY:Math.ceil(this.latY(this.bounds.getSouth(),t.z))};var i=t.x>=r.minX&&t.x<r.maxX&&t.y>=r.minY&&t.y<r.maxY;return i};G.prototype.lngX=function e(t,r){return(t+180)*(Math.pow(2,r)/360)};G.prototype.latY=function t(r,i){var n=e.clamp(Math.sin(Math.PI/180*r),-.9999,.9999);var a=Math.pow(2,i)/(2*Math.PI);return Math.pow(2,i-1)+.5*Math.log((1+n)/(1-n))*-a};var Z=function(t){function r(r,i,n,a){t.call(this);this.id=r;this.dispatcher=n;this.type="vector";this.minzoom=0;this.maxzoom=22;this.scheme="xyz";this.tileSize=512;this.reparseOverscaled=true;this.isTileClipped=true;e.extend(this,e.pick(i,["url","scheme","tileSize"]));this._options=e.extend({type:"vector"},i);this._collectResourceTiming=i.collectResourceTiming;if(this.tileSize!==512){throw new Error("vector tile sources must have a tileSize of 512")}this.setEventedParent(a)}if(t)r.__proto__=t;r.prototype=(0,F.default)(t&&t.prototype);r.prototype.constructor=r;r.prototype.load=function t(){var r=this;this.fire(new e.Event("dataloading",{dataType:"source"}));this._tileJSONRequest=V(this._options,this.map._transformRequest,function(t,i){r._tileJSONRequest=null;if(t){r.fire(new e.ErrorEvent(t))}else if(i){e.extend(r,i);if(i.bounds){r.tileBounds=new G(i.bounds,r.minzoom,r.maxzoom)}e.postTurnstileEvent(i.tiles);e.postMapLoadEvent(i.tiles,r.map._getMapId());r.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"}));r.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))}})};r.prototype.hasTile=function e(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)};r.prototype.onAdd=function e(t){this.map=t;this.load()};r.prototype.onRemove=function e(){if(this._tileJSONRequest){this._tileJSONRequest.cancel();this._tileJSONRequest=null}};r.prototype.serialize=function t(){return e.extend({},this._options)};r.prototype.loadTile=function t(r,i){var n=e.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),this.url);var a={request:this.map._transformRequest(n,e.ResourceType.Tile),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};a.request.collectResourceTiming=this._collectResourceTiming;if(r.workerID===undefined||r.state==="expired"){r.workerID=this.dispatcher.send("loadTile",a,o.bind(this))}else if(r.state==="loading"){r.reloadCallback=i}else{this.dispatcher.send("reloadTile",a,o.bind(this),r.workerID)}function o(e,t){if(r.aborted){return i(null)}if(e&&e.status!==404){return i(e)}if(t&&t.resourceTiming){r.resourceTiming=t.resourceTiming}if(this.map._refreshExpiredTiles&&t){r.setExpiryData(t)}r.loadVectorData(t,this.map.painter);i(null);if(r.reloadCallback){this.loadTile(r,r.reloadCallback);r.reloadCallback=null}}};r.prototype.abortTile=function e(t){this.dispatcher.send("abortTile",{uid:t.uid,type:this.type,source:this.id},undefined,t.workerID)};r.prototype.unloadTile=function e(t){t.unloadVectorData();this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},undefined,t.workerID)};r.prototype.hasTransition=function e(){return false};return r}(e.Evented);var q=function(t){function r(r,i,n,a){t.call(this);this.id=r;this.dispatcher=n;this.setEventedParent(a);this.type="raster";this.minzoom=0;this.maxzoom=22;this.roundZoom=true;this.scheme="xyz";this.tileSize=512;this._loaded=false;this._options=e.extend({},i);e.extend(this,e.pick(i,["url","scheme","tileSize"]))}if(t)r.__proto__=t;r.prototype=(0,F.default)(t&&t.prototype);r.prototype.constructor=r;r.prototype.load=function t(){var r=this;this.fire(new e.Event("dataloading",{dataType:"source"}));this._tileJSONRequest=V(this._options,this.map._transformRequest,function(t,i){r._tileJSONRequest=null;if(t){r.fire(new e.ErrorEvent(t))}else if(i){e.extend(r,i);if(i.bounds){r.tileBounds=new G(i.bounds,r.minzoom,r.maxzoom)}e.postTurnstileEvent(i.tiles);e.postMapLoadEvent(i.tiles,r.map._getMapId());r.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"}));r.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))}})};r.prototype.onAdd=function e(t){this.map=t;this.load()};r.prototype.onRemove=function e(){if(this._tileJSONRequest){this._tileJSONRequest.cancel();this._tileJSONRequest=null}};r.prototype.serialize=function t(){return e.extend({},this._options)};r.prototype.hasTile=function e(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)};r.prototype.loadTile=function t(r,i){var n=this;var a=e.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);r.request=e.getImage(this.map._transformRequest(a,e.ResourceType.Tile),function(t,a){delete r.request;if(r.aborted){r.state="unloaded";i(null)}else if(t){r.state="errored";i(t)}else if(a){if(n.map._refreshExpiredTiles){r.setExpiryData(a)}delete a.cacheControl;delete a.expires;var o=n.map.painter.context;var s=o.gl;r.texture=n.map.painter.getTileTexture(a.width);if(r.texture){r.texture.update(a,{useMipmap:true})}else{r.texture=new e.Texture(o,a,s.RGBA,{useMipmap:true});r.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST);if(o.extTextureFilterAnisotropic){s.texParameterf(s.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax)}}r.state="loaded";i(null)}})};r.prototype.abortTile=function e(t,r){if(t.request){t.request.cancel();delete t.request}r()};r.prototype.unloadTile=function e(t,r){if(t.texture){this.map.painter.saveTileTexture(t.texture)}r()};r.prototype.hasTransition=function e(){return false};return r}(e.Evented);var H=function(t){function r(r,i,n,a){t.call(this,r,i,n,a);this.type="raster-dem";this.maxzoom=22;this._options=e.extend({},i);this.encoding=i.encoding||"mapbox"}if(t)r.__proto__=t;r.prototype=(0,F.default)(t&&t.prototype);r.prototype.constructor=r;r.prototype.serialize=function e(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}};r.prototype.loadTile=function t(r,i){var n=e.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);r.request=e.getImage(this.map._transformRequest(n,e.ResourceType.Tile),a.bind(this));r.neighboringTiles=this._getNeighboringTiles(r.tileID);function a(t,n){delete r.request;if(r.aborted){r.state="unloaded";i(null)}else if(t){r.state="errored";i(t)}else if(n){if(this.map._refreshExpiredTiles){r.setExpiryData(n)}delete n.cacheControl;delete n.expires;var a=e.browser.getImageData(n);var s={uid:r.uid,coord:r.tileID,source:this.id,rawImageData:a,encoding:this.encoding};if(!r.workerID||r.state==="expired"){r.workerID=this.dispatcher.send("loadDEMTile",s,o.bind(this))}}}function o(e,t){if(e){r.state="errored";i(e)}if(t){r.dem=t;r.needsHillshadePrepare=true;r.state="loaded";i(null)}}};r.prototype._getNeighboringTiles=function t(r){var i=r.canonical;var n=Math.pow(2,i.z);var a=(i.x-1+n)%n;var o=i.x===0?r.wrap-1:r.wrap;var s=(i.x+1+n)%n;var l=i.x+1===n?r.wrap+1:r.wrap;var u={};u[new e.OverscaledTileID(r.overscaledZ,o,i.z,a,i.y).key]={backfilled:false};u[new e.OverscaledTileID(r.overscaledZ,l,i.z,s,i.y).key]={backfilled:false};if(i.y>0){u[new e.OverscaledTileID(r.overscaledZ,o,i.z,a,i.y-1).key]={backfilled:false};u[new e.OverscaledTileID(r.overscaledZ,r.wrap,i.z,i.x,i.y-1).key]={backfilled:false};u[new e.OverscaledTileID(r.overscaledZ,l,i.z,s,i.y-1).key]={backfilled:false}}if(i.y+1<n){u[new e.OverscaledTileID(r.overscaledZ,o,i.z,a,i.y+1).key]={backfilled:false};u[new e.OverscaledTileID(r.overscaledZ,r.wrap,i.z,i.x,i.y+1).key]={backfilled:false};u[new e.OverscaledTileID(r.overscaledZ,l,i.z,s,i.y+1).key]={backfilled:false}}return u};r.prototype.unloadTile=function e(t){if(t.demTexture){this.map.painter.saveTileTexture(t.demTexture)}if(t.fbo){t.fbo.destroy();delete t.fbo}if(t.dem){delete t.dem}delete t.neighboringTiles;t.state="unloaded";this.dispatcher.send("removeDEMTile",{uid:t.uid,source:this.id},undefined,t.workerID)};return r}(q);var W=function(t){function r(r,i,n,a){t.call(this);this.id=r;this.type="geojson";this.minzoom=0;this.maxzoom=18;this.tileSize=512;this.isTileClipped=true;this.reparseOverscaled=true;this._removed=false;this.dispatcher=n;this.setEventedParent(a);this._data=i.data;this._options=e.extend({},i);this._collectResourceTiming=i.collectResourceTiming;this._resourceTiming=[];if(i.maxzoom!==undefined){this.maxzoom=i.maxzoom}if(i.type){this.type=i.type}if(i.attribution){this.attribution=i.attribution}var o=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:i.cluster||false,geojsonVtOptions:{buffer:(i.buffer!==undefined?i.buffer:128)*o,tolerance:(i.tolerance!==undefined?i.tolerance:.375)*o,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||false,generateId:i.generateId||false},superclusterOptions:{maxZoom:i.clusterMaxZoom!==undefined?Math.min(i.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(i.clusterRadius||50)*o,log:false}},i.workerOptions)}if(t)r.__proto__=t;r.prototype=(0,F.default)(t&&t.prototype);r.prototype.constructor=r;r.prototype.load=function t(){var r=this;this.fire(new e.Event("dataloading",{dataType:"source"}));this._updateWorkerData(function(t){if(t){r.fire(new e.ErrorEvent(t));return}var i={dataType:"source",sourceDataType:"metadata"};if(r._collectResourceTiming&&r._resourceTiming&&r._resourceTiming.length>0){i.resourceTiming=r._resourceTiming;r._resourceTiming=[]}r.fire(new e.Event("data",i))})};r.prototype.onAdd=function e(t){this.map=t;this.load()};r.prototype.setData=function t(r){var i=this;this._data=r;this.fire(new e.Event("dataloading",{dataType:"source"}));this._updateWorkerData(function(t){if(t){i.fire(new e.ErrorEvent(t));return}var r={dataType:"source",sourceDataType:"content"};if(i._collectResourceTiming&&i._resourceTiming&&i._resourceTiming.length>0){r.resourceTiming=i._resourceTiming;i._resourceTiming=[]}i.fire(new e.Event("data",r))});return this};r.prototype.getClusterExpansionZoom=function e(t,r){this.dispatcher.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},r,this.workerID);return this};r.prototype.getClusterChildren=function e(t,r){this.dispatcher.send("geojson.getClusterChildren",{clusterId:t,source:this.id},r,this.workerID);return this};r.prototype.getClusterLeaves=function e(t,r,i,n){this.dispatcher.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:r,offset:i},n,this.workerID);return this};r.prototype._updateWorkerData=function t(r){var i=this;var n=e.extend({},this.workerOptions);var a=this._data;if(typeof a==="string"){n.request=this.map._transformRequest(e.browser.resolveURL(a),e.ResourceType.Source);n.request.collectResourceTiming=this._collectResourceTiming}else{n.data=(0,B.default)(a)}this.workerID=this.dispatcher.send(this.type+".loadData",n,function(e,t){if(i._removed||t&&t.abandoned){return}i._loaded=true;if(t&&t.resourceTiming&&t.resourceTiming[i.id]){i._resourceTiming=t.resourceTiming[i.id].slice(0)}i.dispatcher.send(i.type+".coalesce",{source:n.source},null,i.workerID);r(e)},this.workerID)};r.prototype.loadTile=function t(r,i){var n=this;var a=r.workerID===undefined?"loadTile":"reloadTile";var o={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};r.workerID=this.dispatcher.send(a,o,function(e,t){r.unloadVectorData();if(r.aborted){return i(null)}if(e){return i(e)}r.loadVectorData(t,n.map.painter,a==="reloadTile");return i(null)},this.workerID)};r.prototype.abortTile=function e(t){t.aborted=true};r.prototype.unloadTile=function e(t){t.unloadVectorData();this.dispatcher.send("removeTile",{uid:t.uid,type:this.type,source:this.id},null,t.workerID)};r.prototype.onRemove=function e(){this._removed=true;this.dispatcher.send("removeSource",{type:this.type,source:this.id},null,this.workerID)};r.prototype.serialize=function t(){return e.extend({},this._options,{type:this.type,data:this._data})};r.prototype.hasTransition=function e(){return false};return r}(e.Evented);var X=function(t){function r(e,r,i,n){t.call(this);this.id=e;this.dispatcher=i;this.coordinates=r.coordinates;this.type="image";this.minzoom=0;this.maxzoom=22;this.tileSize=512;this.tiles={};this.setEventedParent(n);this.options=r}if(t)r.__proto__=t;r.prototype=(0,F.default)(t&&t.prototype);r.prototype.constructor=r;r.prototype.load=function t(r,i){var n=this;this.fire(new e.Event("dataloading",{dataType:"source"}));this.url=this.options.url;e.getImage(this.map._transformRequest(this.url,e.ResourceType.Image),function(t,a){if(t){n.fire(new e.ErrorEvent(t))}else if(a){n.image=e.browser.getImageData(a);if(r){n.coordinates=r}if(i){i()}n._finishLoading()}})};r.prototype.updateImage=function e(t){var r=this;if(!this.image||!t.url){return this}this.options.url=t.url;this.load(t.coordinates,function(){r.texture=null});return this};r.prototype._finishLoading=function t(){if(this.map){this.setCoordinates(this.coordinates);this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"}))}};r.prototype.onAdd=function e(t){this.map=t;this.load()};r.prototype.setCoordinates=function t(r){var i=this;this.coordinates=r;var n=r.map(e.MercatorCoordinate.fromLngLat);this.tileID=Y(n);this.minzoom=this.maxzoom=this.tileID.z;var a=n.map(function(e){return i.tileID.getTilePoint(e)._round()});this._boundsArray=new e.StructArrayLayout4i8;this._boundsArray.emplaceBack(a[0].x,a[0].y,0,0);this._boundsArray.emplaceBack(a[1].x,a[1].y,e.EXTENT,0);this._boundsArray.emplaceBack(a[3].x,a[3].y,0,e.EXTENT);this._boundsArray.emplaceBack(a[2].x,a[2].y,e.EXTENT,e.EXTENT);if(this.boundsBuffer){this.boundsBuffer.destroy();delete this.boundsBuffer}this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}));return this};r.prototype.prepare=function t(){var r=this;if((0,k.default)(this.tiles).length===0||!this.image){return}var i=this.map.painter.context;var n=i.gl;if(!this.boundsBuffer){this.boundsBuffer=i.createVertexBuffer(this._boundsArray,e.rasterBoundsAttributes.members)}if(!this.boundsSegments){this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)}if(!this.texture){this.texture=new e.Texture(i,this.image,n.RGBA);this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}for(var a in r.tiles){var o=r.tiles[a];if(o.state!=="loaded"){o.state="loaded";o.texture=r.texture}}};r.prototype.loadTile=function e(t,r){if(this.tileID&&this.tileID.equals(t.tileID.canonical)){this.tiles[String(t.tileID.wrap)]=t;t.buckets={};r(null)}else{t.state="errored";r(null)}};r.prototype.serialize=function e(){return{type:"image",url:this.options.url,coordinates:this.coordinates}};r.prototype.hasTransition=function e(){return false};return r}(e.Evented);function Y(t){var r=Infinity;var i=Infinity;var n=-Infinity;var a=-Infinity;for(var o=0,s=t;o<s.length;o+=1){var l=s[o];r=Math.min(r,l.x);i=Math.min(i,l.y);n=Math.max(n,l.x);a=Math.max(a,l.y)}var u=n-r;var f=a-i;var c=Math.max(u,f);var h=Math.max(0,Math.floor(-Math.log(c)/Math.LN2));var p=Math.pow(2,h);return new e.CanonicalTileID(h,Math.floor((r+n)/2*p),Math.floor((i+a)/2*p))}var K=function(t){function r(e,r,i,n){t.call(this,e,r,i,n);this.roundZoom=true;this.type="video";this.options=r}if(t)r.__proto__=t;r.prototype=(0,F.default)(t&&t.prototype);r.prototype.constructor=r;r.prototype.load=function t(){var r=this;var i=this.options;this.urls=[];for(var n=0,a=i.urls;n<a.length;n+=1){var o=a[n];r.urls.push(r.map._transformRequest(o,e.ResourceType.Source).url)}e.getVideo(this.urls,function(t,i){if(t){r.fire(new e.ErrorEvent(t))}else if(i){r.video=i;r.video.loop=true;r.video.addEventListener("playing",function(){r.map.triggerRepaint()});if(r.map){r.video.play()}r._finishLoading()}})};r.prototype.getVideo=function e(){return this.video};r.prototype.onAdd=function e(t){if(this.map){return}this.map=t;this.load();if(this.video){this.video.play();this.setCoordinates(this.coordinates)}};r.prototype.prepare=function t(){var r=this;if((0,k.default)(this.tiles).length===0||this.video.readyState<2){return}var i=this.map.painter.context;var n=i.gl;if(!this.boundsBuffer){this.boundsBuffer=i.createVertexBuffer(this._boundsArray,e.rasterBoundsAttributes.members)}if(!this.boundsSegments){this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)}if(!this.texture){this.texture=new e.Texture(i,this.video,n.RGBA);this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}else if(!this.video.paused){this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE);n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)}for(var a in r.tiles){var o=r.tiles[a];if(o.state!=="loaded"){o.state="loaded";o.texture=r.texture}}};r.prototype.serialize=function e(){return{type:"video",urls:this.urls,coordinates:this.coordinates}};r.prototype.hasTransition=function e(){return this.video&&!this.video.paused};return r}(X);var J=function(t){function r(r,i,n,a){t.call(this,r,i,n,a);if(!i.coordinates){this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'missing required property "coordinates"')))}else if(!Array.isArray(i.coordinates)||i.coordinates.length!==4||i.coordinates.some(function(e){return!Array.isArray(e)||e.length!==2||e.some(function(e){return typeof e!=="number"})})){this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs')))}if(i.animate&&typeof i.animate!=="boolean"){this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'optional "animate" property must be a boolean value')))}if(!i.canvas){this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'missing required property "canvas"')))}else if(typeof i.canvas!=="string"&&!(i.canvas instanceof e.window.HTMLCanvasElement)){this.fire(new e.ErrorEvent(new e.ValidationError("sources."+r,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance')))}this.options=i;this.animate=i.animate!==undefined?i.animate:true}if(t)r.__proto__=t;r.prototype=(0,F.default)(t&&t.prototype);r.prototype.constructor=r;r.prototype.load=function t(){if(!this.canvas){this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)}this.width=this.canvas.width;this.height=this.canvas.height;if(this._hasInvalidDimensions()){this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero.")));return}this.play=function(){this._playing=true;this.map.triggerRepaint()};this.pause=function(){this._playing=false};this._finishLoading()};r.prototype.getCanvas=function e(){return this.canvas};r.prototype.onAdd=function e(t){this.map=t;this.load();if(this.canvas){if(this.animate){this.play()}}};r.prototype.onRemove=function e(){this.pause()};r.prototype.prepare=function t(){var r=this;var i=false;if(this.canvas.width!==this.width){this.width=this.canvas.width;i=true}if(this.canvas.height!==this.height){this.height=this.canvas.height;i=true}if(this._hasInvalidDimensions()){return}if((0,k.default)(this.tiles).length===0){return}var n=this.map.painter.context;var a=n.gl;if(!this.boundsBuffer){this.boundsBuffer=n.createVertexBuffer(this._boundsArray,e.rasterBoundsAttributes.members)}if(!this.boundsSegments){this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)}if(!this.texture){this.texture=new e.Texture(n,this.canvas,a.RGBA,{premultiply:true})}else if(i||this._playing){this.texture.update(this.canvas,{premultiply:true})}for(var o in r.tiles){var s=r.tiles[o];if(s.state!=="loaded"){s.state="loaded";s.texture=r.texture}}};r.prototype.serialize=function e(){return{type:"canvas",coordinates:this.coordinates}};r.prototype.hasTransition=function e(){return this._playing};r.prototype._hasInvalidDimensions=function e(){var t=this;for(var r=0,i=[t.canvas.width,t.canvas.height];r<i.length;r+=1){var n=i[r];if(isNaN(n)||n<=0){return true}}return false};return r}(X);var $={vector:Z,raster:q,"raster-dem":H,geojson:W,video:K,image:X,canvas:J};var Q=function t(r,i,n,a){var o=new $[i.type](r,i,n,a);if(o.id!==r){throw new Error("Expected Source id to be "+r+" instead of "+o.id)}e.bindAll(["load","abort","unload","serialize","prepare"],o);return o};var ee=function e(t){return $[t]};var te=function e(t,r){$[t]=r};function re(e,t,r,i,n){var a=n.maxPitchScaleFactor();var o=e.tilesIn(r,a);o.sort(ae);var s=[];for(var l=0,u=o;l<u.length;l+=1){var f=u[l];s.push({wrappedTileID:f.tileID.wrapped().key,queryResults:f.tile.queryRenderedFeatures(t,e._state,f.queryGeometry,f.scale,i,n,a,e.transform.calculatePosMatrix(f.tileID.toUnwrapped()))})}var c=oe(s);for(var h in c){c[h].forEach(function(t){var r=e.getFeatureState(t.layer["source-layer"],t.id);t.source=t.layer.source;if(t.layer["source-layer"]){t.sourceLayer=t.layer["source-layer"]}t.state=r})}return c}function ie(t,r,i,n,a,o){var s={};var l=a.queryRenderedSymbols(i);var u=[];for(var f=0,c=(0,k.default)(l).map(Number);f<c.length;f+=1){var h=c[f];u.push(o[h])}u.sort(ae);var p=function r(){var i=v[d];var a=i.featureIndex.lookupSymbolFeatures(l[i.bucketInstanceId],i.bucketIndex,i.sourceLayerIndex,n.filter,n.layers,t);for(var o in a){var u=s[o]=s[o]||[];var f=a[o];f.sort(function(t,r){var n=i.featureSortOrder;if(n){var a=n.indexOf(t.featureIndex);var o=n.indexOf(r.featureIndex);e.assert(a>=0);e.assert(o>=0);return o-a}else{return r.featureIndex-t.featureIndex}});for(var c=0,h=f;c<h.length;c+=1){var p=h[c];u.push(p.feature)}}};for(var d=0,v=u;d<v.length;d+=1){p()}var y=function e(i){s[i].forEach(function(e){var n=t[i];var a=r[n.source];var o=a.getFeatureState(e.layer["source-layer"],e.id);e.source=e.layer.source;if(e.layer["source-layer"]){e.sourceLayer=e.layer["source-layer"]}e.state=o})};for(var m in s){y(m)}return s}function ne(e,t){var r=e.getRenderableIds().map(function(t){return e.getTileByID(t)});var i=[];var n={};for(var a=0;a<r.length;a++){var o=r[a];var s=o.tileID.canonical.key;if(!n[s]){n[s]=true;o.querySourceFeatures(i,t)}}return i}function ae(e,t){var r=e.tileID;var i=t.tileID;return r.overscaledZ-i.overscaledZ||r.canonical.y-i.canonical.y||r.wrap-i.wrap||r.canonical.x-i.canonical.x}function oe(e){var t={};var r={};for(var i=0,n=e;i<n.length;i+=1){var a=n[i];var o=a.queryResults;var s=a.wrappedTileID;var l=r[s]=r[s]||{};for(var u in o){var f=o[u];var c=l[u]=l[u]||{};var h=t[u]=t[u]||[];for(var p=0,d=f;p<d.length;p+=1){var v=d[p];if(!c[v.featureIndex]){c[v.featureIndex]=true;h.push(v.feature)}}}}return t}var se=function e(t,r){this.max=t;this.onRemove=r;this.reset()};se.prototype.reset=function e(){var t=this;for(var r in t.data){for(var i=0,n=t.data[r];i<n.length;i+=1){var a=n[i];if(a.timeout){clearTimeout(a.timeout)}t.onRemove(a.value)}}this.data={};this.order=[];return this};se.prototype.add=function e(t,r,i){var n=this;var a=t.wrapped().key;if(this.data[a]===undefined){this.data[a]=[]}var o={value:r,timeout:undefined};if(i!==undefined){o.timeout=setTimeout(function(){n.remove(t,o)},i)}this.data[a].push(o);this.order.push(a);if(this.order.length>this.max){var s=this._getAndRemoveByKey(this.order[0]);if(s){this.onRemove(s)}}return this};se.prototype.has=function e(t){return t.wrapped().key in this.data};se.prototype.getAndRemove=function e(t){if(!this.has(t)){return null}return this._getAndRemoveByKey(t.wrapped().key)};se.prototype._getAndRemoveByKey=function e(t){var r=this.data[t].shift();if(r.timeout){clearTimeout(r.timeout)}if(this.data[t].length===0){delete this.data[t]}this.order.splice(this.order.indexOf(t),1);return r.value};se.prototype.get=function e(t){if(!this.has(t)){return null}var r=this.data[t.wrapped().key][0];return r.value};se.prototype.remove=function e(t,r){if(!this.has(t)){return this}var i=t.wrapped().key;var n=r===undefined?0:this.data[i].indexOf(r);var a=this.data[i][n];this.data[i].splice(n,1);if(a.timeout){clearTimeout(a.timeout)}if(this.data[i].length===0){delete this.data[i]}this.onRemove(a.value);this.order.splice(this.order.indexOf(i),1);return this};se.prototype.setMaxSize=function e(t){var r=this;this.max=t;while(this.order.length>this.max){var i=r._getAndRemoveByKey(r.order[0]);if(i){r.onRemove(i)}}return this};var le=function e(t,r,i){this.context=t;var n=t.gl;this.buffer=n.createBuffer();this.dynamicDraw=Boolean(i);this.context.unbindVAO();t.bindElementBuffer.set(this.buffer);n.bufferData(n.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW);if(!this.dynamicDraw){delete r.arrayBuffer}};le.prototype.bind=function e(){this.context.bindElementBuffer.set(this.buffer)};le.prototype.updateData=function t(r){var i=this.context.gl;e.assert(this.dynamicDraw);this.context.unbindVAO();this.bind();i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)};le.prototype.destroy=function e(){var t=this.context.gl;if(this.buffer){t.deleteBuffer(this.buffer);delete this.buffer}};var ue={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};var fe=function e(t,r,i,n){this.length=r.length;this.attributes=i;this.itemSize=r.bytesPerElement;this.dynamicDraw=n;this.context=t;var a=t.gl;this.buffer=a.createBuffer();t.bindVertexBuffer.set(this.buffer);a.bufferData(a.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW);if(!this.dynamicDraw){delete r.arrayBuffer}};fe.prototype.bind=function e(){this.context.bindVertexBuffer.set(this.buffer)};fe.prototype.updateData=function t(r){e.assert(r.length===this.length);var i=this.context.gl;this.bind();i.bufferSubData(i.ARRAY_BUFFER,0,r.arrayBuffer)};fe.prototype.enableAttributes=function e(t,r){var i=this;for(var n=0;n<this.attributes.length;n++){var a=i.attributes[n];var o=r.attributes[a.name];if(o!==undefined){t.enableVertexAttribArray(o)}}};fe.prototype.setVertexAttribPointers=function e(t,r,i){var n=this;for(var a=0;a<this.attributes.length;a++){var o=n.attributes[a];var s=r.attributes[o.name];if(s!==undefined){t.vertexAttribPointer(s,o.components,t[ue[o.type]],false,n.itemSize,o.offset+n.itemSize*(i||0))}}};fe.prototype.destroy=function e(){var t=this.context.gl;if(this.buffer){t.deleteBuffer(this.buffer);delete this.buffer}};var ce=function e(t){this.gl=t.gl;this.default=this.getDefault();this.current=this.default;this.dirty=false};ce.prototype.get=function e(){return this.current};ce.prototype.set=function e(t){};ce.prototype.getDefault=function e(){return this.default};ce.prototype.setDefault=function e(){this.set(this.default)};var he=function(t){function r(){t.apply(this,arguments)}if(t)r.__proto__=t;r.prototype=(0,F.default)(t&&t.prototype);r.prototype.constructor=r;r.prototype.getDefault=function t(){return e.Color.transparent};r.prototype.set=function e(t){var r=this.current;if(t.r===r.r&&t.g===r.g&&t.b===r.b&&t.a===r.a&&!this.dirty){return}this.gl.clearColor(t.r,t.g,t.b,t.a);this.current=t;this.dirty=false};return r}(ce);var pe=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return 1};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.clearDepth(t);this.current=t;this.dirty=false};return t}(ce);var de=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return 0};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.clearStencil(t);this.current=t;this.dirty=false};return t}(ce);var ve=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return[true,true,true,true]};t.prototype.set=function e(t){var r=this.current;if(t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&!this.dirty){return}this.gl.colorMask(t[0],t[1],t[2],t[3]);this.current=t;this.dirty=false};return t}(ce);var ye=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return true};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.depthMask(t);this.current=t;this.dirty=false};return t}(ce);var me=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return 255};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.stencilMask(t);this.current=t;this.dirty=false};return t}(ce);var ge=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return{func:this.gl.ALWAYS,ref:0,mask:255}};t.prototype.set=function e(t){var r=this.current;if(t.func===r.func&&t.ref===r.ref&&t.mask===r.mask&&!this.dirty){return}this.gl.stencilFunc(t.func,t.ref,t.mask);this.current=t;this.dirty=false};return t}(ce);var _e=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){var t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]};t.prototype.set=function e(t){var r=this.current;if(t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&!this.dirty){return}this.gl.stencilOp(t[0],t[1],t[2]);this.current=t;this.dirty=false};return t}(ce);var xe=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return false};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;if(t){r.enable(r.STENCIL_TEST)}else{r.disable(r.STENCIL_TEST)}this.current=t;this.dirty=false};return t}(ce);var be=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return[0,1]};t.prototype.set=function e(t){var r=this.current;if(t[0]===r[0]&&t[1]===r[1]&&!this.dirty){return}this.gl.depthRange(t[0],t[1]);this.current=t;this.dirty=false};return t}(ce);var we=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return false};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;if(t){r.enable(r.DEPTH_TEST)}else{r.disable(r.DEPTH_TEST)}this.current=t;this.dirty=false};return t}(ce);var Se=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return this.gl.LESS};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.depthFunc(t);this.current=t;this.dirty=false};return t}(ce);var Ce=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return false};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;if(t){r.enable(r.BLEND)}else{r.disable(r.BLEND)}this.current=t;this.dirty=false};return t}(ce);var Te=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){var t=this.gl;return[t.ONE,t.ZERO]};t.prototype.set=function e(t){var r=this.current;if(t[0]===r[0]&&t[1]===r[1]&&!this.dirty){return}this.gl.blendFunc(t[0],t[1]);this.current=t;this.dirty=false};return t}(ce);var Pe=function(t){function r(){t.apply(this,arguments)}if(t)r.__proto__=t;r.prototype=(0,F.default)(t&&t.prototype);r.prototype.constructor=r;r.prototype.getDefault=function t(){return e.Color.transparent};r.prototype.set=function e(t){var r=this.current;if(t.r===r.r&&t.g===r.g&&t.b===r.b&&t.a===r.a&&!this.dirty){return}this.gl.blendColor(t.r,t.g,t.b,t.a);this.current=t;this.dirty=false};return r}(ce);var Me=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return this.gl.FUNC_ADD};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.blendEquation(t);this.current=t;this.dirty=false};return t}(ce);var Ie=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return false};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;if(t){r.enable(r.CULL_FACE)}else{r.disable(r.CULL_FACE)}this.current=t;this.dirty=false};return t}(ce);var Ae=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return this.gl.BACK};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.cullFace(t);this.current=t;this.dirty=false};return t}(ce);var Le=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return this.gl.CCW};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.frontFace(t);this.current=t;this.dirty=false};return t}(ce);var Ee=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return null};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.useProgram(t);this.current=t;this.dirty=false};return t}(ce);var ke=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return this.gl.TEXTURE0};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.gl.activeTexture(t);this.current=t;this.dirty=false};return t}(ce);var De=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){var t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]};t.prototype.set=function e(t){var r=this.current;if(t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&!this.dirty){return}this.gl.viewport(t[0],t[1],t[2],t[3]);this.current=t;this.dirty=false};return t}(ce);var Be=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return null};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,t);this.current=t;this.dirty=false};return t}(ce);var Re=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return null};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,t);this.current=t;this.dirty=false};return t}(ce);var Fe=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return null};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;r.bindTexture(r.TEXTURE_2D,t);this.current=t;this.dirty=false};return t}(ce);var Oe=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return null};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,t);this.current=t;this.dirty=false};return t}(ce);var ze=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return null};t.prototype.set=function e(t){var r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t);this.current=t;this.dirty=false};return t}(ce);var Ue=function(e){function t(t){e.call(this,t);this.vao=t.extVertexArrayObject}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return null};t.prototype.set=function e(t){if(!this.vao||t===this.current&&!this.dirty){return}this.vao.bindVertexArrayOES(t);this.current=t;this.dirty=false};return t}(ce);var Ne=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return 4};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,t);this.current=t;this.dirty=false};return t}(ce);var je=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return false};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t);this.current=t;this.dirty=false};return t}(ce);var Ve=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return false};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}var r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,t);this.current=t;this.dirty=false};return t}(ce);var Ge=function(e){function t(t,r){e.call(this,t);this.context=t;this.parent=r}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.getDefault=function e(){return null};return t}(ce);var Ze=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.setDirty=function e(){this.dirty=true};t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.context.bindFramebuffer.set(this.parent);var r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0);this.current=t;this.dirty=false};return t}(Ge);var qe=function(e){function t(){e.apply(this,arguments)}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;t.prototype.set=function e(t){if(t===this.current&&!this.dirty){return}this.context.bindFramebuffer.set(this.parent);var r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,t);this.current=t;this.dirty=false};return t}(Ge);var He=function e(t,r,i){this.context=t;this.width=r;this.height=i;var n=t.gl;var a=this.framebuffer=n.createFramebuffer();this.colorAttachment=new Ze(t,a);this.depthAttachment=new qe(t,a)};He.prototype.destroy=function e(){var t=this.context.gl;var r=this.colorAttachment.get();if(r){t.deleteTexture(r)}var i=this.depthAttachment.get();if(i){t.deleteRenderbuffer(i)}t.deleteFramebuffer(this.framebuffer)};var We=519;var Xe=function e(t,r,i){this.func=t;this.mask=r;this.range=i};Xe.ReadOnly=false;Xe.ReadWrite=true;Xe.disabled=new Xe(We,Xe.ReadOnly,[0,1]);var Ye=519;var Ke=7680;var Je=function e(t,r,i,n,a,o){this.test=t;this.ref=r;this.mask=i;this.fail=n;this.depthFail=a;this.pass=o};Je.disabled=new Je({func:Ye,mask:0},0,0,Ke,Ke,Ke);var $e=0;var Qe=1;var et=771;var tt=function e(t,r,i){this.blendFunction=t;this.blendColor=r;this.mask=i};tt.Replace=[Qe,$e];tt.disabled=new tt(tt.Replace,e.Color.transparent,[false,false,false,false]);tt.unblended=new tt(tt.Replace,e.Color.transparent,[true,true,true,true]);tt.alphaBlended=new tt([Qe,et],e.Color.transparent,[true,true,true,true]);var rt=1029;var it=2305;var nt=function e(t,r,i){this.enable=t;this.mode=r;this.frontFace=i};nt.disabled=new nt(false,rt,it);nt.backCCW=new nt(true,rt,it);var at=function e(t){this.gl=t;this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object");this.clearColor=new he(this);this.clearDepth=new pe(this);this.clearStencil=new de(this);this.colorMask=new ve(this);this.depthMask=new ye(this);this.stencilMask=new me(this);this.stencilFunc=new ge(this);this.stencilOp=new _e(this);this.stencilTest=new xe(this);this.depthRange=new be(this);this.depthTest=new we(this);this.depthFunc=new Se(this);this.blend=new Ce(this);this.blendFunc=new Te(this);this.blendColor=new Pe(this);this.blendEquation=new Me(this);this.cullFace=new Ie(this);this.cullFaceSide=new Ae(this);this.frontFace=new Le(this);this.program=new Ee(this);this.activeTexture=new ke(this);this.viewport=new De(this);this.bindFramebuffer=new Be(this);this.bindRenderbuffer=new Re(this);this.bindTexture=new Fe(this);this.bindVertexBuffer=new Oe(this);this.bindElementBuffer=new ze(this);this.bindVertexArrayOES=this.extVertexArrayObject&&new Ue(this);this.pixelStoreUnpack=new Ne(this);this.pixelStoreUnpackPremultiplyAlpha=new je(this);this.pixelStoreUnpackFlipY=new Ve(this);this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");if(this.extTextureFilterAnisotropic){this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}this.extTextureHalfFloat=t.getExtension("OES_texture_half_float");if(this.extTextureHalfFloat){t.getExtension("OES_texture_half_float_linear")}};at.prototype.setDirty=function e(){this.clearColor.dirty=true;this.clearDepth.dirty=true;this.clearStencil.dirty=true;this.colorMask.dirty=true;this.depthMask.dirty=true;this.stencilMask.dirty=true;this.stencilFunc.dirty=true;this.stencilOp.dirty=true;this.stencilTest.dirty=true;this.depthRange.dirty=true;this.depthTest.dirty=true;this.depthFunc.dirty=true;this.blend.dirty=true;this.blendFunc.dirty=true;this.blendColor.dirty=true;this.blendEquation.dirty=true;this.cullFace.dirty=true;this.cullFaceSide.dirty=true;this.frontFace.dirty=true;this.program.dirty=true;this.activeTexture.dirty=true;this.viewport.dirty=true;this.bindFramebuffer.dirty=true;this.bindRenderbuffer.dirty=true;this.bindTexture.dirty=true;this.bindVertexBuffer.dirty=true;this.bindElementBuffer.dirty=true;if(this.extVertexArrayObject){this.bindVertexArrayOES.dirty=true}this.pixelStoreUnpack.dirty=true;this.pixelStoreUnpackPremultiplyAlpha.dirty=true;this.pixelStoreUnpackFlipY.dirty=true};at.prototype.createIndexBuffer=function e(t,r){return new le(this,t,r)};at.prototype.createVertexBuffer=function e(t,r,i){return new fe(this,t,r,i)};at.prototype.createRenderbuffer=function e(t,r,i){var n=this.gl;var a=n.createRenderbuffer();this.bindRenderbuffer.set(a);n.renderbufferStorage(n.RENDERBUFFER,t,r,i);this.bindRenderbuffer.set(null);return a};at.prototype.createFramebuffer=function e(t,r){return new He(this,t,r)};at.prototype.clear=function e(t){var r=t.color;var i=t.depth;var n=this.gl;var a=0;if(r){a|=n.COLOR_BUFFER_BIT;this.clearColor.set(r);this.colorMask.set([true,true,true,true])}if(typeof i!=="undefined"){a|=n.DEPTH_BUFFER_BIT;this.depthRange.set([0,1]);this.clearDepth.set(i);this.depthMask.set(true)}n.clear(a)};at.prototype.setCullFace=function e(t){if(t.enable===false){this.cullFace.set(false)}else{this.cullFace.set(true);this.cullFaceSide.set(t.mode);this.frontFace.set(t.frontFace)}};at.prototype.setDepthMode=function e(t){if(t.func===this.gl.ALWAYS&&!t.mask){this.depthTest.set(false)}else{this.depthTest.set(true);this.depthFunc.set(t.func);this.depthMask.set(t.mask);this.depthRange.set(t.range)}};at.prototype.setStencilMode=function e(t){if(t.test.func===this.gl.ALWAYS&&!t.mask){this.stencilTest.set(false)}else{this.stencilTest.set(true);this.stencilMask.set(t.mask);this.stencilOp.set([t.fail,t.depthFail,t.pass]);this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})}};at.prototype.setColorMode=function t(r){if(e.isEqual(r.blendFunction,tt.Replace)){this.blend.set(false)}else{this.blend.set(true);this.blendFunc.set(r.blendFunction);this.blendColor.set(r.blendColor)}this.colorMask.set(r.mask)};at.prototype.unbindVAO=function e(){if(this.extVertexArrayObject){this.bindVertexArrayOES.set(null)}};var ot=function(t){function r(r,i,n){var a=this;t.call(this);this.id=r;this.dispatcher=n;this.on("data",function(e){if(e.dataType==="source"&&e.sourceDataType==="metadata"){a._sourceLoaded=true}if(a._sourceLoaded&&!a._paused&&e.dataType==="source"&&e.sourceDataType==="content"){a.reload();if(a.transform){a.update(a.transform)}}});this.on("error",function(){a._sourceErrored=true});this._source=Q(r,i,n,this);this._tiles={};this._cache=new se(0,this._unloadTile.bind(this));this._timers={};this._cacheTimers={};this._maxTileCacheSize=null;this._coveredTiles={};this._state=new e.SourceFeatureState}if(t)r.__proto__=t;r.prototype=(0,F.default)(t&&t.prototype);r.prototype.constructor=r;r.prototype.onAdd=function e(t){this.map=t;this._maxTileCacheSize=t?t._maxTileCacheSize:null;if(this._source&&this._source.onAdd){this._source.onAdd(t)}};r.prototype.onRemove=function e(t){if(this._source&&this._source.onRemove){this._source.onRemove(t)}};r.prototype.loaded=function e(){var t=this;if(this._sourceErrored){return true}if(!this._sourceLoaded){return false}for(var r in t._tiles){var i=t._tiles[r];if(i.state!=="loaded"&&i.state!=="errored"){return false}}return true};r.prototype.getSource=function e(){return this._source};r.prototype.pause=function e(){this._paused=true};r.prototype.resume=function e(){if(!this._paused){return}var t=this._shouldReloadOnResume;this._paused=false;this._shouldReloadOnResume=false;if(t){this.reload()}if(this.transform){this.update(this.transform)}};r.prototype._loadTile=function e(t,r){return this._source.loadTile(t,r)};r.prototype._unloadTile=function e(t){if(this._source.unloadTile){return this._source.unloadTile(t,function(){})}};r.prototype._abortTile=function e(t){if(this._source.abortTile){return this._source.abortTile(t,function(){})}};r.prototype.serialize=function e(){return this._source.serialize()};r.prototype.prepare=function e(t){var r=this;if(this._source.prepare){this._source.prepare()}this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(var i in r._tiles){r._tiles[i].upload(t)}};r.prototype.getIds=function e(){return(0,k.default)(this._tiles).map(Number).sort(st)};r.prototype.getRenderableIds=function t(r){var i=this;var n=[];for(var a in i._tiles){if(i._isIdRenderable(+a,r)){n.push(+a)}}if(r){return n.sort(function(t,r){var n=i._tiles[t].tileID;var a=i._tiles[r].tileID;var o=new e.Point(n.canonical.x,n.canonical.y)._rotate(i.transform.angle);var s=new e.Point(a.canonical.x,a.canonical.y)._rotate(i.transform.angle);return n.overscaledZ-a.overscaledZ||s.y-o.y||s.x-o.x})}return n.sort(st)};r.prototype.hasRenderableParent=function e(t){var r=this.findLoadedParent(t,0);if(r){return this._isIdRenderable(r.tileID.key)}return false};r.prototype._isIdRenderable=function e(t,r){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(r||!this._tiles[t].holdingForFade())};r.prototype.reload=function e(){var t=this;if(this._paused){this._shouldReloadOnResume=true;return}this._cache.reset();for(var r in t._tiles){if(t._tiles[r].state!=="errored"){t._reloadTile(r,"reloading")}}};r.prototype._reloadTile=function e(t,r){var i=this._tiles[t];if(!i){return}if(i.state!=="loading"){i.state=r}this._loadTile(i,this._tileLoaded.bind(this,i,t,r))};r.prototype._tileLoaded=function t(r,i,n,a){if(a){r.state="errored";if(a.status!==404){this._source.fire(new e.ErrorEvent(a,{tile:r}))}else{this.update(this.transform)}return}r.timeAdded=e.browser.now();if(n==="expired"){r.refreshedUponExpiration=true}this._setTileReloadTimer(i,r);if(this.getSource().type==="raster-dem"&&r.dem){this._backfillDEM(r)}this._state.initializeTileState(r,this.map?this.map.painter:null);this._source.fire(new e.Event("data",{dataType:"source",tile:r,coord:r.tileID}))};r.prototype._backfillDEM=function e(t){var r=this;var i=this.getRenderableIds();for(var n=0;n<i.length;n++){var a=i[n];if(t.neighboringTiles&&t.neighboringTiles[a]){var o=r.getTileByID(a);s(t,o);s(o,t)}}function s(e,t){e.needsHillshadePrepare=true;var r=t.tileID.canonical.x-e.tileID.canonical.x;var i=t.tileID.canonical.y-e.tileID.canonical.y;var n=Math.pow(2,e.tileID.canonical.z);var a=t.tileID.key;if(r===0&&i===0){return}if(Math.abs(i)>1){return}if(Math.abs(r)>1){if(Math.abs(r+n)===1){r+=n}else if(Math.abs(r-n)===1){r-=n}}if(!t.dem||!e.dem){return}e.dem.backfillBorder(t.dem,r,i);if(e.neighboringTiles&&e.neighboringTiles[a]){e.neighboringTiles[a].backfilled=true}}};r.prototype.getTile=function e(t){return this.getTileByID(t.key)};r.prototype.getTileByID=function e(t){return this._tiles[t]};r.prototype.getZoom=function e(t){return t.zoom+t.scaleZoom(t.tileSize/this._source.tileSize)};r.prototype._retainLoadedChildren=function e(t,r,i,n){var a=this;for(var o in a._tiles){var s=a._tiles[o];if(n[o]||!s.hasData()||s.tileID.overscaledZ<=r||s.tileID.overscaledZ>i){continue}var l=s.tileID;while(s&&s.tileID.overscaledZ>r+1){var u=s.tileID.scaledTo(s.tileID.overscaledZ-1);s=a._tiles[u.key];if(s&&s.hasData()){l=u}}var f=l;while(f.overscaledZ>r){f=f.scaledTo(f.overscaledZ-1);if(t[f.key]){n[l.key]=l;break}}}};r.prototype.findLoadedParent=function e(t,r){var i=this;for(var n=t.overscaledZ-1;n>=r;n--){var a=t.scaledTo(n);if(!a){return}var o=String(a.key);var s=i._tiles[o];if(s&&s.hasData()){return s}if(i._cache.has(a)){return i._cache.get(a)}}};r.prototype.updateCacheSize=function e(t){var r=Math.ceil(t.width/this._source.tileSize)+1;var i=Math.ceil(t.height/this._source.tileSize)+1;var n=r*i;var a=5;var o=Math.floor(n*a);var s=typeof this._maxTileCacheSize==="number"?Math.min(this._maxTileCacheSize,o):o;this._cache.setMaxSize(s)};r.prototype.handleWrapJump=function e(t){var r=this;var i=this._prevLng===undefined?t:this._prevLng;var n=t-i;var a=n/360;var o=Math.round(a);this._prevLng=t;if(o){var s={};for(var l in r._tiles){var u=r._tiles[l];u.tileID=u.tileID.unwrapTo(u.tileID.wrap+o);s[u.tileID.key]=u}this._tiles=s;for(var f in r._timers){clearTimeout(r._timers[f]);delete r._timers[f]}for(var c in r._tiles){var h=r._tiles[c];r._setTileReloadTimer(c,h)}}};r.prototype.update=function t(i){var n=this;this.transform=i;if(!this._sourceLoaded||this._paused){return}this.updateCacheSize(i);this.handleWrapJump(this.transform.center.lng);this._coveredTiles={};var a;if(!this.used){a=[]}else if(this._source.tileID){a=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(t){return new e.OverscaledTileID(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)})}else{a=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled});if(this._source.hasTile){a=a.filter(function(e){return n._source.hasTile(e)})}}var o=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(i));var s=Math.max(o-r.maxOverzooming,this._source.minzoom);var l=Math.max(o+r.maxUnderzooming,this._source.minzoom);var u=this._updateRetainedTiles(a,o);if(lt(this._source.type)){var f={};var c={};var h=(0,k.default)(u);for(var p=0,d=h;p<d.length;p+=1){var v=d[p];var y=u[v];e.assert(y.key===+v);var m=n._tiles[v];if(!m||m.fadeEndTime&&m.fadeEndTime<=e.browser.now()){continue}var g=n.findLoadedParent(y,s);if(g){n._addTile(g.tileID);f[g.tileID.key]=g.tileID}c[v]=y}this._retainLoadedChildren(c,o,l,u);for(var _ in f){if(!u[_]){n._coveredTiles[_]=true;u[_]=f[_]}}}for(var x in u){n._tiles[x].clearFadeHold()}var b=e.keysDifference(this._tiles,u);for(var w=0,S=b;w<S.length;w+=1){var C=S[w];var T=n._tiles[C];if(T.hasSymbolBuckets&&!T.holdingForFade()){T.setHoldDuration(n.map._fadeDuration)}else if(!T.hasSymbolBuckets||T.symbolFadeFinished()){n._removeTile(C)}}};r.prototype.releaseSymbolFadeTiles=function e(){var t=this;for(var r in t._tiles){if(t._tiles[r].holdingForFade()){t._removeTile(r)}}};r.prototype._updateRetainedTiles=function e(t,i){var n=this;var a={};var o={};var s=Math.max(i-r.maxOverzooming,this._source.minzoom);var l=Math.max(i+r.maxUnderzooming,this._source.minzoom);var u={};for(var f=0,c=t;f<c.length;f+=1){var h=c[f];var p=n._addTile(h);a[h.key]=h;if(p.hasData()){continue}if(i<n._source.maxzoom){u[h.key]=h}}this._retainLoadedChildren(u,i,l,a);for(var d=0,v=t;d<v.length;d+=1){var y=v[d];var m=n._tiles[y.key];if(m.hasData()){continue}if(i+1>n._source.maxzoom){var g=y.children(n._source.maxzoom)[0];var _=n.getTile(g);if(!!_&&_.hasData()){a[g.key]=g;continue}}else{var x=y.children(n._source.maxzoom);if(a[x[0].key]&&a[x[1].key]&&a[x[2].key]&&a[x[3].key]){continue}}var b=m.wasRequested();for(var w=y.overscaledZ-1;w>=s;--w){var S=y.scaledTo(w);if(o[S.key]){break}o[S.key]=true;m=n.getTile(S);if(!m&&b){m=n._addTile(S)}if(m){a[S.key]=S;b=m.wasRequested();if(m.hasData()){break}}}}return a};r.prototype._addTile=function t(r){var i=this._tiles[r.key];if(i){return i}i=this._cache.getAndRemove(r);if(i){this._setTileReloadTimer(r.key,i);i.tileID=r;this._state.initializeTileState(i,this.map?this.map.painter:null);if(this._cacheTimers[r.key]){clearTimeout(this._cacheTimers[r.key]);delete this._cacheTimers[r.key];this._setTileReloadTimer(r.key,i)}}var n=Boolean(i);if(!n){i=new e.Tile(r,this._source.tileSize*r.overscaleFactor());this._loadTile(i,this._tileLoaded.bind(this,i,r.key,i.state))}if(!i){return null}i.uses++;this._tiles[r.key]=i;if(!n){this._source.fire(new e.Event("dataloading",{tile:i,coord:i.tileID,dataType:"source"}))}return i};r.prototype._setTileReloadTimer=function e(t,r){var i=this;if(t in this._timers){clearTimeout(this._timers[t]);delete this._timers[t]}var n=r.getExpiryTimeout();if(n){this._timers[t]=setTimeout(function(){i._reloadTile(t,"expired");delete i._timers[t]},n)}};r.prototype._removeTile=function e(t){var r=this._tiles[t];if(!r){return}r.uses--;delete this._tiles[t];if(this._timers[t]){clearTimeout(this._timers[t]);delete this._timers[t]}if(r.uses>0){return}if(r.hasData()){this._cache.add(r.tileID,r,r.getExpiryTimeout())}else{r.aborted=true;this._abortTile(r);this._unloadTile(r)}};r.prototype.clearTiles=function e(){var t=this;this._shouldReloadOnResume=false;this._paused=false;for(var r in t._tiles){t._removeTile(r)}this._cache.reset()};r.prototype.tilesIn=function t(r,i){var n=this;var a=[];var o=this.getIds();var s=Infinity;var l=Infinity;var u=-Infinity;var f=-Infinity;for(var c=0;c<r.length;c++){var h=r[c];s=Math.min(s,h.x);l=Math.min(l,h.y);u=Math.max(u,h.x);f=Math.max(f,h.y)}for(var p=0;p<o.length;p++){var d=n._tiles[o[p]];if(d.holdingForFade()){continue}var v=d.tileID;var y=Math.pow(2,n.transform.zoom-d.tileID.overscaledZ);var m=i*d.queryPadding*e.EXTENT/d.tileSize/y;var g=[v.getTilePoint(new e.MercatorCoordinate(s,l)),v.getTilePoint(new e.MercatorCoordinate(u,f))];if(g[0].x-m<e.EXTENT&&g[0].y-m<e.EXTENT&&g[1].x+m>=0&&g[1].y+m>=0){var _=[];for(var x=0;x<r.length;x++){_.push(v.getTilePoint(r[x]))}a.push({tile:d,tileID:v,queryGeometry:[_],scale:y})}}return a};r.prototype.getVisibleCoordinates=function e(t){var r=this;var i=this.getRenderableIds(t).map(function(e){return r._tiles[e].tileID});for(var n=0,a=i;n<a.length;n+=1){var o=a[n];o.posMatrix=r.transform.calculatePosMatrix(o.toUnwrapped())}return i};r.prototype.hasTransition=function t(){var r=this;if(this._source.hasTransition()){return true}if(lt(this._source.type)){for(var i in r._tiles){var n=r._tiles[i];if(n.fadeEndTime!==undefined&&n.fadeEndTime>=e.browser.now()){return true}}}return false};r.prototype.setFeatureState=function e(t,r,i){t=t||"_geojsonTileLayer";this._state.updateState(t,r,i)};r.prototype.getFeatureState=function e(t,r){t=t||"_geojsonTileLayer";return this._state.getState(t,r)};return r}(e.Evented);ot.maxOverzooming=10;ot.maxUnderzooming=3;function st(e,t){return e%32-t%32||t-e}function lt(e){return e==="raster"||e==="image"||e==="video"}function ut(){return new e.window.Worker(es.workerUrl)}var ft=function e(){this.active={}};ft.prototype.acquire=function e(t){var r=this;if(!this.workers){this.workers=[];while(this.workers.length<ft.workerCount){r.workers.push(new ut)}}this.active[t]=true;return this.workers.slice()};ft.prototype.release=function e(t){delete this.active[t];if((0,k.default)(this.active).length===0){this.workers.forEach(function(e){e.terminate()});this.workers=null}};var ct=Math.floor(e.browser.hardwareConcurrency/2);ft.workerCount=Math.max(Math.min(ct,6),1);var ht;function pt(){if(!ht){ht=new ft}return ht}function dt(t,r){var i={};for(var n in t){if(n!=="ref"){i[n]=t[n]}}e.refProperties.forEach(function(e){if(e in r){i[e]=r[e]}});return i}function vt(e){e=e.slice();var t=(0,F.default)(null);for(var r=0;r<e.length;r++){t[e[r].id]=e[r]}for(var i=0;i<e.length;i++){if("ref"in e[i]){e[i]=dt(e[i],t[e[i].ref])}}return e}var yt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function mt(e,t,r){r.push({command:yt.addSource,args:[e,t[e]]})}function gt(e,t,r){t.push({command:yt.removeSource,args:[e]});r[e]=true}function _t(e,t,r,i){gt(e,r,i);mt(e,t,r)}function xt(t,r,i){var n;for(n in t[i]){if(!t[i].hasOwnProperty(n)){continue}if(n!=="data"&&!e.isEqual(t[i][n],r[i][n])){return false}}for(n in r[i]){if(!r[i].hasOwnProperty(n)){continue}if(n!=="data"&&!e.isEqual(t[i][n],r[i][n])){return false}}return true}function bt(t,r,i,n){t=t||{};r=r||{};var a;for(a in t){if(!t.hasOwnProperty(a)){continue}if(!r.hasOwnProperty(a)){gt(a,i,n)}}for(a in r){if(!r.hasOwnProperty(a)){continue}if(!t.hasOwnProperty(a)){mt(a,r,i)}else if(!e.isEqual(t[a],r[a])){if(t[a].type==="geojson"&&r[a].type==="geojson"&&xt(t,r,a)){i.push({command:yt.setGeoJSONSourceData,args:[a,r[a].data]})}else{_t(a,r,i,n)}}}}function wt(t,r,i,n,a,o){t=t||{};r=r||{};var s;for(s in t){if(!t.hasOwnProperty(s)){continue}if(!e.isEqual(t[s],r[s])){i.push({command:o,args:[n,s,r[s],a]})}}for(s in r){if(!r.hasOwnProperty(s)||t.hasOwnProperty(s)){continue}if(!e.isEqual(t[s],r[s])){i.push({command:o,args:[n,s,r[s],a]})}}}function St(e){return e.id}function Ct(e,t){e[t.id]=t;return e}function Tt(t,r,i){t=t||[];r=r||[];var n=t.map(St);var a=r.map(St);var o=t.reduce(Ct,{});var s=r.reduce(Ct,{});var l=n.slice();var u=(0,F.default)(null);var f,c,h,p,d,v,y;for(f=0,c=0;f<n.length;f++){h=n[f];if(!s.hasOwnProperty(h)){i.push({command:yt.removeLayer,args:[h]});l.splice(l.indexOf(h,c),1)}else{c++}}for(f=0,c=0;f<a.length;f++){h=a[a.length-1-f];if(l[l.length-1-f]===h){continue}if(o.hasOwnProperty(h)){i.push({command:yt.removeLayer,args:[h]});l.splice(l.lastIndexOf(h,l.length-c),1)}else{c++}v=l[l.length-f];i.push({command:yt.addLayer,args:[s[h],v]});l.splice(l.length-f,0,h);u[h]=true}for(f=0;f<a.length;f++){h=a[f];p=o[h];d=s[h];if(u[h]||e.isEqual(p,d)){continue}if(!e.isEqual(p.source,d.source)||!e.isEqual(p["source-layer"],d["source-layer"])||!e.isEqual(p.type,d.type)){i.push({command:yt.removeLayer,args:[h]});v=l[l.lastIndexOf(h)+1];i.push({command:yt.addLayer,args:[d,v]});continue}wt(p.layout,d.layout,i,h,null,yt.setLayoutProperty);wt(p.paint,d.paint,i,h,null,yt.setPaintProperty);if(!e.isEqual(p.filter,d.filter)){i.push({command:yt.setFilter,args:[h,d.filter]})}if(!e.isEqual(p.minzoom,d.minzoom)||!e.isEqual(p.maxzoom,d.maxzoom)){i.push({command:yt.setLayerZoomRange,args:[h,d.minzoom,d.maxzoom]})}for(y in p){if(!p.hasOwnProperty(y)){continue}if(y==="layout"||y==="paint"||y==="filter"||y==="metadata"||y==="minzoom"||y==="maxzoom"){continue}if(y.indexOf("paint.")===0){wt(p[y],d[y],i,h,y.slice(6),yt.setPaintProperty)}else if(!e.isEqual(p[y],d[y])){i.push({command:yt.setLayerProperty,args:[h,y,d[y]]})}}for(y in d){if(!d.hasOwnProperty(y)||p.hasOwnProperty(y)){continue}if(y==="layout"||y==="paint"||y==="filter"||y==="metadata"||y==="minzoom"||y==="maxzoom"){continue}if(y.indexOf("paint.")===0){wt(p[y],d[y],i,h,y.slice(6),yt.setPaintProperty)}else if(!e.isEqual(p[y],d[y])){i.push({command:yt.setLayerProperty,args:[h,y,d[y]]})}}}}function Pt(t,r){if(!t){return[{command:yt.setStyle,args:[r]}]}var i=[];try{if(!e.isEqual(t.version,r.version)){return[{command:yt.setStyle,args:[r]}]}if(!e.isEqual(t.center,r.center)){i.push({command:yt.setCenter,args:[r.center]})}if(!e.isEqual(t.zoom,r.zoom)){i.push({command:yt.setZoom,args:[r.zoom]})}if(!e.isEqual(t.bearing,r.bearing)){i.push({command:yt.setBearing,args:[r.bearing]})}if(!e.isEqual(t.pitch,r.pitch)){i.push({command:yt.setPitch,args:[r.pitch]})}if(!e.isEqual(t.sprite,r.sprite)){i.push({command:yt.setSprite,args:[r.sprite]})}if(!e.isEqual(t.glyphs,r.glyphs)){i.push({command:yt.setGlyphs,args:[r.glyphs]})}if(!e.isEqual(t.transition,r.transition)){i.push({command:yt.setTransition,args:[r.transition]})}if(!e.isEqual(t.light,r.light)){i.push({command:yt.setLight,args:[r.light]})}var n={};var a=[];bt(t.sources,r.sources,a,n);var o=[];if(t.layers){t.layers.forEach(function(e){if(n[e.source]){i.push({command:yt.removeLayer,args:[e.id]})}else{o.push(e)}})}i=i.concat(a);Tt(o,r.layers,i)}catch(e){console.warn("Unable to compute style diff:",e);i=[{command:yt.setStyle,args:[r]}]}return i}var Mt=function e(t,r,i){var n=this.boxCells=[];var a=this.circleCells=[];this.xCellCount=Math.ceil(t/i);this.yCellCount=Math.ceil(r/i);for(var o=0;o<this.xCellCount*this.yCellCount;o++){n.push([]);a.push([])}this.circleKeys=[];this.boxKeys=[];this.bboxes=[];this.circles=[];this.width=t;this.height=r;this.xScale=this.xCellCount/t;this.yScale=this.yCellCount/r;this.boxUid=0;this.circleUid=0};Mt.prototype.keysLength=function e(){return this.boxKeys.length+this.circleKeys.length};Mt.prototype.insert=function e(t,r,i,n,a){this._forEachCell(r,i,n,a,this._insertBoxCell,this.boxUid++);this.boxKeys.push(t);this.bboxes.push(r);this.bboxes.push(i);this.bboxes.push(n);this.bboxes.push(a)};Mt.prototype.insertCircle=function e(t,r,i,n){this._forEachCell(r-n,i-n,r+n,i+n,this._insertCircleCell,this.circleUid++);this.circleKeys.push(t);this.circles.push(r);this.circles.push(i);this.circles.push(n)};Mt.prototype._insertBoxCell=function e(t,r,i,n,a,o){this.boxCells[a].push(o)};Mt.prototype._insertCircleCell=function e(t,r,i,n,a,o){this.circleCells[a].push(o)};Mt.prototype._query=function e(t,r,i,n,a,o){var s=this;if(i<0||t>this.width||n<0||r>this.height){return a?false:[]}var l=[];if(t<=0&&r<=0&&this.width<=i&&this.height<=n){if(a){return true}for(var u=0;u<this.boxKeys.length;u++){l.push({key:s.boxKeys[u],x1:s.bboxes[u*4],y1:s.bboxes[u*4+1],x2:s.bboxes[u*4+2],y2:s.bboxes[u*4+3]})}for(var f=0;f<this.circleKeys.length;f++){var c=s.circles[f*3];var h=s.circles[f*3+1];var p=s.circles[f*3+2];l.push({key:s.circleKeys[f],x1:c-p,y1:h-p,x2:c+p,y2:h+p})}return o?l.filter(o):l}else{var d={hitTest:a,seenUids:{box:{},circle:{}}};this._forEachCell(t,r,i,n,this._queryCell,l,d,o);return a?l.length>0:l}};Mt.prototype._queryCircle=function e(t,r,i,n,a){var o=t-i;var s=t+i;var l=r-i;var u=r+i;if(s<0||o>this.width||u<0||l>this.height){return n?false:[]}var f=[];var c={hitTest:n,circle:{x:t,y:r,radius:i},seenUids:{box:{},circle:{}}};this._forEachCell(o,l,s,u,this._queryCellCircle,f,c,a);return n?f.length>0:f};Mt.prototype.query=function e(t,r,i,n,a){return this._query(t,r,i,n,false,a)};Mt.prototype.hitTest=function e(t,r,i,n,a){return this._query(t,r,i,n,true,a)};Mt.prototype.hitTestCircle=function e(t,r,i,n){return this._queryCircle(t,r,i,true,n)};Mt.prototype._queryCell=function e(t,r,i,n,a,o,s,l){var u=this;var f=s.seenUids;var c=this.boxCells[a];if(c!==null){var h=this.bboxes;for(var p=0,d=c;p<d.length;p+=1){var v=d[p];if(!f.box[v]){f.box[v]=true;var y=v*4;if(t<=h[y+2]&&r<=h[y+3]&&i>=h[y+0]&&n>=h[y+1]&&(!l||l(u.boxKeys[v]))){if(s.hitTest){o.push(true);return true}else{o.push({key:u.boxKeys[v],x1:h[y],y1:h[y+1],x2:h[y+2],y2:h[y+3]})}}}}}var m=this.circleCells[a];if(m!==null){var g=this.circles;for(var _=0,x=m;_<x.length;_+=1){var b=x[_];if(!f.circle[b]){f.circle[b]=true;var w=b*3;if(u._circleAndRectCollide(g[w],g[w+1],g[w+2],t,r,i,n)&&(!l||l(u.circleKeys[b]))){if(s.hitTest){o.push(true);return true}else{var S=g[w];var C=g[w+1];var T=g[w+2];o.push({key:u.circleKeys[b],x1:S-T,y1:C-T,x2:S+T,y2:C+T})}}}}}};Mt.prototype._queryCellCircle=function e(t,r,i,n,a,o,s,l){var u=this;var f=s.circle;var c=s.seenUids;var h=this.boxCells[a];if(h!==null){var p=this.bboxes;for(var d=0,v=h;d<v.length;d+=1){var y=v[d];if(!c.box[y]){c.box[y]=true;var m=y*4;if(u._circleAndRectCollide(f.x,f.y,f.radius,p[m+0],p[m+1],p[m+2],p[m+3])&&(!l||l(u.boxKeys[y]))){o.push(true);return true}}}}var g=this.circleCells[a];if(g!==null){var _=this.circles;for(var x=0,b=g;x<b.length;x+=1){var w=b[x];if(!c.circle[w]){c.circle[w]=true;var S=w*3;if(u._circlesCollide(_[S],_[S+1],_[S+2],f.x,f.y,f.radius)&&(!l||l(u.circleKeys[w]))){o.push(true);return true}}}}};Mt.prototype._forEachCell=function e(t,r,i,n,a,o,s,l){var u=this;var f=this._convertToXCellCoord(t);var c=this._convertToYCellCoord(r);var h=this._convertToXCellCoord(i);var p=this._convertToYCellCoord(n);for(var d=f;d<=h;d++){for(var v=c;v<=p;v++){var y=u.xCellCount*v+d;if(a.call(u,t,r,i,n,y,o,s,l)){return}}}};Mt.prototype._convertToXCellCoord=function e(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))};Mt.prototype._convertToYCellCoord=function e(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))};Mt.prototype._circlesCollide=function e(t,r,i,n,a,o){var s=n-t;var l=a-r;var u=i+o;return u*u>s*s+l*l};Mt.prototype._circleAndRectCollide=function e(t,r,i,n,a,o,s){var l=(o-n)/2;var u=Math.abs(t-(n+l));if(u>l+i){return false}var f=(s-a)/2;var c=Math.abs(r-(a+f));if(c>f+i){return false}if(u<=l||c<=f){return true}var h=u-l;var p=c-f;return h*h+p*p<=i*i};var It=e.properties.layout;function At(t,r,i,n,a){var o=e.identity(new Float32Array(16));if(r){e.identity(o);e.scale(o,o,[1/a,1/a,1]);if(!i){e.rotateZ(o,o,n.angle)}}else{e.scale(o,o,[n.width/2,-n.height/2,1]);e.translate(o,o,[1,-1,0]);e.multiply(o,o,t)}return o}function Lt(t,r,i,n,a){var o=e.identity(new Float32Array(16));if(r){e.multiply(o,o,t);e.scale(o,o,[a,a,1]);if(!i){e.rotateZ(o,o,-n.angle)}}else{e.scale(o,o,[1,-1,1]);e.translate(o,o,[-1,-1,0]);e.scale(o,o,[2/n.width,2/n.height,1])}return o}function Et(t,r){var i=[t.x,t.y,0,1];jt(i,i,r);var n=i[3];return{point:new e.Point(i[0]/n,i[1]/n),signedDistanceFromCamera:n}}function kt(e,t){var r=e[0]/e[3];var i=e[1]/e[3];var n=r>=-t[0]&&r<=t[0]&&i>=-t[1]&&i<=t[1];return n}function Dt(t,r,i,n,a,o,s,l){var u=n?t.textSizeData:t.iconSizeData;var f=e.evaluateSizeForZoom(u,i.transform.zoom,It.properties[n?"text-size":"icon-size"]);var c=[256/i.width*2+1,256/i.height*2+1];var h=n?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;h.clear();var p=t.lineVertexArray;var d=n?t.text.placedSymbolArray:t.icon.placedSymbolArray;var v=i.transform.width/i.transform.height;var y=false;for(var m=0;m<d.length;m++){var g=d.get(m);if(g.hidden||g.writingMode===e.WritingMode.vertical&&!y){Nt(g.numGlyphs,h);continue}y=false;var _=[g.anchorX,g.anchorY,0,1];e.transformMat4(_,_,r);if(!kt(_,c)){Nt(g.numGlyphs,h);continue}var x=_[3];var b=.5+.5*(x/i.transform.cameraToCenterDistance);var w=e.evaluateSizeForFeature(u,f,g);var S=s?w*b:w/b;var C=new e.Point(g.anchorX,g.anchorY);var T=Et(C,a).point;var P={};var M=Ft(g,S,false,l,r,a,o,t.glyphOffsetArray,p,h,T,C,P,v);y=M.useVertical;if(M.notEnoughRoom||y||M.needsFlipping&&Ft(g,S,true,l,r,a,o,t.glyphOffsetArray,p,h,T,C,P,v).notEnoughRoom){Nt(g.numGlyphs,h)}}if(n){t.text.dynamicLayoutVertexBuffer.updateData(h)}else{t.icon.dynamicLayoutVertexBuffer.updateData(h)}}function Bt(e,t,r,i,n,a,o,s,l,u,f,c){var h=s.glyphStartIndex+s.numGlyphs;var p=s.lineStartIndex;var d=s.lineStartIndex+s.lineLength;var v=t.getoffsetX(s.glyphStartIndex);var y=t.getoffsetX(h-1);var m=zt(e*v,r,i,n,a,o,s.segment,p,d,l,u,f,c);if(!m){return null}var g=zt(e*y,r,i,n,a,o,s.segment,p,d,l,u,f,c);if(!g){return null}return{first:m,last:g}}function Rt(t,r,i,n){if(t===e.WritingMode.horizontal){var a=Math.abs(i.y-r.y);var o=Math.abs(i.x-r.x)*n;if(a>o){return{useVertical:true}}}if(t===e.WritingMode.vertical?r.y<i.y:r.x>i.x){return{needsFlipping:true}}return null}function Ft(t,r,i,n,a,o,s,l,u,f,c,h,p,d){var v=r/24;var y=t.lineOffsetX*r;var m=t.lineOffsetY*r;var g;if(t.numGlyphs>1){var _=t.glyphStartIndex+t.numGlyphs;var x=t.lineStartIndex;var b=t.lineStartIndex+t.lineLength;var w=Bt(v,l,y,m,i,c,h,t,u,o,p,false);if(!w){return{notEnoughRoom:true}}var S=Et(w.first.point,s).point;var C=Et(w.last.point,s).point;if(n&&!i){var T=Rt(t.writingMode,S,C,d);if(T){return T}}g=[w.first];for(var P=t.glyphStartIndex+1;P<_-1;P++){g.push(zt(v*l.getoffsetX(P),y,m,i,c,h,t.segment,x,b,u,o,p,false))}g.push(w.last)}else{if(n&&!i){var M=Et(h,a).point;var I=t.lineStartIndex+t.segment+1;var A=new e.Point(u.getx(I),u.gety(I));var L=Et(A,a);var E=L.signedDistanceFromCamera>0?L.point:Ot(h,A,M,1,a);var k=Rt(t.writingMode,M,E,d);if(k){return k}}var D=zt(v*l.getoffsetX(t.glyphStartIndex),y,m,i,c,h,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,u,o,p,false);if(!D){return{notEnoughRoom:true}}g=[D]}for(var B=0,R=g;B<R.length;B+=1){var F=R[B];e.addDynamicAttributes(f,F.point,F.angle)}return{}}function Ot(e,t,r,i,n){var a=Et(e.add(e.sub(t)._unit()),n).point;var o=r.sub(a);return r.add(o._mult(i/o.mag()))}function zt(t,r,i,n,a,o,s,l,u,f,c,h,p){var d=n?t-r:t+r;var v=d>0?1:-1;var y=0;if(n){v*=-1;y=Math.PI}if(v<0){y+=Math.PI}var m=v>0?l+s:l+s+1;var g=m;var _=a;var x=a;var b=0;var w=0;var S=Math.abs(d);while(b+w<=S){m+=v;if(m<l||m>=u){return null}x=_;_=h[m];if(_===undefined){var C=new e.Point(f.getx(m),f.gety(m));var T=Et(C,c);if(T.signedDistanceFromCamera>0){_=h[m]=T.point}else{var P=m-v;var M=b===0?o:new e.Point(f.getx(P),f.gety(P));_=Ot(M,C,x,S-b+1,c)}}b+=w;w=x.dist(_)}var I=(S-b)/w;var A=_.sub(x);var L=A.mult(I)._add(x);L._add(A._unit()._perp()._mult(i*v));var E=y+Math.atan2(_.y-x.y,_.x-x.x);return{point:L,angle:E,tileDistance:p?{prevTileDistance:m-v===g?0:f.gettileUnitDistanceFromAnchor(m-v),lastSegmentViewportDistance:S-b}:null}}var Ut=new Float32Array([-Infinity,-Infinity,0,-Infinity,-Infinity,0,-Infinity,-Infinity,0,-Infinity,-Infinity,0]);function Nt(e,t){for(var r=0;r<e;r++){var i=t.length;t.resize(i+4);t.float32.set(Ut,i*3)}}function jt(e,t,r){var i=t[0],n=t[1];e[0]=r[0]*i+r[4]*n+r[12];e[1]=r[1]*i+r[5]*n+r[13];e[3]=r[3]*i+r[7]*n+r[15];return e}var Vt=100;var Gt=function e(t,r,i){if(r===void 0)r=new Mt(t.width+2*Vt,t.height+2*Vt,25);if(i===void 0)i=new Mt(t.width+2*Vt,t.height+2*Vt,25);this.transform=t;this.grid=r;this.ignoredGrid=i;this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance;this.screenRightBoundary=t.width+Vt;this.screenBottomBoundary=t.height+Vt;this.gridRightBoundary=t.width+2*Vt;this.gridBottomBoundary=t.height+2*Vt};Gt.prototype.placeCollisionBox=function e(t,r,i,n,a){var o=this.projectAndGetPerspectiveRatio(n,t.anchorPointX,t.anchorPointY);var s=i*o.perspectiveRatio;var l=t.x1*s+o.point.x;var u=t.y1*s+o.point.y;var f=t.x2*s+o.point.x;var c=t.y2*s+o.point.y;if(!this.isInsideGrid(l,u,f,c)||!r&&this.grid.hitTest(l,u,f,c,a)){return{box:[],offscreen:false}}return{box:[l,u,f,c],offscreen:this.isOffscreen(l,u,f,c)}};Gt.prototype.approximateTileDistance=function e(t,r,i,n,a){var o=a?1:n/this.pitchfactor;var s=t.lastSegmentViewportDistance*i;return t.prevTileDistance+s+(o-1)*s*Math.abs(Math.sin(r))};Gt.prototype.placeCollisionCircles=function t(r,i,n,a,o,s,l,u,f,c,h,p,d){var v=this;var y=[];var m=this.projectAnchor(f,o.anchorX,o.anchorY);var g={};var _=u/24;var x=o.lineOffsetX*u;var b=o.lineOffsetY*u;var w=new e.Point(o.anchorX,o.anchorY);var S=Et(w,c).point;var C=Bt(_,l,x,b,false,S,w,o,s,c,g,true);var T=false;var P=false;var M=true;var I=m.perspectiveRatio*a;var A=1/(a*n);var L=0,E=0;if(C){L=this.approximateTileDistance(C.first.tileDistance,C.first.angle,A,m.cameraDistance,p);E=this.approximateTileDistance(C.last.tileDistance,C.last.angle,A,m.cameraDistance,p)}for(var k=0;k<r.length;k+=5){var D=r[k];var B=r[k+1];var R=r[k+2];var F=r[k+3];if(!C||F<-L||F>E){Zt(r,k,false);continue}var O=v.projectPoint(f,D,B);var z=R*I;var U=y.length>0;if(U){var N=O.x-y[y.length-4];var j=O.y-y[y.length-3];var V=z*z*2>N*N+j*j;if(V){var G=k+8<r.length;if(G){var Z=r[k+8];if(Z>-L&&Z<E){Zt(r,k,false);continue}}}}var q=k/5;y.push(O.x,O.y,z,q);Zt(r,k,true);var H=O.x-z;var W=O.y-z;var X=O.x+z;var Y=O.y+z;M=M&&v.isOffscreen(H,W,X,Y);P=P||v.isInsideGrid(H,W,X,Y);if(!i){if(v.grid.hitTestCircle(O.x,O.y,z,d)){if(!h){return{circles:[],offscreen:false}}else{T=true}}}}return{circles:T||!P?[]:y,offscreen:M}};Gt.prototype.queryRenderedSymbols=function t(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0){return{}}var i=[];var n=Infinity;var a=Infinity;var o=-Infinity;var s=-Infinity;for(var l=0,u=r;l<u.length;l+=1){var f=u[l];var c=new e.Point(f.x+Vt,f.y+Vt);n=Math.min(n,c.x);a=Math.min(a,c.y);o=Math.max(o,c.x);s=Math.max(s,c.y);i.push(c)}var h=this.grid.query(n,a,o,s).concat(this.ignoredGrid.query(n,a,o,s));var p={};var d={};for(var v=0,y=h;v<y.length;v+=1){var m=y[v];var g=m.key;if(p[g.bucketInstanceId]===undefined){p[g.bucketInstanceId]={}}if(p[g.bucketInstanceId][g.featureIndex]){continue}var _=[new e.Point(m.x1,m.y1),new e.Point(m.x2,m.y1),new e.Point(m.x2,m.y2),new e.Point(m.x1,m.y2)];if(!e.polygonIntersectsPolygon(i,_)){continue}p[g.bucketInstanceId][g.featureIndex]=true;if(d[g.bucketInstanceId]===undefined){d[g.bucketInstanceId]=[]}d[g.bucketInstanceId].push(g.featureIndex)}return d};Gt.prototype.insertCollisionBox=function e(t,r,i,n,a){var o=r?this.ignoredGrid:this.grid;var s={bucketInstanceId:i,featureIndex:n,collisionGroupID:a};o.insert(s,t[0],t[1],t[2],t[3])};Gt.prototype.insertCollisionCircles=function e(t,r,i,n,a){var o=r?this.ignoredGrid:this.grid;var s={bucketInstanceId:i,featureIndex:n,collisionGroupID:a};for(var l=0;l<t.length;l+=4){o.insertCircle(s,t[l],t[l+1],t[l+2])}};Gt.prototype.projectAnchor=function e(t,r,i){var n=[r,i,0,1];jt(n,n,t);return{perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/n[3]),cameraDistance:n[3]}};Gt.prototype.projectPoint=function t(r,i,n){var a=[i,n,0,1];jt(a,a,r);return new e.Point((a[0]/a[3]+1)/2*this.transform.width+Vt,(-a[1]/a[3]+1)/2*this.transform.height+Vt)};Gt.prototype.projectAndGetPerspectiveRatio=function t(r,i,n){var a=[i,n,0,1];jt(a,a,r);var o=new e.Point((a[0]/a[3]+1)/2*this.transform.width+Vt,(-a[1]/a[3]+1)/2*this.transform.height+Vt);return{point:o,perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/a[3])}};Gt.prototype.isOffscreen=function e(t,r,i,n){return i<Vt||t>=this.screenRightBoundary||n<Vt||r>this.screenBottomBoundary};Gt.prototype.isInsideGrid=function e(t,r,i,n){return i>=0&&t<this.gridRightBoundary&&n>=0&&r<this.gridBottomBoundary};function Zt(e,t,r){e[t+4]=r?1:0}function qt(t,r,i){return r*(e.EXTENT/(t.tileSize*Math.pow(2,i-t.tileID.overscaledZ)))}var Ht=function e(t,r,i,n){if(t){this.opacity=Math.max(0,Math.min(1,t.opacity+(t.placed?r:-r)))}else{this.opacity=n&&i?1:0}this.placed=i};Ht.prototype.isHidden=function e(){return this.opacity===0&&!this.placed};var Wt=function e(t,r,i,n,a){this.text=new Ht(t?t.text:null,r,i,a);this.icon=new Ht(t?t.icon:null,r,n,a)};Wt.prototype.isHidden=function e(){return this.text.isHidden()&&this.icon.isHidden()};var Xt=function e(t,r,i){this.text=t;this.icon=r;this.skipFade=i};var Yt=function e(t,r,i,n,a){this.bucketInstanceId=t;this.featureIndex=r;this.sourceLayerIndex=i;this.bucketIndex=n;this.tileID=a};var Kt=function e(t){this.crossSourceCollisions=t;this.maxGroupID=0;this.collisionGroups={}};Kt.prototype.get=function e(t){if(!this.crossSourceCollisions){if(!this.collisionGroups[t]){var r=++this.maxGroupID;this.collisionGroups[t]={ID:r,predicate:function e(t){return t.collisionGroupID===r}}}return this.collisionGroups[t]}else{return{ID:0,predicate:null}}};var Jt=function e(t,r,i){this.transform=t.clone();this.collisionIndex=new Gt(this.transform);this.placements={};this.opacities={};this.stale=false;this.fadeDuration=r;this.retainedQueryData={};this.collisionGroups=new Kt(i)};Jt.prototype.placeLayerTile=function t(r,i,n,a){var o=i.getBucket(r);var s=i.latestFeatureIndex;if(!o||!s||r.id!==o.layerIds[0]){return}var l=i.collisionBoxArray;var u=o.layers[0].layout;var f=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ);var c=i.tileSize/e.EXTENT;var h=this.transform.calculatePosMatrix(i.tileID.toUnwrapped());var p=At(h,u.get("text-pitch-alignment")==="map",u.get("text-rotation-alignment")==="map",this.transform,qt(i,1,this.transform.zoom));var d=At(h,u.get("icon-pitch-alignment")==="map",u.get("icon-rotation-alignment")==="map",this.transform,qt(i,1,this.transform.zoom));this.retainedQueryData[o.bucketInstanceId]=new Yt(o.bucketInstanceId,s,o.sourceLayerIndex,o.index,i.tileID);this.placeLayerBucket(o,h,p,d,f,c,n,i.holdingForFade(),a,l)};Jt.prototype.placeLayerBucket=function t(r,i,n,a,o,s,l,u,f,c){var h=this;var p=r.layers[0].layout;var d=e.evaluateSizeForZoom(r.textSizeData,this.transform.zoom,e.properties.layout.properties["text-size"]);var v=p.get("text-optional");var y=p.get("icon-optional");var m=p.get("text-allow-overlap");var g=p.get("icon-allow-overlap");var _=m&&(g||!r.hasIconData()||y);var x=g&&(m||!r.hasTextData()||v);var b=this.collisionGroups.get(r.sourceID);if(!r.collisionArrays&&c){r.deserializeCollisionBoxes(c)}for(var w=0;w<r.symbolInstances.length;w++){var S=r.symbolInstances.get(w);if(!f[S.crossTileID]){if(u){h.placements[S.crossTileID]=new Xt(false,false,false);continue}var C=false;var T=false;var P=true;var M=null;var I=null;var A=null;var L=0;var E=0;var k=r.collisionArrays[w];if(k.textFeatureIndex){L=k.textFeatureIndex}if(k.textBox){M=h.collisionIndex.placeCollisionBox(k.textBox,p.get("text-allow-overlap"),s,i,b.predicate);C=M.box.length>0;P=P&&M.offscreen}var D=k.textCircles;if(D){var B=r.text.placedSymbolArray.get(S.horizontalPlacedTextSymbolIndex);var R=e.evaluateSizeForFeature(r.textSizeData,d,B);I=h.collisionIndex.placeCollisionCircles(D,p.get("text-allow-overlap"),o,s,B,r.lineVertexArray,r.glyphOffsetArray,R,i,n,l,p.get("text-pitch-alignment")==="map",b.predicate);C=p.get("text-allow-overlap")||I.circles.length>0;P=P&&I.offscreen}if(k.iconFeatureIndex){E=k.iconFeatureIndex}if(k.iconBox){A=h.collisionIndex.placeCollisionBox(k.iconBox,p.get("icon-allow-overlap"),s,i,b.predicate);T=A.box.length>0;P=P&&A.offscreen}var F=v||S.numGlyphVertices===0&&S.numVerticalGlyphVertices===0;var O=y||S.numIconVertices===0;if(!F&&!O){T=C=T&&C}else if(!O){C=T&&C}else if(!F){T=T&&C}if(C&&M){h.collisionIndex.insertCollisionBox(M.box,p.get("text-ignore-placement"),r.bucketInstanceId,L,b.ID)}if(T&&A){h.collisionIndex.insertCollisionBox(A.box,p.get("icon-ignore-placement"),r.bucketInstanceId,E,b.ID)}if(C&&I){h.collisionIndex.insertCollisionCircles(I.circles,p.get("text-ignore-placement"),r.bucketInstanceId,L,b.ID)}e.assert(S.crossTileID!==0);e.assert(r.bucketInstanceId!==0);h.placements[S.crossTileID]=new Xt(C||_,T||x,P||r.justReloaded);f[S.crossTileID]=true}}r.justReloaded=false};Jt.prototype.commit=function t(r,i){var n=this;this.commitTime=i;var a=false;var o=r&&this.fadeDuration!==0?(this.commitTime-r.commitTime)/this.fadeDuration:1;var s=r?r.opacities:{};for(var l in n.placements){var u=n.placements[l];var f=s[l];if(f){n.opacities[l]=new Wt(f,o,u.text,u.icon);a=a||u.text!==f.text.placed||u.icon!==f.icon.placed}else{n.opacities[l]=new Wt(null,o,u.text,u.icon,u.skipFade);a=a||u.text||u.icon}}for(var c in s){var h=s[c];if(!n.opacities[c]){var p=new Wt(h,o,false,false);if(!p.isHidden()){n.opacities[c]=p;a=a||h.text.placed||h.icon.placed}}}e.assert(!r||r.lastPlacementChangeTime!==undefined);if(a){this.lastPlacementChangeTime=i}else if(typeof this.lastPlacementChangeTime!=="number"){this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:i}};Jt.prototype.updateLayerOpacities=function e(t,r){var i=this;var n={};for(var a=0,o=r;a<o.length;a+=1){var s=o[a];var l=s.getBucket(t);if(l&&s.latestFeatureIndex&&t.id===l.layerIds[0]){i.updateBucketOpacities(l,n,s.collisionBoxArray)}}};Jt.prototype.updateBucketOpacities=function t(r,i,n){var a=this;if(r.hasTextData()){r.text.opacityVertexArray.clear()}if(r.hasIconData()){r.icon.opacityVertexArray.clear()}if(r.hasCollisionBoxData()){r.collisionBox.collisionVertexArray.clear()}if(r.hasCollisionCircleData()){r.collisionCircle.collisionVertexArray.clear()}var o=r.layers[0].layout;var s=new Wt(null,0,false,false,true);var l=o.get("text-allow-overlap");var u=o.get("icon-allow-overlap");var f=new Wt(null,0,l&&(u||!r.hasIconData()||o.get("icon-optional")),u&&(l||!r.hasTextData()||o.get("text-optional")),true);if(!r.collisionArrays&&n&&(r.hasCollisionBoxData()||r.hasCollisionCircleData())){r.deserializeCollisionBoxes(n)}for(var c=0;c<r.symbolInstances.length;c++){var h=r.symbolInstances.get(c);var p=i[h.crossTileID];var d=a.opacities[h.crossTileID];if(p){d=s}else if(!d){d=f;a.opacities[h.crossTileID]=d}i[h.crossTileID]=true;var v=h.numGlyphVertices>0||h.numVerticalGlyphVertices>0;var y=h.numIconVertices>0;if(v){var m=or(d.text);var g=(h.numGlyphVertices+h.numVerticalGlyphVertices)/4;for(var _=0;_<g;_++){r.text.opacityVertexArray.emplaceBack(m)}r.text.placedSymbolArray.get(h.horizontalPlacedTextSymbolIndex).hidden=d.text.isHidden();if(h.verticalPlacedTextSymbolIndex>=0){r.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).hidden=d.text.isHidden()}}if(y){var x=or(d.icon);for(var b=0;b<h.numIconVertices/4;b++){r.icon.opacityVertexArray.emplaceBack(x)}r.icon.placedSymbolArray.get(c).hidden=d.icon.isHidden()}if(r.hasCollisionBoxData()||r.hasCollisionCircleData()){var w=r.collisionArrays[c];if(w){if(w.textBox){$t(r.collisionBox.collisionVertexArray,d.text.placed,false)}if(w.iconBox){$t(r.collisionBox.collisionVertexArray,d.icon.placed,false)}var S=w.textCircles;if(S&&r.hasCollisionCircleData()){for(var C=0;C<S.length;C+=5){var T=p||S[C+4]===0;$t(r.collisionCircle.collisionVertexArray,d.text.placed,T)}}}}}r.sortFeatures(this.transform.angle);if(this.retainedQueryData[r.bucketInstanceId]){this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder}if(r.hasTextData()&&r.text.opacityVertexBuffer){r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray)}if(r.hasIconData()&&r.icon.opacityVertexBuffer){r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray)}if(r.hasCollisionBoxData()&&r.collisionBox.collisionVertexBuffer){r.collisionBox.collisionVertexBuffer.updateData(r.collisionBox.collisionVertexArray)}if(r.hasCollisionCircleData()&&r.collisionCircle.collisionVertexBuffer){r.collisionCircle.collisionVertexBuffer.updateData(r.collisionCircle.collisionVertexArray)}e.assert(r.text.opacityVertexArray.length===r.text.layoutVertexArray.length/4);e.assert(r.icon.opacityVertexArray.length===r.icon.layoutVertexArray.length/4)};Jt.prototype.symbolFadeChange=function e(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration};Jt.prototype.hasTransitions=function e(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration};Jt.prototype.stillRecent=function e(t){return this.commitTime!=="undefined"&&this.commitTime+this.fadeDuration>t};Jt.prototype.setStale=function e(){this.stale=true};function $t(e,t,r){e.emplaceBack(t?1:0,r?1:0);e.emplaceBack(t?1:0,r?1:0);e.emplaceBack(t?1:0,r?1:0);e.emplaceBack(t?1:0,r?1:0)}var Qt=Math.pow(2,25);var er=Math.pow(2,24);var tr=Math.pow(2,17);var rr=Math.pow(2,16);var ir=Math.pow(2,9);var nr=Math.pow(2,8);var ar=Math.pow(2,1);function or(e){if(e.opacity===0&&!e.placed){return 0}else if(e.opacity===1&&e.placed){return 4294967295}var t=e.placed?1:0;var r=Math.floor(e.opacity*127);return r*Qt+t*er+r*tr+t*rr+r*ir+t*nr+r*ar+t}var sr=function e(){this._currentTileIndex=0;this._seenCrossTileIDs={}};sr.prototype.continuePlacement=function e(t,r,i,n,a){var o=this;while(this._currentTileIndex<t.length){var s=t[o._currentTileIndex];r.placeLayerTile(n,s,i,o._seenCrossTileIDs);o._currentTileIndex++;if(a()){return true}}};var lr=function e(t,r,i,n,a,o){this.placement=new Jt(t,a,o);this._currentPlacementIndex=r.length-1;this._forceFullPlacement=i;this._showCollisionBoxes=n;this._done=false};lr.prototype.isDone=function e(){return this._done};lr.prototype.continuePlacement=function t(r,i,n){var a=this;var o=e.browser.now();var s=function t(){var r=e.browser.now()-o;return a._forceFullPlacement?false:r>2};while(this._currentPlacementIndex>=0){var l=r[a._currentPlacementIndex];var u=i[l];var f=a.placement.collisionIndex.transform.zoom;if(u.type==="symbol"&&(!u.minzoom||u.minzoom<=f)&&(!u.maxzoom||u.maxzoom>f)){if(!a._inProgressLayer){a._inProgressLayer=new sr}var c=a._inProgressLayer.continuePlacement(n[u.source],a.placement,a._showCollisionBoxes,u,s);if(c){return}delete a._inProgressLayer}a._currentPlacementIndex--}this._done=true};lr.prototype.commit=function e(t,r){this.placement.commit(t,r);return this.placement};var ur=512/e.EXTENT/2;var fr=function e(t,r,i){var n=this;this.tileID=t;this.indexedSymbolInstances={};this.bucketInstanceId=i;for(var a=0;a<r.length;a++){var o=r.get(a);var s=o.key;if(!n.indexedSymbolInstances[s]){n.indexedSymbolInstances[s]=[]}n.indexedSymbolInstances[s].push({crossTileID:o.crossTileID,coord:n.getScaledCoordinates(o,t)})}};fr.prototype.getScaledCoordinates=function t(r,i){var n=i.canonical.z-this.tileID.canonical.z;var a=ur/Math.pow(2,n);return{x:Math.floor((i.canonical.x*e.EXTENT+r.anchorX)*a),y:Math.floor((i.canonical.y*e.EXTENT+r.anchorY)*a)}};fr.prototype.findMatches=function e(t,r,i){var n=this;var a=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z);for(var o=0;o<t.length;o++){var s=t.get(o);if(s.crossTileID){continue}var l=n.indexedSymbolInstances[s.key];if(!l){continue}var u=n.getScaledCoordinates(s,r);for(var f=0,c=l;f<c.length;f+=1){var h=c[f];if(Math.abs(h.coord.x-u.x)<=a&&Math.abs(h.coord.y-u.y)<=a&&!i[h.crossTileID]){i[h.crossTileID]=true;s.crossTileID=h.crossTileID;break}}}};var cr=function e(){this.maxCrossTileID=0};cr.prototype.generate=function e(){return++this.maxCrossTileID};var hr=function e(){this.indexes={};this.usedCrossTileIDs={};this.lng=0};hr.prototype.handleWrapJump=function e(t){var r=this;var i=Math.round((t-this.lng)/360);if(i!==0){for(var n in r.indexes){var a=r.indexes[n];var o={};for(var s in a){var l=a[s];l.tileID=l.tileID.unwrapTo(l.tileID.wrap+i);o[l.tileID.key]=l}r.indexes[n]=o}}this.lng=t};hr.prototype.addBucket=function e(t,r,i){var n=this;if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===r.bucketInstanceId){return false}else{this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}}for(var a=0;a<r.symbolInstances.length;a++){var o=r.symbolInstances.get(a);o.crossTileID=0}if(!this.usedCrossTileIDs[t.overscaledZ]){this.usedCrossTileIDs[t.overscaledZ]={}}var s=this.usedCrossTileIDs[t.overscaledZ];for(var l in n.indexes){var u=n.indexes[l];if(Number(l)>t.overscaledZ){for(var f in u){var c=u[f];if(c.tileID.isChildOf(t)){c.findMatches(r.symbolInstances,t,s)}}}else{var h=t.scaledTo(Number(l));var p=u[h.key];if(p){p.findMatches(r.symbolInstances,t,s)}}}for(var d=0;d<r.symbolInstances.length;d++){var v=r.symbolInstances.get(d);if(!v.crossTileID){v.crossTileID=i.generate();s[v.crossTileID]=true}}if(this.indexes[t.overscaledZ]===undefined){this.indexes[t.overscaledZ]={}}this.indexes[t.overscaledZ][t.key]=new fr(t,r.symbolInstances,r.bucketInstanceId);return true};hr.prototype.removeBucketCrossTileIDs=function e(t,r){var i=this;for(var n in r.indexedSymbolInstances){for(var a=0,o=r.indexedSymbolInstances[n];a<o.length;a+=1){var s=o[a];delete i.usedCrossTileIDs[t][s.crossTileID]}}};hr.prototype.removeStaleBuckets=function e(t){var r=this;var i=false;for(var n in r.indexes){var a=r.indexes[n];for(var o in a){if(!t[a[o].bucketInstanceId]){r.removeBucketCrossTileIDs(n,a[o]);delete a[o];i=true}}}return i};var pr=function e(){this.layerIndexes={};this.crossTileIDs=new cr;this.maxBucketInstanceId=0;this.bucketsInCurrentPlacement={}};pr.prototype.addLayer=function e(t,r,i){var n=this;var a=this.layerIndexes[t.id];if(a===undefined){a=this.layerIndexes[t.id]=new hr}var o=false;var s={};a.handleWrapJump(i);for(var l=0,u=r;l<u.length;l+=1){var f=u[l];var c=f.getBucket(t);if(!c||t.id!==c.layerIds[0]){continue}if(!c.bucketInstanceId){c.bucketInstanceId=++n.maxBucketInstanceId}if(a.addBucket(f.tileID,c,n.crossTileIDs)){o=true}s[c.bucketInstanceId]=true}if(a.removeStaleBuckets(s)){o=true}return o};pr.prototype.pruneUnusedLayers=function e(t){var r=this;var i={};t.forEach(function(e){i[e]=true});for(var n in r.layerIndexes){if(!i[n]){delete r.layerIndexes[n]}}};var dr=function t(r,i){return e.emitValidationErrors(r,i&&i.filter(function(e){return e.identifier!=="source.canvas"}))};var vr=e.pick(yt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]);var yr=e.pick(yt,["setCenter","setZoom","setBearing","setPitch"]);var mr=function(t){function r(i,n){var a=this;if(n===void 0)n={};t.call(this);this.map=i;this.dispatcher=new j(pt(),this);this.imageManager=new _;this.glyphManager=new E(i._transformRequest,n.localIdeographFontFamily);this.lineAtlas=new N(256,512);this.crossTileSymbolIndex=new pr;this._layers={};this._order=[];this.sourceCaches={};this.zoomHistory=new e.ZoomHistory;this._loaded=false;this._resetUpdates();this.dispatcher.broadcast("setReferrer",e.getReferrer());var o=this;this._rtlTextPluginCallback=r.registerForPluginAvailability(function(e){o.dispatcher.broadcast("loadRTLTextPlugin",e.pluginURL,e.completionCallback);for(var t in o.sourceCaches){o.sourceCaches[t].reload()}});this.on("data",function(e){if(e.dataType!=="source"||e.sourceDataType!=="metadata"){return}var t=a.sourceCaches[e.sourceId];if(!t){return}var r=t.getSource();if(!r||!r.vectorLayerIds){return}for(var i in a._layers){var n=a._layers[i];if(n.source===r.id){a._validateLayer(n)}}})}if(t)r.__proto__=t;r.prototype=(0,F.default)(t&&t.prototype);r.prototype.constructor=r;r.prototype.loadURL=function t(r,i){var n=this;if(i===void 0)i={};this.fire(new e.Event("dataloading",{dataType:"style"}));var a=typeof i.validate==="boolean"?i.validate:!e.isMapboxURL(r);r=e.normalizeStyleURL(r,i.accessToken);var o=this.map._transformRequest(r,e.ResourceType.Style);this._request=e.getJSON(o,function(t,r){n._request=null;if(t){n.fire(new e.ErrorEvent(t))}else if(r){n._load(r,a)}})};r.prototype.loadJSON=function t(r,i){var n=this;if(i===void 0)i={};this.fire(new e.Event("dataloading",{dataType:"style"}));this._request=e.browser.frame(function(){n._request=null;n._load(r,i.validate!==false)})};r.prototype._load=function t(r,i){var n=this;if(i&&dr(this,e.validateStyle(r))){return}this._loaded=true;this.stylesheet=r;for(var a in r.sources){n.addSource(a,r.sources[a],{validate:false})}if(r.sprite){this._spriteRequest=v(r.sprite,this.map._transformRequest,function(t,r){n._spriteRequest=null;if(t){n.fire(new e.ErrorEvent(t))}else if(r){for(var i in r){n.imageManager.addImage(i,r[i])}}n.imageManager.setLoaded(true);n.fire(new e.Event("data",{dataType:"style"}))})}else{this.imageManager.setLoaded(true)}this.glyphManager.setURL(r.glyphs);var o=vt(this.stylesheet.layers);this._order=o.map(function(e){return e.id});this._layers={};for(var s=0,l=o;s<l.length;s+=1){var u=l[s];u=e.createStyleLayer(u);u.setEventedParent(n,{layer:{id:u.id}});n._layers[u.id]=u}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order));this.light=new U(this.stylesheet.light);this.fire(new e.Event("data",{dataType:"style"}));this.fire(new e.Event("style.load"))};r.prototype._validateLayer=function t(r){var i=this.sourceCaches[r.source];if(!i){return}var n=r.sourceLayer;if(!n){return}var a=i.getSource();if(a.type==="geojson"||a.vectorLayerIds&&a.vectorLayerIds.indexOf(n)===-1){this.fire(new e.ErrorEvent(new Error('Source layer "'+n+'" '+'does not exist on source "'+a.id+'" '+'as specified by style layer "'+r.id+'"')))}};r.prototype.loaded=function e(){var t=this;if(!this._loaded){return false}if((0,k.default)(this._updatedSources).length){return false}for(var r in t.sourceCaches){if(!t.sourceCaches[r].loaded()){return false}}if(!this.imageManager.isLoaded()){return false}return true};r.prototype._serializeLayers=function e(t){var r=this;var i=[];for(var n=0,a=t;n<a.length;n+=1){var o=a[n];var s=r._layers[o];if(s.type!=="custom"){i.push(s.serialize())}}return i};r.prototype.hasTransitions=function e(){var t=this;if(this.light&&this.light.hasTransition()){return true}for(var r in t.sourceCaches){if(t.sourceCaches[r].hasTransition()){return true}}for(var i in t._layers){if(t._layers[i].hasTransition()){return true}}return false};r.prototype._checkLoaded=function e(){if(!this._loaded){throw new Error("Style is not done loading")}};r.prototype.update=function t(r){var i=this;if(!this._loaded){return}var n=this._changed;if(this._changed){var a=(0,k.default)(this._updatedLayers);var o=(0,k.default)(this._removedLayers);if(a.length||o.length){this._updateWorkerLayers(a,o)}for(var s in i._updatedSources){var l=i._updatedSources[s];e.assert(l==="reload"||l==="clear");if(l==="reload"){i._reloadSource(s)}else if(l==="clear"){i._clearSource(s)}}for(var u in i._updatedPaintProps){i._layers[u].updateTransitions(r)}this.light.updateTransitions(r);this._resetUpdates()}for(var f in i.sourceCaches){i.sourceCaches[f].used=false}for(var c=0,h=i._order;c<h.length;c+=1){var p=h[c];var d=i._layers[p];d.recalculate(r);if(!d.isHidden(r.zoom)&&d.source){i.sourceCaches[d.source].used=true}}this.light.recalculate(r);this.z=r.zoom;if(n){this.fire(new e.Event("data",{dataType:"style"}))}};r.prototype._updateWorkerLayers=function e(t,r){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:r})};r.prototype._resetUpdates=function e(){this._changed=false;this._updatedLayers={};this._removedLayers={};this._updatedSources={};this._updatedPaintProps={}};r.prototype.setState=function t(r){var i=this;this._checkLoaded();if(dr(this,e.validateStyle(r))){return false}r=e.clone$2(r);r.layers=vt(r.layers);var n=Pt(this.serialize(),r).filter(function(e){return!(e.command in yr)});if(n.length===0){return false}var a=n.filter(function(e){return!(e.command in vr)});if(a.length>0){throw new Error("Unimplemented: "+a.map(function(e){return e.command}).join(", ")+".")}n.forEach(function(e){if(e.command==="setTransition"){return}i[e.command].apply(i,e.args)});this.stylesheet=r;return true};r.prototype.addImage=function t(r,i){if(this.getImage(r)){return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")))}this.imageManager.addImage(r,i);this.fire(new e.Event("data",{dataType:"style"}))};r.prototype.getImage=function e(t){return this.imageManager.getImage(t)};r.prototype.removeImage=function t(r){if(!this.getImage(r)){return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")))}this.imageManager.removeImage(r);this.fire(new e.Event("data",{dataType:"style"}))};r.prototype.listImages=function e(){this._checkLoaded();return this.imageManager.listImages()};r.prototype.addSource=function t(r,i,n){var a=this;this._checkLoaded();if(this.sourceCaches[r]!==undefined){throw new Error("There is already a source with this ID")}if(!i.type){throw new Error("The type property must be defined, but the only the following properties were given: "+(0,k.default)(i).join(", ")+".")}var o=["vector","raster","geojson","video","image"];var s=o.indexOf(i.type)>=0;if(s&&this._validate(e.validateStyle.source,"sources."+r,i,null,n)){return}if(this.map&&this.map._collectResourceTiming){i.collectResourceTiming=true}var l=this.sourceCaches[r]=new ot(r,i,this.dispatcher);l.style=this;l.setEventedParent(this,function(){return{isSourceLoaded:a.loaded(),source:l.serialize(),sourceId:r}});l.onAdd(this.map);this._changed=true};r.prototype.removeSource=function t(r){var i=this;this._checkLoaded();if(this.sourceCaches[r]===undefined){throw new Error("There is no source with this ID")}for(var n in i._layers){if(i._layers[n].source===r){return i.fire(new e.ErrorEvent(new Error('Source "'+r+'" cannot be removed while layer "'+n+'" is using it.')))}}var a=this.sourceCaches[r];delete this.sourceCaches[r];delete this._updatedSources[r];a.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:r}));a.setEventedParent(null);a.clearTiles();if(a.onRemove){a.onRemove(this.map)}this._changed=true};r.prototype.setGeoJSONSourceData=function t(r,i){this._checkLoaded();e.assert(this.sourceCaches[r]!==undefined,"There is no source with this ID");var n=this.sourceCaches[r].getSource();e.assert(n.type==="geojson");n.setData(i);this._changed=true};r.prototype.getSource=function e(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()};r.prototype.addLayer=function t(r,i,n){this._checkLoaded();var a=r.id;if(this.getLayer(a)){this.fire(new e.ErrorEvent(new Error('Layer with id "'+a+'" already exists on this map')));return}var o;if(r.type==="custom"){if(dr(this,e.validateCustomStyleLayer(r))){return}o=e.createStyleLayer(r)}else{if((0,z.default)(r.source)==="object"){this.addSource(a,r.source);r=e.clone$2(r);r=e.extend(r,{source:a})}if(this._validate(e.validateStyle.layer,"layers."+a,r,{arrayIndex:-1},n)){return}o=e.createStyleLayer(r);this._validateLayer(o);o.setEventedParent(this,{layer:{id:a}})}var s=i?this._order.indexOf(i):this._order.length;if(i&&s===-1){this.fire(new e.ErrorEvent(new Error('Layer with id "'+i+'" does not exist on this map.')));return}this._order.splice(s,0,a);this._layerOrderChanged=true;this._layers[a]=o;if(this._removedLayers[a]&&o.source&&o.type!=="custom"){var l=this._removedLayers[a];delete this._removedLayers[a];if(l.type!==o.type){this._updatedSources[o.source]="clear"}else{this._updatedSources[o.source]="reload";this.sourceCaches[o.source].pause()}}this._updateLayer(o);if(o.onAdd){o.onAdd(this.map)}};r.prototype.moveLayer=function t(r,i){this._checkLoaded();this._changed=true;var n=this._layers[r];if(!n){this.fire(new e.ErrorEvent(new Error("The layer '"+r+"' does not exist in the map's style and cannot be moved.")));return}if(r===i){return}var a=this._order.indexOf(r);this._order.splice(a,1);var o=i?this._order.indexOf(i):this._order.length;if(i&&o===-1){this.fire(new e.ErrorEvent(new Error('Layer with id "'+i+'" does not exist on this map.')));return}this._order.splice(o,0,r);this._layerOrderChanged=true};r.prototype.removeLayer=function t(r){this._checkLoaded();var i=this._layers[r];if(!i){this.fire(new e.ErrorEvent(new Error("The layer '"+r+"' does not exist in the map's style and cannot be removed.")));return}i.setEventedParent(null);var n=this._order.indexOf(r);this._order.splice(n,1);this._layerOrderChanged=true;this._changed=true;this._removedLayers[r]=i;delete this._layers[r];delete this._updatedLayers[r];delete this._updatedPaintProps[r];if(i.onRemove){i.onRemove(this.map)}};r.prototype.getLayer=function e(t){return this._layers[t]};r.prototype.setLayerZoomRange=function t(r,i,n){this._checkLoaded();var a=this.getLayer(r);if(!a){this.fire(new e.ErrorEvent(new Error("The layer '"+r+"' does not exist in the map's style and cannot have zoom extent.")));return}if(a.minzoom===i&&a.maxzoom===n){return}if(i!=null){a.minzoom=i}if(n!=null){a.maxzoom=n}this._updateLayer(a)};r.prototype.setFilter=function t(r,i){this._checkLoaded();var n=this.getLayer(r);if(!n){this.fire(new e.ErrorEvent(new Error("The layer '"+r+"' does not exist in the map's style and cannot be filtered.")));return}if(e.isEqual(n.filter,i)){return}if(i===null||i===undefined){n.filter=undefined;this._updateLayer(n);return}if(this._validate(e.validateStyle.filter,"layers."+n.id+".filter",i)){return}n.filter=e.clone$2(i);this._updateLayer(n)};r.prototype.getFilter=function t(r){return e.clone$2(this.getLayer(r).filter)};r.prototype.setLayoutProperty=function t(r,i,n){this._checkLoaded();var a=this.getLayer(r);if(!a){this.fire(new e.ErrorEvent(new Error("The layer '"+r+"' does not exist in the map's style and cannot be styled.")));return}if(e.isEqual(a.getLayoutProperty(i),n)){return}a.setLayoutProperty(i,n);this._updateLayer(a)};r.prototype.getLayoutProperty=function e(t,r){return this.getLayer(t).getLayoutProperty(r)};r.prototype.setPaintProperty=function t(r,i,n){this._checkLoaded();var a=this.getLayer(r);if(!a){this.fire(new e.ErrorEvent(new Error("The layer '"+r+"' does not exist in the map's style and cannot be styled.")));return}if(e.isEqual(a.getPaintProperty(i),n)){return}var o=a.setPaintProperty(i,n);if(o){this._updateLayer(a)}this._changed=true;this._updatedPaintProps[r]=true};r.prototype.getPaintProperty=function e(t,r){return this.getLayer(t).getPaintProperty(r)};r.prototype.setFeatureState=function t(r,i){this._checkLoaded();var n=r.source;var a=r.sourceLayer;var o=this.sourceCaches[n];var s=parseInt(r.id,10);if(o===undefined){this.fire(new e.ErrorEvent(new Error("The source '"+n+"' does not exist in the map's style.")));return}var l=o.getSource().type;if(l==="vector"&&!a){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(isNaN(s)||s<0){this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided and non-negative.")));return}o.setFeatureState(a,s,i)};r.prototype.getFeatureState=function t(r){this._checkLoaded();var i=r.source;var n=r.sourceLayer;var a=this.sourceCaches[i];var o=parseInt(r.id,10);if(a===undefined){this.fire(new e.ErrorEvent(new Error("The source '"+i+"' does not exist in the map's style.")));return}var s=a.getSource().type;if(s==="vector"&&!n){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(isNaN(o)||o<0){this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided and non-negative.")));return}return a.getFeatureState(n,o)};r.prototype.getTransition=function t(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)};r.prototype.serialize=function t(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(e){return e.serialize()}),layers:this._serializeLayers(this._order)},function(e){return e!==undefined})};r.prototype._updateLayer=function e(t){this._updatedLayers[t.id]=true;if(t.source&&!this._updatedSources[t.source]){this._updatedSources[t.source]="reload";this.sourceCaches[t.source].pause()}this._changed=true};r.prototype._flattenRenderedFeatures=function e(t){var r=this;var i=[];for(var n=this._order.length-1;n>=0;n--){var a=r._order[n];for(var o=0,s=t;o<s.length;o+=1){var l=s[o];var u=l[a];if(u){for(var f=0,c=u;f<c.length;f+=1){var h=c[f];i.push(h)}}}}return i};r.prototype.queryRenderedFeatures=function t(r,i,n){var a=this;if(i&&i.filter){this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",i.filter)}var o={};if(i&&i.layers){if(!Array.isArray(i.layers)){this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array.")));return[]}for(var s=0,l=i.layers;s<l.length;s+=1){var u=l[s];var f=a._layers[u];if(!f){a.fire(new e.ErrorEvent(new Error("The layer '"+u+"' does not exist in the map's style and cannot be queried for features.")));return[]}o[f.source]=true}}var c=[];var h=r.map(function(e){return n.pointCoordinate(e)});for(var p in a.sourceCaches){if(i.layers&&!o[p]){continue}c.push(re(a.sourceCaches[p],a._layers,h,i,n))}if(this.placement){c.push(ie(this._layers,this.sourceCaches,r,i,this.placement.collisionIndex,this.placement.retainedQueryData))}return this._flattenRenderedFeatures(c)};r.prototype.querySourceFeatures=function t(r,i){if(i&&i.filter){this._validate(e.validateStyle.filter,"querySourceFeatures.filter",i.filter)}var n=this.sourceCaches[r];return n?ne(n,i):[]};r.prototype.addSourceType=function e(t,i,n){if(r.getSourceType(t)){return n(new Error('A source type called "'+t+'" already exists.'))}r.setSourceType(t,i);if(!i.workerSourceURL){return n(null,null)}this.dispatcher.broadcast("loadWorkerSource",{name:t,url:i.workerSourceURL},n)};r.prototype.getLight=function e(){return this.light.getLight()};r.prototype.setLight=function t(r){this._checkLoaded();var i=this.light.getLight();var n=false;for(var a in r){if(!e.isEqual(r[a],i[a])){n=true;break}}if(!n){return}var o={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r);this.light.updateTransitions(o)};r.prototype._validate=function t(r,i,n,a,o){if(o&&o.validate===false){return false}return dr(this,r.call(e.validateStyle,e.extend({key:i,style:this.serialize(),value:n,styleSpec:e.styleSpec},a)))};r.prototype._remove=function t(){var r=this;if(this._request){this._request.cancel();this._request=null}if(this._spriteRequest){this._spriteRequest.cancel();this._spriteRequest=null}e.evented.off("pluginAvailable",this._rtlTextPluginCallback);for(var i in r.sourceCaches){r.sourceCaches[i].clearTiles()}this.dispatcher.remove()};r.prototype._clearSource=function e(t){this.sourceCaches[t].clearTiles()};r.prototype._reloadSource=function e(t){this.sourceCaches[t].resume();this.sourceCaches[t].reload()};r.prototype._updateSources=function e(t){var r=this;for(var i in r.sourceCaches){r.sourceCaches[i].update(t)}};r.prototype._generateCollisionBoxes=function e(){var t=this;for(var r in t.sourceCaches){t._reloadSource(r)}};r.prototype._updatePlacement=function t(r,i,n,a){var o=this;var s=false;var l=false;var u={};for(var f=0,c=o._order;f<c.length;f+=1){var h=c[f];var p=o._layers[h];if(p.type!=="symbol"){continue}if(!u[p.source]){var d=o.sourceCaches[p.source];u[p.source]=d.getRenderableIds(true).map(function(e){return d.getTileByID(e)}).sort(function(e,t){return t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)})}var v=o.crossTileSymbolIndex.addLayer(p,u[p.source],r.center.lng);s=s||v}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);var y=this._layerOrderChanged;if(y||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now())){this.pauseablePlacement=new lr(r,this._order,y,i,n,a);this._layerOrderChanged=false}if(this.pauseablePlacement.isDone()){this.placement.setStale()}else{this.pauseablePlacement.continuePlacement(this._order,this._layers,u);if(this.pauseablePlacement.isDone()){this.placement=this.pauseablePlacement.commit(this.placement,e.browser.now());l=true}if(s){this.pauseablePlacement.placement.setStale()}}if(l||s){for(var m=0,g=o._order;m<g.length;m+=1){var _=g[m];var x=o._layers[_];if(x.type!=="symbol"){continue}o.placement.updateLayerOpacities(x,u[x.source])}}var b=!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now());return b};r.prototype._releaseSymbolFadeTiles=function e(){var t=this;for(var r in t.sourceCaches){t.sourceCaches[r].releaseSymbolFadeTiles()}};r.prototype.getImages=function e(t,r,i){this.imageManager.getImages(r.icons,i)};r.prototype.getGlyphs=function e(t,r,i){this.glyphManager.getGlyphs(r.stacks,i)};return r}(e.Evented);mr.getSourceType=ee;mr.setSourceType=te;mr.registerForPluginAvailability=e.registerForPluginAvailability;var gr=e.createLayout([{name:"a_pos",type:"Int16",components:2}]);var _r="#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n";var xr="#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\n// Unpack a pair of values that have been packed into a single float.\n// The packed values are assumed to be 8-bit unsigned integers, and are\n// packed like so:\n// packedValue = floor(input[0]) * 256 + input[1],\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue = int(packedValue);\n    int v0 = packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec2 unpack_opacity(const float packedOpacity) {\n    int intOpacity = int(packedOpacity) / 2;\n    return vec2(float(intOpacity) / 127.0, mod(packedOpacity, 2.0));\n}\n\n// To minimize the number of attributes needed, we encode a 4-component\n// color into a pair of floats (i.e. a vec2) as follows:\n// [ floor(color.r * 255) * 256 + color.g * 255,\n//   floor(color.b * 255) * 256 + color.g * 255 ]\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\n// Unpack a pair of paint values and interpolate between them.\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\n// Unpack a pair of paint values and interpolate between them.\nvec4 unpack_mix_color(const vec4 packedColors, const float t) {\n    vec4 minColor = decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor = decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\n// The offset depends on how many pixels are between the world origin and the edge of the tile:\n// vec2 offset = mod(pixel_coord, size)\n//\n// At high zoom levels there are a ton of pixels between the world origin and the edge of the tile.\n// The glsl spec only guarantees 16 bits of precision for highp floats. We need more than that.\n//\n// The pixel_coord is passed in as two 16 bit values:\n// pixel_coord_upper = floor(pixel_coord / 2^16)\n// pixel_coord_lower = mod(pixel_coord, 2^16)\n//\n// The offset is calculated in a series of steps that should preserve this precision:\nvec2 get_pattern_pos(const vec2 pixel_coord_upper, const vec2 pixel_coord_lower,\n    const vec2 pattern_size, const float tile_units_to_pixels, const vec2 pos) {\n\n    vec2 offset = mod(mod(mod(pixel_coord_upper, pattern_size) * 256.0, pattern_size) * 256.0 + pixel_coord_lower, pattern_size);\n    return (tile_units_to_pixels * pos + offset) / pattern_size;\n}\n";var br="uniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main() {\n    gl_FragColor = u_color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var wr="attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n";var Sr="uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\nuniform float u_opacity;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var Cr="uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n";var Tr="#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    vec2 extrude = v_data.xy;\n    float extrude_length = length(extrude);\n\n    lowp float antialiasblur = v_data.z;\n    float antialiased_blur = -max(blur, antialiasblur);\n\n    float opacity_t = smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n\n    float color_t = stroke_width < 0.01 ? 0.0 : smoothstep(\n        antialiased_blur,\n        0.0,\n        extrude_length - radius / (radius + stroke_width)\n    );\n\n    gl_FragColor = opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var Pr="uniform mat4 u_matrix;\nuniform bool u_scale_with_map;\nuniform bool u_pitch_with_map;\nuniform vec2 u_extrude_scale;\nuniform highp float u_camera_to_center_distance;\n\nattribute vec2 a_pos;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main(void) {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec2 circle_center = floor(a_pos * 0.5);\n    if (u_pitch_with_map) {\n        vec2 corner_position = circle_center;\n        if (u_scale_with_map) {\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale;\n        } else {\n            // Pitching the circle with the map effectively scales it with the map\n            // To counteract the effect for pitch-scale: viewport, we rescale the\n            // whole circle based on the pitch scaling effect at its central point\n            vec4 projected_center = u_matrix * vec4(circle_center, 0, 1);\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n        }\n\n        gl_Position = u_matrix * vec4(corner_position, 0, 1);\n    } else {\n        gl_Position = u_matrix * vec4(circle_center, 0, 1);\n\n        if (u_scale_with_map) {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n        } else {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n        }\n    }\n\n    // This is a minimum blur distance that serves as a faux-antialiasing for\n    // the circle. since blur is a ratio of the circle's size and the intent is\n    // to keep the blur at roughly 1px, the two are inversely related.\n    lowp float antialiasblur = 1.0 / DEVICE_PIXEL_RATIO / (radius + stroke_width);\n\n    v_data = vec3(extrude.x, extrude.y, antialiasblur);\n}\n";var Mr="void main() {\n    gl_FragColor = vec4(1.0);\n}\n";var Ir="attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n";var Ar="#pragma mapbox: define highp float weight\n\nuniform highp float u_intensity;\nvarying vec2 v_extrude;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main() {\n    #pragma mapbox: initialize highp float weight\n\n    // Kernel density estimation with a Gaussian kernel of size 5x5\n    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);\n    float val = weight * u_intensity * GAUSS_COEF * exp(d);\n\n    gl_FragColor = vec4(val, 1.0, 1.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var Lr="#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\n\nuniform mat4 u_matrix;\nuniform float u_extrude_scale;\nuniform float u_opacity;\nuniform float u_intensity;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_extrude;\n\n// Effective \"0\" in the kernel density texture to adjust the kernel size to;\n// this empirically chosen number minimizes artifacts on overlapping kernels\n// for typical heatmap cases (assuming clustered source)\nconst highp float ZERO = 1.0 / 255.0 / 16.0;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main(void) {\n    #pragma mapbox: initialize highp float weight\n    #pragma mapbox: initialize mediump float radius\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 unscaled_extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // This 'extrude' comes in ranging from [-1, -1], to [1, 1].  We'll use\n    // it to produce the vertices of a square mesh framing the point feature\n    // we're adding to the kernel density texture.  We'll also pass it as\n    // a varying, so that the fragment shader can determine the distance of\n    // each fragment from the point feature.\n    // Before we do so, we need to scale it up sufficiently so that the\n    // kernel falls effectively to zero at the edge of the mesh.\n    // That is, we want to know S such that\n    // weight * u_intensity * GAUSS_COEF * exp(-0.5 * 3.0^2 * S^2) == ZERO\n    // Which solves to:\n    // S = sqrt(-2.0 * log(ZERO / (weight * u_intensity * GAUSS_COEF))) / 3.0\n    float S = sqrt(-2.0 * log(ZERO / weight / u_intensity / GAUSS_COEF)) / 3.0;\n\n    // Pass the varying in units of radius\n    v_extrude = S * unscaled_extrude;\n\n    // Scale by radius and the zoom-based scale factor to produce actual\n    // mesh position\n    vec2 extrude = v_extrude * radius * u_extrude_scale;\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec4 pos = vec4(floor(a_pos * 0.5) + extrude, 0, 1);\n\n    gl_Position = u_matrix * pos;\n}\n";var Er="uniform sampler2D u_image;\nuniform sampler2D u_color_ramp;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    float t = texture2D(u_image, v_pos).r;\n    vec4 color = texture2D(u_color_ramp, vec2(t, 0.5));\n    gl_FragColor = color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n";var kr="uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n";var Dr="\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        gl_FragColor *= .1;\n    }\n}";var Br="attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field boxes in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n    gl_Position.xy += a_extrude * u_extrude_scale * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n}\n";var Rr="uniform float u_overscale_factor;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    vec4 color = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        color = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        color *= .2;\n    }\n\n    float extrude_scale_length = length(v_extrude_scale);\n    float extrude_length = length(v_extrude) * extrude_scale_length;\n    float stroke_width = 15.0 * extrude_scale_length / u_overscale_factor;\n    float radius = v_radius * extrude_scale_length;\n\n    float distance_to_edge = abs(extrude_length - radius);\n    float opacity_t = smoothstep(-stroke_width, 0.0, -distance_to_edge);\n\n    gl_FragColor = opacity_t * color;\n}\n";var Fr="attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\n\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field circles in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n\n    highp float padding_factor = 1.2; // Pad the vertices slightly to make room for anti-alias blur\n    gl_Position.xy += a_extrude * u_extrude_scale * padding_factor * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n    v_radius = abs(a_extrude.y); // We don't pitch the circles, so both units of the extrusion vector are equal in magnitude to the radius\n\n    v_extrude = a_extrude * padding_factor;\n    v_extrude_scale = u_extrude_scale * u_camera_to_center_distance * collision_perspective_ratio;\n}\n";var Or="uniform highp vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n";var zr="attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n";var Ur="#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_FragColor = color * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var Nr="attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n";var jr="#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_pos;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n    gl_FragColor = outline_color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var Vr="attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\n\nvarying vec2 v_pos;\n\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n";var Gr="\nuniform vec2 u_texsize;\nuniform sampler2D u_image;\nuniform float u_fade;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(pattern_tl_a / u_texsize, pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(pattern_tl_b / u_texsize, pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    // find distance to outline for alpha interpolation\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n\n\n    gl_FragColor = mix(color1, color2, u_fade) * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var Zr="uniform mat4 u_matrix;\nuniform vec2 u_world;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform vec4 u_scale;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    float pixelRatio = u_scale.x;\n    float tileRatio = u_scale.y;\n    float fromScale = u_scale.z;\n    float toScale = u_scale.w;\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    vec2 display_size_a = vec2((pattern_br_a.x - pattern_tl_a.x) / pixelRatio, (pattern_br_a.y - pattern_tl_a.y) / pixelRatio);\n    vec2 display_size_b = vec2((pattern_br_b.x - pattern_tl_b.x) / pixelRatio, (pattern_br_b.y - pattern_tl_b.y) / pixelRatio);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, fromScale * display_size_a, tileRatio, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, toScale * display_size_b, tileRatio, a_pos);\n\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n";var qr="uniform vec2 u_texsize;\nuniform float u_fade;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(pattern_tl_a / u_texsize, pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(pattern_tl_b / u_texsize, pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_fade) * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var Hr="uniform mat4 u_matrix;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform vec4 u_scale;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    float pixelRatio = u_scale.x;\n    float tileZoomRatio = u_scale.y;\n    float fromScale = u_scale.z;\n    float toScale = u_scale.w;\n\n    vec2 display_size_a = vec2((pattern_br_a.x - pattern_tl_a.x) / pixelRatio, (pattern_br_a.y - pattern_tl_a.y) / pixelRatio);\n    vec2 display_size_b = vec2((pattern_br_b.x - pattern_tl_b.x) / pixelRatio, (pattern_br_b.y - pattern_tl_b.y) / pixelRatio);\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, fromScale * display_size_a, tileZoomRatio, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, toScale * display_size_b, tileZoomRatio, a_pos);\n}\n";var Wr="varying vec4 v_color;\n\nvoid main() {\n    gl_FragColor = v_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var Xr="uniform mat4 u_matrix;\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\nuniform float u_vertical_gradient;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec4 v_color;\n\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize highp float base\n    #pragma mapbox: initialize highp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    vec3 normal = a_normal_ed.xyz;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n\n    gl_Position = u_matrix * vec4(a_pos, t > 0.0 ? height : base, 1);\n\n    // Relative luminance (how dark/bright is the surface color?)\n    float colorvalue = color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722;\n\n    v_color = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // Add slight ambient lighting so no extrusions are totally black\n    vec4 ambientlight = vec4(0.03, 0.03, 0.03, 1.0);\n    color += ambientlight;\n\n    // Calculate cos(theta), where theta is the angle between surface normal and diffuse light ray\n    float directional = clamp(dot(normal / 16384.0, u_lightpos), 0.0, 1.0);\n\n    // Adjust directional so that\n    // the range of values for highlight/shading is narrower\n    // with lower light intensity\n    // and with lighter/brighter surface colors\n    directional = mix((1.0 - u_lightintensity), max((1.0 - colorvalue + u_lightintensity), 1.0), directional);\n\n    // Add gradient along z axis of side surfaces\n    if (normal.y != 0.0) {\n        // This avoids another branching statement, but multiplies by a constant of 0.84 if no vertical gradient,\n        // and otherwise calculates the gradient based on base + height\n        directional *= (\n            (1.0 - u_vertical_gradient) +\n            (u_vertical_gradient * clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0)));\n    }\n\n    // Assign final color based on surface + ambient light color, diffuse light directional, and light color\n    // with lower bounds adjusted to hue of light\n    // so that shading is tinted with the complementary (opposite) color to the light color\n    v_color.r += clamp(color.r * directional * u_lightcolor.r, mix(0.0, 0.3, 1.0 - u_lightcolor.r), 1.0);\n    v_color.g += clamp(color.g * directional * u_lightcolor.g, mix(0.0, 0.3, 1.0 - u_lightcolor.g), 1.0);\n    v_color.b += clamp(color.b * directional * u_lightcolor.b, mix(0.0, 0.3, 1.0 - u_lightcolor.b), 1.0);\n}\n";var Yr="uniform vec2 u_texsize;\nuniform float u_fade;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(pattern_tl_a / u_texsize, pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(pattern_tl_b / u_texsize, pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    vec4 mixedColor = mix(color1, color2, u_fade);\n\n    gl_FragColor = mixedColor * v_lighting;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var Kr="uniform mat4 u_matrix;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_height_factor;\nuniform vec4 u_scale;\nuniform float u_vertical_gradient;\n\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    float pixelRatio = u_scale.x;\n    float tileRatio = u_scale.y;\n    float fromScale = u_scale.z;\n    float toScale = u_scale.w;\n\n    vec3 normal = a_normal_ed.xyz;\n    float edgedistance = a_normal_ed.w;\n\n    vec2 display_size_a = vec2((pattern_br_a.x - pattern_tl_a.x) / pixelRatio, (pattern_br_a.y - pattern_tl_a.y) / pixelRatio);\n    vec2 display_size_b = vec2((pattern_br_b.x - pattern_tl_b.x) / pixelRatio, (pattern_br_b.y - pattern_tl_b.y) / pixelRatio);\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n    float z = t > 0.0 ? height : base;\n\n    gl_Position = u_matrix * vec4(a_pos, z, 1);\n\n    vec2 pos = normal.x == 1.0 && normal.y == 0.0 && normal.z == 16384.0\n        ? a_pos // extrusion top\n        : vec2(edgedistance, z * u_height_factor); // extrusion side\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, fromScale * display_size_a, tileRatio, pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, toScale * display_size_b, tileRatio, pos);\n\n    v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\n    float directional = clamp(dot(normal / 16383.0, u_lightpos), 0.0, 1.0);\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\n\n    if (normal.y != 0.0) {\n        // This avoids another branching statement, but multiplies by a constant of 0.84 if no vertical gradient,\n        // and otherwise calculates the gradient based on base + height\n        directional *= (\n            (1.0 - u_vertical_gradient) +\n            (u_vertical_gradient * clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0)));\n    }\n\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\n}\n";var Jr="uniform sampler2D u_image;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_FragColor = texture2D(u_image, v_pos) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n";var $r="uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n";var Qr="#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D u_image;\nvarying vec2 v_pos;\nuniform vec2 u_dimension;\nuniform float u_zoom;\nuniform float u_maxzoom;\n\nfloat getElevation(vec2 coord, float bias) {\n    // Convert encoded elevation value to meters\n    vec4 data = texture2D(u_image, coord) * 255.0;\n    return (data.r + data.g * 256.0 + data.b * 256.0 * 256.0) / 4.0;\n}\n\nvoid main() {\n    vec2 epsilon = 1.0 / u_dimension;\n\n    // queried pixels:\n    // +-----------+\n    // |   |   |   |\n    // | a | b | c |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | d | e | f |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | g | h | i |\n    // |   |   |   |\n    // +-----------+\n\n    float a = getElevation(v_pos + vec2(-epsilon.x, -epsilon.y), 0.0);\n    float b = getElevation(v_pos + vec2(0, -epsilon.y), 0.0);\n    float c = getElevation(v_pos + vec2(epsilon.x, -epsilon.y), 0.0);\n    float d = getElevation(v_pos + vec2(-epsilon.x, 0), 0.0);\n    float e = getElevation(v_pos, 0.0);\n    float f = getElevation(v_pos + vec2(epsilon.x, 0), 0.0);\n    float g = getElevation(v_pos + vec2(-epsilon.x, epsilon.y), 0.0);\n    float h = getElevation(v_pos + vec2(0, epsilon.y), 0.0);\n    float i = getElevation(v_pos + vec2(epsilon.x, epsilon.y), 0.0);\n\n    // here we divide the x and y slopes by 8 * pixel size\n    // where pixel size (aka meters/pixel) is:\n    // circumference of the world / (pixels per tile * number of tiles)\n    // which is equivalent to: 8 * 40075016.6855785 / (512 * pow(2, u_zoom))\n    // which can be reduced to: pow(2, 19.25619978527 - u_zoom)\n    // we want to vertically exaggerate the hillshading though, because otherwise\n    // it is barely noticeable at low zooms. to do this, we multiply this by some\n    // scale factor pow(2, (u_zoom - u_maxzoom) * a) where a is an arbitrary value\n    // Here we use a=0.3 which works out to the expression below. see \n    // nickidlugash's awesome breakdown for more info\n    // https://github.com/mapbox/mapbox-gl-js/pull/5286#discussion_r148419556\n    float exaggeration = u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;\n\n    vec2 deriv = vec2(\n        (c + f + f + i) - (a + d + d + g),\n        (g + h + h + i) - (a + b + b + c)\n    ) /  pow(2.0, (u_zoom - u_maxzoom) * exaggeration + 19.2562 - u_zoom);\n\n    gl_FragColor = clamp(vec4(\n        deriv.x / 2.0 + 0.5,\n        deriv.y / 2.0 + 0.5,\n        1.0,\n        1.0), 0.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var ei="uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (a_texture_pos / 8192.0) / 2.0 + 0.25;\n}\n";var ti="uniform sampler2D u_image;\nvarying vec2 v_pos;\n\nuniform vec2 u_latrange;\nuniform vec2 u_light;\nuniform vec4 u_shadow;\nuniform vec4 u_highlight;\nuniform vec4 u_accent;\n\n#define PI 3.141592653589793\n\nvoid main() {\n    vec4 pixel = texture2D(u_image, v_pos);\n\n    vec2 deriv = ((pixel.rg * 2.0) - 1.0);\n\n    // We divide the slope by a scale factor based on the cosin of the pixel's approximate latitude\n    // to account for mercator projection distortion. see #4807 for details\n    float scaleFactor = cos(radians((u_latrange[0] - u_latrange[1]) * (1.0 - v_pos.y) + u_latrange[1]));\n    // We also multiply the slope by an arbitrary z-factor of 1.25\n    float slope = atan(1.25 * length(deriv) / scaleFactor);\n    float aspect = deriv.x != 0.0 ? atan(deriv.y, -deriv.x) : PI / 2.0 * (deriv.y > 0.0 ? 1.0 : -1.0);\n\n    float intensity = u_light.x;\n    // We add PI to make this property match the global light object, which adds PI/2 to the light's azimuthal\n    // position property to account for 0deg corresponding to north/the top of the viewport in the style spec\n    // and the original shader was written to accept (-illuminationDirection - 90) as the azimuthal.\n    float azimuth = u_light.y + PI;\n\n    // We scale the slope exponentially based on intensity, using a calculation similar to\n    // the exponential interpolation function in the style spec:\n    // https://github.com/mapbox/mapbox-gl-js/blob/master/src/style-spec/expression/definitions/interpolate.js#L217-L228\n    // so that higher intensity values create more opaque hillshading.\n    float base = 1.875 - intensity * 1.75;\n    float maxValue = 0.5 * PI;\n    float scaledSlope = intensity != 0.5 ? ((pow(base, slope) - 1.0) / (pow(base, maxValue) - 1.0)) * maxValue : slope;\n\n    // The accent color is calculated with the cosine of the slope while the shade color is calculated with the sine\n    // so that the accent color's rate of change eases in while the shade color's eases out.\n    float accent = cos(scaledSlope);\n    // We multiply both the accent and shade color by a clamped intensity value\n    // so that intensities >= 0.5 do not additionally affect the color values\n    // while intensity values < 0.5 make the overall color more transparent.\n    vec4 accent_color = (1.0 - accent) * u_accent * clamp(intensity * 2.0, 0.0, 1.0);\n    float shade = abs(mod((aspect + azimuth) / PI + 0.5, 2.0) - 1.0);\n    vec4 shade_color = mix(u_shadow, u_highlight, shade) * sin(scaledSlope) * clamp(intensity * 2.0, 0.0, 1.0);\n    gl_FragColor = accent_color * (1.0 - shade_color.a) + shade_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var ri="uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = a_texture_pos / 8192.0;\n}\n";var ii="#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var ni="\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_linesofar;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n";var ai="\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nuniform sampler2D u_image;\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    // For gradient lines, v_lineprogress is the ratio along the entire line,\n    // scaled to [0, 2^15), and the gradient ramp is stored in a texture.\n    vec4 color = texture2D(u_image, vec2(v_lineprogress, 0.5));\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var oi="\n// the attribute conveying progress along a line is scaled to [0, 2^15)\n#define MAX_LINE_DISTANCE 32767.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_lineprogress = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0 / MAX_LINE_DISTANCE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n";var si="uniform vec2 u_texsize;\nuniform float u_fade;\nuniform mediump vec4 u_scale;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 pattern_tl_a = pattern_from.xy;\n    vec2 pattern_br_a = pattern_from.zw;\n    vec2 pattern_tl_b = pattern_to.xy;\n    vec2 pattern_br_b = pattern_to.zw;\n\n    float pixelRatio = u_scale.x;\n    float tileZoomRatio = u_scale.y;\n    float fromScale = u_scale.z;\n    float toScale = u_scale.w;\n\n    vec2 display_size_a = vec2((pattern_br_a.x - pattern_tl_a.x) / pixelRatio, (pattern_br_a.y - pattern_tl_a.y) / pixelRatio);\n    vec2 display_size_b = vec2((pattern_br_b.x - pattern_tl_b.x) / pixelRatio, (pattern_br_b.y - pattern_tl_b.y) / pixelRatio);\n\n    vec2 pattern_size_a = vec2(display_size_a.x * fromScale / tileZoomRatio, display_size_a.y);\n    vec2 pattern_size_b = vec2(display_size_b.x * toScale / tileZoomRatio, display_size_b.y);\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float x_a = mod(v_linesofar / pattern_size_a.x, 1.0);\n    float x_b = mod(v_linesofar / pattern_size_b.x, 1.0);\n\n    // v_normal.y is 0 at the midpoint of the line, -1 at the lower edge, 1 at the upper edge\n    // we clamp the line width outset to be between 0 and half the pattern height plus padding (2.0)\n    // to ensure we don't sample outside the designated symbol on the sprite sheet.\n    // 0.5 is added to shift the component to be bounded between 0 and 1 for interpolation of\n    // the texture coordinate\n    float y_a = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (pattern_size_a.y + 2.0) / 2.0) / pattern_size_a.y);\n    float y_b = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (pattern_size_b.y + 2.0) / 2.0) / pattern_size_b.y);\n    vec2 pos_a = mix(pattern_tl_a / u_texsize, pattern_br_a / u_texsize, vec2(x_a, y_a));\n    vec2 pos_b = mix(pattern_tl_b / u_texsize, pattern_br_b / u_texsize, vec2(x_b, y_b));\n\n    vec4 color = mix(texture2D(u_image, pos_a), texture2D(u_image, pos_b), u_fade);\n\n    gl_FragColor = color * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var li="// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform vec2 u_gl_units_to_pixels;\nuniform mediump float u_ratio;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize mediump vec4 pattern_from\n    #pragma mapbox: initialize mediump vec4 pattern_to\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n    // float tileRatio = u_scale.y;\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_linesofar = a_linesofar;\n    v_width2 = vec2(outset, inset);\n}\n";var ui="\nuniform sampler2D u_image;\nuniform float u_sdfgamma;\nuniform float u_mix;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *= smoothstep(0.5 - u_sdfgamma / floorwidth, 0.5 + u_sdfgamma / floorwidth, sdfdist);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var fi="// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_patternscale_a;\nuniform float u_tex_y_a;\nuniform vec2 u_patternscale_b;\nuniform float u_tex_y_b;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + (halfwidth == 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist =outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x / floorwidth, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x / floorwidth, normal.y * u_patternscale_b.y + u_tex_y_b);\n\n    v_width2 = vec2(outset, inset);\n}\n";var ci="uniform float u_fade_t;\nuniform float u_opacity;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nuniform float u_brightness_low;\nuniform float u_brightness_high;\n\nuniform float u_saturation_factor;\nuniform float u_contrast_factor;\nuniform vec3 u_spin_weights;\n\nvoid main() {\n\n    // read and cross-fade colors from the main and parent tiles\n    vec4 color0 = texture2D(u_image0, v_pos0);\n    vec4 color1 = texture2D(u_image1, v_pos1);\n    if (color0.a > 0.0) {\n        color0.rgb = color0.rgb / color0.a;\n    }\n    if (color1.a > 0.0) {\n        color1.rgb = color1.rgb / color1.a;\n    }\n    vec4 color = mix(color0, color1, u_fade_t);\n    color.a *= u_opacity;\n    vec3 rgb = color.rgb;\n\n    // spin\n    rgb = vec3(\n        dot(rgb, u_spin_weights.xyz),\n        dot(rgb, u_spin_weights.zxy),\n        dot(rgb, u_spin_weights.yzx));\n\n    // saturation\n    float average = (color.r + color.g + color.b) / 3.0;\n    rgb += (average - rgb) * u_saturation_factor;\n\n    // contrast\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\n\n    // brightness\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\n\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var hi="uniform mat4 u_matrix;\nuniform vec2 u_tl_parent;\nuniform float u_scale_parent;\nuniform float u_buffer_scale;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    // We are using Int16 for texture position coordinates to give us enough precision for\n    // fractional coordinates. We use 8192 to scale the texture coordinates in the buffer\n    // as an arbitrarily high number to preserve adequate precision when rendering.\n    // This is also the same value as the EXTENT we are using for our tile buffer pos coordinates,\n    // so math for modifying either is consistent.\n    v_pos0 = (((a_texture_pos / 8192.0) - 0.5) / u_buffer_scale ) + 0.5;\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\n}\n";var pi="uniform sampler2D u_texture;\n\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    lowp float alpha = opacity * v_fade_opacity;\n    gl_FragColor = texture2D(u_texture, v_tex) * alpha;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var di="const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform float u_fade_change;\n\n#pragma mapbox: define lowp float opacity\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n\n    float size;\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 256.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 256.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // See comments in symbol_sdf.vertex\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n            0.5 + 0.5 * distance_ratio,\n            0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n            4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // See comments in symbol_sdf.vertex\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n\n    v_tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    v_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n}\n";var vi="#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\n\nuniform bool u_is_halo;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform sampler2D u_texture;\nuniform highp float u_gamma_scale;\nuniform bool u_is_text;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 tex = v_data0.xy;\n    float gamma_scale = v_data1.x;\n    float size = v_data1.y;\n    float fade_opacity = v_data1[2];\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    lowp vec4 color = fill_color;\n    highp float gamma = EDGE_GAMMA / (fontScale * u_gamma_scale);\n    lowp float buff = (256.0 - 64.0) / 256.0;\n    if (u_is_halo) {\n        color = halo_color;\n        gamma = (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\n        buff = (6.0 - halo_width / fontScale) / SDF_PX;\n    }\n\n    lowp float dist = texture2D(u_texture, tex).a;\n    highp float gamma_scaled = gamma * gamma_scale;\n    highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n\n    gl_FragColor = color * (alpha * opacity * fade_opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n";var yi="const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\n// contents of a_size vary based on the type of property value\n// used for {text,icon}-size.\n// For constants, a_size is disabled.\n// For source functions, we bind only one value per vertex: the value of {text,icon}-size evaluated for the current feature.\n// For composite functions:\n// [ text-size(lowerZoomStop, feature),\n//   text-size(upperZoomStop, feature) ]\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\n\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_camera_to_center_distance;\nuniform float u_fade_change;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n    float size;\n\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 256.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 256.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // If the label is pitched with the map, layout is done in pitched space,\n    // which makes labels in the distance smaller relative to viewport space.\n    // We counteract part of that effect by multiplying by the perspective ratio.\n    // If the label isn't pitched with the map, we do layout in viewport space,\n    // which makes labels in the distance larger relative to the features around\n    // them. We counteract part of that effect by dividing by the perspective ratio.\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n        0.5 + 0.5 * distance_ratio,\n        0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n        4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // Point labels with 'rotation-alignment: map' are horizontal with respect to tile units\n        // To figure out that angle in projected space, we draw a short horizontal line in tile\n        // space, project it, and measure its angle in projected space.\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n    float gamma_scale = gl_Position.w;\n\n    vec2 tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    float interpolated_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n\n    v_data0 = vec2(tex.x, tex.y);\n    v_data1 = vec3(gamma_scale, size, interpolated_fade_opacity);\n}\n";var mi=Gi(_r,xr);var gi=Gi(br,wr);var _i=Gi(Sr,Cr);var xi=Gi(Tr,Pr);var bi=Gi(Mr,Ir);var wi=Gi(Ar,Lr);var Si=Gi(Er,kr);var Ci=Gi(Dr,Br);var Ti=Gi(Rr,Fr);var Pi=Gi(Or,zr);var Mi=Gi(Ur,Nr);var Ii=Gi(jr,Vr);var Ai=Gi(Gr,Zr);var Li=Gi(qr,Hr);var Ei=Gi(Wr,Xr);var ki=Gi(Yr,Kr);var Di=Gi(Jr,$r);var Bi=Gi(Qr,ei);var Ri=Gi(ti,ri);var Fi=Gi(ii,ni);var Oi=Gi(ai,oi);var zi=Gi(si,li);var Ui=Gi(ui,fi);var Ni=Gi(ci,hi);var ji=Gi(pi,di);var Vi=Gi(vi,yi);function Gi(e,t){var r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g;var i={};e=e.replace(r,function(e,t,r,n,a){i[a]=true;if(t==="define"){return"\n#ifndef HAS_UNIFORM_u_"+a+"\nvarying "+r+" "+n+" "+a+";\n#else\nuniform "+r+" "+n+" u_"+a+";\n#endif\n"}else{return"\n#ifdef HAS_UNIFORM_u_"+a+"\n    "+r+" "+n+" "+a+" = u_"+a+";\n#endif\n"}});t=t.replace(r,function(e,t,r,n,a){var o=n==="float"?"vec2":"vec4";var s=a.match(/color/)?"color":o;if(i[a]){if(t==="define"){return"\n#ifndef HAS_UNIFORM_u_"+a+"\nuniform lowp float a_"+a+"_t;\nattribute "+r+" "+o+" a_"+a+";\nvarying "+r+" "+n+" "+a+";\n#else\nuniform "+r+" "+n+" u_"+a+";\n#endif\n"}else{if(s==="vec4"){return"\n#ifndef HAS_UNIFORM_u_"+a+"\n    "+a+" = a_"+a+";\n#else\n    "+r+" "+n+" "+a+" = u_"+a+";\n#endif\n"}else{return"\n#ifndef HAS_UNIFORM_u_"+a+"\n    "+a+" = unpack_mix_"+s+"(a_"+a+", a_"+a+"_t);\n#else\n    "+r+" "+n+" "+a+" = u_"+a+";\n#endif\n"}}}else{if(t==="define"){return"\n#ifndef HAS_UNIFORM_u_"+a+"\nuniform lowp float a_"+a+"_t;\nattribute "+r+" "+o+" a_"+a+";\n#else\nuniform "+r+" "+n+" u_"+a+";\n#endif\n"}else{if(s==="vec4"){return"\n#ifndef HAS_UNIFORM_u_"+a+"\n    "+r+" "+n+" "+a+" = a_"+a+";\n#else\n    "+r+" "+n+" "+a+" = u_"+a+";\n#endif\n"}else{return"\n#ifndef HAS_UNIFORM_u_"+a+"\n    "+r+" "+n+" "+a+" = unpack_mix_"+s+"(a_"+a+", a_"+a+"_t);\n#else\n    "+r+" "+n+" "+a+" = u_"+a+";\n#endif\n"}}}});return{fragmentSource:e,vertexSource:t}}var Zi=(0,C.default)({prelude:mi,background:gi,backgroundPattern:_i,circle:xi,clippingMask:bi,heatmap:wi,heatmapTexture:Si,collisionBox:Ci,collisionCircle:Ti,debug:Pi,fill:Mi,fillOutline:Ii,fillOutlinePattern:Ai,fillPattern:Li,fillExtrusion:Ei,fillExtrusionPattern:ki,extrusionTexture:Di,hillshadePrepare:Bi,hillshade:Ri,line:Fi,lineGradient:Oi,linePattern:zi,lineSDF:Ui,raster:Ni,symbolIcon:ji,symbolSDF:Vi});var qi=function e(){this.boundProgram=null;this.boundLayoutVertexBuffer=null;this.boundPaintVertexBuffers=[];this.boundIndexBuffer=null;this.boundVertexOffset=null;this.boundDynamicVertexBuffer=null;this.vao=null};qi.prototype.bind=function e(t,r,i,n,a,o,s,l){var u=this;this.context=t;var f=this.boundPaintVertexBuffers.length!==n.length;for(var c=0;!f&&c<n.length;c++){if(u.boundPaintVertexBuffers[c]!==n[c]){f=true}}var h=!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==i||f||this.boundIndexBuffer!==a||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==s||this.boundDynamicVertexBuffer2!==l;if(!t.extVertexArrayObject||h){this.freshBind(r,i,n,a,o,s,l)}else{t.bindVertexArrayOES.set(this.vao);if(s){s.bind()}if(a&&a.dynamicDraw){a.bind()}if(l){l.bind()}}};qi.prototype.freshBind=function t(r,i,n,a,o,s,l){var u;var f=r.numAttributes;var c=this.context;var h=c.gl;if(c.extVertexArrayObject){if(this.vao){this.destroy()}this.vao=c.extVertexArrayObject.createVertexArrayOES();c.bindVertexArrayOES.set(this.vao);u=0;this.boundProgram=r;this.boundLayoutVertexBuffer=i;this.boundPaintVertexBuffers=n;this.boundIndexBuffer=a;this.boundVertexOffset=o;this.boundDynamicVertexBuffer=s;this.boundDynamicVertexBuffer2=l}else{u=c.currentNumAttributes||0;for(var p=f;p<u;p++){e.assert(p!==0);h.disableVertexAttribArray(p)}}i.enableAttributes(h,r);for(var d=0,v=n;d<v.length;d+=1){var y=v[d];y.enableAttributes(h,r)}if(s){s.enableAttributes(h,r)}if(l){l.enableAttributes(h,r)}i.bind();i.setVertexAttribPointers(h,r,o);for(var m=0,g=n;m<g.length;m+=1){var _=g[m];_.bind();_.setVertexAttribPointers(h,r,o)}if(s){s.bind();s.setVertexAttribPointers(h,r,o)}if(a){a.bind()}if(l){l.bind();l.setVertexAttribPointers(h,r,o)}c.currentNumAttributes=f};qi.prototype.destroy=function e(){if(this.vao){this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao);this.vao=null}};var Hi=function t(r,i,n,a,o){var s=this;var l=r.gl;this.program=l.createProgram();var u=n.defines().concat("#define DEVICE_PIXEL_RATIO "+e.browser.devicePixelRatio.toFixed(1));if(o){u.push("#define OVERDRAW_INSPECTOR;")}var f=u.concat(mi.fragmentSource,i.fragmentSource).join("\n");var c=u.concat(mi.vertexSource,i.vertexSource).join("\n");var h=l.createShader(l.FRAGMENT_SHADER);l.shaderSource(h,f);l.compileShader(h);e.assert(l.getShaderParameter(h,l.COMPILE_STATUS),l.getShaderInfoLog(h));l.attachShader(this.program,h);var p=l.createShader(l.VERTEX_SHADER);l.shaderSource(p,c);l.compileShader(p);e.assert(l.getShaderParameter(p,l.COMPILE_STATUS),l.getShaderInfoLog(p));l.attachShader(this.program,p);var d=n.layoutAttributes||[];for(var v=0;v<d.length;v++){l.bindAttribLocation(s.program,v,d[v].name)}l.linkProgram(this.program);e.assert(l.getProgramParameter(this.program,l.LINK_STATUS),l.getProgramInfoLog(this.program));this.numAttributes=l.getProgramParameter(this.program,l.ACTIVE_ATTRIBUTES);this.attributes={};var y={};for(var m=0;m<this.numAttributes;m++){var g=l.getActiveAttrib(s.program,m);if(g){s.attributes[g.name]=l.getAttribLocation(s.program,g.name)}}var _=l.getProgramParameter(this.program,l.ACTIVE_UNIFORMS);for(var x=0;x<_;x++){var b=l.getActiveUniform(s.program,x);if(b){y[b.name]=l.getUniformLocation(s.program,b.name)}}this.fixedUniforms=a(r,y);this.binderUniforms=n.getUniforms(r,y)};Hi.prototype.draw=function e(t,r,i,n,a,o,s,l,u,f,c,h,p,d,v,y){var m=this;var g;var _=t.gl;t.program.set(this.program);t.setDepthMode(i);t.setStencilMode(n);t.setColorMode(a);t.setCullFace(o);for(var x in m.fixedUniforms){m.fixedUniforms[x].set(s[x])}if(d){d.setUniforms(t,this.binderUniforms,h,{zoom:p})}var b=(g={},g[_.LINES]=2,g[_.TRIANGLES]=3,g[_.LINE_STRIP]=1,g)[r];for(var w=0,S=c.get();w<S.length;w+=1){var C=S[w];var T=C.vaos||(C.vaos={});var P=T[l]||(T[l]=new qi);P.bind(t,m,u,d?d.getPaintVertexBuffers():[],f,C.vertexOffset,v,y);_.drawElements(r,C.primitiveLength*b,_.UNSIGNED_SHORT,C.primitiveOffset*b*2)}};function Wi(t,r,i){var n=1/qt(i,1,r.transform.tileZoom);var a=Math.pow(2,i.tileID.overscaledZ);var o=i.tileSize*Math.pow(2,r.transform.tileZoom)/a;var s=o*(i.tileID.canonical.x+i.tileID.wrap*a);var l=o*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[e.browser.devicePixelRatio,n,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[s>>16,l>>16],u_pixel_coord_lower:[s&65535,l&65535]}}function Xi(t,r,i,n){var a=i.imageManager.getPattern(t.from);var o=i.imageManager.getPattern(t.to);e.assert(a&&o);var s=i.imageManager.getPixelSize();var l=s.width;var u=s.height;var f=Math.pow(2,n.tileID.overscaledZ);var c=n.tileSize*Math.pow(2,i.transform.tileZoom)/f;var h=c*(n.tileID.canonical.x+n.tileID.wrap*f);var p=c*n.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:a.tl,u_pattern_br_a:a.br,u_pattern_tl_b:o.tl,u_pattern_br_b:o.br,u_texsize:[l,u],u_mix:r.t,u_pattern_size_a:a.displaySize,u_pattern_size_b:o.displaySize,u_scale_a:r.fromScale,u_scale_b:r.toScale,u_tile_units_to_pixels:1/qt(n,1,i.transform.tileZoom),u_pixel_coord_upper:[h>>16,p>>16],u_pixel_coord_lower:[h&65535,p&65535]}}var Yi=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_lightpos:new e.Uniform3f(r,i.u_lightpos),u_lightintensity:new e.Uniform1f(r,i.u_lightintensity),u_lightcolor:new e.Uniform3f(r,i.u_lightcolor),u_vertical_gradient:new e.Uniform1f(r,i.u_vertical_gradient)}};var Ki=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_lightpos:new e.Uniform3f(r,i.u_lightpos),u_lightintensity:new e.Uniform1f(r,i.u_lightintensity),u_lightcolor:new e.Uniform3f(r,i.u_lightcolor),u_vertical_gradient:new e.Uniform1f(r,i.u_vertical_gradient),u_height_factor:new e.Uniform1f(r,i.u_height_factor),u_image:new e.Uniform1i(r,i.u_image),u_texsize:new e.Uniform2f(r,i.u_texsize),u_pixel_coord_upper:new e.Uniform2f(r,i.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(r,i.u_pixel_coord_lower),u_scale:new e.Uniform4f(r,i.u_scale),u_fade:new e.Uniform1f(r,i.u_fade)}};var Ji=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_world:new e.Uniform2f(r,i.u_world),u_image:new e.Uniform1i(r,i.u_image),u_opacity:new e.Uniform1f(r,i.u_opacity)}};var $i=function t(r,i,n){var a=i.style.light;var o=a.properties.get("position");var s=[o.x,o.y,o.z];var l=e.create$2();if(a.properties.get("anchor")==="viewport"){e.fromRotation$1(l,-i.transform.angle)}e.transformMat3(s,s,l);var u=a.properties.get("color");return{u_matrix:r,u_lightpos:s,u_lightintensity:a.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+n}};var Qi=function t(r,i,n,a,o,s){return e.extend($i(r,i,n),Wi(o,i,s),{u_height_factor:-Math.pow(2,a.overscaledZ)/s.tileSize/8})};var en=function t(r,i,n){var a=e.create();e.ortho(a,0,r.width,r.height,0,0,1);var o=r.context.gl;return{u_matrix:a,u_world:[o.drawingBufferWidth,o.drawingBufferHeight],u_image:n,u_opacity:i}};var tn=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix)}};var rn=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_image:new e.Uniform1i(r,i.u_image),u_texsize:new e.Uniform2f(r,i.u_texsize),u_pixel_coord_upper:new e.Uniform2f(r,i.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(r,i.u_pixel_coord_lower),u_scale:new e.Uniform4f(r,i.u_scale),u_fade:new e.Uniform1f(r,i.u_fade)}};var nn=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_world:new e.Uniform2f(r,i.u_world)}};var an=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_world:new e.Uniform2f(r,i.u_world),u_image:new e.Uniform1i(r,i.u_image),u_texsize:new e.Uniform2f(r,i.u_texsize),u_pixel_coord_upper:new e.Uniform2f(r,i.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(r,i.u_pixel_coord_lower),u_scale:new e.Uniform4f(r,i.u_scale),u_fade:new e.Uniform1f(r,i.u_fade)}};var on=function e(t){return{u_matrix:t}};var sn=function t(r,i,n,a){return e.extend(on(r),Wi(n,i,a))};var ln=function e(t,r){return{u_matrix:t,u_world:r}};var un=function t(r,i,n,a,o){return e.extend(sn(r,i,n,a),{u_world:o})};var fn=function t(r,i){return{u_camera_to_center_distance:new e.Uniform1f(r,i.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(r,i.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(r,i.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(r,i.u_extrude_scale),u_matrix:new e.UniformMatrix4f(r,i.u_matrix)}};var cn=function e(t,r,i,n){var a=t.transform;var o,s;if(n.paint.get("circle-pitch-alignment")==="map"){var l=qt(i,1,a.zoom);o=true;s=[l,l]}else{o=false;s=a.pixelsToGLUnits}return{u_camera_to_center_distance:a.cameraToCenterDistance,u_scale_with_map:+(n.paint.get("circle-pitch-scale")==="map"),u_matrix:t.translatePosMatrix(r.posMatrix,i,n.paint.get("circle-translate"),n.paint.get("circle-translate-anchor")),u_pitch_with_map:+o,u_extrude_scale:s}};var hn=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_camera_to_center_distance:new e.Uniform1f(r,i.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(r,i.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(r,i.u_extrude_scale),u_overscale_factor:new e.Uniform1f(r,i.u_overscale_factor)}};var pn=function e(t,r,i){var n=qt(i,1,r.zoom);var a=Math.pow(2,r.zoom-i.tileID.overscaledZ);var o=i.tileID.overscaleFactor();return{u_matrix:t,u_camera_to_center_distance:r.cameraToCenterDistance,u_pixels_to_tile_units:n,u_extrude_scale:[r.pixelsToGLUnits[0]/(n*a),r.pixelsToGLUnits[1]/(n*a)],u_overscale_factor:o}};var dn=function t(r,i){return{u_color:new e.UniformColor(r,i.u_color),u_matrix:new e.UniformMatrix4f(r,i.u_matrix)}};var vn=function e(t,r){return{u_matrix:t,u_color:r}};var yn=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix)}};var mn=function e(t){return{u_matrix:t}};var gn=function t(r,i){return{u_extrude_scale:new e.Uniform1f(r,i.u_extrude_scale),u_intensity:new e.Uniform1f(r,i.u_intensity),u_matrix:new e.UniformMatrix4f(r,i.u_matrix)}};var _n=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_world:new e.Uniform2f(r,i.u_world),u_image:new e.Uniform1i(r,i.u_image),u_color_ramp:new e.Uniform1i(r,i.u_color_ramp),u_opacity:new e.Uniform1f(r,i.u_opacity)}};var xn=function e(t,r,i,n){return{u_matrix:t,u_extrude_scale:qt(r,1,i),u_intensity:n}};var bn=function t(r,i,n,a){var o=e.create();e.ortho(o,0,r.width,r.height,0,0,1);var s=r.context.gl;return{u_matrix:o,u_world:[s.drawingBufferWidth,s.drawingBufferHeight],u_image:n,u_color_ramp:a,u_opacity:i.paint.get("heatmap-opacity")}};var wn=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_image:new e.Uniform1i(r,i.u_image),u_latrange:new e.Uniform2f(r,i.u_latrange),u_light:new e.Uniform2f(r,i.u_light),u_shadow:new e.UniformColor(r,i.u_shadow),u_highlight:new e.UniformColor(r,i.u_highlight),u_accent:new e.UniformColor(r,i.u_accent)}};var Sn=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_image:new e.Uniform1i(r,i.u_image),u_dimension:new e.Uniform2f(r,i.u_dimension),u_zoom:new e.Uniform1f(r,i.u_zoom),u_maxzoom:new e.Uniform1f(r,i.u_maxzoom)}};var Cn=function e(t,r,i){var n=i.paint.get("hillshade-shadow-color");var a=i.paint.get("hillshade-highlight-color");var o=i.paint.get("hillshade-accent-color");var s=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);if(i.paint.get("hillshade-illumination-anchor")==="viewport"){s-=t.transform.angle}return{u_matrix:t.transform.calculatePosMatrix(r.tileID.toUnwrapped(),true),u_image:0,u_latrange:Pn(t,r.tileID),u_light:[i.paint.get("hillshade-exaggeration"),s],u_shadow:n,u_highlight:a,u_accent:o}};var Tn=function t(r,i){e.assert(r.dem);var n=r.dem.dim;var a=e.create();e.ortho(a,0,e.EXTENT,-e.EXTENT,0,0,1);e.translate(a,a,[0,-e.EXTENT,0]);return{u_matrix:a,u_image:1,u_dimension:[n*2,n*2],u_zoom:r.tileID.overscaledZ,u_maxzoom:i}};function Pn(t,r){var i=Math.pow(2,r.canonical.z);var n=r.canonical.y;return[new e.MercatorCoordinate(0,n/i).toLngLat().lat,new e.MercatorCoordinate(0,(n+1)/i).toLngLat().lat]}var Mn=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_ratio:new e.Uniform1f(r,i.u_ratio),u_gl_units_to_pixels:new e.Uniform2f(r,i.u_gl_units_to_pixels)}};var In=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_ratio:new e.Uniform1f(r,i.u_ratio),u_gl_units_to_pixels:new e.Uniform2f(r,i.u_gl_units_to_pixels),u_image:new e.Uniform1i(r,i.u_image)}};var An=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_texsize:new e.Uniform2f(r,i.u_texsize),u_ratio:new e.Uniform1f(r,i.u_ratio),u_image:new e.Uniform1i(r,i.u_image),u_gl_units_to_pixels:new e.Uniform2f(r,i.u_gl_units_to_pixels),u_scale:new e.Uniform4f(r,i.u_scale),u_fade:new e.Uniform1f(r,i.u_fade)}};var Ln=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_ratio:new e.Uniform1f(r,i.u_ratio),u_gl_units_to_pixels:new e.Uniform2f(r,i.u_gl_units_to_pixels),u_patternscale_a:new e.Uniform2f(r,i.u_patternscale_a),u_patternscale_b:new e.Uniform2f(r,i.u_patternscale_b),u_sdfgamma:new e.Uniform1f(r,i.u_sdfgamma),u_image:new e.Uniform1i(r,i.u_image),u_tex_y_a:new e.Uniform1f(r,i.u_tex_y_a),u_tex_y_b:new e.Uniform1f(r,i.u_tex_y_b),u_mix:new e.Uniform1f(r,i.u_mix)}};var En=function e(t,r,i){var n=t.transform;return{u_matrix:Fn(t,r,i),u_ratio:1/qt(r,1,n.zoom),u_gl_units_to_pixels:[1/n.pixelsToGLUnits[0],1/n.pixelsToGLUnits[1]]}};var kn=function t(r,i,n){return e.extend(En(r,i,n),{u_image:0})};var Dn=function t(r,i,n,a){var o=r.transform;var s=Rn(i,o);return{u_matrix:Fn(r,i,n),u_texsize:i.imageAtlasTexture.size,u_ratio:1/qt(i,1,o.zoom),u_image:0,u_scale:[e.browser.devicePixelRatio,s,a.fromScale,a.toScale],u_fade:a.t,u_gl_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}};var Bn=function t(r,i,n,a,o){var s=r.transform;var l=r.lineAtlas;var u=Rn(i,s);var f=n.layout.get("line-cap")==="round";var c=l.getDash(a.from,f);var h=l.getDash(a.to,f);var p=c.width*o.fromScale;var d=h.width*o.toScale;return e.extend(En(r,i,n),{u_patternscale_a:[u/p,-c.height/2],u_patternscale_b:[u/d,-h.height/2],u_sdfgamma:l.width/(Math.min(p,d)*256*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:h.y,u_mix:o.t})};function Rn(e,t){return 1/qt(e,1,t.tileZoom)}function Fn(e,t,r){return e.translatePosMatrix(t.tileID.posMatrix,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}var On=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_tl_parent:new e.Uniform2f(r,i.u_tl_parent),u_scale_parent:new e.Uniform1f(r,i.u_scale_parent),u_buffer_scale:new e.Uniform1f(r,i.u_buffer_scale),u_fade_t:new e.Uniform1f(r,i.u_fade_t),u_opacity:new e.Uniform1f(r,i.u_opacity),u_image0:new e.Uniform1i(r,i.u_image0),u_image1:new e.Uniform1i(r,i.u_image1),u_brightness_low:new e.Uniform1f(r,i.u_brightness_low),u_brightness_high:new e.Uniform1f(r,i.u_brightness_high),u_saturation_factor:new e.Uniform1f(r,i.u_saturation_factor),u_contrast_factor:new e.Uniform1f(r,i.u_contrast_factor),u_spin_weights:new e.Uniform3f(r,i.u_spin_weights)}};var zn=function e(t,r,i,n,a){return{u_matrix:t,u_tl_parent:r,u_scale_parent:i,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*a.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:a.paint.get("raster-brightness-min"),u_brightness_high:a.paint.get("raster-brightness-max"),u_saturation_factor:jn(a.paint.get("raster-saturation")),u_contrast_factor:Nn(a.paint.get("raster-contrast")),u_spin_weights:Un(a.paint.get("raster-hue-rotate"))}};function Un(e){e*=Math.PI/180;var t=Math.sin(e);var r=Math.cos(e);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}function Nn(e){return e>0?1/(1-e):1+e}function jn(e){return e>0?1-1/(1.001-e):-e}var Vn=function t(r,i){return{u_is_size_zoom_constant:new e.Uniform1i(r,i.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(r,i.u_is_size_feature_constant),u_size_t:new e.Uniform1f(r,i.u_size_t),u_size:new e.Uniform1f(r,i.u_size),u_camera_to_center_distance:new e.Uniform1f(r,i.u_camera_to_center_distance),u_pitch:new e.Uniform1f(r,i.u_pitch),u_rotate_symbol:new e.Uniform1i(r,i.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(r,i.u_aspect_ratio),u_fade_change:new e.Uniform1f(r,i.u_fade_change),u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(r,i.u_label_plane_matrix),u_gl_coord_matrix:new e.UniformMatrix4f(r,i.u_gl_coord_matrix),u_is_text:new e.Uniform1f(r,i.u_is_text),u_pitch_with_map:new e.Uniform1i(r,i.u_pitch_with_map),u_texsize:new e.Uniform2f(r,i.u_texsize),u_texture:new e.Uniform1i(r,i.u_texture)}};var Gn=function t(r,i){return{u_is_size_zoom_constant:new e.Uniform1i(r,i.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(r,i.u_is_size_feature_constant),u_size_t:new e.Uniform1f(r,i.u_size_t),u_size:new e.Uniform1f(r,i.u_size),u_camera_to_center_distance:new e.Uniform1f(r,i.u_camera_to_center_distance),u_pitch:new e.Uniform1f(r,i.u_pitch),u_rotate_symbol:new e.Uniform1i(r,i.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(r,i.u_aspect_ratio),u_fade_change:new e.Uniform1f(r,i.u_fade_change),u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(r,i.u_label_plane_matrix),u_gl_coord_matrix:new e.UniformMatrix4f(r,i.u_gl_coord_matrix),u_is_text:new e.Uniform1f(r,i.u_is_text),u_pitch_with_map:new e.Uniform1i(r,i.u_pitch_with_map),u_texsize:new e.Uniform2f(r,i.u_texsize),u_texture:new e.Uniform1i(r,i.u_texture),u_gamma_scale:new e.Uniform1f(r,i.u_gamma_scale),u_is_halo:new e.Uniform1f(r,i.u_is_halo)}};var Zn=function e(t,r,i,n,a,o,s,l,u,f){var c=a.transform;return{u_is_size_zoom_constant:+(t==="constant"||t==="source"),u_is_size_feature_constant:+(t==="constant"||t==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:c.width/c.height,u_fade_change:a.options.fadeDuration?a.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:s,u_gl_coord_matrix:l,u_is_text:+u,u_pitch_with_map:+n,u_texsize:f,u_texture:0}};var qn=function t(r,i,n,a,o,s,l,u,f,c,h){var p=o.transform;return e.extend(Zn(r,i,n,a,o,s,l,u,f,c),{u_gamma_scale:a?Math.cos(p._pitch)*p.cameraToCenterDistance:1,u_is_halo:+h})};var Hn=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_opacity:new e.Uniform1f(r,i.u_opacity),u_color:new e.UniformColor(r,i.u_color)}};var Wn=function t(r,i){return{u_matrix:new e.UniformMatrix4f(r,i.u_matrix),u_opacity:new e.Uniform1f(r,i.u_opacity),u_image:new e.Uniform1i(r,i.u_image),u_pattern_tl_a:new e.Uniform2f(r,i.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(r,i.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(r,i.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(r,i.u_pattern_br_b),u_texsize:new e.Uniform2f(r,i.u_texsize),u_mix:new e.Uniform1f(r,i.u_mix),u_pattern_size_a:new e.Uniform2f(r,i.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(r,i.u_pattern_size_b),u_scale_a:new e.Uniform1f(r,i.u_scale_a),u_scale_b:new e.Uniform1f(r,i.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(r,i.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(r,i.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(r,i.u_tile_units_to_pixels)}};var Xn=function e(t,r,i){return{u_matrix:t,u_opacity:r,u_color:i}};var Yn=function t(r,i,n,a,o,s){return e.extend(Xi(a,s,n,o),{u_matrix:r,u_opacity:i})};var Kn={fillExtrusion:Yi,fillExtrusionPattern:Ki,extrusionTexture:Ji,fill:tn,fillPattern:rn,fillOutline:nn,fillOutlinePattern:an,circle:fn,collisionBox:hn,collisionCircle:hn,debug:dn,clippingMask:yn,heatmap:gn,heatmapTexture:_n,hillshade:wn,hillshadePrepare:Sn,line:Mn,lineGradient:In,linePattern:An,lineSDF:Ln,raster:On,symbolIcon:Vn,symbolSDF:Gn,background:Hn,backgroundPattern:Wn};function Jn(t,r){var i=t.sort(function(e,t){return e.tileID.isLessThan(t.tileID)?-1:t.tileID.isLessThan(e.tileID)?1:0});for(var n=0;n<i.length;n++){var a={};var o=i[n];var s=i.slice(n+1);$n(o.tileID.wrapped(),o.tileID,s,new e.OverscaledTileID(0,o.tileID.wrap+1,0,0,0),a);o.setMask(a,r)}}function $n(t,r,i,n,a){for(var o=0;o<i.length;o++){var s=i[o];if(n.isLessThan(s.tileID)){break}if(r.key===s.tileID.key){return}else if(s.tileID.isChildOf(r)){var l=r.children(Infinity);for(var u=0;u<l.length;u++){var f=l[u];$n(t,f,i.slice(o),n,a)}return}}var c=r.overscaledZ-t.overscaledZ;var h=new e.CanonicalTileID(c,r.canonical.x-(t.canonical.x<<c),r.canonical.y-(t.canonical.y<<c));a[h.key]=a[h.key]||h}function Qn(e,t,r,i,n){var a=e.context;var o=a.gl;var s=n?e.useProgram("collisionCircle"):e.useProgram("collisionBox");for(var l=0;l<i.length;l++){var u=i[l];var f=t.getTile(u);var c=f.getBucket(r);if(!c){continue}var h=n?c.collisionCircle:c.collisionBox;if(!h){continue}s.draw(a,n?o.TRIANGLES:o.LINES,Xe.disabled,Je.disabled,e.colorModeForRenderPass(),nt.disabled,pn(u.posMatrix,e.transform,f),r.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,null,e.transform.zoom,null,null,h.collisionVertexBuffer)}}function ea(e,t,r,i){Qn(e,t,r,i,false);Qn(e,t,r,i,true)}var ta=e.identity(new Float32Array(16));var ra=e.properties.layout;function ia(e,t,r,i){if(e.renderPass!=="translucent"){return}var n=Je.disabled;var a=e.colorModeForRenderPass();if(r.paint.get("icon-opacity").constantOr(1)!==0){na(e,t,r,i,false,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),n,a)}if(r.paint.get("text-opacity").constantOr(1)!==0){na(e,t,r,i,true,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),n,a)}if(t.map.showCollisionBoxes){ea(e,t,r,i)}}function na(t,r,i,n,a,o,s,l,u,f,c,h){var p=t.context;var d=p.gl;var v=t.transform;var y=l==="map";var m=u==="map";var g=y&&i.layout.get("symbol-placement")!=="point";var _=y&&!m&&!g;var x=m;var b=x?t.depthModeForSublayer(0,Xe.ReadOnly):Xe.disabled;var w;var S;for(var C=0,T=n;C<T.length;C+=1){var P=T[C];var M=r.getTile(P);var I=M.getBucket(i);if(!I){continue}var A=a?I.text:I.icon;if(!A||!A.segments.get().length){continue}var L=A.programConfigurations.get(i.id);var E=a||I.sdfIcons;var k=a?I.textSizeData:I.iconSizeData;if(!w){w=t.useProgram(E?"symbolSDF":"symbolIcon",L);S=e.evaluateSizeForZoom(k,v.zoom,ra.properties[a?"text-size":"icon-size"])}p.activeTexture.set(d.TEXTURE0);var D=void 0;if(a){M.glyphAtlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE);D=M.glyphAtlasTexture.size}else{var B=i.layout.get("icon-size").constantOr(0)!==1||I.iconsNeedLinear;var R=m||v.pitch!==0;M.imageAtlasTexture.bind(E||t.options.rotating||t.options.zooming||B||R?d.LINEAR:d.NEAREST,d.CLAMP_TO_EDGE);D=M.imageAtlasTexture.size}var F=qt(M,1,t.transform.zoom);var O=At(P.posMatrix,m,y,t.transform,F);var z=Lt(P.posMatrix,m,y,t.transform,F);if(g){Dt(I,P.posMatrix,t,a,O,z,m,f)}var U=t.translatePosMatrix(P.posMatrix,M,o,s),N=g?ta:O,j=t.translatePosMatrix(z,M,o,s,true);var V=void 0;if(E){var G=i.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1)!==0;V=qn(k.functionType,S,_,m,t,U,N,j,a,D,true);if(G){aa(A,i,t,w,b,c,h,V)}V["u_is_halo"]=0}else{V=Zn(k.functionType,S,_,m,t,U,N,j,a,D)}aa(A,i,t,w,b,c,h,V)}}function aa(e,t,r,i,n,a,o,s){var l=r.context;var u=l.gl;i.draw(l,u.TRIANGLES,n,a,o,nt.disabled,s,t.id,e.layoutVertexBuffer,e.indexBuffer,e.segments,t.paint,r.transform.zoom,e.programConfigurations.get(t.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function oa(e,t,r,i){if(e.renderPass!=="translucent"){return}var n=r.paint.get("circle-opacity");var a=r.paint.get("circle-stroke-width");var o=r.paint.get("circle-stroke-opacity");if(n.constantOr(1)===0&&(a.constantOr(1)===0||o.constantOr(1)===0)){return}var s=e.context;var l=s.gl;var u=e.depthModeForSublayer(0,Xe.ReadOnly);var f=Je.disabled;var c=e.colorModeForRenderPass();for(var h=0;h<i.length;h++){var p=i[h];var d=t.getTile(p);var v=d.getBucket(r);if(!v){continue}var y=v.programConfigurations.get(r.id);var m=e.useProgram("circle",y);m.draw(s,l.TRIANGLES,u,f,c,nt.disabled,cn(e,p,d,r),r.id,v.layoutVertexBuffer,v.indexBuffer,v.segments,r.paint,e.transform.zoom,y)}}function sa(t,r,i,n){if(i.paint.get("heatmap-opacity")===0){return}if(t.renderPass==="offscreen"){var a=t.context;var o=a.gl;var s=t.depthModeForSublayer(0,Xe.ReadOnly);var l=Je.disabled;var u=new tt([o.ONE,o.ONE],e.Color.transparent,[true,true,true,true]);la(a,t,i);a.clear({color:e.Color.transparent});for(var f=0;f<n.length;f++){var c=n[f];if(r.hasRenderableParent(c)){continue}var h=r.getTile(c);var p=h.getBucket(i);if(!p){continue}var d=p.programConfigurations.get(i.id);var v=t.useProgram("heatmap",d);var y=t.transform;var m=y.zoom;v.draw(a,o.TRIANGLES,s,l,u,nt.disabled,xn(c.posMatrix,h,m,i.paint.get("heatmap-intensity")),i.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,i.paint,t.transform.zoom,d)}a.viewport.set([0,0,t.width,t.height])}else if(t.renderPass==="translucent"){t.context.setColorMode(t.colorModeForRenderPass());fa(t,i)}}function la(e,t,r){var i=e.gl;e.activeTexture.set(i.TEXTURE1);e.viewport.set([0,0,t.width/4,t.height/4]);var n=r.heatmapFbo;if(!n){var a=i.createTexture();i.bindTexture(i.TEXTURE_2D,a);i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE);i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE);i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR);i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR);n=r.heatmapFbo=e.createFramebuffer(t.width/4,t.height/4);ua(e,t,a,n)}else{i.bindTexture(i.TEXTURE_2D,n.colorAttachment.get());e.bindFramebuffer.set(n.framebuffer)}}function ua(e,t,r,i){var n=e.gl;n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width/4,t.height/4,0,n.RGBA,e.extTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:n.UNSIGNED_BYTE,null);i.colorAttachment.set(r);if(e.extTextureHalfFloat&&n.checkFramebufferStatus(n.FRAMEBUFFER)!==n.FRAMEBUFFER_COMPLETE){e.extTextureHalfFloat=null;i.colorAttachment.setDirty();ua(e,t,r,i)}}function fa(t,r){var i=t.context;var n=i.gl;var a=r.heatmapFbo;if(!a){return}i.activeTexture.set(n.TEXTURE0);n.bindTexture(n.TEXTURE_2D,a.colorAttachment.get());i.activeTexture.set(n.TEXTURE1);var o=r.colorRampTexture;if(!o){o=r.colorRampTexture=new e.Texture(i,r.colorRamp,n.RGBA)}o.bind(n.LINEAR,n.CLAMP_TO_EDGE);t.useProgram("heatmapTexture").draw(i,n.TRIANGLES,Xe.disabled,Je.disabled,t.colorModeForRenderPass(),nt.disabled,bn(t,r,0,1),r.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,r.paint,t.transform.zoom)}function ca(t,r,i,n){if(t.renderPass!=="translucent"){return}var a=i.paint.get("line-opacity");var o=i.paint.get("line-width");if(a.constantOr(1)===0||o.constantOr(1)===0){return}var s=t.depthModeForSublayer(0,Xe.ReadOnly);var l=t.colorModeForRenderPass();var u=i.paint.get("line-dasharray");var f=i.paint.get("line-pattern");var c=f.constantOr(1);var h=i.paint.get("line-gradient");var p=i.getCrossfadeParameters();var d=u?"lineSDF":c?"linePattern":h?"lineGradient":"line";var v=t.context;var y=v.gl;var m=true;if(h){v.activeTexture.set(y.TEXTURE0);var g=i.gradientTexture;if(!i.gradient){return}if(!g){g=i.gradientTexture=new e.Texture(v,i.gradient,y.RGBA)}g.bind(y.LINEAR,y.CLAMP_TO_EDGE)}for(var _=0,x=n;_<x.length;_+=1){var b=x[_];var w=r.getTile(b);if(c&&!w.patternsLoaded()){continue}var S=w.getBucket(i);if(!S){continue}var C=S.programConfigurations.get(i.id);var T=t.context.program.get();var P=t.useProgram(d,C);var M=m||P.program!==T;var I=f.constantOr(null);if(I&&w.imageAtlas){var A=w.imageAtlas.patternPositions[I.to];var L=w.imageAtlas.patternPositions[I.from];if(A&&L){C.setConstantPatternPositions(A,L)}}var E=u?Bn(t,w,i,u,p):c?Dn(t,w,i,p):h?kn(t,w,i):En(t,w,i);if(u&&(M||t.lineAtlas.dirty)){v.activeTexture.set(y.TEXTURE0);t.lineAtlas.bind(v)}else if(c){v.activeTexture.set(y.TEXTURE0);w.imageAtlasTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE);C.updatePatternPaintBuffers(p)}P.draw(v,y.TRIANGLES,s,t.stencilModeForClipping(b),l,nt.disabled,E,i.id,S.layoutVertexBuffer,S.indexBuffer,S.segments,i.paint,t.transform.zoom,C);m=false}}function ha(t,r,i,n){var a=i.paint.get("fill-color");var o=i.paint.get("fill-opacity");if(o.constantOr(1)===0){return}var s=t.colorModeForRenderPass();var l=i.paint.get("fill-pattern");var u=!l.constantOr(1)&&a.constantOr(e.Color.transparent).a===1&&o.constantOr(0)===1?"opaque":"translucent";if(t.renderPass===u){var f=t.depthModeForSublayer(1,t.renderPass==="opaque"?Xe.ReadWrite:Xe.ReadOnly);pa(t,r,i,n,f,s,false)}if(t.renderPass==="translucent"&&i.paint.get("fill-antialias")){var c=t.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,Xe.ReadOnly);pa(t,r,i,n,c,s,true)}}function pa(e,t,r,i,n,a,o){var s=e.context.gl;var l=r.paint.get("fill-pattern");var u=l&&l.constantOr(1);var f=r.getCrossfadeParameters();var c,h,p,d,v;if(!o){h=u?"fillPattern":"fill";c=s.TRIANGLES}else{h=u&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline";c=s.LINES}for(var y=0,m=i;y<m.length;y+=1){var g=m[y];var _=t.getTile(g);if(u&&!_.patternsLoaded()){continue}var x=_.getBucket(r);if(!x){continue}var b=x.programConfigurations.get(r.id);var w=e.useProgram(h,b);if(u){e.context.activeTexture.set(s.TEXTURE0);_.imageAtlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE);b.updatePatternPaintBuffers(f)}var S=l.constantOr(null);if(S&&_.imageAtlas){var C=_.imageAtlas.patternPositions[S.to];var T=_.imageAtlas.patternPositions[S.from];if(C&&T){b.setConstantPatternPositions(C,T)}}var P=e.translatePosMatrix(g.posMatrix,_,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor"));if(!o){d=x.indexBuffer;v=x.segments;p=u?sn(P,e,f,_):on(P)}else{d=x.indexBuffer2;v=x.segments2;var M=[s.drawingBufferWidth,s.drawingBufferHeight];p=h==="fillOutlinePattern"&&u?un(P,e,f,_,M):ln(P,M)}w.draw(e.context,c,n,e.stencilModeForClipping(g),a,nt.disabled,p,r.id,x.layoutVertexBuffer,d,v,r.paint,e.transform.zoom,b)}}function da(t,r){var i=t.context;var n=i.gl;var a=r.viewportFrame;if(t.depthRboNeedsClear){t.setupOffscreenDepthRenderbuffer()}if(!a){var o=new e.Texture(i,{width:t.width,height:t.height,data:null},n.RGBA);o.bind(n.LINEAR,n.CLAMP_TO_EDGE);a=r.viewportFrame=i.createFramebuffer(t.width,t.height);a.colorAttachment.set(o.texture)}i.bindFramebuffer.set(a.framebuffer);a.depthAttachment.set(t.depthRbo);if(t.depthRboNeedsClear){i.clear({depth:1});t.depthRboNeedsClear=false}i.clear({color:e.Color.transparent});i.setStencilMode(Je.disabled);i.setDepthMode(new Xe(n.LEQUAL,Xe.ReadWrite,[0,1]));i.setColorMode(t.colorModeForRenderPass())}function va(e,t,r){var i=t.viewportFrame;if(!i){return}var n=e.context;var a=n.gl;n.activeTexture.set(a.TEXTURE0);a.bindTexture(a.TEXTURE_2D,i.colorAttachment.get());e.useProgram("extrusionTexture").draw(n,a.TRIANGLES,Xe.disabled,Je.disabled,e.colorModeForRenderPass(),nt.disabled,en(e,r,0),t.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,t.paint,e.transform.zoom)}function ya(e,t,r,i){if(r.paint.get("fill-extrusion-opacity")===0){return}if(e.renderPass==="offscreen"){da(e,r);var n=new Xe(e.context.gl.LEQUAL,Xe.ReadWrite,[0,1]),a=Je.disabled,o=e.colorModeForRenderPass();ma(e,t,r,i,n,a,o)}else if(e.renderPass==="translucent"){va(e,r,r.paint.get("fill-extrusion-opacity"))}}function ma(e,t,r,i,n,a,o){var s=e.context;var l=s.gl;var u=r.paint.get("fill-extrusion-pattern");var f=u.constantOr(1);var c=r.getCrossfadeParameters();for(var h=0,p=i;h<p.length;h+=1){var d=p[h];var v=t.getTile(d);var y=v.getBucket(r);if(!y){continue}var m=y.programConfigurations.get(r.id);var g=e.useProgram(f?"fillExtrusionPattern":"fillExtrusion",m);if(f){e.context.activeTexture.set(l.TEXTURE0);v.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE);m.updatePatternPaintBuffers(c)}var _=u.constantOr(null);if(_&&v.imageAtlas){var x=v.imageAtlas.patternPositions[_.to];var b=v.imageAtlas.patternPositions[_.from];if(x&&b){m.setConstantPatternPositions(x,b)}}var w=e.translatePosMatrix(d.posMatrix,v,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor"));var S=r.paint.get("fill-extrusion-vertical-gradient");var C=f?Qi(w,e,S,d,c,v):$i(w,e,S);g.draw(s,s.gl.TRIANGLES,n,a,o,nt.backCCW,C,r.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,r.paint,e.transform.zoom,m)}}function ga(e,t,r,i){if(e.renderPass!=="offscreen"&&e.renderPass!=="translucent"){return}var n=e.context;var a=t.getSource().maxzoom;var o=e.depthModeForSublayer(0,Xe.ReadOnly);var s=Je.disabled;var l=e.colorModeForRenderPass();for(var u=0,f=i;u<f.length;u+=1){var c=f[u];var h=t.getTile(c);if(h.needsHillshadePrepare&&e.renderPass==="offscreen"){xa(e,h,r,a,o,s,l);continue}else if(e.renderPass==="translucent"){_a(e,h,r,o,s,l)}}n.viewport.set([0,0,e.width,e.height])}function _a(e,t,r,i,n,a){var o=e.context;var s=o.gl;var l=t.fbo;if(!l){return}var u=e.useProgram("hillshade");o.activeTexture.set(s.TEXTURE0);s.bindTexture(s.TEXTURE_2D,l.colorAttachment.get());var f=Cn(e,t,r);if(t.maskedBoundsBuffer&&t.maskedIndexBuffer&&t.segments){u.draw(o,s.TRIANGLES,i,n,a,nt.disabled,f,r.id,t.maskedBoundsBuffer,t.maskedIndexBuffer,t.segments)}else{u.draw(o,s.TRIANGLES,i,n,a,nt.disabled,f,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}}function xa(t,r,i,n,a,o,s){var l=t.context;var u=l.gl;if(r.dem&&r.dem.data){var f=r.dem.dim;var c=r.dem.getPixels();l.activeTexture.set(u.TEXTURE1);l.pixelStoreUnpackPremultiplyAlpha.set(false);r.demTexture=r.demTexture||t.getTileTexture(r.tileSize);if(r.demTexture){var h=r.demTexture;h.update(c,{premultiply:false});h.bind(u.NEAREST,u.CLAMP_TO_EDGE)}else{r.demTexture=new e.Texture(l,c,u.RGBA,{premultiply:false});r.demTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE)}l.activeTexture.set(u.TEXTURE0);var p=r.fbo;if(!p){var d=new e.Texture(l,{width:f,height:f,data:null},u.RGBA);d.bind(u.LINEAR,u.CLAMP_TO_EDGE);p=r.fbo=l.createFramebuffer(f,f);p.colorAttachment.set(d.texture)}l.bindFramebuffer.set(p.framebuffer);l.viewport.set([0,0,f,f]);t.useProgram("hillshadePrepare").draw(l,u.TRIANGLES,a,o,s,nt.disabled,Tn(r,n),i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments);r.needsHillshadePrepare=false}}function ba(e,t,r,i){if(e.renderPass!=="translucent"){return}if(r.paint.get("raster-opacity")===0){return}var n=e.context;var a=n.gl;var o=t.getSource();var s=e.useProgram("raster");var l=Je.disabled;var u=e.colorModeForRenderPass();var f=i.length&&i[0].overscaledZ;for(var c=0,h=i;c<h.length;c+=1){var p=h[c];var d=e.depthModeForSublayer(p.overscaledZ-f,r.paint.get("raster-opacity")===1?Xe.ReadWrite:Xe.ReadOnly,a.LESS);var v=t.getTile(p);var y=e.transform.calculatePosMatrix(p.toUnwrapped(),true);v.registerFadeDuration(r.paint.get("raster-fade-duration"));var m=t.findLoadedParent(p,0),g=wa(v,m,t,r,e.transform);var _=void 0,x=void 0;var b=r.paint.get("raster-resampling")==="nearest"?a.NEAREST:a.LINEAR;n.activeTexture.set(a.TEXTURE0);v.texture.bind(b,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);n.activeTexture.set(a.TEXTURE1);if(m){m.texture.bind(b,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);_=Math.pow(2,m.tileID.overscaledZ-v.tileID.overscaledZ);x=[v.tileID.canonical.x*_%1,v.tileID.canonical.y*_%1]}else{v.texture.bind(b,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST)}var w=zn(y,x||[0,0],_||1,g,r);if(o instanceof X){s.draw(n,a.TRIANGLES,d,l,u,nt.disabled,w,r.id,o.boundsBuffer,e.quadTriangleIndexBuffer,o.boundsSegments)}else if(v.maskedBoundsBuffer&&v.maskedIndexBuffer&&v.segments){s.draw(n,a.TRIANGLES,d,l,u,nt.disabled,w,r.id,v.maskedBoundsBuffer,v.maskedIndexBuffer,v.segments,r.paint,e.transform.zoom)}else{s.draw(n,a.TRIANGLES,d,l,u,nt.disabled,w,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}}}function wa(t,r,i,n,a){var o=n.paint.get("raster-fade-duration");if(o>0){var s=e.browser.now();var l=(s-t.timeAdded)/o;var u=r?(s-r.timeAdded)/o:-1;var f=i.getSource();var c=a.coveringZoomLevel({tileSize:f.tileSize,roundZoom:f.roundZoom});var h=!r||Math.abs(r.tileID.overscaledZ-c)>Math.abs(t.tileID.overscaledZ-c);var p=h&&t.refreshedUponExpiration?1:e.clamp(h?l:1-u,0,1);if(t.refreshedUponExpiration&&l>=1){t.refreshedUponExpiration=false}if(r){return{opacity:1,mix:1-p}}else{return{opacity:p,mix:0}}}else{return{opacity:1,mix:0}}}function Sa(e,t,r){var i=r.paint.get("background-color");var n=r.paint.get("background-opacity");if(n===0){return}var a=e.context;var o=a.gl;var s=e.transform;var l=s.tileSize;var u=r.paint.get("background-pattern");if(e.isPatternMissing(u)){return}var f=!u&&i.a===1&&n===1?"opaque":"translucent";if(e.renderPass!==f){return}var c=Je.disabled;var h=e.depthModeForSublayer(0,f==="opaque"?Xe.ReadWrite:Xe.ReadOnly);var p=e.colorModeForRenderPass();var d=e.useProgram(u?"backgroundPattern":"background");var v=s.coveringTiles({tileSize:l});if(u){a.activeTexture.set(o.TEXTURE0);e.imageManager.bind(e.context)}var y=r.getCrossfadeParameters();for(var m=0,g=v;m<g.length;m+=1){var _=g[m];var x=e.transform.calculatePosMatrix(_.toUnwrapped());var b=u?Yn(x,n,e,u,{tileID:_,tileSize:l},y):Xn(x,n,i);d.draw(a,o.TRIANGLES,h,c,p,nt.disabled,b,r.id,e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments)}}function Ca(e,t,r){for(var i=0;i<r.length;i++){Ta(e,t,r[i])}}function Ta(t,r,i){var n=t.context;var a=n.gl;var o=i.posMatrix;var s=t.useProgram("debug");var l=Xe.disabled;var u=Je.disabled;var f=t.colorModeForRenderPass();var c="$debug";s.draw(n,a.LINE_STRIP,l,u,f,nt.disabled,vn(o,e.Color.red),c,t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments);var h=Ma(i.toString(),50,200,5);var p=new e.StructArrayLayout2i4;var d=new e.StructArrayLayout2ui4;for(var v=0;v<h.length;v+=2){p.emplaceBack(h[v],h[v+1]);d.emplaceBack(v,v+1)}var y=n.createVertexBuffer(p,gr.members);var m=n.createIndexBuffer(d);var g=e.SegmentVector.simpleSegment(0,0,p.length/2,p.length/2);var _=r.getTile(i).tileSize;var x=e.EXTENT/(Math.pow(2,t.transform.zoom-i.overscaledZ)*_);var b=[[-1,-1],[-1,1],[1,-1],[1,1]];for(var w=0;w<b.length;w++){var S=b[w];s.draw(n,a.LINES,l,u,f,nt.disabled,vn(e.translate([],o,[x*S[0],x*S[1],0]),e.Color.white),c,y,m,g)}s.draw(n,a.LINES,l,u,f,nt.disabled,vn(o,e.Color.black),c,y,m,g)}var Pa={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]};function Ma(e,t,r,i){i=i||1;var n=[];var a,o,s,l,u,f,c,h;for(a=0,o=e.length;a<o;a++){u=Pa[e[a]];if(!u){continue}h=null;for(s=0,l=u[1].length;s<l;s+=2){if(u[1][s]===-1&&u[1][s+1]===-1){h=null}else{f=t+u[1][s]*i;c=r-u[1][s+1]*i;if(h){n.push(h.x,h.y,f,c)}h={x:f,y:c}}}t+=u[0]*i}return n}function Ia(e,t,r){var i=e.context;var n=r.implementation;if(e.renderPass==="offscreen"){var a=n.prerender;if(a){e.setCustomLayerDefaults();a.call(n,i.gl,e.transform.customLayerMatrix());i.setDirty();e.setBaseState()}if(n.renderingMode==="3d"){e.setCustomLayerDefaults();da(e,r);n.render(i.gl,e.transform.customLayerMatrix());i.setDirty();e.setBaseState()}}else if(e.renderPass==="translucent"){if(n.renderingMode==="3d"){va(e,r,1)}else{e.setCustomLayerDefaults();i.setStencilMode(Je.disabled);var o=e.depthModeForSublayer(0,Xe.ReadOnly);i.setDepthMode(o);n.render(i.gl,e.transform.customLayerMatrix());i.setDirty();e.setBaseState();i.bindFramebuffer.set(null)}}}var Aa={symbol:ia,circle:oa,heatmap:sa,line:ca,fill:ha,"fill-extrusion":ya,hillshade:ga,raster:ba,background:Sa,debug:Ca,custom:Ia};var La=function t(r,i){this.context=new at(r);this.transform=i;this._tileTextures={};this.setup();this.numSublayers=ot.maxUnderzooming+ot.maxOverzooming+1;this.depthEpsilon=1/Math.pow(2,16);this.depthRboNeedsClear=true;this.emptyProgramConfiguration=new e.ProgramConfiguration;this.crossTileSymbolIndex=new pr};La.prototype.resize=function t(r,i){var n=this;var a=this.context.gl;this.width=r*e.browser.devicePixelRatio;this.height=i*e.browser.devicePixelRatio;this.context.viewport.set([0,0,this.width,this.height]);if(this.style){for(var o=0,s=n.style._order;o<s.length;o+=1){var l=s[o];n.style._layers[l].resize()}}if(this.depthRbo){a.deleteRenderbuffer(this.depthRbo);this.depthRbo=null}};La.prototype.setup=function t(){var r=this.context;var i=new e.StructArrayLayout2i4;i.emplaceBack(0,0);i.emplaceBack(e.EXTENT,0);i.emplaceBack(0,e.EXTENT);i.emplaceBack(e.EXTENT,e.EXTENT);this.tileExtentBuffer=r.createVertexBuffer(i,gr.members);this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var n=new e.StructArrayLayout2i4;n.emplaceBack(0,0);n.emplaceBack(e.EXTENT,0);n.emplaceBack(0,e.EXTENT);n.emplaceBack(e.EXTENT,e.EXTENT);this.debugBuffer=r.createVertexBuffer(n,gr.members);this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var a=new e.StructArrayLayout4i8;a.emplaceBack(0,0,0,0);a.emplaceBack(e.EXTENT,0,e.EXTENT,0);a.emplaceBack(0,e.EXTENT,0,e.EXTENT);a.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT);this.rasterBoundsBuffer=r.createVertexBuffer(a,e.rasterBoundsAttributes.members);this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var o=new e.StructArrayLayout2i4;o.emplaceBack(0,0);o.emplaceBack(1,0);o.emplaceBack(0,1);o.emplaceBack(1,1);this.viewportBuffer=r.createVertexBuffer(o,gr.members);this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var s=new e.StructArrayLayout1ui2;s.emplaceBack(0);s.emplaceBack(1);s.emplaceBack(3);s.emplaceBack(2);s.emplaceBack(0);this.tileBorderIndexBuffer=r.createIndexBuffer(s);var l=new e.StructArrayLayout3ui6;l.emplaceBack(0,1,2);l.emplaceBack(2,1,3);this.quadTriangleIndexBuffer=r.createIndexBuffer(l);var u=this.context.gl;this.stencilClearMode=new Je({func:u.ALWAYS,mask:0},0,255,u.ZERO,u.ZERO,u.ZERO)};La.prototype.clearStencil=function t(){var r=this.context;var i=r.gl;var n=e.create();e.ortho(n,0,this.width,this.height,0,0,1);e.scale(n,n,[i.drawingBufferWidth,i.drawingBufferHeight,0]);this.useProgram("clippingMask").draw(r,i.TRIANGLES,Xe.disabled,this.stencilClearMode,tt.disabled,nt.disabled,mn(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)};La.prototype._renderTileClippingMasks=function e(t){var r=this;var i=this.context;var n=i.gl;i.setColorMode(tt.disabled);i.setDepthMode(Xe.disabled);var a=this.useProgram("clippingMask");var o=1;this._tileClippingMaskIDs={};for(var s=0,l=t;s<l.length;s+=1){var u=l[s];var f=r._tileClippingMaskIDs[u.key]=o++;a.draw(i,n.TRIANGLES,Xe.disabled,new Je({func:n.ALWAYS,mask:0},f,255,n.KEEP,n.KEEP,n.REPLACE),tt.disabled,nt.disabled,mn(u.posMatrix),"$clipping",r.tileExtentBuffer,r.quadTriangleIndexBuffer,r.tileExtentSegments)}};La.prototype.stencilModeForClipping=function e(t){var r=this.context.gl;return new Je({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,r.KEEP,r.KEEP,r.REPLACE)};La.prototype.colorModeForRenderPass=function t(){var r=this.context.gl;if(this._showOverdrawInspector){var i=8;var n=1/i;return new tt([r.CONSTANT_COLOR,r.ONE],new e.Color(n,n,n,0),[true,true,true,true])}else if(this.renderPass==="opaque"){return tt.unblended}else{return tt.alphaBlended}};La.prototype.depthModeForSublayer=function e(t,r,i){var n=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;var a=n-1+this.depthRange;return new Xe(i||this.context.gl.LEQUAL,r,[a,n])};La.prototype.render=function t(r,i){var n=this;this.style=r;this.options=i;this.lineAtlas=r.lineAtlas;this.imageManager=r.imageManager;this.glyphManager=r.glyphManager;this.symbolFadeChange=r.placement.symbolFadeChange(e.browser.now());var a=this.style._order;var o=this.style.sourceCaches;for(var s in o){var l=o[s];if(l.used){l.prepare(n.context)}}var u={};var f={};var c={};for(var h in o){var p=o[h];u[h]=p.getVisibleCoordinates();f[h]=u[h].slice().reverse();c[h]=p.getVisibleCoordinates(true).reverse()}for(var d in o){var v=o[d];var y=v.getSource();if(y.type!=="raster"&&y.type!=="raster-dem"){continue}var m=[];for(var g=0,_=u[d];g<_.length;g+=1){var x=_[g];m.push(v.getTile(x))}Jn(m,n.context)}this.renderPass="offscreen";this.depthRboNeedsClear=true;for(var b=0,w=a;b<w.length;b+=1){var S=w[b];var C=n.style._layers[S];if(!C.hasOffscreenPass()||C.isHidden(n.transform.zoom)){continue}var T=f[C.source];if(C.type!=="custom"&&!T.length){continue}n.renderLayer(n,o[C.source],C,T)}this.context.bindFramebuffer.set(null);this.context.clear({color:i.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1});this._showOverdrawInspector=i.showOverdrawInspector;this.depthRange=(r._order.length+2)*this.numSublayers*this.depthEpsilon;this.renderPass="opaque";var P;for(this.currentLayer=a.length-1;this.currentLayer>=0;this.currentLayer--){var M=n.style._layers[a[n.currentLayer]];var I=o[M.source];var A=u[M.source];if(M.source!==P&&I){n.clearStencil();if(I.getSource().isTileClipped){n._renderTileClippingMasks(A)}}n.renderLayer(n,I,M,A);P=M.source}this.renderPass="translucent";for(this.currentLayer=0,P=null;this.currentLayer<a.length;this.currentLayer++){var L=n.style._layers[a[n.currentLayer]];var E=o[L.source];var k=(L.type==="symbol"?c:f)[L.source];if(L.source!==P&&E){n.clearStencil();if(E.getSource().isTileClipped){n._renderTileClippingMasks(u[L.source])}}n.renderLayer(n,E,L,k);P=L.source}if(this.options.showTileBoundaries){for(var D in o){Aa.debug(n,o[D],u[D]);break}}this.setCustomLayerDefaults()};La.prototype.setupOffscreenDepthRenderbuffer=function e(){var t=this.context;if(!this.depthRbo){this.depthRbo=t.createRenderbuffer(t.gl.DEPTH_COMPONENT16,this.width,this.height)}};La.prototype.renderLayer=function e(t,r,i,n){if(i.isHidden(this.transform.zoom)){return}if(i.type!=="background"&&i.type!=="custom"&&!n.length){return}this.id=i.id;Aa[i.type](t,r,i,n)};La.prototype.translatePosMatrix=function t(r,i,n,a,o){if(!n[0]&&!n[1]){return r}var s=o?a==="map"?this.transform.angle:0:a==="viewport"?-this.transform.angle:0;if(s){var l=Math.sin(s);var u=Math.cos(s);n=[n[0]*u-n[1]*l,n[0]*l+n[1]*u]}var f=[o?n[0]:qt(i,n[0],this.transform.zoom),o?n[1]:qt(i,n[1],this.transform.zoom),0];var c=new Float32Array(16);e.translate(c,r,f);return c};La.prototype.saveTileTexture=function e(t){var r=this._tileTextures[t.size[0]];if(!r){this._tileTextures[t.size[0]]=[t]}else{r.push(t)}};La.prototype.getTileTexture=function e(t){var r=this._tileTextures[t];return r&&r.length>0?r.pop():null};La.prototype.isPatternMissing=function e(t){if(!t){return false}var r=this.imageManager.getPattern(t.from);var i=this.imageManager.getPattern(t.to);return!r||!i};La.prototype.useProgram=function e(t,r){if(r===void 0)r=this.emptyProgramConfiguration;this.cache=this.cache||{};var i=""+t+(r.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");if(!this.cache[i]){this.cache[i]=new Hi(this.context,Zi[t],r,Kn[t],this._showOverdrawInspector)}return this.cache[i]};La.prototype.setCustomLayerDefaults=function e(){this.context.unbindVAO();this.context.cullFace.setDefault();this.context.activeTexture.setDefault();this.context.pixelStoreUnpack.setDefault();this.context.pixelStoreUnpackPremultiplyAlpha.setDefault();this.context.pixelStoreUnpackFlipY.setDefault()};La.prototype.setBaseState=function e(){var t=this.context.gl;this.context.cullFace.set(false);this.context.viewport.set([0,0,this.width,this.height]);this.context.blendEquation.set(t.FUNC_ADD)};function Ea(t,r,i,n){if(n===undefined){n=true}var a=1<<t;var o={};function s(r,s,l){var u,f,c,h;if(l>=0&&l<=a){for(u=r;u<s;u++){f=Math.floor(u/a);c=(u%a+a)%a;if(f===0||n===true){h=new e.OverscaledTileID(i,f,t,c,l);o[h.key]=h}}}}var l=r.map(function(t){return new e.Point(t.x,t.y)._mult(a)});Ba(l[0],l[1],l[2],0,a,s);Ba(l[2],l[3],l[0],0,a,s);return(0,k.default)(o).map(function(e){return o[e]})}function ka(e,t){if(e.y>t.y){var r=e;e=t;t=r}return{x0:e.x,y0:e.y,x1:t.x,y1:t.y,dx:t.x-e.x,dy:t.y-e.y}}function Da(e,t,r,i,n){var a=Math.max(r,Math.floor(t.y0));var o=Math.min(i,Math.ceil(t.y1));if(e.x0===t.x0&&e.y0===t.y0?e.x0+t.dy/e.dy*e.dx<t.x1:e.x1-t.dy/e.dy*e.dx<t.x0){var s=e;e=t;t=s}var l=e.dx/e.dy;var u=t.dx/t.dy;var f=e.dx>0;var c=t.dx<0;for(var h=a;h<o;h++){var p=l*Math.max(0,Math.min(e.dy,h+f-e.y0))+e.x0;var d=u*Math.max(0,Math.min(t.dy,h+c-t.y0))+t.x0;n(Math.floor(d),Math.ceil(p),h)}}function Ba(e,t,r,i,n,a){var o=ka(e,t),s=ka(t,r),l=ka(r,e);var u;if(o.dy>s.dy){u=o;o=s;s=u}if(o.dy>l.dy){u=o;o=l;l=u}if(s.dy>l.dy){u=s;s=l;l=u}if(o.dy){Da(l,o,i,n,a)}if(s.dy){Da(l,s,i,n,a)}}var Ra=function t(r,i,n){this.tileSize=512;this.maxValidLatitude=85.051129;this._renderWorldCopies=n===undefined?true:n;this._minZoom=r||0;this._maxZoom=i||22;this.setMaxBounds();this.width=0;this.height=0;this._center=new e.LngLat(0,0);this.zoom=0;this.angle=0;this._fov=.6435011087932844;this._pitch=0;this._unmodified=true;this._posMatrixCache={};this._alignedPosMatrixCache={}};var Fa={minZoom:{configurable:true},maxZoom:{configurable:true},renderWorldCopies:{configurable:true},worldSize:{configurable:true},centerPoint:{configurable:true},size:{configurable:true},bearing:{configurable:true},pitch:{configurable:true},fov:{configurable:true},zoom:{configurable:true},center:{configurable:true},unmodified:{configurable:true},point:{configurable:true}};Ra.prototype.clone=function e(){var e=new Ra(this._minZoom,this._maxZoom,this._renderWorldCopies);e.tileSize=this.tileSize;e.latRange=this.latRange;e.width=this.width;e.height=this.height;e._center=this._center;e.zoom=this.zoom;e.angle=this.angle;e._fov=this._fov;e._pitch=this._pitch;e._unmodified=this._unmodified;e._calcMatrices();return e};Fa.minZoom.get=function(){return this._minZoom};Fa.minZoom.set=function(e){if(this._minZoom===e){return}this._minZoom=e;this.zoom=Math.max(this.zoom,e)};Fa.maxZoom.get=function(){return this._maxZoom};Fa.maxZoom.set=function(e){if(this._maxZoom===e){return}this._maxZoom=e;this.zoom=Math.min(this.zoom,e)};Fa.renderWorldCopies.get=function(){return this._renderWorldCopies};Fa.renderWorldCopies.set=function(e){if(e===undefined){e=true}else if(e===null){e=false}this._renderWorldCopies=e};Fa.worldSize.get=function(){return this.tileSize*this.scale};Fa.centerPoint.get=function(){return this.size._div(2)};Fa.size.get=function(){return new e.Point(this.width,this.height)};Fa.bearing.get=function(){return-this.angle/Math.PI*180};Fa.bearing.set=function(t){var r=-e.wrap(t,-180,180)*Math.PI/180;if(this.angle===r){return}this._unmodified=false;this.angle=r;this._calcMatrices();this.rotationMatrix=e.create$4();e.rotate$2(this.rotationMatrix,this.rotationMatrix,this.angle)};Fa.pitch.get=function(){return this._pitch/Math.PI*180};Fa.pitch.set=function(t){var r=e.clamp(t,0,60)/180*Math.PI;if(this._pitch===r){return}this._unmodified=false;this._pitch=r;this._calcMatrices()};Fa.fov.get=function(){return this._fov/Math.PI*180};Fa.fov.set=function(e){e=Math.max(.01,Math.min(60,e));if(this._fov===e){return}this._unmodified=false;this._fov=e/180*Math.PI;this._calcMatrices()};Fa.zoom.get=function(){return this._zoom};Fa.zoom.set=function(e){var t=Math.min(Math.max(e,this.minZoom),this.maxZoom);if(this._zoom===t){return}this._unmodified=false;this._zoom=t;this.scale=this.zoomScale(t);this.tileZoom=Math.floor(t);this.zoomFraction=t-this.tileZoom;this._constrain();this._calcMatrices()};Fa.center.get=function(){return this._center};Fa.center.set=function(e){if(e.lat===this._center.lat&&e.lng===this._center.lng){return}this._unmodified=false;this._center=e;this._constrain();this._calcMatrices()};Ra.prototype.coveringZoomLevel=function e(t){return(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize))};Ra.prototype.getVisibleUnwrappedCoordinates=function t(r){var i=[new e.UnwrappedTileID(0,r)];if(this._renderWorldCopies){var n=this.pointCoordinate(new e.Point(0,0));var a=this.pointCoordinate(new e.Point(this.width,0));var o=this.pointCoordinate(new e.Point(this.width,this.height));var s=this.pointCoordinate(new e.Point(0,this.height));var l=Math.floor(Math.min(n.x,a.x,o.x,s.x));var u=Math.floor(Math.max(n.x,a.x,o.x,s.x));var f=1;for(var c=l-f;c<=u+f;c++){if(c===0){continue}i.push(new e.UnwrappedTileID(c,r))}}return i};Ra.prototype.coveringTiles=function t(r){var i=this.coveringZoomLevel(r);var n=i;if(r.minzoom!==undefined&&i<r.minzoom){return[]}if(r.maxzoom!==undefined&&i>r.maxzoom){i=r.maxzoom}var a=e.MercatorCoordinate.fromLngLat(this.center);var o=Math.pow(2,i);var s=new e.Point(o*a.x-.5,o*a.y-.5);var l=[this.pointCoordinate(new e.Point(0,0)),this.pointCoordinate(new e.Point(this.width,0)),this.pointCoordinate(new e.Point(this.width,this.height)),this.pointCoordinate(new e.Point(0,this.height))];return Ea(i,l,r.reparseOverscaled?n:i,this._renderWorldCopies).sort(function(e,t){return s.dist(e.canonical)-s.dist(t.canonical)})};Ra.prototype.resize=function e(t,r){this.width=t;this.height=r;this.pixelsToGLUnits=[2/t,-2/r];this._constrain();this._calcMatrices()};Fa.unmodified.get=function(){return this._unmodified};Ra.prototype.zoomScale=function e(t){return Math.pow(2,t)};Ra.prototype.scaleZoom=function e(t){return Math.log(t)/Math.LN2};Ra.prototype.project=function t(r){var i=e.clamp(r.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(this.lngX(r.lng),this.latY(i))};Ra.prototype.unproject=function t(r){return new e.LngLat(this.xLng(r.x),this.yLat(r.y))};Fa.point.get=function(){return this.project(this.center)};Ra.prototype.lngX=function e(t){return(180+t)*this.worldSize/360};Ra.prototype.latY=function e(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))*this.worldSize/360};Ra.prototype.xLng=function e(t){return 360*t/this.worldSize-180};Ra.prototype.yLat=function e(t){var r=180-360*t/this.worldSize;return 360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90};Ra.prototype.setLocationAtPoint=function t(r,i){var n=this.pointCoordinate(i);var a=this.pointCoordinate(this.centerPoint);var o=this.locationCoordinate(r);var s=new e.MercatorCoordinate(o.x-(n.x-a.x),o.y-(n.y-a.y));this.center=this.coordinateLocation(s);if(this._renderWorldCopies){this.center=this.center.wrap()}};Ra.prototype.locationPoint=function e(t){return this.coordinatePoint(this.locationCoordinate(t))};Ra.prototype.pointLocation=function e(t){return this.coordinateLocation(this.pointCoordinate(t))};Ra.prototype.locationCoordinate=function t(r){return e.MercatorCoordinate.fromLngLat(r)};Ra.prototype.coordinateLocation=function e(t){return t.toLngLat()};Ra.prototype.pointCoordinate=function t(r){var i=0;var n=[r.x,r.y,0,1];var a=[r.x,r.y,1,1];e.transformMat4(n,n,this.pixelMatrixInverse);e.transformMat4(a,a,this.pixelMatrixInverse);var o=n[3];var s=a[3];var l=n[0]/o;var u=a[0]/s;var f=n[1]/o;var c=a[1]/s;var h=n[2]/o;var p=a[2]/s;var d=h===p?0:(i-h)/(p-h);return new e.MercatorCoordinate(e.number(l,u,d)/this.worldSize,e.number(f,c,d)/this.worldSize)};Ra.prototype.coordinatePoint=function t(r){var i=[r.x*this.worldSize,r.y*this.worldSize,0,1];e.transformMat4(i,i,this.pixelMatrix);return new e.Point(i[0]/i[3],i[1]/i[3])};Ra.prototype.getBounds=function t(){return(new e.LngLatBounds).extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))};Ra.prototype.getMaxBounds=function t(){if(!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2){return null}return new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])};Ra.prototype.setMaxBounds=function e(t){if(t){this.lngRange=[t.getWest(),t.getEast()];this.latRange=[t.getSouth(),t.getNorth()];this._constrain()}else{this.lngRange=null;this.latRange=[-this.maxValidLatitude,this.maxValidLatitude]}};Ra.prototype.calculatePosMatrix=function t(r,i){if(i===void 0)i=false;var n=r.key;var a=i?this._alignedPosMatrixCache:this._posMatrixCache;if(a[n]){return a[n]}var o=r.canonical;var s=this.worldSize/this.zoomScale(o.z);var l=o.x+Math.pow(2,o.z)*r.wrap;var u=e.identity(new Float64Array(16));e.translate(u,u,[l*s,o.y*s,0]);e.scale(u,u,[s/e.EXTENT,s/e.EXTENT,1]);e.multiply(u,i?this.alignedProjMatrix:this.projMatrix,u);a[n]=new Float32Array(u);return a[n]};Ra.prototype.customLayerMatrix=function e(){return this.mercatorMatrix.slice()};Ra.prototype._constrain=function t(){if(!this.center||!this.width||!this.height||this._constraining){return}this._constraining=true;var r=-90;var i=90;var n=-180;var a=180;var o,s,l,u;var f=this.size,c=this._unmodified;if(this.latRange){var h=this.latRange;r=this.latY(h[1]);i=this.latY(h[0]);o=i-r<f.y?f.y/(i-r):0}if(this.lngRange){var p=this.lngRange;n=this.lngX(p[0]);a=this.lngX(p[1]);s=a-n<f.x?f.x/(a-n):0}var d=this.point;var v=Math.max(s||0,o||0);if(v){this.center=this.unproject(new e.Point(s?(a+n)/2:d.x,o?(i+r)/2:d.y));this.zoom+=this.scaleZoom(v);this._unmodified=c;this._constraining=false;return}if(this.latRange){var y=d.y,m=f.y/2;if(y-m<r){u=r+m}if(y+m>i){u=i-m}}if(this.lngRange){var g=d.x,_=f.x/2;if(g-_<n){l=n+_}if(g+_>a){l=a-_}}if(l!==undefined||u!==undefined){this.center=this.unproject(new e.Point(l!==undefined?l:d.x,u!==undefined?u:d.y))}this._unmodified=c;this._constraining=false};Ra.prototype._calcMatrices=function t(){if(!this.height){return}this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var r=this._fov/2;var i=Math.PI/2+this._pitch;var n=Math.sin(r)*this.cameraToCenterDistance/Math.sin(Math.PI-i-r);var a=this.point;var o=a.x,s=a.y;var l=Math.cos(Math.PI/2-this._pitch)*n+this.cameraToCenterDistance;var u=l*1.01;var f=new Float64Array(16);e.perspective(f,this._fov,this.width/this.height,1,u);e.scale(f,f,[1,-1,1]);e.translate(f,f,[0,0,-this.cameraToCenterDistance]);e.rotateX(f,f,this._pitch);e.rotateZ(f,f,this.angle);e.translate(f,f,[-o,-s,0]);this.mercatorMatrix=e.scale([],f,[this.worldSize,this.worldSize,this.worldSize]);var c=this.worldSize/(2*Math.PI*6378137*Math.abs(Math.cos(this.center.lat*(Math.PI/180))));if(this.units==="m"){c=this.worldSize/(this.latRange[1]-this.latRange[0])}e.scale(f,f,[1,1,c,1]);this.projMatrix=f;var h=this.width%2/2,p=this.height%2/2,d=Math.cos(this.angle),v=Math.sin(this.angle),y=o-Math.round(o)+d*h+v*p,m=s-Math.round(s)+d*p+v*h;var g=new Float64Array(f);e.translate(g,g,[y>.5?y-1:y,m>.5?m-1:m,0]);this.alignedProjMatrix=g;f=e.create();e.scale(f,f,[this.width/2,-this.height/2,1]);e.translate(f,f,[1,-1,0]);this.pixelMatrix=e.multiply(new Float64Array(16),f,this.projMatrix);f=e.invert(new Float64Array(16),this.pixelMatrix);if(!f){throw new Error("failed to invert matrix")}this.pixelMatrixInverse=f;this._posMatrixCache={};this._alignedPosMatrixCache={}};Ra.prototype.maxPitchScaleFactor=function t(){if(!this.pixelMatrixInverse){return 1}var r=this.pointCoordinate(new e.Point(0,0));var i=[r.x*this.worldSize,r.y*this.worldSize,0,1];var n=e.transformMat4(i,i,this.pixelMatrix);return n[3]/this.cameraToCenterDistance};(0,x.default)(Ra.prototype,Fa);function Oa(e,t){var r=false;var i=0;var n=function n(){i=0;if(r){e();i=setTimeout(n,t);r=false}};return function(){r=true;if(!i){n()}return i}}var za=function t(){e.bindAll(["_onHashChange","_updateHash"],this);this._updateHash=Oa(this._updateHashUnthrottled.bind(this),30*1e3/100)};za.prototype.addTo=function t(r){this._map=r;e.window.addEventListener("hashchange",this._onHashChange,false);this._map.on("moveend",this._updateHash);return this};za.prototype.remove=function t(){e.window.removeEventListener("hashchange",this._onHashChange,false);this._map.off("moveend",this._updateHash);clearTimeout(this._updateHash());delete this._map;return this};za.prototype.getHashString=function e(t){var r=this._map.getCenter(),i=Math.round(this._map.getZoom()*100)/100,n=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,n),o=Math.round(r.lng*a)/a,s=Math.round(r.lat*a)/a,l=this._map.getBearing(),u=this._map.getPitch();var f="";if(t){f+="#/"+o+"/"+s+"/"+i}else{f+="#"+i+"/"+s+"/"+o}if(l||u){f+="/"+Math.round(l*10)/10}if(u){f+="/"+Math.round(u)}return f};za.prototype._onHashChange=function t(){var r=e.window.location.hash.replace("#","").split("/");if(r.length>=3){this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:+(r[3]||0),pitch:+(r[4]||0)});return true}return false};za.prototype._updateHashUnthrottled=function t(){var r=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",r)}catch(e){}};var Ua=function(t){function i(i,n,a,o){if(o===void 0)o={};var s=r.mousePos(n.getCanvasContainer(),a);var l=n.unproject(s);t.call(this,i,e.extend({point:s,lngLat:l,originalEvent:a},o));this._defaultPrevented=false;this.target=n}if(t)i.__proto__=t;i.prototype=(0,F.default)(t&&t.prototype);i.prototype.constructor=i;var n={defaultPrevented:{configurable:true}};i.prototype.preventDefault=function e(){this._defaultPrevented=true};n.defaultPrevented.get=function(){return this._defaultPrevented};(0,x.default)(i.prototype,n);return i}(e.Event);var Na=function(t){function i(i,n,a){var o=r.touchPos(n.getCanvasContainer(),a);var s=o.map(function(e){return n.unproject(e)});var l=o.reduce(function(e,t,r,i){return e.add(t.div(i.length))},new e.Point(0,0));var u=n.unproject(l);t.call(this,i,{points:o,point:l,lngLats:s,lngLat:u,originalEvent:a});this._defaultPrevented=false}if(t)i.__proto__=t;i.prototype=(0,F.default)(t&&t.prototype);i.prototype.constructor=i;var n={defaultPrevented:{configurable:true}};i.prototype.preventDefault=function e(){this._defaultPrevented=true};n.defaultPrevented.get=function(){return this._defaultPrevented};(0,x.default)(i.prototype,n);return i}(e.Event);var ja=function(e){function t(t,r,i){e.call(this,t,{originalEvent:i});this._defaultPrevented=false}if(e)t.__proto__=e;t.prototype=(0,F.default)(e&&e.prototype);t.prototype.constructor=t;var r={defaultPrevented:{configurable:true}};t.prototype.preventDefault=function e(){this._defaultPrevented=true};r.defaultPrevented.get=function(){return this._defaultPrevented};(0,x.default)(t.prototype,r);return t}(e.Event);var Va=4.000244140625;var Ga=1/100;var Za=1/450;var qa=2;var Ha=function t(r){this._map=r;this._el=r.getCanvasContainer();this._delta=0;e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Ha.prototype.isEnabled=function e(){return!!this._enabled};Ha.prototype.isActive=function e(){return!!this._active};Ha.prototype.isZooming=function e(){return!!this._zooming};Ha.prototype.enable=function e(t){if(this.isEnabled()){return}this._enabled=true;this._aroundCenter=t&&t.around==="center"};Ha.prototype.disable=function e(){if(!this.isEnabled()){return}this._enabled=false};Ha.prototype.onWheel=function t(r){if(!this.isEnabled()){return}var i=r.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?r.deltaY*40:r.deltaY;var n=e.browser.now(),a=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n;if(i!==0&&i%Va===0){this._type="wheel"}else if(i!==0&&Math.abs(i)<4){this._type="trackpad"}else if(a>400){this._type=null;this._lastValue=i;this._timeout=setTimeout(this._onTimeout,40,r)}else if(!this._type){this._type=Math.abs(a*i)<200?"trackpad":"wheel";if(this._timeout){clearTimeout(this._timeout);this._timeout=null;i+=this._lastValue}}if(r.shiftKey&&i){i=i/4}if(this._type){this._lastWheelEvent=r;this._delta-=i;if(!this.isActive()){this._start(r)}}r.preventDefault()};Ha.prototype._onTimeout=function e(t){this._type="wheel";this._delta-=this._lastValue;if(!this.isActive()){this._start(t)}};Ha.prototype._start=function t(i){if(!this._delta){return}if(this._frameId){this._map._cancelRenderFrame(this._frameId);this._frameId=null}this._active=true;this._zooming=true;this._map.fire(new e.Event("movestart",{originalEvent:i}));this._map.fire(new e.Event("zoomstart",{originalEvent:i}));if(this._finishTimeout){clearTimeout(this._finishTimeout)}var n=r.mousePos(this._el,i);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(n));this._aroundPoint=this._map.transform.locationPoint(this._around);if(!this._frameId){this._frameId=this._map._requestRenderFrame(this._onScrollFrame)}};Ha.prototype._onScrollFrame=function t(){var r=this;this._frameId=null;if(!this.isActive()){return}var i=this._map.transform;if(this._delta!==0){var n=this._type==="wheel"&&Math.abs(this._delta)>Va?Za:Ga;var a=qa/(1+Math.exp(-Math.abs(this._delta*n)));if(this._delta<0&&a!==0){a=1/a}var o=typeof this._targetZoom==="number"?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(o*a)));if(this._type==="wheel"){this._startZoom=i.zoom;this._easing=this._smoothOutEasing(200)}this._delta=0}var s=typeof this._targetZoom==="number"?this._targetZoom:i.zoom;var l=this._startZoom;var u=this._easing;var f=false;if(this._type==="wheel"&&l&&u){e.assert(u&&typeof l==="number");var c=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1);var h=u(c);i.zoom=e.number(l,s,h);if(c<1){if(!this._frameId){this._frameId=this._map._requestRenderFrame(this._onScrollFrame)}}else{f=true}}else{i.zoom=s;f=true}i.setLocationAtPoint(this._around,this._aroundPoint);this._map.fire(new e.Event("move",{originalEvent:this._lastWheelEvent}));this._map.fire(new e.Event("zoom",{originalEvent:this._lastWheelEvent}));if(f){this._active=false;this._finishTimeout=setTimeout(function(){r._zooming=false;r._map.fire(new e.Event("zoomend",{originalEvent:r._lastWheelEvent}));r._map.fire(new e.Event("moveend",{originalEvent:r._lastWheelEvent}));delete r._targetZoom},200)}};Ha.prototype._smoothOutEasing=function t(r){var i=e.ease;if(this._prevEase){var n=this._prevEase,a=(e.browser.now()-n.start)/n.duration,o=n.easing(a+.01)-n.easing(a),s=.27/Math.sqrt(o*o+1e-4)*.01,l=Math.sqrt(.27*.27-s*s);i=e.bezier$1(s,l,.25,1)}this._prevEase={start:e.browser.now(),duration:r,easing:i};return i};var Wa=function t(r,i){this._map=r;this._el=r.getCanvasContainer();this._container=r.getContainer();this._clickTolerance=i.clickTolerance||1;e.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};Wa.prototype.isEnabled=function e(){return!!this._enabled};Wa.prototype.isActive=function e(){return!!this._active};Wa.prototype.enable=function e(){if(this.isEnabled()){return}this._enabled=true};Wa.prototype.disable=function e(){if(!this.isEnabled()){return}this._enabled=false};Wa.prototype.onMouseDown=function t(i){if(!this.isEnabled()){return}if(!(i.shiftKey&&i.button===0)){return}e.window.document.addEventListener("mousemove",this._onMouseMove,false);e.window.document.addEventListener("keydown",this._onKeyDown,false);e.window.document.addEventListener("mouseup",this._onMouseUp,false);r.disableDrag();this._startPos=this._lastPos=r.mousePos(this._el,i);this._active=true};Wa.prototype._onMouseMove=function e(t){var i=r.mousePos(this._el,t);if(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance){return}var n=this._startPos;this._lastPos=i;if(!this._box){this._box=r.create("div","mapboxgl-boxzoom",this._container);this._container.classList.add("mapboxgl-crosshair");this._fireEvent("boxzoomstart",t)}var a=Math.min(n.x,i.x),o=Math.max(n.x,i.x),s=Math.min(n.y,i.y),l=Math.max(n.y,i.y);r.setTransform(this._box,"translate("+a+"px,"+s+"px)");this._box.style.width=o-a+"px";this._box.style.height=l-s+"px"};Wa.prototype._onMouseUp=function t(i){if(i.button!==0){return}var n=this._startPos,a=r.mousePos(this._el,i);this._finish();r.suppressClick();if(n.x===a.x&&n.y===a.y){this._fireEvent("boxzoomcancel",i)}else{this._map.fitScreenCoordinates(n,a,this._map.getBearing(),{linear:true}).fire(new e.Event("boxzoomend",{originalEvent:i}))}};Wa.prototype._onKeyDown=function e(t){if(t.keyCode===27){this._finish();this._fireEvent("boxzoomcancel",t)}};Wa.prototype._finish=function t(){this._active=false;e.window.document.removeEventListener("mousemove",this._onMouseMove,false);e.window.document.removeEventListener("keydown",this._onKeyDown,false);e.window.document.removeEventListener("mouseup",this._onMouseUp,false);this._container.classList.remove("mapboxgl-crosshair");if(this._box){r.remove(this._box);this._box=null}r.enableDrag();delete this._startPos;delete this._lastPos};Wa.prototype._fireEvent=function t(r,i){return this._map.fire(new e.Event(r,{originalEvent:i}))};var Xa=.25,Ya=e.bezier$1(0,0,Xa,1),Ka=180,Ja=720;var $a=function t(r,i){this._map=r;this._el=i.element||r.getCanvasContainer();this._state="disabled";this._button=i.button||"right";this._bearingSnap=i.bearingSnap||0;this._pitchWithRotate=i.pitchWithRotate!==false;e.bindAll(["onMouseDown","_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};$a.prototype.isEnabled=function e(){return this._state!=="disabled"};$a.prototype.isActive=function e(){return this._state==="active"};$a.prototype.enable=function e(){if(this.isEnabled()){return}this._state="enabled"};$a.prototype.disable=function e(){if(!this.isEnabled()){return}switch(this._state){case"active":this._state="disabled";this._unbind();this._deactivate();this._fireEvent("rotateend");if(this._pitchWithRotate){this._fireEvent("pitchend")}this._fireEvent("moveend");break;case"pending":this._state="disabled";this._unbind();break;default:this._state="disabled";break}};$a.prototype.onMouseDown=function t(i){if(this._state!=="enabled"){return}if(this._button==="right"){this._eventButton=r.mouseButton(i);if(this._eventButton!==(i.ctrlKey?0:2)){return}}else{if(i.ctrlKey||r.mouseButton(i)!==0){return}this._eventButton=0}r.disableDrag();e.window.document.addEventListener("mousemove",this._onMouseMove,{capture:true});e.window.document.addEventListener("mouseup",this._onMouseUp);e.window.addEventListener("blur",this._onBlur);this._state="pending";this._inertia=[[e.browser.now(),this._map.getBearing()]];this._startPos=this._lastPos=r.mousePos(this._el,i);this._center=this._map.transform.centerPoint;i.preventDefault()};$a.prototype._onMouseMove=function e(t){var i=r.mousePos(this._el,t);if(this._lastPos.equals(i)){return}this._lastMoveEvent=t;this._lastPos=i;if(this._state==="pending"){this._state="active";this._fireEvent("rotatestart",t);this._fireEvent("movestart",t);if(this._pitchWithRotate){this._fireEvent("pitchstart",t)}}if(!this._frameId){this._frameId=this._map._requestRenderFrame(this._onDragFrame)}};$a.prototype._onDragFrame=function t(){this._frameId=null;var r=this._lastMoveEvent;if(!r){return}var i=this._map.transform;var n=this._startPos,a=this._lastPos,o=(n.x-a.x)*.8,s=(n.y-a.y)*-.5,l=i.bearing-o,u=i.pitch-s,f=this._inertia,c=f[f.length-1];this._drainInertiaBuffer();f.push([e.browser.now(),this._map._normalizeBearing(l,c[1])]);i.bearing=l;if(this._pitchWithRotate){this._fireEvent("pitch",r);i.pitch=u}this._fireEvent("rotate",r);this._fireEvent("move",r);delete this._lastMoveEvent;this._startPos=this._lastPos};$a.prototype._onMouseUp=function t(i){if(r.mouseButton(i)!==this._eventButton){return}switch(this._state){case"active":this._state="enabled";r.suppressClick();this._unbind();this._deactivate();this._inertialRotate(i);break;case"pending":this._state="enabled";this._unbind();break;default:e.assert(false);break}};$a.prototype._onBlur=function t(r){switch(this._state){case"active":this._state="enabled";this._unbind();this._deactivate();this._fireEvent("rotateend",r);if(this._pitchWithRotate){this._fireEvent("pitchend",r)}this._fireEvent("moveend",r);break;case"pending":this._state="enabled";this._unbind();break;default:e.assert(false);break}};$a.prototype._unbind=function t(){e.window.document.removeEventListener("mousemove",this._onMouseMove,{capture:true});e.window.document.removeEventListener("mouseup",this._onMouseUp);e.window.removeEventListener("blur",this._onBlur);r.enableDrag()};$a.prototype._deactivate=function e(){if(this._frameId){this._map._cancelRenderFrame(this._frameId);this._frameId=null}delete this._lastMoveEvent;delete this._startPos;delete this._lastPos};$a.prototype._inertialRotate=function e(t){var r=this;this._fireEvent("rotateend",t);this._drainInertiaBuffer();var i=this._map,n=i.getBearing(),a=this._inertia;var o=function e(){if(Math.abs(n)<r._bearingSnap){i.resetNorth({noMoveStart:true},{originalEvent:t})}else{r._fireEvent("moveend",t)}if(r._pitchWithRotate){r._fireEvent("pitchend",t)}};if(a.length<2){o();return}var s=a[0],l=a[a.length-1],u=a[a.length-2];var f=i._normalizeBearing(n,u[1]);var c=l[1]-s[1],h=c<0?-1:1,p=(l[0]-s[0])/1e3;if(c===0||p===0){o();return}var d=Math.abs(c*(Xa/p));if(d>Ka){d=Ka}var v=d/(Ja*Xa),y=h*d*(v/2);f+=y;if(Math.abs(i._normalizeBearing(f,0))<this._bearingSnap){f=i._normalizeBearing(0,f)}i.rotateTo(f,{duration:v*1e3,easing:Ya,noMoveStart:true},{originalEvent:t})};$a.prototype._fireEvent=function t(r,i){return this._map.fire(new e.Event(r,i?{originalEvent:i}:{}))};$a.prototype._drainInertiaBuffer=function t(){var r=this._inertia,i=e.browser.now(),n=160;while(r.length>0&&i-r[0][0]>n){r.shift()}};var Qa=.3,eo=e.bezier$1(0,0,Qa,1),to=1400,ro=2500;var io=function t(r,i){this._map=r;this._el=r.getCanvasContainer();this._state="disabled";this._clickTolerance=i.clickTolerance||1;e.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};io.prototype.isEnabled=function e(){return this._state!=="disabled"};io.prototype.isActive=function e(){return this._state==="active"};io.prototype.enable=function e(){if(this.isEnabled()){return}this._el.classList.add("mapboxgl-touch-drag-pan");this._state="enabled"};io.prototype.disable=function e(){if(!this.isEnabled()){return}this._el.classList.remove("mapboxgl-touch-drag-pan");switch(this._state){case"active":this._state="disabled";this._unbind();this._deactivate();this._fireEvent("dragend");this._fireEvent("moveend");break;case"pending":this._state="disabled";this._unbind();break;default:this._state="disabled";break}};io.prototype.onMouseDown=function t(i){if(this._state!=="enabled"){return}if(i.ctrlKey||r.mouseButton(i)!==0){return}r.addEventListener(e.window.document,"mousemove",this._onMove,{capture:true});r.addEventListener(e.window.document,"mouseup",this._onMouseUp);this._start(i)};io.prototype.onTouchStart=function t(i){if(this._state!=="enabled"){return}if(i.touches.length>1){return}r.addEventListener(e.window.document,"touchmove",this._onMove,{capture:true,passive:false});r.addEventListener(e.window.document,"touchend",this._onTouchEnd);this._start(i)};io.prototype._start=function t(i){e.window.addEventListener("blur",this._onBlur);this._state="pending";this._startPos=this._mouseDownPos=this._lastPos=r.mousePos(this._el,i);this._inertia=[[e.browser.now(),this._startPos]]};io.prototype._onMove=function t(i){i.preventDefault();var n=r.mousePos(this._el,i);if(this._lastPos.equals(n)||this._state==="pending"&&n.dist(this._mouseDownPos)<this._clickTolerance){return}this._lastMoveEvent=i;this._lastPos=n;this._drainInertiaBuffer();this._inertia.push([e.browser.now(),this._lastPos]);if(this._state==="pending"){this._state="active";this._fireEvent("dragstart",i);this._fireEvent("movestart",i)}if(!this._frameId){this._frameId=this._map._requestRenderFrame(this._onDragFrame)}};io.prototype._onDragFrame=function e(){this._frameId=null;var t=this._lastMoveEvent;if(!t){return}var r=this._map.transform;r.setLocationAtPoint(r.pointLocation(this._startPos),this._lastPos);this._fireEvent("drag",t);this._fireEvent("move",t);this._startPos=this._lastPos;delete this._lastMoveEvent};io.prototype._onMouseUp=function t(i){if(r.mouseButton(i)!==0){return}switch(this._state){case"active":this._state="enabled";r.suppressClick();this._unbind();this._deactivate();this._inertialPan(i);break;case"pending":this._state="enabled";this._unbind();break;default:e.assert(false);break}};io.prototype._onTouchEnd=function t(r){switch(this._state){case"active":this._state="enabled";this._unbind();this._deactivate();this._inertialPan(r);break;case"pending":this._state="enabled";this._unbind();break;default:e.assert(false);break}};io.prototype._onBlur=function t(r){switch(this._state){case"active":this._state="enabled";this._unbind();this._deactivate();this._fireEvent("dragend",r);this._fireEvent("moveend",r);break;case"pending":this._state="enabled";this._unbind();break;default:e.assert(false);break}};io.prototype._unbind=function t(){r.removeEventListener(e.window.document,"touchmove",this._onMove,{capture:true,passive:false});r.removeEventListener(e.window.document,"touchend",this._onTouchEnd);r.removeEventListener(e.window.document,"mousemove",this._onMove,{capture:true});r.removeEventListener(e.window.document,"mouseup",this._onMouseUp);r.removeEventListener(e.window,"blur",this._onBlur)};io.prototype._deactivate=function e(){if(this._frameId){this._map._cancelRenderFrame(this._frameId);this._frameId=null}delete this._lastMoveEvent;delete this._startPos;delete this._mouseDownPos;delete this._lastPos};io.prototype._inertialPan=function e(t){this._fireEvent("dragend",t);this._drainInertiaBuffer();var r=this._inertia;if(r.length<2){this._fireEvent("moveend",t);return}var i=r[r.length-1],n=r[0],a=i[1].sub(n[1]),o=(i[0]-n[0])/1e3;if(o===0||i[1].equals(n[1])){this._fireEvent("moveend",t);return}var s=a.mult(Qa/o);var l=s.mag();if(l>to){l=to;s._unit()._mult(l)}var u=l/(ro*Qa),f=s.mult(-u/2);this._map.panBy(f,{duration:u*1e3,easing:eo,noMoveStart:true},{originalEvent:t})};io.prototype._fireEvent=function t(r,i){return this._map.fire(new e.Event(r,i?{originalEvent:i}:{}))};io.prototype._drainInertiaBuffer=function t(){var r=this._inertia,i=e.browser.now(),n=160;while(r.length>0&&i-r[0][0]>n){r.shift()}};var no=100,ao=15,oo=10;var so=function t(r){this._map=r;this._el=r.getCanvasContainer();e.bindAll(["_onKeyDown"],this)};so.prototype.isEnabled=function e(){return!!this._enabled};so.prototype.enable=function e(){if(this.isEnabled()){return}this._el.addEventListener("keydown",this._onKeyDown,false);this._enabled=true};so.prototype.disable=function e(){if(!this.isEnabled()){return}this._el.removeEventListener("keydown",this._onKeyDown);this._enabled=false};so.prototype._onKeyDown=function e(t){if(t.altKey||t.ctrlKey||t.metaKey){return}var r=0;var i=0;var n=0;var a=0;var o=0;switch(t.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:if(t.shiftKey){i=-1}else{t.preventDefault();a=-1}break;case 39:if(t.shiftKey){i=1}else{t.preventDefault();a=1}break;case 38:if(t.shiftKey){n=1}else{t.preventDefault();o=-1}break;case 40:if(t.shiftKey){n=-1}else{o=1;t.preventDefault()}break;default:return}var s=this._map;var l=s.getZoom();var u={duration:300,delayEndEvents:500,easing:lo,zoom:r?Math.round(l)+r*(t.shiftKey?2:1):l,bearing:s.getBearing()+i*ao,pitch:s.getPitch()+n*oo,offset:[-a*no,-o*no],center:s.getCenter()};s.easeTo(u,{originalEvent:t})};function lo(e){return e*(2-e)}var uo=function t(r){this._map=r;e.bindAll(["_onDblClick","_onZoomEnd"],this)};uo.prototype.isEnabled=function e(){return!!this._enabled};uo.prototype.isActive=function e(){return!!this._active};uo.prototype.enable=function e(){if(this.isEnabled()){return}this._enabled=true};uo.prototype.disable=function e(){if(!this.isEnabled()){return}this._enabled=false};uo.prototype.onTouchStart=function e(t){var r=this;if(!this.isEnabled()){return}if(t.points.length>1){return}if(!this._tapped){this._tapped=setTimeout(function(){r._tapped=null},300)}else{clearTimeout(this._tapped);this._tapped=null;this._zoom(t)}};uo.prototype.onDblClick=function e(t){if(!this.isEnabled()){return}t.originalEvent.preventDefault();this._zoom(t)};uo.prototype._zoom=function e(t){this._active=true;this._map.on("zoomend",this._onZoomEnd);this._map.zoomTo(this._map.getZoom()+(t.originalEvent.shiftKey?-1:1),{around:t.lngLat},t)};uo.prototype._onZoomEnd=function e(){this._active=false;this._map.off("zoomend",this._onZoomEnd)};var fo=.15,co=e.bezier$1(0,0,fo,1),ho=12,po=2.5,vo=.15,yo=10;var mo=function t(r){this._map=r;this._el=r.getCanvasContainer();e.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};mo.prototype.isEnabled=function e(){return!!this._enabled};mo.prototype.enable=function e(t){if(this.isEnabled()){return}this._el.classList.add("mapboxgl-touch-zoom-rotate");this._enabled=true;this._aroundCenter=!!t&&t.around==="center"};mo.prototype.disable=function e(){if(!this.isEnabled()){return}this._el.classList.remove("mapboxgl-touch-zoom-rotate");this._enabled=false};mo.prototype.disableRotation=function e(){this._rotationDisabled=true};mo.prototype.enableRotation=function e(){this._rotationDisabled=false};mo.prototype.onStart=function t(i){if(!this.isEnabled()){return}if(i.touches.length!==2){return}var n=r.mousePos(this._el,i.touches[0]),a=r.mousePos(this._el,i.touches[1]),o=n.add(a).div(2);this._startVec=n.sub(a);this._startAround=this._map.transform.pointLocation(o);this._gestureIntent=undefined;this._inertia=[];r.addEventListener(e.window.document,"touchmove",this._onMove,{passive:false});r.addEventListener(e.window.document,"touchend",this._onEnd)};mo.prototype._getTouchEventData=function e(t){var i=r.mousePos(this._el,t.touches[0]),n=r.mousePos(this._el,t.touches[1]);var a=i.sub(n);return{vec:a,center:i.add(n).div(2),scale:a.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:a.angleWith(this._startVec)*180/Math.PI}};mo.prototype._onMove=function t(r){if(r.touches.length!==2){return}var i=this._getTouchEventData(r);var n=i.vec;var a=i.scale;var o=i.bearing;if(!this._gestureIntent){var s=Math.abs(1-a)>vo,l=Math.abs(o)>yo;if(l){this._gestureIntent="rotate"}else if(s){this._gestureIntent="zoom"}if(this._gestureIntent){this._map.fire(new e.Event(this._gestureIntent+"start",{originalEvent:r}));this._map.fire(new e.Event("movestart",{originalEvent:r}));this._startVec=n}}this._lastTouchEvent=r;if(!this._frameId){this._frameId=this._map._requestRenderFrame(this._onTouchFrame)}r.preventDefault()};mo.prototype._onTouchFrame=function t(){this._frameId=null;var r=this._gestureIntent;if(!r){return}var i=this._map.transform;if(!this._startScale){this._startScale=i.scale;this._startBearing=i.bearing}var n=this._getTouchEventData(this._lastTouchEvent);var a=n.center;var o=n.bearing;var s=n.scale;var l=i.pointLocation(a);var u=i.locationPoint(l);if(r==="rotate"){i.bearing=this._startBearing+o}i.zoom=i.scaleZoom(this._startScale*s);i.setLocationAtPoint(this._startAround,u);this._map.fire(new e.Event(r,{originalEvent:this._lastTouchEvent}));this._map.fire(new e.Event("move",{originalEvent:this._lastTouchEvent}));this._drainInertiaBuffer();this._inertia.push([e.browser.now(),s,a])};mo.prototype._onEnd=function t(i){r.removeEventListener(e.window.document,"touchmove",this._onMove,{passive:false});r.removeEventListener(e.window.document,"touchend",this._onEnd);var n=this._gestureIntent;var a=this._startScale;if(this._frameId){this._map._cancelRenderFrame(this._frameId);this._frameId=null}delete this._gestureIntent;delete this._startScale;delete this._startBearing;delete this._lastTouchEvent;if(!n){return}this._map.fire(new e.Event(n+"end",{originalEvent:i}));this._drainInertiaBuffer();var o=this._inertia,s=this._map;if(o.length<2){s.snapToNorth({},{originalEvent:i});return}var l=o[o.length-1],u=o[0],f=s.transform.scaleZoom(a*l[1]),c=s.transform.scaleZoom(a*u[1]),h=f-c,p=(l[0]-u[0])/1e3,d=l[2];if(p===0||f===c){s.snapToNorth({},{originalEvent:i});return}var v=h*fo/p;if(Math.abs(v)>po){if(v>0){v=po}else{v=-po}}var y=Math.abs(v/(ho*fo))*1e3;var m=f+v*y/2e3;if(m<0){m=0}s.easeTo({zoom:m,duration:y,easing:co,around:this._aroundCenter?s.getCenter():s.unproject(d),noMoveStart:true},{originalEvent:i})};mo.prototype._drainInertiaBuffer=function t(){var r=this._inertia,i=e.browser.now(),n=160;while(r.length>2&&i-r[0][0]>n){r.shift()}};var go={scrollZoom:Ha,boxZoom:Wa,dragRotate:$a,dragPan:io,keyboard:so,doubleClickZoom:uo,touchZoomRotate:mo};function _o(e,t){var i=e.getCanvasContainer();var n=null;var a=false;var o=null;for(var s in go){e[s]=new go[s](e,t);if(t.interactive&&t[s]){e[s].enable(t[s])}}r.addEventListener(i,"mouseout",h);r.addEventListener(i,"mousedown",l);r.addEventListener(i,"mouseup",u);r.addEventListener(i,"mousemove",f);r.addEventListener(i,"mouseover",c);r.addEventListener(i,"touchstart",p,{passive:false});r.addEventListener(i,"touchmove",d,{passive:false});r.addEventListener(i,"touchend",v);r.addEventListener(i,"touchcancel",y);r.addEventListener(i,"click",m);r.addEventListener(i,"dblclick",g);r.addEventListener(i,"contextmenu",_);r.addEventListener(i,"wheel",x,{passive:false});function l(n){a=true;o=r.mousePos(i,n);var s=new Ua("mousedown",e,n);e.fire(s);if(s.defaultPrevented){return}if(t.interactive&&!e.doubleClickZoom.isActive()){e.stop()}e.boxZoom.onMouseDown(n);if(!e.boxZoom.isActive()&&!e.dragPan.isActive()){e.dragRotate.onMouseDown(n)}if(!e.boxZoom.isActive()&&!e.dragRotate.isActive()){e.dragPan.onMouseDown(n)}}function u(t){var r=e.dragRotate.isActive();if(n&&!r){e.fire(new Ua("contextmenu",e,n))}n=null;a=false;e.fire(new Ua("mouseup",e,t))}function f(t){if(e.dragPan.isActive()){return}if(e.dragRotate.isActive()){return}var r=t.target;while(r&&r!==i){r=r.parentNode}if(r!==i){return}e.fire(new Ua("mousemove",e,t))}function c(t){var r=t.target;while(r&&r!==i){r=r.parentNode}if(r!==i){return}e.fire(new Ua("mouseover",e,t))}function h(t){e.fire(new Ua("mouseout",e,t))}function p(r){var i=new Na("touchstart",e,r);e.fire(i);if(i.defaultPrevented){return}if(t.interactive){e.stop()}if(!e.boxZoom.isActive()&&!e.dragRotate.isActive()){e.dragPan.onTouchStart(r)}e.touchZoomRotate.onStart(r);e.doubleClickZoom.onTouchStart(i)}function d(t){e.fire(new Na("touchmove",e,t))}function v(t){e.fire(new Na("touchend",e,t))}function y(t){e.fire(new Na("touchcancel",e,t))}function m(n){var a=r.mousePos(i,n);if(a.equals(o)||a.dist(o)<t.clickTolerance){e.fire(new Ua("click",e,n))}}function g(t){var r=new Ua("dblclick",e,t);e.fire(r);if(r.defaultPrevented){return}e.doubleClickZoom.onDblClick(r)}function _(t){var r=e.dragRotate.isActive();if(!a&&!r){e.fire(new Ua("contextmenu",e,t))}else if(a){n=t}if(e.dragRotate.isEnabled()||e.listens("contextmenu")){t.preventDefault()}}function x(r){if(t.interactive){e.stop()}var i=new ja("wheel",e,r);e.fire(i);if(i.defaultPrevented){return}e.scrollZoom.onWheel(r)}}var xo=function(t){function r(r,i){t.call(this);this._moving=false;this._zooming=false;this.transform=r;this._bearingSnap=i.bearingSnap;e.bindAll(["_renderFrameCallback"],this)}if(t)r.__proto__=t;r.prototype=(0,F.default)(t&&t.prototype);r.prototype.constructor=r;r.prototype.getCenter=function e(){return this.transform.center};r.prototype.setCenter=function e(t,r){return this.jumpTo({center:t},r)};r.prototype.panBy=function t(r,i,n){r=e.Point.convert(r).mult(-1);return this.panTo(this.transform.center,e.extend({offset:r},i),n)};r.prototype.panTo=function t(r,i,n){return this.easeTo(e.extend({center:r},i),n)};r.prototype.getZoom=function e(){return this.transform.zoom};r.prototype.setZoom=function e(t,r){this.jumpTo({zoom:t},r);return this};r.prototype.zoomTo=function t(r,i,n){return this.easeTo(e.extend({zoom:r},i),n)};r.prototype.zoomIn=function e(t,r){this.zoomTo(this.getZoom()+1,t,r);return this};r.prototype.zoomOut=function e(t,r){this.zoomTo(this.getZoom()-1,t,r);return this};r.prototype.getBearing=function e(){return this.transform.bearing};r.prototype.setBearing=function e(t,r){this.jumpTo({bearing:t},r);return this};r.prototype.rotateTo=function t(r,i,n){return this.easeTo(e.extend({bearing:r},i),n)};r.prototype.resetNorth=function t(r,i){this.rotateTo(0,e.extend({duration:1e3},r),i);return this};r.prototype.snapToNorth=function e(t,r){if(Math.abs(this.getBearing())<this._bearingSnap){return this.resetNorth(t,r)}return this};r.prototype.getPitch=function e(){return this.transform.pitch};r.prototype.setPitch=function e(t,r){this.jumpTo({pitch:t},r);return this};r.prototype.cameraForBounds=function t(r,i){r=e.LngLatBounds.convert(r);return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),0,i)};r.prototype._cameraForBoxAndBearing=function t(r,i,n,a){a=e.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},a);if(typeof a.padding==="number"){var o=a.padding;a.padding={top:o,bottom:o,right:o,left:o}}if(!e.isEqual((0,k.default)(a.padding).sort(function(e,t){if(e<t){return-1}if(e>t){return 1}return 0}),["bottom","left","right","top"])){e.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'");return}var s=[(a.padding.left-a.padding.right)/2,(a.padding.top-a.padding.bottom)/2],l=Math.min(a.padding.right,a.padding.left),u=Math.min(a.padding.top,a.padding.bottom);a.offset=[a.offset[0]+s[0],a.offset[1]+s[1]];var f=this.transform;var c=f.project(e.LngLat.convert(r));var h=f.project(e.LngLat.convert(i));var p=c.rotate(-n*Math.PI/180);var d=h.rotate(-n*Math.PI/180);var v=new e.Point(Math.max(p.x,d.x),Math.max(p.y,d.y));var y=new e.Point(Math.min(p.x,d.x),Math.min(p.y,d.y));var m=e.Point.convert(a.offset),g=v.sub(y),_=(f.width-l*2-Math.abs(m.x)*2)/g.x,x=(f.height-u*2-Math.abs(m.y)*2)/g.y;if(x<0||_<0){e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return}a.center=f.unproject(c.add(h).div(2));a.zoom=Math.min(f.scaleZoom(f.scale*Math.min(_,x)),a.maxZoom);a.bearing=n;return a};r.prototype.fitBounds=function e(t,r,i){return this._fitInternal(this.cameraForBounds(t,r),r,i)};r.prototype.fitScreenCoordinates=function t(r,i,n,a,o){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(r)),this.transform.pointLocation(e.Point.convert(i)),n,a),a,o)};r.prototype._fitInternal=function t(r,i,n){if(!r){return this}i=e.extend(r,i);return i.linear?this.easeTo(i,n):this.flyTo(i,n)};r.prototype.jumpTo=function t(r,i){this.stop();var n=this.transform;var a=false,o=false,s=false;if("zoom"in r&&n.zoom!==+r.zoom){a=true;n.zoom=+r.zoom}if(r.center!==undefined){n.center=e.LngLat.convert(r.center)}if("bearing"in r&&n.bearing!==+r.bearing){o=true;n.bearing=+r.bearing}if("pitch"in r&&n.pitch!==+r.pitch){s=true;n.pitch=+r.pitch}this.fire(new e.Event("movestart",i)).fire(new e.Event("move",i));if(a){this.fire(new e.Event("zoomstart",i)).fire(new e.Event("zoom",i)).fire(new e.Event("zoomend",i))}if(o){this.fire(new e.Event("rotatestart",i)).fire(new e.Event("rotate",i)).fire(new e.Event("rotateend",i))}if(s){this.fire(new e.Event("pitchstart",i)).fire(new e.Event("pitch",i)).fire(new e.Event("pitchend",i))}return this.fire(new e.Event("moveend",i))};r.prototype.easeTo=function t(r,i){var n=this;this.stop();r=e.extend({offset:[0,0],duration:500,easing:e.ease},r);if(r.animate===false){r.duration=0}var a=this.transform,o=this.getZoom(),s=this.getBearing(),l=this.getPitch(),u="zoom"in r?+r.zoom:o,f="bearing"in r?this._normalizeBearing(r.bearing,s):s,c="pitch"in r?+r.pitch:l;var h=a.centerPoint.add(e.Point.convert(r.offset));var p=a.pointLocation(h);var d=e.LngLat.convert(r.center||p);this._normalizeCenter(d);var v=a.project(p);var y=a.project(d).sub(v);var m=a.zoomScale(u-o);var g,_;if(r.around){g=e.LngLat.convert(r.around);_=a.locationPoint(g)}this._zooming=u!==o;this._rotating=s!==f;this._pitching=c!==l;this._prepareEase(i,r.noMoveStart);clearTimeout(this._easeEndTimeoutID);this._ease(function(t){if(n._zooming){a.zoom=e.number(o,u,t)}if(n._rotating){a.bearing=e.number(s,f,t)}if(n._pitching){a.pitch=e.number(l,c,t)}if(g){a.setLocationAtPoint(g,_)}else{var r=a.zoomScale(a.zoom-o);var p=u>o?Math.min(2,m):Math.max(.5,m);var d=Math.pow(p,1-t);var x=a.unproject(v.add(y.mult(t*d)).mult(r));a.setLocationAtPoint(a.renderWorldCopies?x.wrap():x,h)}n._fireMoveEvents(i)},function(){if(r.delayEndEvents){n._easeEndTimeoutID=setTimeout(function(){return n._afterEase(i)},r.delayEndEvents)}else{n._afterEase(i)}},r);return this};r.prototype._prepareEase=function t(r,i){this._moving=true;if(!i){this.fire(new e.Event("movestart",r))}if(this._zooming){this.fire(new e.Event("zoomstart",r))}if(this._rotating){this.fire(new e.Event("rotatestart",r))}if(this._pitching){this.fire(new e.Event("pitchstart",r))}};r.prototype._fireMoveEvents=function t(r){this.fire(new e.Event("move",r));if(this._zooming){this.fire(new e.Event("zoom",r))}if(this._rotating){this.fire(new e.Event("rotate",r))}if(this._pitching){this.fire(new e.Event("pitch",r))}};r.prototype._afterEase=function t(r){var i=this._zooming;var n=this._rotating;var a=this._pitching;this._moving=false;this._zooming=false;this._rotating=false;this._pitching=false;if(i){this.fire(new e.Event("zoomend",r))}if(n){this.fire(new e.Event("rotateend",r))}if(a){this.fire(new e.Event("pitchend",r))}this.fire(new e.Event("moveend",r))};r.prototype.flyTo=function t(r,i){var n=this;this.stop();r=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},r);var a=this.transform,o=this.getZoom(),s=this.getBearing(),l=this.getPitch();var u="zoom"in r?e.clamp(+r.zoom,a.minZoom,a.maxZoom):o;var f="bearing"in r?this._normalizeBearing(r.bearing,s):s;var c="pitch"in r?+r.pitch:l;var h=a.zoomScale(u-o);var p=a.centerPoint.add(e.Point.convert(r.offset));var d=a.pointLocation(p);var v=e.LngLat.convert(r.center||d);this._normalizeCenter(v);var y=a.project(d);var m=a.project(v).sub(y);var g=r.curve;var _=Math.max(a.width,a.height),x=_/h,b=m.mag();if("minZoom"in r){var w=e.clamp(Math.min(r.minZoom,o,u),a.minZoom,a.maxZoom);var S=_/a.zoomScale(w-o);g=Math.sqrt(S/b*2)}var C=g*g;function T(e){var t=(x*x-_*_+(e?-1:1)*C*C*b*b)/(2*(e?x:_)*C*b);return Math.log(Math.sqrt(t*t+1)-t)}function P(e){return(Math.exp(e)-Math.exp(-e))/2}function M(e){return(Math.exp(e)+Math.exp(-e))/2}function I(e){return P(e)/M(e)}var A=T(0);var L=function e(t){return M(A)/M(A+g*t)};var E=function e(t){return _*((M(A)*I(A+g*t)-P(A))/C)/b};var k=(T(1)-A)/g;if(Math.abs(b)<1e-6||!isFinite(k)){if(Math.abs(_-x)<1e-6){return this.easeTo(r,i)}var D=x<_?-1:1;k=Math.abs(Math.log(x/_))/g;E=function e(){return 0};L=function e(t){return Math.exp(D*g*t)}}if("duration"in r){r.duration=+r.duration}else{var B="screenSpeed"in r?+r.screenSpeed/g:+r.speed;r.duration=1e3*k/B}if(r.maxDuration&&r.duration>r.maxDuration){r.duration=0}this._zooming=true;this._rotating=s!==f;this._pitching=c!==l;this._prepareEase(i,false);this._ease(function(t){var r=t*k;var h=1/L(r);a.zoom=t===1?u:o+a.scaleZoom(h);if(n._rotating){a.bearing=e.number(s,f,t)}if(n._pitching){a.pitch=e.number(l,c,t)}var d=t===1?v:a.unproject(y.add(m.mult(E(r))).mult(h));a.setLocationAtPoint(a.renderWorldCopies?d.wrap():d,p);n._fireMoveEvents(i)},function(){return n._afterEase(i)},r);return this};r.prototype.isEasing=function e(){return!!this._easeFrameId};r.prototype.stop=function e(){if(this._easeFrameId){this._cancelRenderFrame(this._easeFrameId);delete this._easeFrameId;delete this._onEaseFrame}if(this._onEaseEnd){var t=this._onEaseEnd;delete this._onEaseEnd;t.call(this)}return this};r.prototype._ease=function t(r,i,n){if(n.animate===false||n.duration===0){r(1);i()}else{this._easeStart=e.browser.now();this._easeOptions=n;this._onEaseFrame=r;this._onEaseEnd=i;this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback)}};r.prototype._renderFrameCallback=function t(){var r=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r));if(r<1){this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback)}else{this.stop()}};r.prototype._normalizeBearing=function t(r,i){r=e.wrap(r,-180,180);var n=Math.abs(r-i);if(Math.abs(r-360-i)<n){r-=360}if(Math.abs(r+360-i)<n){r+=360}return r};r.prototype._normalizeCenter=function e(t){var r=this.transform;if(!r.renderWorldCopies||r.lngRange){return}var i=t.lng-r.center.lng;t.lng+=i>180?-360:i<-180?360:0};return r}(e.Evented);var bo=function t(r){if(r===void 0)r={};this.options=r;e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};bo.prototype.getDefaultPosition=function e(){return"bottom-right"};bo.prototype.onAdd=function e(t){var i=this.options&&this.options.compact;this._map=t;this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib");if(i){this._container.classList.add("mapboxgl-compact")}this._updateAttributions();this._updateEditLink();this._map.on("styledata",this._updateData);this._map.on("sourcedata",this._updateData);this._map.on("moveend",this._updateEditLink);if(i===undefined){this._map.on("resize",this._updateCompact);this._updateCompact()}return this._container};bo.prototype.onRemove=function e(){r.remove(this._container);this._map.off("styledata",this._updateData);this._map.off("sourcedata",this._updateData);this._map.off("moveend",this._updateEditLink);this._map.off("resize",this._updateCompact);this._map=undefined};bo.prototype._updateEditLink=function t(){var r=this._editLink;if(!r){r=this._editLink=this._container.querySelector(".mapbox-improve-map")}var i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:e.config.ACCESS_TOKEN}];if(r){var n=i.reduce(function(e,t,r){if(t.value){e+=t.key+"="+t.value+(r<i.length-1?"&":"")}return e},"?");r.href="https://www.mapbox.com/feedback/"+n+(this._map._hash?this._map._hash.getHashString(true):"")}};bo.prototype._updateData=function e(t){if(t&&(t.sourceDataType==="metadata"||t.dataType==="style")){this._updateAttributions();this._updateEditLink()}};bo.prototype._updateAttributions=function e(){if(!this._map.style){return}var t=[];if(this.options.customAttribution){if(Array.isArray(this.options.customAttribution)){t=t.concat(this.options.customAttribution.map(function(e){if(typeof e!=="string"){return""}return"<p>"+e+"</p>"}))}else if(typeof this.options.customAttribution==="string"){t.push("<p>"+this.options.customAttribution+"</p>")}}if(this._map.style.stylesheet){var r=this._map.style.stylesheet;this.styleOwner=r.owner;this.styleId=r.id}var i=this._map.style.sourceCaches;for(var n in i){var a=i[n];if(a.used){var o=a.getSource();if(o.attribution&&t.indexOf(o.attribution)<0){t.push(o.attribution)}}}t.sort(function(e,t){return e.length-t.length});t=t.filter(function(e,r){for(var i=r+1;i<t.length;i++){if(t[i].indexOf(e)>=0){return false}}return true});if(t.length){this._container.innerHTML=t.join("<p> | </p>");this._container.classList.remove("mapboxgl-attrib-empty")}else{this._container.classList.add("mapboxgl-attrib-empty")}this._editLink=null};bo.prototype._updateCompact=function e(){if(this._map.getCanvasContainer().offsetWidth<=640){this._container.classList.add("mapboxgl-compact")}else{this._container.classList.remove("mapboxgl-compact")}};var wo=function t(){e.bindAll(["_updateLogo"],this);e.bindAll(["_updateCompact"],this)};wo.prototype.onAdd=function e(t){this._map=t;this._container=r.create("div","mapboxgl-ctrl");var i=r.create("a","mapboxgl-ctrl-logo");i.target="_blank";i.href="https://www.mapbox.com/";i.setAttribute("aria-label","Mapbox logo");i.setAttribute("rel","noopener");this._container.appendChild(i);this._container.style.display="none";this._map.on("sourcedata",this._updateLogo);this._updateLogo();this._map.on("resize",this._updateCompact);this._updateCompact();return this._container};wo.prototype.onRemove=function e(){r.remove(this._container);this._map.off("sourcedata",this._updateLogo);this._map.off("resize",this._updateCompact)};wo.prototype.getDefaultPosition=function e(){return"bottom-left"};wo.prototype._updateLogo=function e(t){if(!t||t.sourceDataType==="metadata"){this._container.style.display=this._logoRequired()?"block":"none"}};wo.prototype._logoRequired=function e(){if(!this._map.style){return}var t=this._map.style.sourceCaches;for(var r in t){var i=t[r].getSource();if(i.mapbox_logo){return true}}return false};wo.prototype._updateCompact=function e(){var t=this._container.children;if(t.length){var r=t[0];if(this._map.getCanvasContainer().offsetWidth<250){r.classList.add("mapboxgl-compact")}else{r.classList.remove("mapboxgl-compact")}}};var So=function e(){this._queue=[];this._id=0;this._cleared=false;this._currentlyRunning=false};So.prototype.add=function e(t){var r=++this._id;var i=this._queue;i.push({callback:t,id:r,cancelled:false});return r};So.prototype.remove=function e(t){var r=this._currentlyRunning;var i=r?this._queue.concat(r):this._queue;for(var n=0,a=i;n<a.length;n+=1){var o=a[n];if(o.id===t){o.cancelled=true;return}}};So.prototype.run=function t(){var r=this;e.assert(!this._currentlyRunning);var i=this._currentlyRunning=this._queue;this._queue=[];for(var n=0,a=i;n<a.length;n+=1){var o=a[n];if(o.cancelled){continue}o.callback();if(r._cleared){break}}this._cleared=false;this._currentlyRunning=false};So.prototype.clear=function e(){if(this._currentlyRunning){this._cleared=true}this._queue=[]};var Co=function e(t,r,i){this.epsgCode=t;this.extent=r;this.unit=i||"degree";e.set(this)};Co.prototype.getExtent=function e(){if(!this._rectifyExtent){var t=this.extent[2]-this.extent[0],r=this.extent[3]-this.extent[1];if(t===r){this._rectifyExtent=[this.extent[0],this.extent[1],this.extent[2],this.extent[3]]}else{var i=Math.max(t,r);this._rectifyExtent=[this.extent[0],this.extent[3]-i,this.extent[0]+i,this.extent[3]]}}return this._rectifyExtent};Co.prototype.getOrigin=function e(){return[this.extent[0],this.extent[3]]};Co.prototype.getEpsgCode=function e(){return this.epsgCode};Co.prototype.getUnit=function e(){return this.unit};Co.get=function(e){for(var t in Co){if(Co.hasOwnProperty(t)&&Co[t].getEpsgCode&&Co[t].getEpsgCode()===e){return Co[t]}}return null};Co.set=function(e){var t=e.getEpsgCode().replace(":","").toUpperCase();Co[t]=e};Co.EPSG4326=new Co("EPSG:4326",[-180,-90,180,90]);Co.EPSG4214=new Co("EPSG:4214",[-180,-90,180,90]);Co.EPSG4490=new Co("EPSG:4490",[-180,-90,180,90]);Co.EPSG4610=new Co("EPSG:4610",[-180,-90,180,90]);Co.EPSG3857=new Co("EPSG:3857",[-20037508.3427892,-20037508.3427892,20037508.3427892,20037508.3427892]);var To=e.window.HTMLImageElement;var Po=e.window.HTMLElement;var Mo=0;var Io=22;var Ao={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:Mo,maxZoom:Io,interactive:true,scrollZoom:true,boxZoom:true,dragRotate:true,dragPan:true,keyboard:true,doubleClickZoom:true,touchZoomRotate:true,bearingSnap:7,clickTolerance:3,hash:false,attributionControl:true,failIfMajorPerformanceCaveat:false,preserveDrawingBuffer:false,trackResize:true,renderWorldCopies:true,refreshExpiredTiles:true,maxTileCacheSize:null,transformRequest:null,fadeDuration:300,crossSourceCollisions:true};var Lo=function(i){function n(t){var r=this;t=e.extend({},Ao,t);if(t.minZoom!=null&&t.maxZoom!=null&&t.minZoom>t.maxZoom){throw new Error("maxZoom must be greater than minZoom")}var n=new Ra(t.minZoom,t.maxZoom,t.renderWorldCopies);i.call(this,n,t);this.crs=this.initCRS(t.crs);this.setCRS(this.crs);this._interactive=t.interactive;this._maxTileCacheSize=t.maxTileCacheSize;this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat;this._preserveDrawingBuffer=t.preserveDrawingBuffer;this._trackResize=t.trackResize;this._bearingSnap=t.bearingSnap;this._refreshExpiredTiles=t.refreshExpiredTiles;this._fadeDuration=t.fadeDuration;this._crossSourceCollisions=t.crossSourceCollisions;this._crossFadingFactor=1;this._collectResourceTiming=t.collectResourceTiming;this._renderTaskQueue=new So;this._controls=[];this._mapId=e.uniqueId();var a=t.transformRequest;this._transformRequest=a?function(e,t){return a(e,t)||{url:e}}:function(e){return{url:e}};if(typeof t.container==="string"){this._container=e.window.document.getElementById(t.container);if(!this._container){throw new Error("Container '"+t.container+"' not found.")}}else if(t.container instanceof Po){this._container=t.container}else{throw new Error("Invalid type: 'container' must be a String or HTMLElement.")}if(t.maxBounds){this.setMaxBounds(t.maxBounds)}e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this);this._setupContainer();this._setupPainter();if(this.painter===undefined){throw new Error("Failed to initialize WebGL.")}this.on("move",function(){return r._update(false)});this.on("zoom",function(){return r._update(true)});if(typeof e.window!=="undefined"){e.window.addEventListener("online",this._onWindowOnline,false);e.window.addEventListener("resize",this._onWindowResize,false)}_o(this,t);this._hash=t.hash&&(new za).addTo(this);if(!this._hash||!this._hash._onHashChange()){if(t.bounds){this.resize();this.fitBounds(t.bounds,{duration:0})}else{this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch})}}this.resize();if(t.style){this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily})}if(t.attributionControl){this.addControl(new bo({customAttribution:t.customAttribution}))}this.addControl(new wo,t.logoPosition);this.on("style.load",function(){if(r.transform.unmodified){r.jumpTo(r.style.stylesheet)}});this.on("data",function(t){r._update(t.dataType==="style");r.fire(new e.Event(t.dataType+"data",t))});this.on("dataloading",function(t){r.fire(new e.Event(t.dataType+"dataloading",t))})}if(i)n.__proto__=i;n.prototype=(0,F.default)(i&&i.prototype);n.prototype.constructor=n;var a={showTileBoundaries:{configurable:true},showCollisionBoxes:{configurable:true},showOverdrawInspector:{configurable:true},repaint:{configurable:true},vertices:{configurable:true}};n.prototype._getMapId=function e(){return this._mapId};n.prototype.initCRS=function e(t){if(t&&typeof t==="string"&&!(t=Co.get(t))){throw new Error("crs "+t+" is not define")}return t||Co.EPSG3857};n.prototype.getCRS=function e(){return this.crs};n.prototype.addControl=function t(r,i){if(i===undefined&&r.getDefaultPosition){i=r.getDefaultPosition()}if(i===undefined){i="top-right"}if(!r||!r.onAdd){return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")))}var n=r.onAdd(this);this._controls.push(r);var a=this._controlPositions[i];if(i.indexOf("bottom")!==-1){a.insertBefore(n,a.firstChild)}else{a.appendChild(n)}return this};n.prototype.removeControl=function t(r){if(!r||!r.onRemove){return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")))}var i=this._controls.indexOf(r);if(i>-1){this._controls.splice(i,1)}r.onRemove(this);return this};n.prototype.resize=function t(r){var i=this._containerDimensions();var n=i[0];var a=i[1];this._resizeCanvas(n,a);this.transform.resize(n,a);this.painter.resize(n,a);this.fire(new e.Event("movestart",r)).fire(new e.Event("move",r)).fire(new e.Event("resize",r)).fire(new e.Event("moveend",r));return this};n.prototype.getBounds=function e(){return this.transform.getBounds()};n.prototype.getMaxBounds=function e(){return this.transform.getMaxBounds()};n.prototype.setMaxBounds=function t(r){this.transform.setMaxBounds(e.LngLatBounds.convert(r));return this._update()};n.prototype.setMinZoom=function e(t){t=t===null||t===undefined?Mo:t;if(t>=Mo&&t<=this.transform.maxZoom){this.transform.minZoom=t;this._update();if(this.getZoom()<t){this.setZoom(t)}return this}else{throw new Error("minZoom must be between "+Mo+" and the current maxZoom, inclusive")}};n.prototype.getMinZoom=function e(){return this.transform.minZoom};n.prototype.setMaxZoom=function e(t){t=t===null||t===undefined?Io:t;if(t>=this.transform.minZoom){this.transform.maxZoom=t;this._update();if(this.getZoom()>t){this.setZoom(t)}return this}else{throw new Error("maxZoom must be greater than the current minZoom")}};n.prototype.getRenderWorldCopies=function e(){return this.transform.renderWorldCopies};n.prototype.setRenderWorldCopies=function e(t){this.transform.renderWorldCopies=t;return this._update()};n.prototype.getMaxZoom=function e(){return this.transform.maxZoom};n.prototype.project=function t(r){return this.transform.locationPoint(e.LngLat.convert(r))};n.prototype.unproject=function t(r){return this.transform.pointLocation(e.Point.convert(r))};n.prototype.isMoving=function e(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()};n.prototype.isZooming=function e(){return this._zooming||this.scrollZoom.isZooming()};n.prototype.isRotating=function e(){return this._rotating||this.dragRotate.isActive()};n.prototype.on=function e(t,r,n){var a=this;var o;if(n===undefined){return i.prototype.on.call(this,t,r)}var s=function(){if(t==="mouseenter"||t==="mouseover"){var e=false;var i=function i(o){var s=a.getLayer(r)?a.queryRenderedFeatures(o.point,{layers:[r]}):[];if(!s.length){e=false}else if(!e){e=true;n.call(a,new Ua(t,a,o.originalEvent,{features:s}))}};var s=function t(){e=false};return{layer:r,listener:n,delegates:{mousemove:i,mouseout:s}}}else if(t==="mouseleave"||t==="mouseout"){var l=false;var u=function e(i){var o=a.getLayer(r)?a.queryRenderedFeatures(i.point,{layers:[r]}):[];if(o.length){l=true}else if(l){l=false;n.call(a,new Ua(t,a,i.originalEvent))}};var f=function e(r){if(l){l=false;n.call(a,new Ua(t,a,r.originalEvent))}};return{layer:r,listener:n,delegates:{mousemove:u,mouseout:f}}}else{var c=function e(t){var i=a.getLayer(r)?a.queryRenderedFeatures(t.point,{layers:[r]}):[];if(i.length){t.features=i;n.call(a,t);delete t.features}};return{layer:r,listener:n,delegates:(o={},o[t]=c,o)}}}();this._delegatedListeners=this._delegatedListeners||{};this._delegatedListeners[t]=this._delegatedListeners[t]||[];this._delegatedListeners[t].push(s);for(var l in s.delegates){a.on(l,s.delegates[l])}return this};n.prototype.off=function e(t,r,n){var a=this;if(n===undefined){return i.prototype.off.call(this,t,r)}if(this._delegatedListeners&&this._delegatedListeners[t]){var o=this._delegatedListeners[t];for(var s=0;s<o.length;s++){var l=o[s];if(l.layer===r&&l.listener===n){for(var u in l.delegates){a.off(u,l.delegates[u])}o.splice(s,1);return a}}}return this};n.prototype.queryRenderedFeatures=function t(r,i){if(!this.style){return[]}if(i===undefined&&r!==undefined&&!(r instanceof e.Point)&&!Array.isArray(r)){i=r;r=undefined}i=i||{};r=r||[[0,0],[this.transform.width,this.transform.height]];var n;if(r instanceof e.Point||typeof r[0]==="number"){n=[e.Point.convert(r)]}else{var a=e.Point.convert(r[0]);var o=e.Point.convert(r[1]);n=[a,new e.Point(o.x,a.y),o,new e.Point(a.x,o.y),a]}return this.style.queryRenderedFeatures(n,i,this.transform)};n.prototype.querySourceFeatures=function e(t,r){return this.style.querySourceFeatures(t,r)};n.prototype.setStyle=function t(r,i){var n=(!i||i.diff!==false&&!i.localIdeographFontFamily)&&this.style;if(n&&r&&(typeof r==="undefined"?"undefined":(0,z.default)(r))==="object"){try{if(this.style.setState(r)){this._update(true)}return this}catch(t){e.warnOnce("Unable to perform style diff: "+(t.message||t.error||t)+".  Rebuilding the style from scratch.")}}if(this.style){this.style.setEventedParent(null);this.style._remove()}if(!r){delete this.style;return this}else{this.style=new mr(this,i||{})}this.style.setEventedParent(this,{style:this.style});if(typeof r==="string"){this.style.loadURL(r)}else{this.style.loadJSON(r)}return this};n.prototype.getStyle=function e(){if(this.style){return this.style.serialize()}};n.prototype.isStyleLoaded=function t(){if(!this.style){return e.warnOnce("There is no style added to the map.")}return this.style.loaded()};n.prototype.addSource=function e(t,r){this.style.addSource(t,r);return this._update(true)};n.prototype.isSourceLoaded=function t(r){var i=this.style&&this.style.sourceCaches[r];if(i===undefined){this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+r+"'")));return}return i.loaded()};n.prototype.areTilesLoaded=function e(){var t=this.style&&this.style.sourceCaches;for(var r in t){var i=t[r];var n=i._tiles;for(var a in n){var o=n[a];if(!(o.state==="loaded"||o.state==="errored")){return false}}}return true};n.prototype.addSourceType=function e(t,r,i){return this.style.addSourceType(t,r,i)};n.prototype.removeSource=function e(t){this.style.removeSource(t);return this._update(true)};n.prototype.getSource=function e(t){return this.style.getSource(t)};n.prototype.addImage=function t(r,i,n){if(n===void 0)n={};var a=n.pixelRatio;if(a===void 0)a=1;var o=n.sdf;if(o===void 0)o=false;if(i instanceof To){var s=e.browser.getImageData(i);var l=s.width;var u=s.height;var f=s.data;this.style.addImage(r,{data:new e.RGBAImage({width:l,height:u},f),pixelRatio:a,sdf:o})}else if(i.width===undefined||i.height===undefined){return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, "+"or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}else{var c=i.width;var h=i.height;var p=i.data;this.style.addImage(r,{data:new e.RGBAImage({width:c,height:h},new Uint8Array(p)),pixelRatio:a,sdf:o})}};n.prototype.hasImage=function t(r){if(!r){this.fire(new e.ErrorEvent(new Error("Missing required image id")));return false}return!!this.style.getImage(r)};n.prototype.removeImage=function e(t){this.style.removeImage(t)};n.prototype.loadImage=function t(r,i){e.getImage(this._transformRequest(r,e.ResourceType.Image),i)};n.prototype.listImages=function e(){return this.style.listImages()};n.prototype.addLayer=function e(t,r){this.style.addLayer(t,r);return this._update(true)};n.prototype.moveLayer=function e(t,r){this.style.moveLayer(t,r);return this._update(true)};n.prototype.removeLayer=function e(t){this.style.removeLayer(t);return this._update(true)};n.prototype.getLayer=function e(t){return this.style.getLayer(t)};n.prototype.setFilter=function e(t,r){this.style.setFilter(t,r);return this._update(true)};n.prototype.setLayerZoomRange=function e(t,r,i){this.style.setLayerZoomRange(t,r,i);return this._update(true)};n.prototype.getFilter=function e(t){return this.style.getFilter(t)};n.prototype.setPaintProperty=function e(t,r,i){this.style.setPaintProperty(t,r,i);return this._update(true)};n.prototype.getPaintProperty=function e(t,r){return this.style.getPaintProperty(t,r)};n.prototype.setLayoutProperty=function e(t,r,i){this.style.setLayoutProperty(t,r,i);return this._update(true)};n.prototype.getLayoutProperty=function e(t,r){return this.style.getLayoutProperty(t,r)};n.prototype.setLight=function e(t){this.style.setLight(t);return this._update(true)};n.prototype.getLight=function e(){return this.style.getLight()};n.prototype.setFeatureState=function e(t,r){this.style.setFeatureState(t,r);return this._update()};n.prototype.getFeatureState=function e(t){return this.style.getFeatureState(t)};n.prototype.getContainer=function e(){return this._container};n.prototype.getCanvasContainer=function e(){return this._canvasContainer};n.prototype.getCanvas=function e(){return this._canvas};n.prototype._containerDimensions=function e(){var t=0;var r=0;if(this._container){t=this._container.clientWidth||400;r=this._container.clientHeight||300}return[t,r]};n.prototype._detectMissingCSS=function t(){var r=e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color");if(r!=="rgb(250, 128, 114)"){e.warnOnce("This page appears to be missing CSS declarations for "+"Mapbox GL JS, which may cause the map to display incorrectly. "+"Please ensure your page includes mapbox-gl.css, as described "+"in https://www.mapbox.com/mapbox-gl-js/api/.")}};n.prototype._setupContainer=function e(){var t=this._container;t.classList.add("mapboxgl-map");var i=this._missingCSSCanary=r.create("div","mapboxgl-canary",t);i.style.visibility="hidden";this._detectMissingCSS();var n=this._canvasContainer=r.create("div","mapboxgl-canvas-container",t);if(this._interactive){n.classList.add("mapboxgl-interactive")}this._canvas=r.create("canvas","mapboxgl-canvas",n);this._canvas.style.position="absolute";this._canvas.addEventListener("webglcontextlost",this._contextLost,false);this._canvas.addEventListener("webglcontextrestored",this._contextRestored,false);this._canvas.setAttribute("tabindex","0");this._canvas.setAttribute("aria-label","Map");var a=this._containerDimensions();this._resizeCanvas(a[0],a[1]);var o=this._controlContainer=r.create("div","mapboxgl-control-container",t);var s=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(e){s[e]=r.create("div","mapboxgl-ctrl-"+e,o)})};n.prototype._resizeCanvas=function t(r,i){var n=e.window.devicePixelRatio||1;this._canvas.width=n*r;this._canvas.height=n*i;this._canvas.style.width=r+"px";this._canvas.style.height=i+"px"};n.prototype._setupPainter=function r(){var i=e.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},t.webGLContextAttributes);var n=this._canvas.getContext("webgl",i)||this._canvas.getContext("experimental-webgl",i);if(!n){this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")));return}this.painter=new La(n,this.transform)};n.prototype._contextLost=function t(r){r.preventDefault();if(this._frame){this._frame.cancel();this._frame=null}this.fire(new e.Event("webglcontextlost",{originalEvent:r}))};n.prototype._contextRestored=function t(r){this._setupPainter();this.resize();this._update();this.fire(new e.Event("webglcontextrestored",{originalEvent:r}))};n.prototype.loaded=function e(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()};n.prototype._update=function e(t){if(!this.style){return this}this._styleDirty=this._styleDirty||t;this._sourcesDirty=true;this.triggerRepaint();return this};n.prototype._requestRenderFrame=function e(t){this._update();return this._renderTaskQueue.add(t)};n.prototype._cancelRenderFrame=function e(t){this._renderTaskQueue.remove(t)};n.prototype._render=function t(){this.painter.context.setDirty();this.painter.setBaseState();this._renderTaskQueue.run();var r=false;if(this.style&&this._styleDirty){this._styleDirty=false;var i=this.transform.zoom;var n=e.browser.now();this.style.zoomHistory.update(i,n);var a=new e.EvaluationParameters(i,{now:n,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()});var o=a.crossFadingFactor();if(o!==1||o!==this._crossFadingFactor){r=true;this._crossFadingFactor=o}this.style.update(a)}if(this.style&&this._sourcesDirty){this._sourcesDirty=false;this.style._updateSources(this.transform)}this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions);this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),fadeDuration:this._fadeDuration});this.fire(new e.Event("render"));if(this.loaded()&&!this._loaded){this._loaded=true;this.fire(new e.Event("load"))}if(this.style&&(this.style.hasTransitions()||r)){this._styleDirty=true}if(this.style&&!this._placementDirty){this.style._releaseSymbolFadeTiles()}if(this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty){this.triggerRepaint()}return this};n.prototype.remove=function t(){var r=this;if(this._hash){this._hash.remove()}for(var i=0,n=r._controls;i<n.length;i+=1){var a=n[i];a.onRemove(r)}this._controls=[];if(this._frame){this._frame.cancel();this._frame=null}this._renderTaskQueue.clear();this.setStyle(null);if(typeof e.window!=="undefined"){e.window.removeEventListener("resize",this._onWindowResize,false);e.window.removeEventListener("online",this._onWindowOnline,false)}var o=this.painter.context.gl.getExtension("WEBGL_lose_context");if(o){o.loseContext()}Eo(this._canvasContainer);Eo(this._controlContainer);Eo(this._missingCSSCanary);this._container.classList.remove("mapboxgl-map");this.fire(new e.Event("remove"))};n.prototype.triggerRepaint=function t(){var r=this;if(this.style&&!this._frame){this._frame=e.browser.frame(function(){r._frame=null;r._render()})}};n.prototype._onWindowOnline=function e(){this._update()};n.prototype._onWindowResize=function e(){if(this._trackResize){this.resize()._update()}};a.showTileBoundaries.get=function(){return!!this._showTileBoundaries};a.showTileBoundaries.set=function(e){if(this._showTileBoundaries===e){return}this._showTileBoundaries=e;this._update()};a.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes};a.showCollisionBoxes.set=function(e){if(this._showCollisionBoxes===e){return}this._showCollisionBoxes=e;if(e){this.style._generateCollisionBoxes()}else{this._update()}};a.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector};a.showOverdrawInspector.set=function(e){if(this._showOverdrawInspector===e){return}this._showOverdrawInspector=e;this._update()};a.repaint.get=function(){return!!this._repaint};a.repaint.set=function(e){this._repaint=e;this._update()};a.vertices.get=function(){return!!this._vertices};a.vertices.set=function(e){this._vertices=e;this._update()};n.prototype.setCRS=function t(r){if(r!==Co.EPSG3857){this._tileExtent=[-20037508.3427892,-20037508.3427892,20037508.3427892,20037508.3427892];this._mapCRS=r;var i=r.getExtent();if(i&&Array.isArray(i)&&i.length===4){this._tileExtent=i;var n=this._tileExtent[2]-this._tileExtent[0],a=this._tileExtent[3]-this._tileExtent[1],o=(this._tileExtent[2]+this._tileExtent[0])/2,s=(this._tileExtent[3]+this._tileExtent[1])/2,l=this._tileExtent[0],u=this._tileExtent[3];q.prototype.getMeterPerMapUnit=function(e){var t=1;if(e==="degree"||e==="degrees"||e==="d"){t=2*Math.PI*6378137/360}else if(e==="kilometer"||e==="km"){t=.001}else if(e==="inch"){t=1/.025399999918}else{t=.3048}return t};q.prototype.getResolution=function(e,t){if(!this._resolutions[e]){var r=Math.pow(2,e);this._resolutions[e]=n/r/t}return this._resolutions[e]};q.prototype.getScale=function(e,t){if(!this._scales[e]){var i=96*this.getResolution(e,t)*(1/.0254)*this.getMeterPerMapUnit(r.getUnit());this._scales[e]=1/i}return this._scales[e]};Z.prototype.getMeterPerMapUnit=function(e){var t=1;if(e==="degree"||e==="degrees"||e==="d"){t=2*Math.PI*6378137/360}else if(e==="kilometer"||e==="km"){t=.001}else if(e==="inch"){t=1/.025399999918}else{t=.3048}return t};Z.prototype.getResolution=function(e,t){if(!this._resolutions[e]){var r=Math.pow(2,e);this._resolutions[e]=n/r/t}return this._resolutions[e]};Z.prototype.getScale=function(e,t){if(!this._scales[e]){var i=96*this.getResolution(e,t)*(1/.0254)*this.getMeterPerMapUnit(r.getUnit());this._scales[e]=1/i}return this._scales[e]};e.CanonicalTileID.prototype.getTileBBox=function(){var e=Math.pow(2,this.z);return i[0]+n*this.x/e+","+(i[3]-a*(this.y+1)/e)+","+(i[0]+n*(this.x+1)/e)+","+(i[3]-a*this.y/e)};e.CanonicalTileID.prototype.getViewBounds=function(){var e=Math.pow(2,this.z);return'{"leftBottom":{"x":'+(i[0]+n*this.x/e)+',"y":'+(i[3]-a*(this.y+1)/e)+'},"rightTop":{"x":'+(i[0]+n*(this.x+1)/e)+',"y": '+(i[3]-a*this.y/e)+"}}"};Ra.prototype.lngX=function(e){return(e-l)*this.worldSize/n};Ra.prototype.latY=function(e){return(u-e)*this.worldSize/a};Ra.prototype.xLng=function(e){return e*n/this.worldSize+l};Ra.prototype.yLat=function(e){return u-e*a/this.worldSize};G.prototype.contains=function(e){var t=Math.pow(2,e.z);var r={minX:Math.floor((this.bounds.getWest()-l)*t/n),minY:Math.floor((u-this.bounds.getNorth())*t/a),maxX:Math.ceil((this.bounds.getEast()-l)*t/n),maxY:Math.ceil((u-this.bounds.getSouth())*t/a)};var i=e.x>=r.minX&&e.x<r.maxX&&e.y>=r.minY&&e.y<r.maxY;return i};e.GeoJSONFeature.prototype.yLat=function(e,t){return u-e*a/t};if(this.updateTransform){this.mercatorZfromAltitude=e.mercatorZfromAltitude;this.updateTransform(r.getUnit(),l,u,o,s,n,a)}}}};n.prototype.updateTransform=function t(r,i,n,a,o,s,l){this.transform.units=r;this.transform.latRange=[this._tileExtent[1],this._tileExtent[3]];this.transform.lngRange=[this._tileExtent[0],this._tileExtent[2]];var u=this.mercatorZfromAltitude;e.MercatorCoordinate.fromLngLat=function(t,r){r=r||0;var a=e.LngLat.convert(t);return new e.MercatorCoordinate((a.lng-i)/s,(n-a.lat)/l,u(r,a.lat))};e.MercatorCoordinate.prototype.toLngLat=function(){var t=n-this.y*l;if(t<=90&&t>=-90){return new e.LngLat(this.x*s+i,n-this.y*l)}};this.customConvertPoint=e.window.URL.createObjectURL(new Blob(["customConvertPoint = {projectX:function(x){return (x - "+a+") / "+s+" + 0.5},projectY:function(y){y = 0.5 - ((y - "+o+") / "+l+");return y < 0 ? 0 : y > 1 ? 1 : y;},toY:function(y){return (0.5-y)*"+l+"+"+o+";}}"],{type:"text/javascript"}))};(0,x.default)(n.prototype,a);return n}(xo);function Eo(e){if(e.parentNode){e.parentNode.removeChild(e)}}var ko={showCompass:true,showZoom:true};var Do=function t(i){var n=this;this.options=e.extend({},ko,i);this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-group");this._container.addEventListener("contextmenu",function(e){return e.preventDefault()});if(this.options.showZoom){this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom in",function(){return n._map.zoomIn()});this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom out",function(){return n._map.zoomOut()})}if(this.options.showCompass){e.bindAll(["_rotateCompassArrow"],this);this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset bearing to north",function(){return n._map.resetNorth()});this._compassArrow=r.create("span","mapboxgl-ctrl-compass-arrow",this._compass)}};Do.prototype._rotateCompassArrow=function e(){var t="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=t};Do.prototype.onAdd=function e(t){this._map=t;if(this.options.showCompass){this._map.on("rotate",this._rotateCompassArrow);this._rotateCompassArrow();this._handler=new $a(t,{button:"left",element:this._compass});r.addEventListener(this._compass,"mousedown",this._handler.onMouseDown);this._handler.enable()}return this._container};Do.prototype.onRemove=function e(){r.remove(this._container);if(this.options.showCompass){this._map.off("rotate",this._rotateCompassArrow);r.removeEventListener(this._compass,"mousedown",this._handler.onMouseDown);this._handler.disable();delete this._handler}delete this._map};Do.prototype._createButton=function e(t,i,n){var a=r.create("button",t,this._container);a.type="button";a.title=i;a.setAttribute("aria-label",i);a.addEventListener("click",n);return a};function Bo(t,r,i){t=new e.LngLat(t.lng,t.lat);if(r){var n=new e.LngLat(t.lng-360,t.lat);var a=new e.LngLat(t.lng+360,t.lat);var o=i.locationPoint(t).distSqr(r);if(i.locationPoint(n).distSqr(r)<o){t=n}else if(i.locationPoint(a).distSqr(r)<o){t=a}}while(Math.abs(t.lng-i.center.lng)>180){var s=i.locationPoint(t);if(s.x>=0&&s.y>=0&&s.x<=i.width&&s.y<=i.height){break}if(t.lng>i.center.lng){t.lng-=360}else{t.lng+=360}}return t}var Ro={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Fo(e,t,r){var i=e.classList;for(var n in Ro){i.remove("mapboxgl-"+r+"-anchor-"+n)}i.add("mapboxgl-"+r+"-anchor-"+t)}var Oo=function(t){function i(i){t.call(this);if(arguments[0]instanceof e.window.HTMLElement||arguments.length===2){i=e.extend({element:i},arguments[1])}e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick"],this);this._anchor=i&&i.anchor||"center";this._color=i&&i.color||"#3FB1CE";this._draggable=i&&i.draggable||false;this._state="inactive";if(!i||!i.element){this._defaultMarker=true;this._element=r.create("div");var n=r.createNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS(null,"height","41px");n.setAttributeNS(null,"width","27px");n.setAttributeNS(null,"viewBox","0 0 27 41");var a=r.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none");a.setAttributeNS(null,"stroke-width","1");a.setAttributeNS(null,"fill","none");a.setAttributeNS(null,"fill-rule","evenodd");var o=r.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"fill-rule","nonzero");var s=r.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"transform","translate(3.0, 29.0)");s.setAttributeNS(null,"fill","#000000");var l=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(var u=0,f=l;u<f.length;u+=1){var c=f[u];var h=r.createNS("http://www.w3.org/2000/svg","ellipse");h.setAttributeNS(null,"opacity","0.04");h.setAttributeNS(null,"cx","10.5");h.setAttributeNS(null,"cy","5.80029008");h.setAttributeNS(null,"rx",c["rx"]);h.setAttributeNS(null,"ry",c["ry"]);s.appendChild(h)}var p=r.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"fill",this._color);var d=r.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z");p.appendChild(d);var v=r.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"opacity","0.25");v.setAttributeNS(null,"fill","#000000");var y=r.createNS("http://www.w3.org/2000/svg","path");y.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z");v.appendChild(y);var m=r.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(6.0, 7.0)");m.setAttributeNS(null,"fill","#FFFFFF");var g=r.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"transform","translate(8.0, 8.0)");var _=r.createNS("http://www.w3.org/2000/svg","circle");_.setAttributeNS(null,"fill","#000000");_.setAttributeNS(null,"opacity","0.25");_.setAttributeNS(null,"cx","5.5");_.setAttributeNS(null,"cy","5.5");_.setAttributeNS(null,"r","5.4999962");var x=r.createNS("http://www.w3.org/2000/svg","circle");x.setAttributeNS(null,"fill","#FFFFFF");x.setAttributeNS(null,"cx","5.5");x.setAttributeNS(null,"cy","5.5");x.setAttributeNS(null,"r","5.4999962");g.appendChild(_);g.appendChild(x);o.appendChild(s);o.appendChild(p);o.appendChild(v);o.appendChild(m);o.appendChild(g);n.appendChild(o);this._element.appendChild(n);this._offset=e.Point.convert(i&&i.offset||[0,-14])}else{this._element=i.element;this._offset=e.Point.convert(i&&i.offset||[0,0])}this._element.classList.add("mapboxgl-marker");this._popup=null}if(t)i.__proto__=t;i.prototype=(0,F.default)(t&&t.prototype);i.prototype.constructor=i;i.prototype.addTo=function e(t){this.remove();this._map=t;t.getCanvasContainer().appendChild(this._element);t.on("move",this._update);t.on("moveend",this._update);this.setDraggable(this._draggable);this._update();this._map.on("click",this._onMapClick);return this};i.prototype.remove=function e(){if(this._map){this._map.off("click",this._onMapClick);this._map.off("move",this._update);this._map.off("moveend",this._update);this._map.off("mousedown",this._addDragHandler);this._map.off("touchstart",this._addDragHandler);this._map.off("mouseup",this._onUp);this._map.off("touchend",this._onUp);delete this._map}r.remove(this._element);if(this._popup){this._popup.remove()}return this};i.prototype.getLngLat=function e(){return this._lngLat};i.prototype.setLngLat=function t(r){this._lngLat=e.LngLat.convert(r);this._pos=null;if(this._popup){this._popup.setLngLat(this._lngLat)}this._update();return this};i.prototype.getElement=function e(){return this._element};i.prototype.setPopup=function e(t){if(this._popup){this._popup.remove();this._popup=null}if(t){if(!("offset"in t.options)){var r=41-5.8/2;var i=13.5;var n=Math.sqrt(Math.pow(i,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-r],"bottom-left":[n,(r-i+n)*-1],"bottom-right":[-n,(r-i+n)*-1],left:[i,(r-i)*-1],right:[-i,(r-i)*-1]}:this._offset}this._popup=t;if(this._lngLat){this._popup.setLngLat(this._lngLat)}}return this};i.prototype._onMapClick=function e(t){var r=t.originalEvent.target;var i=this._element;if(this._popup&&(r===i||i.contains(r))){this.togglePopup()}};i.prototype.getPopup=function e(){return this._popup};i.prototype.togglePopup=function e(){var t=this._popup;if(!t){return this}else if(t.isOpen()){t.remove()}else{t.addTo(this._map)}return this};i.prototype._update=function e(t){if(!this._map){return}if(this._map.transform.renderWorldCopies){this._lngLat=Bo(this._lngLat,this._pos,this._map.transform)}this._pos=this._map.project(this._lngLat)._add(this._offset);if(!t||t.type==="moveend"){this._pos=this._pos.round()}r.setTransform(this._element,Ro[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px)");Fo(this._element,this._anchor,"marker")};i.prototype.getOffset=function e(){return this._offset};i.prototype.setOffset=function t(r){this._offset=e.Point.convert(r);this._update();return this};i.prototype._onMove=function t(r){this._pos=r.point.sub(this._positionDelta);this._lngLat=this._map.unproject(this._pos);this.setLngLat(this._lngLat);this._element.style.pointerEvents="none";if(this._state==="pending"){this._state="active";this.fire(new e.Event("dragstart"))}this.fire(new e.Event("drag"))};i.prototype._onUp=function t(){this._element.style.pointerEvents="auto";this._positionDelta=null;this._map.off("mousemove",this._onMove);this._map.off("touchmove",this._onMove);if(this._state==="active"){this.fire(new e.Event("dragend"))}this._state="inactive"};i.prototype._addDragHandler=function e(t){if(this._element.contains(t.originalEvent.target)){t.preventDefault();this._positionDelta=t.point.sub(this._pos).add(this._offset);this._state="pending";this._map.on("mousemove",this._onMove);this._map.on("touchmove",this._onMove);this._map.once("mouseup",this._onUp);this._map.once("touchend",this._onUp)}};i.prototype.setDraggable=function e(t){this._draggable=!!t;if(this._map){if(t){this._map.on("mousedown",this._addDragHandler);this._map.on("touchstart",this._addDragHandler)}else{this._map.off("mousedown",this._addDragHandler);this._map.off("touchstart",this._addDragHandler)}}return this};i.prototype.isDraggable=function e(){return this._draggable};return i}(e.Evented);var zo={positionOptions:{enableHighAccuracy:false,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:false,showUserLocation:true};var Uo="mapboxgl-ctrl";var No;function jo(t){if(No!==undefined){t(No)}else if(e.window.navigator.permissions!==undefined){e.window.navigator.permissions.query({name:"geolocation"}).then(function(e){No=e.state!=="denied";t(No)})}else{No=!!e.window.navigator.geolocation;t(No)}}var Vo=function(t){function i(r){t.call(this);this.options=e.extend({},zo,r);e.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}if(t)i.__proto__=t;i.prototype=(0,F.default)(t&&t.prototype);i.prototype.constructor=i;i.prototype.onAdd=function e(t){this._map=t;this._container=r.create("div",Uo+" "+Uo+"-group");jo(this._setupUI);return this._container};i.prototype.onRemove=function t(){if(this._geolocationWatchID!==undefined){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID);this._geolocationWatchID=undefined}if(this.options.showUserLocation&&this._userLocationDotMarker){this._userLocationDotMarker.remove()}r.remove(this._container);this._map=undefined};i.prototype._onSuccess=function t(r){if(this.options.trackUserLocation){this._lastKnownPosition=r;switch(this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;default:e.assert(false,"Unexpected watchState "+this._watchState)}}if(this.options.showUserLocation&&this._watchState!=="OFF"){this._updateMarker(r)}if(!this.options.trackUserLocation||this._watchState==="ACTIVE_LOCK"){this._updateCamera(r)}if(this.options.showUserLocation){this._dotElement.classList.remove("mapboxgl-user-location-dot-stale")}this.fire(new e.Event("geolocate",r));this._finish()};i.prototype._updateCamera=function t(r){var i=new e.LngLat(r.coords.longitude,r.coords.latitude);var n=r.coords.accuracy;this._map.fitBounds(i.toBounds(n),this.options.fitBoundsOptions,{geolocateSource:true})};i.prototype._updateMarker=function e(t){if(t){this._userLocationDotMarker.setLngLat([t.coords.longitude,t.coords.latitude]).addTo(this._map)}else{this._userLocationDotMarker.remove()}};i.prototype._onError=function t(r){if(this.options.trackUserLocation){if(r.code===1){this._watchState="OFF";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error");if(this._geolocationWatchID!==undefined){this._clearWatch()}}else{switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:e.assert(false,"Unexpected watchState "+this._watchState)}}}if(this._watchState!=="OFF"&&this.options.showUserLocation){this._dotElement.classList.add("mapboxgl-user-location-dot-stale")}this.fire(new e.Event("error",r));this._finish()};i.prototype._finish=function e(){if(this._timeoutId){clearTimeout(this._timeoutId)}this._timeoutId=undefined};i.prototype._setupUI=function t(i){var n=this;if(i===false){e.warnOnce("Geolocation support is not available, the GeolocateControl will not be visible.");return}this._container.addEventListener("contextmenu",function(e){return e.preventDefault()});this._geolocateButton=r.create("button",Uo+"-icon "+Uo+"-geolocate",this._container);this._geolocateButton.type="button";this._geolocateButton.setAttribute("aria-label","Geolocate");if(this.options.trackUserLocation){this._geolocateButton.setAttribute("aria-pressed","false");this._watchState="OFF"}if(this.options.showUserLocation){this._dotElement=r.create("div","mapboxgl-user-location-dot");this._userLocationDotMarker=new Oo(this._dotElement);if(this.options.trackUserLocation){this._watchState="OFF"}}this._geolocateButton.addEventListener("click",this.trigger.bind(this));this._setup=true;if(this.options.trackUserLocation){this._map.on("movestart",function(t){if(!t.geolocateSource&&n._watchState==="ACTIVE_LOCK"){n._watchState="BACKGROUND";n._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");n._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active");n.fire(new e.Event("trackuserlocationend"))}})}};i.prototype.trigger=function t(){if(!this._setup){e.warnOnce("Geolocate control triggered before added to a map");return false}if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE";this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background");this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error");this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK";this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background");if(this._lastKnownPosition){this._updateCamera(this._lastKnownPosition)}this.fire(new e.Event("trackuserlocationstart"));break;default:e.assert(false,"Unexpected watchState "+this._watchState)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");break;case"OFF":break;default:e.assert(false,"Unexpected watchState "+this._watchState)}if(this._watchState==="OFF"&&this._geolocationWatchID!==undefined){this._clearWatch()}else if(this._geolocationWatchID===undefined){this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.setAttribute("aria-pressed","true");this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions)}}else{e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions);this._timeoutId=setTimeout(this._finish,1e4)}return true};i.prototype._clearWatch=function t(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID);this._geolocationWatchID=undefined;this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting");this._geolocateButton.setAttribute("aria-pressed","false");if(this.options.showUserLocation){this._updateMarker(null)}};return i}(e.Evented);var Go={maxWidth:100,unit:"metric"};var Zo=function t(r){this.options=e.extend({},Go,r);e.bindAll(["_onMove","setUnit"],this)};Zo.prototype.getDefaultPosition=function e(){return"bottom-left"};Zo.prototype._onMove=function e(){qo(this._map,this._container,this.options)};Zo.prototype.onAdd=function e(t){this._map=t;this._container=r.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer());this._map.on("move",this._onMove);this._onMove();return this._container};Zo.prototype.onRemove=function e(){r.remove(this._container);this._map.off("move",this._onMove);this._map=undefined};Zo.prototype.setUnit=function e(t){this.options.unit=t;qo(this._map,this._container,this.options)};function qo(e,t,r){var i=r&&r.maxWidth||100;var n=e._container.clientHeight/2;var a=Wo(e.unproject([0,n]),e.unproject([i,n]));if(r&&r.unit==="imperial"){var o=3.2808*a;if(o>5280){var s=o/5280;Ho(t,i,s,"mi")}else{Ho(t,i,o,"ft")}}else if(r&&r.unit==="nautical"){var l=a/1852;Ho(t,i,l,"nm")}else{Ho(t,i,a,"m")}}function Ho(e,t,r,i){var n=Yo(r);var a=n/r;if(i==="m"&&n>=1e3){n=n/1e3;i="km"}e.style.width=t*a+"px";e.innerHTML=n+i}function Wo(e,t){var r=6371e3;var i=Math.PI/180,n=e.lat*i,a=t.lat*i,o=Math.sin(n)*Math.sin(a)+Math.cos(n)*Math.cos(a)*Math.cos((t.lng-e.lng)*i);var s=r*Math.acos(Math.min(o,1));return s}function Xo(e){var t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}function Yo(e){var t=Math.pow(10,(""+Math.floor(e)).length-1);var r=e/t;r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:r>=1?1:Xo(r);return t*r}var Ko=function t(){this._fullscreen=false;e.bindAll(["_onClickFullscreen","_changeIcon"],this);if("onfullscreenchange"in e.window.document){this._fullscreenchange="fullscreenchange"}else if("onmozfullscreenchange"in e.window.document){this._fullscreenchange="mozfullscreenchange"}else if("onwebkitfullscreenchange"in e.window.document){this._fullscreenchange="webkitfullscreenchange"}else if("onmsfullscreenchange"in e.window.document){this._fullscreenchange="MSFullscreenChange"}this._className="mapboxgl-ctrl"};Ko.prototype.onAdd=function t(i){this._map=i;this._mapContainer=this._map.getContainer();this._container=r.create("div",this._className+" mapboxgl-ctrl-group");if(this._checkFullscreenSupport()){this._setupUI()}else{this._container.style.display="none";e.warnOnce("This device does not support fullscreen mode.")}return this._container};Ko.prototype.onRemove=function t(){r.remove(this._container);this._map=null;e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)};Ko.prototype._checkFullscreenSupport=function t(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)};Ko.prototype._setupUI=function t(){var i=this._fullscreenButton=r.create("button",this._className+"-icon "+this._className+"-fullscreen",this._container);i.setAttribute("aria-label","Toggle fullscreen");i.type="button";this._fullscreenButton.addEventListener("click",this._onClickFullscreen);e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)};Ko.prototype._isFullscreen=function e(){return this._fullscreen};Ko.prototype._changeIcon=function t(){var r=e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement;if(r===this._mapContainer!==this._fullscreen){this._fullscreen=!this._fullscreen;this._fullscreenButton.classList.toggle(this._className+"-shrink");this._fullscreenButton.classList.toggle(this._className+"-fullscreen")}};Ko.prototype._onClickFullscreen=function t(){if(this._isFullscreen()){if(e.window.document.exitFullscreen){e.window.document.exitFullscreen()}else if(e.window.document.mozCancelFullScreen){e.window.document.mozCancelFullScreen()}else if(e.window.document.msExitFullscreen){e.window.document.msExitFullscreen()}else if(e.window.document.webkitCancelFullScreen){e.window.document.webkitCancelFullScreen()}}else if(this._mapContainer.requestFullscreen){this._mapContainer.requestFullscreen()}else if(this._mapContainer.mozRequestFullScreen){this._mapContainer.mozRequestFullScreen()}else if(this._mapContainer.msRequestFullscreen){this._mapContainer.msRequestFullscreen()}else if(this._mapContainer.webkitRequestFullscreen){this._mapContainer.webkitRequestFullscreen()}};var Jo={closeButton:true,closeOnClick:true,className:""};var $o=function(t){function i(r){t.call(this);this.options=e.extend((0,F.default)(Jo),r);e.bindAll(["_update","_onClickClose"],this)}if(t)i.__proto__=t;i.prototype=(0,F.default)(t&&t.prototype);i.prototype.constructor=i;i.prototype.addTo=function t(r){this._map=r;this._map.on("move",this._update);if(this.options.closeOnClick){this._map.on("click",this._onClickClose)}this._update();this.fire(new e.Event("open"));return this};i.prototype.isOpen=function e(){return!!this._map};i.prototype.remove=function t(){if(this._content){r.remove(this._content)}if(this._container){r.remove(this._container);delete this._container}if(this._map){this._map.off("move",this._update);this._map.off("click",this._onClickClose);delete this._map}this.fire(new e.Event("close"));return this};i.prototype.getLngLat=function e(){return this._lngLat};i.prototype.setLngLat=function t(r){this._lngLat=e.LngLat.convert(r);this._pos=null;this._update();return this};i.prototype.setText=function t(r){return this.setDOMContent(e.window.document.createTextNode(r))};i.prototype.setHTML=function t(r){var i=e.window.document.createDocumentFragment();var n=e.window.document.createElement("body");var a;n.innerHTML=r;while(true){a=n.firstChild;if(!a){break}i.appendChild(a)}return this.setDOMContent(i)};i.prototype.setDOMContent=function e(t){this._createContent();this._content.appendChild(t);this._update();return this};i.prototype._createContent=function e(){if(this._content){r.remove(this._content)}this._content=r.create("div","mapboxgl-popup-content",this._container);if(this.options.closeButton){this._closeButton=r.create("button","mapboxgl-popup-close-button",this._content);this._closeButton.type="button";this._closeButton.setAttribute("aria-label","Close popup");this._closeButton.innerHTML="&#215;";this._closeButton.addEventListener("click",this._onClickClose)}};i.prototype._update=function e(){var t=this;if(!this._map||!this._lngLat||!this._content){return}if(!this._container){this._container=r.create("div","mapboxgl-popup",this._map.getContainer());this._tip=r.create("div","mapboxgl-popup-tip",this._container);this._container.appendChild(this._content);if(this.options.className){this.options.className.split(" ").forEach(function(e){return t._container.classList.add(e)})}}if(this._map.transform.renderWorldCopies){this._lngLat=Bo(this._lngLat,this._pos,this._map.transform)}var i=this._pos=this._map.project(this._lngLat);var n=this.options.anchor;var a=Qo(this.options.offset);if(!n){var o=this._container.offsetWidth;var s=this._container.offsetHeight;var l;if(i.y+a.bottom.y<s){l=["top"]}else if(i.y>this._map.transform.height-s){l=["bottom"]}else{l=[]}if(i.x<o/2){l.push("left")}else if(i.x>this._map.transform.width-o/2){l.push("right")}if(l.length===0){n="bottom"}else{n=l.join("-")}}var u=i.add(a[n]).round();r.setTransform(this._container,Ro[n]+" translate("+u.x+"px,"+u.y+"px)");Fo(this._container,n,"popup")};i.prototype._onClickClose=function e(){this.remove()};return i}(e.Evented);function Qo(t){if(!t){return Qo(new e.Point(0,0))}else if(typeof t==="number"){var r=Math.round(Math.sqrt(.5*Math.pow(t,2)));return{center:new e.Point(0,0),top:new e.Point(0,t),"top-left":new e.Point(r,r),"top-right":new e.Point(-r,r),bottom:new e.Point(0,-t),"bottom-left":new e.Point(r,-r),"bottom-right":new e.Point(-r,-r),left:new e.Point(t,0),right:new e.Point(-t,0)}}else if(t instanceof e.Point||Array.isArray(t)){var i=e.Point.convert(t);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}else{return{center:e.Point.convert(t["center"]||[0,0]),top:e.Point.convert(t["top"]||[0,0]),"top-left":e.Point.convert(t["top-left"]||[0,0]),"top-right":e.Point.convert(t["top-right"]||[0,0]),bottom:e.Point.convert(t["bottom"]||[0,0]),"bottom-left":e.Point.convert(t["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(t["bottom-right"]||[0,0]),left:e.Point.convert(t["left"]||[0,0]),right:e.Point.convert(t["right"]||[0,0])}}}var es={version:e.version,supported:t,setRTLTextPlugin:e.setRTLTextPlugin,Map:Lo,CRS:Co,CanonicalTileID:e.CanonicalTileID$1,NavigationControl:Do,GeolocateControl:Vo,AttributionControl:bo,ScaleControl:Zo,FullscreenControl:Ko,Popup:$o,Marker:Oo,Style:mr,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(t){e.config.ACCESS_TOKEN=t},get workerCount(){return ft.workerCount},set workerCount(e){ft.workerCount=e},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){e.config.MAX_PARALLEL_IMAGE_REQUESTS=t},workerUrl:""};e.assert(true,"canary assert");return es});return r})}).call(this,r(223),r(224))},function(e,t,r){e.exports=!r(44)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ServiceBase=undefined;var i=r(1);var n=u(i);var a=r(5);var o=u(a);var s=r(0);var l=r(6);function u(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t){(0,n.default)(this,e);(0,l.extend)(this,t);this.baseUrl=t&&t.baseUrl?t.baseUrl:null;this.ip=t&&t.ip?t.ip:"localhost";this.port=t&&t.port?t.port:"6163";this.partUrl=t&&t.partUrl?t.partUrl:null;this.networkProtocol=t&&t.networkProtocol?t.networkProtocol:location.protocol.split(":")[0]||"http";this.domain=t&&t.domain?t.domain:""}(0,o.default)(e,[{key:"getFullUrl",value:function e(){var t=this;var r=null;if(s.Zondy.Util.isArray(t.ip)){for(var i=0;i<t.ip.length;i++){r=new Array;var n=null;if((0,l.isArray)(t.port)){n=t.port[i]!==undefined?t.port[i]:"6163"}else{n=t.port!==undefined?t.port:"6163"}var a=null;if((0,l.isArray)(t.partUrl)){a=t.partUrl[i]!==undefined?t.partUrl[i]:null}else{a=t.partUrl!==undefined?t.partUrl:null}if(t.domain===""){t.domainStr=t.networkProtocol+"://"+t.ip[i]+":"+n}else{t.domainStr=t.domain}r.push(encodeURI((t.domainStr+"/"+t.baseUrl+"/"+a).trim()))}}else{if(t.domain===""){t.domainStr=t.networkProtocol+"://"+t.ip+":"+t.port}else{t.domainStr=t.domain}r=encodeURI((t.domainStr+"/"+t.baseUrl+"/"+t.partUrl).trim())}return r}}]);return e}();t.ServiceBase=f;s.Zondy.Service.ServiceBase=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AnalysisBase=undefined;var i=r(9);var n=_(i);var a=r(2);var o=_(a);var s=r(1);var l=_(s);var u=r(5);var f=_(u);var c=r(3);var h=_(c);var p=r(4);var d=_(p);var v=r(0);var y=r(6);var m=r(27);var g=r(10);function _(e){return e&&e.__esModule?e:{default:e}}var x=function(e){(0,d.default)(t,e);function t(e){(0,l.default)(this,t);var r=e||{};r.baseUrl="igs/rest/mrfws";var i=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,r));i.flowID=r.flowID!==undefined?r.flowID:null;return i}(0,f.default)(t,[{key:"execute",value:function e(t,r,i){var a={};(0,y.copyExcluce)(a,this,["port","ip","baseUrl","partUrl","flowID"]);if(!r){r="get"}if(r.toLowerCase()==="get"){this.partUrl="execute/"+this.flowID+"?isAsy=false&f=json";if(a!==null){var o=(0,y.getWFParameterString)(a);if(o!==null||o!==""){this.partUrl+="&paraValues="+o}}}if(r.toLowerCase()==="post"){this.partUrl="execute/"+this.flowID+"?isAsy=false&f=json";var s=new Array;if(a!==null){for(var l in a){if(a[l]!==null){var u={};u.Key=l;u.Value=a[l].toString();s.push(u)}}}a=s}var f=this.getFullUrl();var c=this;var h=new g.IgsServiceBase(f,{eventListeners:{scope:c,processCompleted:t,processFailed:i}});if(r.toLowerCase()==="post"){h.processAsync({method:"POST",data:(0,n.default)(a),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}else{h.processAsync()}}}]);return t}(m.ServiceBase);t.AnalysisBase=x;v.Zondy.Service.AnalysisBase=x},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ShapeParameters=undefined;var i=r(1);var n=l(i);var a=r(5);var o=l(a);var s=r(0);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){(0,n.default)(this,e);this.refOriginalPosition=[0,0];this.refDataID=null;this.isHoverByRefDataID=false;this.refDataHoverGroup=null;this.dataInfo=null;this.clickable=true;this.hoverable=true;this.style=null;this.highlightStyle={};this.CLASS_NAME="Zondy.Feature.ShapeParameters"}(0,o.default)(e,[{key:"destroy",value:function e(){this.refOriginalPosition=null;this.refDataID=null;this.isHoverByRefDataID=null;this.refDataHoverGroup=null;this.dataInfo=null;this.clickable=null;this.hoverable=null;this.style=null;this.highlightStyle=null}}]);return e}();t.ShapeParameters=u;s.Zondy.Feature.ShapeParameters=u},function(e,t,r){var i=r(23);var n=r(121);var a=r(75);var o=Object.defineProperty;t.f=r(26)?Object.defineProperty:function e(t,r,s){i(t);r=a(r,true);i(s);if(n)try{return o(t,r,s)}catch(e){}if("get"in s||"set"in s)throw TypeError("Accessors not supported!");if("value"in s)t[r]=s.value;return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var i=window.mapboxgl=window.mapboxgl||{};i.Zondy=i.Zondy||{};var n=i.Zondy||{};n.Map=n.Map||{};t.Zondy=n;t.mapboxgl=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CThemeInfo=undefined;var i=r(1);var n=f(i);var a=r(0);var o=r(6);var s=r(65);var l=r(175);var u=r(176);function f(e){return e&&e.__esModule?e:{default:e}}var c=function e(t){(0,n.default)(this,e);var r=t!==undefined?t:{};(0,o.extend)(this,r);this.Caption=r.Caption!==undefined?r.Caption:null;this.IsVisible=r.IsVisible!==undefined?r.IsVisible:true;this.MaxScale=r.MaxScale!==undefined?parseFloat(r.MaxScale):0;this.MinScale=r.MinScale!==undefined?parseFloat(r.MinScale):0;this.RegInfo=r.RegInfo!==undefined?r.RegInfo:null;this.LinInfo=r.LinInfo!==undefined?r.LinInfo:null;this.PntInfo=r.PntInfo!==undefined?r.PntInfo:null};t.CThemeInfo=c;a.Zondy.Object.Theme.CThemeInfo=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Graph=undefined;var i=r(2);var n=_(i);var a=r(1);var o=_(a);var s=r(5);var l=_(s);var u=r(3);var f=_(u);var c=r(7);var h=_(c);var p=r(4);var d=_(p);var v=r(0);var y=r(43);var m=r(13);var g=r(94);function _(e){return e&&e.__esModule?e:{default:e}}var x=function(e){(0,d.default)(t,e);function t(e,r,i,a,s,l){(0,o.default)(this,t);var u=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i,a,s,l));u.shapeFactory=new m.ShapeFactory;u.shapeParameters=null;u.RelativeCoordinate=false;u.setting=null;u.origonPoint=null;u.chartBox=null;u.chartBounds=null;u.width=null;u.height=null;u.XOffset=0;u.YOffset=0;u.DVBParameter=null;u.dataViewBox=null;u.DVBCodomain=null;u.DVBCenterPoint=null;u.DVBUnitValue=null;u.DVBOrigonPoint=null;u.DVBWidth=null;u.DVBHeight=null;u.origonPointOffset=null;u.fields=i||[];u.dataValues=null;if(s){u.lonlat=s}else{if(l&&l.calGravity){if(e.ftype===v.Zondy.Enum.FeatureType.Pnt){var c=e.fGeom.PntGeom[0].Dot;u.lonlat=[c.x,c.y]}else if(e.ftype===v.Zondy.Enum.FeatureType.Lin){var h=e.fGeom.LinGeom[0].Line.Arcs;var p=[];h.forEach(function(e){var t=e.Dots;p=[].concat(t)});var d=Math.ceil(p.length/2);var c=p[d-1];u.lonlat=[c.x,c.y]}else if(e.ftype===v.Zondy.Enum.FeatureType.Reg){u.lonlat=u.getCenterOfGravityPoint(e)}else{var y=e.bound;u.lonlat=[(y.xmin+y.xmax)/2,(y.ymin+y.ymax)/2]}}else{var y=e.bound;u.lonlat=[(y.xmin+y.xmax)/2,(y.ymin+y.ymax)/2]}}if(a&&a.width&&a.height&&a.codomain){u.setting=a}u.CLASS_NAME="Zondy.Feature.Theme.Graph";return u}(0,l.default)(t,[{key:"destroy",value:function e(){this.shapeFactory=null;this.shapeParameters=null;this.width=null;this.height=null;this.origonPoint=null;this.chartBox=null;this.dataViewBox=null;this.chartBounds=null;this.DVBParameter=null;this.DVBOrigonPoint=null;this.DVBCenterPoint=null;this.DVBWidth=null;this.DVBHeight=null;this.DVBCodomain=null;this.DVBUnitValue=null;this.origonPointOffset=null;this.XOffset=null;this.YOffset=null;this.fields=null;this.dataValues=null;this.setting=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"initBaseParameter",value:function e(){var t=true;if(!this.setting){return false}var r=this.setting;if(!(r.width&&r.height&&r.codomain)){return false}var i=typeof r.decimalNumber!=="undefined"&&!isNaN(r.decimalNumber)?r.decimalNumber:-1;var n=y.Theme.getDataValues(this.data,this.fields,i);this.dataValues=n?n:[];this.width=parseFloat(r.width);this.height=parseFloat(r.height);this.DVBCodomain=r.codomain;this.XOffset=r.XOffset?r.XOffset:0;this.YOffset=r.YOffset?r.YOffset:0;this.origonPoint=[];this.chartBox=[];this.dataViewBox=[];this.DVBParameter=r.dataViewBoxParameter?r.dataViewBoxParameter:[0,0,0,0];this.DVBOrigonPoint=[];this.DVBCenterPoint=[];this.origonPointOffset=[];this.resetLocation();var a=this.width;var o=this.height;var s=this.location;this.origonPoint=[s[0]-a/2,s[1]-o/2];var l=this.origonPoint;this.chartBox=[l[0],l[1]+o,l[0]+a,l[1]];var u=this.chartBox;var f=this.DVBParameter;this.dataViewBox=[u[0]+f[0],u[1]-f[1],u[2]-f[2],u[3]+f[3]];var c=this.dataViewBox;if(c[0]>=c[2]||c[1]<=c[3]){return false}this.DVBOrigonPoint=[c[0],c[3]];this.DVBWidth=Math.abs(c[2]-c[0]);this.DVBHeight=Math.abs(c[1]-c[3]);this.DVBCenterPoint=[this.DVBOrigonPoint[0]+this.DVBWidth/2,this.DVBOrigonPoint[1]+this.DVBHeight/2];this.origonPointOffset=[this.DVBOrigonPoint[0]-l[0],this.DVBOrigonPoint[1]-l[1]];return t}},{key:"resetLocation",value:function e(t){if(t){this.lonlat=t}var r=this.getLocalXY(this.lonlat);r[0]+=this.XOffset;r[1]+=this.YOffset;this.location=r;var i=this.width;var n=this.height;var a=this.location;this.chartBounds=new g.Rectangle(a[0]-i/2,a[1]-n/2,a[0]+i/2,a[1]+n/2);this.resetLinearGradient();return a}},{key:"resetLinearGradient",value:function e(){}},{key:"shapesConvertToRelativeCoordinate",value:function e(){var t=this.shapes;var r=this.location;for(var i=0,n=t.length;i<n;i++){t[i].refOriginalPosition=r;var a=t[i].style;for(var o in a){switch(o){case"pointList":var s=a[o];for(var l=0,u=s.length;l<u;l++){s[l][0]-=r[0];s[l][1]-=r[1]}break;case"x":a[o]-=r[0];break;case"y":a[o]-=r[1];break;default:break}}}this.RelativeCoordinate=true}},{key:"assembleShapes",value:function e(){}},{key:"getLocalXY",value:function e(t){return this.layer.getLocalXY(t)}},{key:"getCenterOfGravityPoint",value:function e(t){var r=[];var i=0;var n=0,a=0;if(t.ftype===v.Zondy.Enum.FeatureType.Reg){var o=t.fGeom.RegGeom;for(var s=0;s<o.length;s++){var l=o[s];if(l==null||l.Rings==null){continue}var u=l.Rings;for(var f=0;f<u.length;f++){var c=u[f];if(c==null||c.Arcs==null){continue}var h=c.Arcs;for(var p=0;p<h.length;p++){var d=h[p];if(d==null||d.Dots==null){continue}var y=d.Dots;for(var m=0;m<y.length;m++){r.push(y[m])}}}}}for(var f=1;f<=r.length;f++){var g=r[f%r.length].x;var _=r[f%r.length].y;var x=r[f-1].x;var b=r[f-1].y;var w=(g*b-_*x)/2;i+=w;n+=w*(g+x)/3;a+=w*(_+b)/3}n=n/i;a=a/i;return[n,a]}}]);return t}(y.Theme);y.Theme.getDataValues=function(e,t,r){if(!e.attributes){return false}var i=[];var n=e.attributes;for(var a=0;a<t.length;a++){for(var o in n){if(o!==t[a]){continue}if(n[o]===null||n[o]===undefined){continue}try{if(!isNaN(r)&&r>=0){i.push(parseFloat(n[o].toString()).toFixed(r))}else{i.push(parseFloat(n[o].toString()))}}catch(e){throw new Error("not a number")}}}if(i.length===t.length){return i}else{return false}};t.Graph=x;v.Zondy.Theme.Graph=x},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){var i=r(30);var n=r(55);e.exports=r(26)?function(e,t,r){return i.f(e,t,n(1,r))}:function(e,t,r){e[t]=r;return e}},function(e,t,r){var i=r(245);var n=r(76);e.exports=function(e){return i(n(e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Tangram=undefined;var i=r(1);var n=u(i);var a=r(5);var o=u(a);var s=r(0);var l=r(6);function u(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t){(0,n.default)(this,e);var r=t?t:{};(0,l.extend)(this,r)}(0,o.default)(e,[{key:"setByOL",value:function e(t){return null}},{key:"toString",value:function e(){return""}},{key:"getGeometryType",value:function e(){return}},{key:"Trim",value:function e(t,r){var i;i=t.replace(/(^\s+)|(\s+$)/g,"");if(r.toLowerCase()==="g"){i=i.replace(/\s/g,"")}return i}}]);return e}();t.Tangram=f;s.Zondy.Object.Tangram=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GeometryAnalysisBase=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(27);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};r.baseUrl="igs/rest/mrgs";return(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r))}return t}(h.ServiceBase);t.GeometryAnalysisBase=d;c.Zondy.Service.GeometryAnalysisBase=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Zondy=undefined;var i=r(21);var n=a(i);function a(e){return e&&e.__esModule?e:{default:e}}var o=t.Zondy=window.Zondy=window.Zondy||{};o.Util=o.Util||{};o.Network=o.Network||{};o.Event=o.Event||{};o.Socket=o.Socket||{};n.default.zondy=n.default.zondy||{}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CatalogService=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(27);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};r.baseUrl="igs/rest/mrcs";return(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r))}return t}(h.ServiceBase);t.CatalogService=d;c.Zondy.Catalog.CatalogService=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MapServiceBase=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(27);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};r.baseUrl="igs/rest/mrms";return(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r))}return t}(h.ServiceBase);t.MapServiceBase=d;c.Zondy.Service.MapServiceBase=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Util=undefined;var i=r(18);var n=f(i);var a=r(1);var o=f(a);var s=r(5);var l=f(s);var u=r(0);function f(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(){(0,o.default)(this,e);this.BUILTIN_OBJECT={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1};this._ctx=null;this._canvas=null;this._pixelCtx=null;this._width=null;this._height=null;this._offsetX=0;this._offsetY=0;this.CLASS_NAME="Zondy.LevelRenderer.Tool.Util"}(0,l.default)(e,[{key:"clone",value:function e(t){var r=this.BUILTIN_OBJECT;if((typeof t==="undefined"?"undefined":(0,n.default)(t))=="object"&&t!==null){var i=t;if(t instanceof Array){i=[];for(var a=0,o=t.length;a<o;a++){i[a]=this.clone(t[a])}}else if(!r[Object.prototype.toString.call(t)]){i={};for(var s in t){if(t.hasOwnProperty(s)){i[s]=this.clone(t[s])}}}return i}return t}},{key:"mergeItem",value:function e(t,r,i,a){var o=this.BUILTIN_OBJECT;if(r.hasOwnProperty(i)){if((0,n.default)(t[i])=="object"&&!o[Object.prototype.toString.call(t[i])]){this.merge(t[i],r[i],a)}else if(a||!(i in t)){t[i]=r[i]}}}},{key:"merge",value:function e(t,r,i){for(var n in r){this.mergeItem(t,r,n,i)}return t}},{key:"getContext",value:function e(){if(!this._ctx){this._ctx=document.createElement("canvas").getContext("2d")}return this._ctx}},{key:"getPixelContext",value:function e(){if(!this._pixelCtx){this._canvas=document.createElement("canvas");this._width=this._canvas.width;this._height=this._canvas.height;this._pixelCtx=this._canvas.getContext("2d")}return this._pixelCtx}},{key:"adjustCanvasSize",value:function e(t,r){var i=this._canvas;var n=this._pixelCtx;var a=this._width;var o=this._height;var s=this._offsetX;var l=this._offsetY;var u=100;var f;if(t+s>a){a=t+s+u;i.width=a;f=true}if(r+l>o){o=r+l+u;i.height=o;f=true}if(t<-s){s=Math.ceil(-t/u)*u;a+=s;i.width=a;f=true}if(r<-l){l=Math.ceil(-r/u)*u;o+=l;i.height=o;f=true}if(f){n.translate(s,l)}}},{key:"getPixelOffset",value:function e(){return{x:this._offsetX,y:this._offsetY}}},{key:"indexOf",value:function e(t,r){if(t.indexOf){return t.indexOf(r)}for(var i=0,n=t.length;i<n;i++){if(t[i]===r){return i}}return-1}},{key:"inherits",value:function e(t,r){var i=t.prototype;function n(){}n.prototype=r.prototype;t.prototype=new n;for(var a in i){t.prototype[a]=i[a]}t.constructor=t}}]);return e}();t.Util=c;u.Zondy.LevelRenderer.Tool.Util=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Theme=undefined;var i=r(1);var n=u(i);var a=r(5);var o=u(a);var s=r(0);var l=r(6);function u(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t,r){(0,n.default)(this,e);if(!t){return}if(!r||!r.map||!r.renderer){return}this.id=(0,l.newGuid)();this.lonlat=null;this.location=[];this.data=t;this.shapes=[];this.layer=r;this.CLASS_NAME="Zondy.Feature.Theme"}(0,o.default)(e,[{key:"destroy",value:function e(){this.data=null;this.id=null;this.lonlat=null;this.location=null;this.shapes=null;this.layer=null}}]);return e}();t.Theme=f;s.Zondy.Theme=f},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return true}}},function(e,t,r){var i=r(54);e.exports=function(e,t,r){i(e);if(t===undefined)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,i){return e.call(t,r,i)};case 3:return function(r,i,n){return e.call(t,r,i,n)}}return function(){return e.apply(t,arguments)}}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t){e.exports=true},function(e,t){e.exports={}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.QueryServiceBase=undefined;var i=r(9);var n=b(i);var a=r(2);var o=b(a);var s=r(1);var l=b(s);var u=r(5);var f=b(u);var c=r(3);var h=b(c);var p=r(4);var d=b(p);var v=r(0);var y=r(6);var m=r(27);var g=r(63);var _=r(101);var x=r(10);function b(e){return e&&e.__esModule?e:{default:e}}var w=function(e){(0,d.default)(t,e);function t(e){(0,l.default)(this,t);var r=e||{};r.baseUrl="igs/rest/mrfs";var i=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,r));i.resultCallBack=r.resultCallBack!==undefined?r.resultCallBack:null;i.queryParam=r.queryParam!==undefined?r.queryParam:null;i.requestType=r.requestType!==undefined?r.requestType:"GET";return i}(0,f.default)(t,[{key:"processResult",value:function e(t){var r=new g.FeatureSet;(0,y.copyExcluce)(r,t,"succeed");this.resultCallBack(r)}},{key:"processGeoJsonResult",value:function e(t){var r={};(0,y.copyExcluce)(r,t,"succeed");this.resultCallBack(r)}},{key:"restQuery",value:function e(t,r,i,a,o,s){var l=this;l.resultCallBack=i;var u=new x.IgsServiceBase(t,{eventListeners:{scope:l,processCompleted:s!=="geojson"?l.processResult:l.processGeoJsonResult,processFailed:o}});if(a==="GET"){u.processAsync()}else{u.processAsync({method:"POST",data:(0,n.default)(r),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}}},{key:"query",value:function e(t,r,i){if(this.queryParam===null){return}var n="";if(this.queryParam instanceof _.QueryParameter){n=this.getFullUrl()}else{return}var a="";var o=null;if(!i){if(!this.requestType){a="GET"}else{a=this.requestType}}else{a=i}if(a.toUpperCase()==="GET"){n+="?"+this.queryParam.getParameterURL();n=encodeURI(n)}else{o=this.queryParam.getParameterObject()}this.restQuery(n,o,t,a,r,this.queryParam.resultFormat.toLowerCase())}}]);return t}(m.ServiceBase);t.QueryServiceBase=w;v.Zondy.Service.QueryServiceBase=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Eventful=undefined;var i=r(1);var n=l(i);var a=r(5);var o=l(a);var s=r(0);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){(0,n.default)(this,e);this._handlers={};this.CLASS_NAME="Zondy.LevelRenderer.Eventful"}(0,o.default)(e,[{key:"destroy",value:function e(){this._handlers=null}},{key:"one",value:function e(t,r,i){var n=this._handlers;if(!r||!t){return this}if(!n[t]){n[t]=[]}n[t].push({h:r,one:true,ctx:i||this});return this}},{key:"bind",value:function e(t,r,i){var n=this._handlers;if(!r||!t){return this}if(!n[t]){n[t]=[]}n[t].push({h:r,one:false,ctx:i||this});return this}},{key:"unbind",value:function e(t,r){var i=this._handlers;if(!t){this._handlers={};return this}if(r){if(i[t]){var n=[];for(var a=0,o=i[t].length;a<o;a++){if(i[t][a]["h"]!==r){n.push(i[t][a])}}i[t]=n}if(i[t]&&i[t].length===0){delete i[t]}}else{delete i[t]}return this}},{key:"dispatch",value:function e(t){if(this._handlers[t]){var r=arguments;var i=r.length;if(i>3){r=Array.prototype.slice.call(r,1)}var n=this._handlers[t];var a=n.length;for(var o=0;o<a;){switch(i){case 1:n[o]["h"].call(n[o]["ctx"]);break;case 2:n[o]["h"].call(n[o]["ctx"],r[1]);break;case 3:n[o]["h"].call(n[o]["ctx"],r[1],r[2]);break;default:n[o]["h"].apply(n[o]["ctx"],r);break}if(n[o]["one"]){n.splice(o,1);a--}else{o++}}}return this}},{key:"dispatchWithContext",value:function e(t){if(this._handlers[t]){var r=arguments;var i=r.length;if(i>4){r=Array.prototype.slice.call(r,1,r.length-1)}var n=r[r.length-1];var a=this._handlers[t];var o=a.length;for(var s=0;s<o;){switch(i){case 1:a[s]["h"].call(n);break;case 2:a[s]["h"].call(n,r[1]);break;case 3:a[s]["h"].call(n,r[1],r[2]);break;default:a[s]["h"].apply(n,r);break}if(a[s]["one"]){a.splice(s,1);o--}else{s++}}}return this}}]);return e}();t.Eventful=u;s.Zondy.LevelRenderer.Eventful=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ThemeVector=undefined;var i=r(2);var n=b(i);var a=r(1);var o=b(a);var s=r(5);var l=b(s);var u=r(3);var f=b(u);var c=r(7);var h=b(c);var p=r(4);var d=b(p);var v=r(0);var y=r(6);var m=r(43);var g=r(118);var _=r(117);var x=r(73);function b(e){return e&&e.__esModule?e:{default:e}}var w=function(e){(0,d.default)(t,e);function t(e,r,i,a,s){(0,o.default)(this,t);var l=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r));if(!e.fGeom){return(0,f.default)(l)}l.dataBounds=e.bound;l.nodesClipPixel=2;l.isHoverAble=true;l.isMultiHover=true;l.isClickAble=true;l.highlightStyle=null;l.shapeOptions={};l.style=i||{};l.CLASS_NAME="Zondy.Theme.ThemeVector";l.style=i?i:{};if(a){(0,y.copyAttributesWithClip)(l,a,["shapeOptions","dataBounds"])}if(s){(0,y.copyAttributesWithClip)(l.shapeOptions,s)}var u=e.fGeom;l.lonlat=[(l.dataBounds.xmin+l.dataBounds.xmax)/2,(l.dataBounds.ymin+l.dataBounds.ymax)/2];l.location=l.getLocalXY(l.lonlat);switch(e.ftype){case 0:break;case 1:l.pointsToTF(e.fGeom.PntGeom);break;case 2:l.linesToTF(e.fGeom.LinGeom);break;case 3:l.regsToTF(e.fGeom.RegGeom);break}return l}(0,l.default)(t,[{key:"destroy",value:function e(){this.style=null;this.dataBounds=null;this.nodesClipPixel=null;this.isHoverAble=null;this.isMultiHover=null;this.isClickAble=null;this.highlightStyle=null;this.shapeOptions=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"pointsToTF",value:function e(t){if(t==null||t.length<=0){return}var r=t.components;var i=[];var n=[];var a=this.location;var o=[];var s=this.nodesClipPixel;for(var l=0;l<t.length;l++){var u=t[l];n=[];i=this.getLocalXY([u.Dot.x,u.Dot.y]);n[0]=i[0]-a[0];n[1]=i[1]-a[1];if(o.length>0){var f=o[o.length-1];if(Math.abs(f[0]-n[0])<=s&&Math.abs(f[1]-n[1])<=s){continue}}o.push(n);var c=new Object;c.r=6;c=(0,y.copyAttributesWithClip)(c,this.style);c.x=n[0];c.y=n[1];var h=new _.SmicPoint({style:c,clickable:this.isClickAble,hoverable:this.isHoverAble});if(this.highlightStyle){h.highlightStyle=this.highlightStyle}h.refOriginalPosition=a;h.refDataID=this.data.FID;h.isHoverByRefDataID=this.isMultiHover;if(this.shapeOptions){(0,y.copyAttributesWithClip)(h,this.shapeOptions)}this.shapes.push(h)}}},{key:"linesToTF",value:function e(t){if(t==null||t.length<=0){return}for(var r=0;r<t.length;r++){this.lineToTF(t[r])}}},{key:"lineToTF",value:function e(t){var r=[];if(t.Line!=null&&t.Line.Arcs!=null&&t.Line.Arcs.length>0){var i=t.Line.Arcs;for(var n=0;n<i.length;n++){var a=i[n].Dots;for(var o=0;o<a.length;o++){r.push([a[o].x,a[o].y])}}}if(r.length<=0){return}var s=[];var l=[];var u=this.location;var f=[];var c=this.nodesClipPixel;for(var n=0;n<r.length;n++){var h=r[n];l=[];s=this.getLocalXY(h);l[0]=s[0]-u[0];l[1]=s[1]-u[1];if(f.length>0){var p=f[f.length-1];if(Math.abs(p[0]-l[0])<=c&&Math.abs(p[1]-l[1])<=c){continue}}f.push(l)}if(f.length<2){return null}var d=new Object;d=(0,y.copyAttributesWithClip)(d,this.style,["pointList"]);d.pointList=f;var v=new g.SmicBrokenLine({style:d,clickable:this.isClickAble,hoverable:this.isHoverAble});if(this.highlightStyle){v.highlightStyle=this.highlightStyle}v.refOriginalPosition=this.location;v.refDataID=this.data.FID;v.isHoverByRefDataID=this.isMultiHover;if(this.shapeOptions){(0,y.copyAttributesWithClip)(v,this.shapeOptions)}this.shapes.push(v)}},{key:"regsToTF",value:function e(t){if(t==null||t.length<=0){return}for(var r=0;r<t.length;r++){this.regToTF(t[r])}}},{key:"regToTF",value:function e(t){var r=t.Rings;if(r==null||r.length<=0){return}var i=[];var n=[];var a=this.location;var o=[];var s=[];var l=[];var u=this.nodesClipPixel;for(var f=0;f<r.length;f++){if(f===0){o=[];if(r[f]!=null&&r[f].Arcs!=null&&r[f].Arcs.length>0){var c=r[f].Arcs;for(var h=0;h<c.length;h++){var p=c[h].Dots;for(var d=0;d<p.length;d++){n=[];i=this.getLocalXY([p[d].x,p[d].y]);n[0]=i[0]-a[0];n[1]=i[1]-a[1];if(o.length>0){var v=o[o.length-1];if(Math.abs(v[0]-n[0])<=u&&Math.abs(v[1]-n[1])<=u){continue}}o.push(n)}}}}else{s=[];if(r[f]!=null&&r[f].Arcs!=null&&r[f].Arcs.length>0){var c=r[f].Arcs;for(var h=0;h<c.length;h++){var p=c[h].Dots;for(var d=0;d<p.length;d++){n=[];i=this.getLocalXY([p[d].x,p[d].y]);n[0]=i[0]-a[0];n[1]=i[1]-a[1];if(s.length>0){var m=s[s.length-1];if(Math.abs(m[0]-n[0])<=u&&Math.abs(m[1]-n[1])<=u){continue}}s.push(n)}}}}if(s.length<2){continue}l.push(s)}if(o.length<2){return}var g={};g=(0,y.copyAttributesWithClip)(g,this.style,["pointList"]);g.pointList=o;var _=new x.SmicPolygon({style:g,clickable:this.isClickAble,hoverable:this.isHoverAble});if(this.highlightStyle){_.highlightStyle=this.highlightStyle}_.refOriginalPosition=this.location;_.refDataID=this.data.FID;_.isHoverByRefDataID=this.isMultiHover;if(l.length>0){_.holePolygonPointLists=l}if(this.shapeOptions){(0,y.copyAttributesWithClip)(_,this.shapeOptions)}this.shapes.push(_)}},{key:"updateAndAddShapes",value:function e(){var t=this.getLocalXY(this.lonlat);this.location=t;var r=this.layer.renderer;for(var i=0,n=this.shapes.length;i<n;i++){var a=this.shapes[i];a.refOriginalPosition=t;r.addShape(a)}}},{key:"getShapesCount",value:function e(){return this.shapes.length}},{key:"getLocalXY",value:function e(t){return this.layer.getLocalXY(t)}}]);return t}(m.Theme);t.ThemeVector=w;v.Zondy.Theme.ThemeVector=w},function(e,t,r){var i=r(53)("meta");var n=r(11);var a=r(34);var o=r(30).f;var s=0;var l=Object.isExtensible||function(){return true};var u=!r(44)(function(){return l(Object.preventExtensions({}))});var f=function(e){o(e,i,{value:{i:"O"+ ++s,w:{}}})};var c=function(e,t){if(!n(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!a(e,i)){if(!l(e))return"F";if(!t)return"E";f(e)}return e[i].i};var h=function(e,t){if(!a(e,i)){if(!l(e))return true;if(!t)return false;f(e)}return e[i].w};var p=function(e){if(u&&d.NEED&&l(e)&&!a(e,i))f(e);return e};var d=e.exports={KEY:i,NEED:false,fastKey:c,getWeak:h,onFreeze:p}},function(e,t){var r=0;var i=Math.random();e.exports=function(e){return"Symbol(".concat(e===undefined?"":e,")_",(++r+i).toString(36))}},function(e,t){e.exports=function(e){if(typeof e!="function")throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}},function(e,t,r){e.exports={default:r(231),__esModule:true}},function(e,t,r){var i=r(123);var n=r(80);e.exports=Object.keys||function e(t){return i(t,n)}},function(e,t,r){var i=r(76);e.exports=function(e){return Object(i(e))}},function(e,t,r){var i=r(30).f;var n=r(34);var a=r(14)("toStringTag");e.exports=function(e,t,r){if(e&&!n(e=r?e:e.prototype,a))i(e,a,{configurable:true,value:t})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CAttStruct=undefined;var i=r(0);var n=r(6);var a=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.FldNumber=r.FldNumber!==undefined?r.FldNumber:0;this.FldName=r.FldName!==undefined?r.FldName:null;this.FldType=r.FldType!==undefined?r.FldType:null};t.CAttStruct=a;i.Zondy.Object.CAttStruct=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CLineInfo=undefined;var i=r(0);var n=r(6);var a=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.Color=r.Color!==undefined&&r.Color!==null?r.Color:1;this.LinStyleID=r.LinStyleID!==undefined&&r.LinStyleID!==null?r.LinStyleID:1;this.LinStyleID2=r.LinStyleID2!==undefined&&r.LinStyleID2!==null?r.LinStyleID2:0;this.LinWidth=r.LinWidth!==undefined&&r.LinWidth!==null?r.LinWidth:1;this.Xscale=r.Xscale!==undefined&&r.Xscale!==null?r.Xscale:1;this.Yscale=r.Yscale!==undefined&&r.Yscale!==null?r.Yscale:1};t.CLineInfo=a;i.Zondy.Object.CLineInfo=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FeatureGraphicBase=undefined;var i=r(1);var n=u(i);var a=r(5);var o=u(a);var s=r(0);var l=r(6);function u(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t){(0,n.default)(this,e);var r=t!==undefined?t:{};(0,l.extend)(this,r);this.GID=r.GID!==undefined&&r.GID!==null?r.GID:0}(0,o.default)(e,[{key:"setGID",value:function e(t){if(t!==undefined&&t!==null){this.GID=t}}}]);return e}();t.FeatureGraphicBase=f;s.Zondy.Object.FeatureGraphicBase=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FeatureSet=undefined;var i=r(0);var n=r(6);var a=r(60);var o=r(144);var s=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.TotalCount=r.TotalCount!==undefined&&r.TotalCount!==null?r.TotalCount:0;this.AttStruct=r.AttStruct!==undefined&&r.AttStruct!==null?r.AttStruct:null;this.SFEleArray=r.SFEleArray!==undefined&&r.SFEleArray!==null?r.SFEleArray:new Array};s.prototype.clear=function(){this.AttStruct=null;this.SFEleArray=new Array};s.prototype.addFeature=function(e){if(e instanceof Array){this.SFEleArray.concat(e)}else{this.SFEleArray.push(e)}};s.prototype.getFeaturesLength=function(){if(this.SFEleArray instanceof Array){return this.SFEleArray.length}else{return 0}};s.prototype.getFeatureByIndex=function(e){if(e>=this.getFeaturesLength()){return null}else{var t=this.SFEleArray[e];if(t instanceof o.Feature){return t}else{return new o.Feature(this.SFEleArray[e])}}};s.prototype.getAttType=function(e){var t;if(this.AttStruct==null){return null}if(typeof e=="number"){t=e}else{t=this.getAttIndexByAttName(e)}if(t==null){return null}else{return this.AttStruct.FldType[t]}};s.prototype.getAttIndexByAttName=function(e){if(this.AttStruct==null){return null}if(this.AttStruct.FldName==null){return null}var t=this.AttStruct.FldName.length;for(var r=0;r<t;r++){if(this.AttStruct.FldName[r]==e){return r}}return null};s.prototype.getAttNameByIndex=function(e){if(this.AttStruct==null){return null}if(this.AttStruct.FldName==null){return null}if(this.AttStruct.FldName.length<=e){return null}return this.AttStruct.FldName[e]};t.FeatureSet=s;i.Zondy.Object.FeatureSet=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ClipBase=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(28);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.desInfo=r.desInfo!==undefined?r.desInfo:null;i.attOptType=r.attOptType!==undefined?r.attOptType:1;i.infoOptType=r.infoOptType!==undefined?r.infoOptType:1;i.overType=r.overType!==undefined?r.overType:3;i.tolerance=r.tolerance!==undefined?r.tolerance:1e-4;i.isCleanNode=r.isCleanNode!==undefined?r.isCleanNode:false;i.isLabelPnt=r.isLabelPnt!==undefined?r.isLabelPnt:false;i.isValidReg=r.isValidReg!==undefined?r.isValidReg:false;return i}return t}(h.AnalysisBase);t.ClipBase=d;c.Zondy.Service.ClipBase=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CPntInfo=undefined;var i=r(0);var n=r(6);var a=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.LibID=r.LibID!==undefined?r.LibID:0;this.Ovprnt=r.Ovprnt!==undefined?r.Ovprnt:false;this.Angle=r.Angle!==undefined?r.Angle:0;this.BackClr=r.BackClr!==undefined?r.BackClr:0;this.BackExp=r.BackExp!==undefined?r.BackExp:0;this.FillFlg=r.FillFlg!==undefined?r.FillFlg:0;this.Height=r.Height!==undefined?r.Height:0;this.Width=r.Width!==undefined?r.Width:0;this.OutClr=r.OutClr!==undefined?r.OutClr:[0,0,0];this.SymID=r.SymID!==undefined?r.SymID:0;this.OutPenW=r.OutPenW!==undefined?r.OutPenW:[.05,.05,.05]};t.CPntInfo=a;i.Zondy.Object.Theme.CPntInfo=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GeoFeatureThemeLayer=undefined;var i=r(2);var n=b(i);var a=r(1);var o=b(a);var s=r(5);var l=b(s);var u=r(3);var f=b(u);var c=r(4);var h=b(c);var p=r(25);var d=b(p);var v=r(0);var y=r(111);var m=r(6);var g=r(13);var _=r(51);var x=r(63);function b(e){return e&&e.__esModule?e:{default:e}}var w=function(e){(0,h.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r));i.name=null;i.style=null;i.highlightStyle=null;i.nodesClipPixel=2;i.isHoverAble=false;i.isMultiHover=false;i.isClickAble=true;i.isAllowFeatureStyle=false;(0,m.extend)(i,r);i.cache=r.cache||{};i.cacheFields=r.cacheFields||[];i.maxCacheCount=r.maxCacheCount||0;i.isCustomSetMaxCacheCount=r.isCustomSetMaxCacheCount===undefined?false:r.isCustomSetMaxCacheCount;return i}(0,l.default)(t,[{key:"addFeatures",value:function e(t){var r=this;window.mapboxgl.Evented.prototype.fire("beforefeaturesadded",{features:t});if(t instanceof x.FeatureSet){var i=null;var n=t.AttStruct;var a=t.SFEleArray;if(a!=null&&a.length>0){for(var o=0;o<a.length;o++){var s=a[o];if(s.AttValue!=null&&s.AttValue.length>0){var i={};for(var l=0;l<s.AttValue.length;l++){i[n.FldName[l]]=s.AttValue[l]}i["FID"]=s.FID}s.attributes=i;r.features.push(s)}}}if(!this.isCustomSetMaxCacheCount){this.maxCacheCount=this.features.length*5}if(this.renderer){this.redrawThematicFeatures(this.map.getBounds())}}},{key:"removeFeatures",value:function e(t){this.clearCache();y.ThemeLayer.prototype.removeFeatures.apply(this,arguments)}},{key:"removeAllFeatures",value:function e(){this.clearCache();y.ThemeLayer.prototype.removeAllFeatures.apply(this,arguments)}},{key:"redrawThematicFeatures",value:function e(t){this.clearCache();var r=this.renderer.getHoverOne();var i=null;if(r&&r.refDataID){i=r.refDataID}this.renderer.clearAll();var n=this.features;var a=this.cache;var o=this.cacheFields;var s=this.map.getZoom();var l=this.maxCacheCount;for(var u=0,f=n.length;u<f;u++){var c=n[u];var h=c.FID+"_zoom_"+s.toString();var p;if(a[h]){a[h].updateAndAddShapes()}else{p=this.createThematicFeature(n[u]);if(p.getShapesCount()<1){continue}a[h]=p;o.push(h);if(o.length>l){var d=o[0];o.splice(0,1);delete a[d]}}}this.renderer.render();if(i&&this.isHoverAble&&this.isMultiHover){var v=this.getShapesByFeatureID(i);this.renderer.updateHoverShapes(v)}}},{key:"createThematicFeature",value:function e(t){var r=(0,m.copyAttributesWithClip)(this.style);var i={};i.nodesClipPixel=this.nodesClipPixel;i.isHoverAble=this.isHoverAble;i.isMultiHover=this.isMultiHover;i.isClickAble=this.isClickAble;i.highlightStyle=g.ShapeFactory.transformStyle(this.highlightStyle);var n=new _.ThemeVector(t,this,g.ShapeFactory.transformStyle(r),i);for(var a=0;a<n.shapes.length;a++){this.renderer.addShape(n.shapes[a])}return n}},{key:"clearCache",value:function e(){this.cache={};this.cacheFields=[]}},{key:"clear",value:function e(){this.renderer.clearAll();this.renderer.refresh();this.removeAllFeatures();this.clearCache()}},{key:"getCacheCount",value:function e(){return this.cacheFields.length}},{key:"setMaxCacheCount",value:function e(t){if(!isNaN(t)){this.maxCacheCount=t;this.isCustomSetMaxCacheCount=true}}},{key:"getShapesByFeatureID",value:function e(t){var r=[];var i=this.renderer.getAllShapes();if(!t){return i}for(var n=0,a=i.length;n<a;n++){var o=i[n];if(o.refDataID&&t===o.refDataID){r.push(o)}}return r}}]);return t}(y.ThemeLayer);t.GeoFeatureThemeLayer=w;v.Zondy.Map.GeoFeatureThemeLayer=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Transformable=undefined;var i=r(1);var n=u(i);var a=r(5);var o=u(a);var s=r(0);var l=r(20);function u(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(){(0,n.default)(this,e);this.position=[0,0];this.rotation=[0,0,0];this.scale=[1,1,0,0];this.needLocalTransform=false;this.needTransform=false;this.CLASS_NAME="Zondy.LevelRenderer.Transformable";this.lookAt=function(){var e=l.SUtil.Util_vector.create();return function(t){if(!this.transform){this.transform=l.SUtil.Util_matrix.create()}var r=this.transform;l.SUtil.Util_vector.sub(e,t,this.position);if(i(e[0])&&i(e[1])){return}l.SUtil.Util_vector.normalize(e,e);r[2]=e[0]*this.scale[1];r[3]=e[1]*this.scale[1];r[0]=e[1]*this.scale[0];r[1]=-e[0]*this.scale[0];r[4]=this.position[0];r[5]=this.position[1];this.decomposeTransform();function i(e){var t=5e-5;return e>-t&&e<t}}}()}(0,o.default)(e,[{key:"destroy",value:function e(){this.position=null;this.rotation=null;this.scale=null;this.needLocalTransform=null;this.needTransform=null}},{key:"updateNeedTransform",value:function e(){this.needLocalTransform=t(this.rotation[0])||t(this.position[0])||t(this.position[1])||t(this.scale[0]-1)||t(this.scale[1]-1);function t(e){var t=5e-5;return e>t||e<-t}}},{key:"updateTransform",value:function e(){this.updateNeedTransform();if(this.parent){this.needTransform=this.needLocalTransform||this.parent.needTransform}else{this.needTransform=this.needLocalTransform}if(!this.needTransform){return}var t=[0,0];var r=this.transform||l.SUtil.Util_matrix.create();l.SUtil.Util_matrix.identity(r);if(this.needLocalTransform){if(a(this.scale[0])||a(this.scale[1])){t[0]=-this.scale[2]||0;t[1]=-this.scale[3]||0;var i=a(t[0])||a(t[1]);if(i){l.SUtil.Util_matrix.translate(r,r,t)}l.SUtil.Util_matrix.scale(r,r,this.scale);if(i){t[0]=-t[0];t[1]=-t[1];l.SUtil.Util_matrix.translate(r,r,t)}}if(this.rotation instanceof Array){if(this.rotation[0]!==0){t[0]=-this.rotation[1]||0;t[1]=-this.rotation[2]||0;var n=a(t[0])||a(t[1]);if(n){l.SUtil.Util_matrix.translate(r,r,t)}l.SUtil.Util_matrix.rotate(r,r,this.rotation[0]);if(n){t[0]=-t[0];t[1]=-t[1];l.SUtil.Util_matrix.translate(r,r,t)}}}else{if(this.rotation!==0){l.SUtil.Util_matrix.rotate(r,r,this.rotation)}}if(a(this.position[0])||a(this.position[1])){l.SUtil.Util_matrix.translate(r,r,this.position)}}this.transform=r;if(this.parent&&this.parent.needTransform){if(this.needLocalTransform){l.SUtil.Util_matrix.mul(this.transform,this.parent.transform,this.transform)}else{l.SUtil.Util_matrix.copy(this.transform,this.parent.transform)}}function a(e){var t=5e-5;return e>t||e<-t}}},{key:"setTransform",value:function e(t){if(this.needTransform){var r=this.transform;t.transform(r[0],r[1],r[2],r[3],r[4],r[5])}}},{key:"decomposeTransform",value:function e(){if(!this.transform){return}var t=this.transform;var r=t[0]*t[0]+t[1]*t[1];var i=this.position;var n=this.scale;var a=this.rotation;if(s(r-1)){r=Math.sqrt(r)}var o=t[2]*t[2]+t[3]*t[3];if(s(o-1)){o=Math.sqrt(o)}i[0]=t[4];i[1]=t[5];n[0]=r;n[1]=o;n[2]=n[3]=0;a[0]=Math.atan2(-t[1]/o,t[0]/r);a[1]=a[2]=0;function s(e){var t=5e-5;return e>t||e<-t}}}]);return e}();t.Transformable=f;s.Zondy.LevelRenderer.Transformable=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Curve=undefined;var i=r(1);var n=u(i);var a=r(5);var o=u(a);var s=r(0);var l=r(69);function u(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(){(0,n.default)(this,e);this.vector=new l.Vector;this.EPSILON=1e-4;this.THREE_SQRT=Math.sqrt(3);this.ONE_THIRD=1/3;this.CLASS_NAME="Zondy.LevelRenderer.Tool.Curve"}(0,o.default)(e,[{key:"isAroundZero",value:function e(t){return t>-this.EPSILON&&t<this.EPSILON}},{key:"isNotAroundZero",value:function e(t){return t>this.EPSILON||t<-this.EPSILON}},{key:"cubicAt",value:function e(t,r,i,n,a){var o=1-a;return o*o*(o*t+3*a*r)+a*a*(a*n+3*o*i)}},{key:"cubicDerivativeAt",value:function e(t,r,i,n,a){var o=1-a;return 3*(((r-t)*o+2*(i-r)*a)*o+(n-i)*a*a)}},{key:"cubicRootAt",value:function e(t,r,i,n,a,o){var s=n+3*(r-i)-t;var l=3*(i-r*2+t);var u=3*(r-t);var f=t-a;var c=l*l-3*s*u;var h=l*u-9*s*f;var p=u*u-3*l*f;var d=0;if(this.isAroundZero(c)&&this.isAroundZero(h)){if(this.isAroundZero(l)){o[0]=0}else{var v=-u/l;if(v>=0&&v<=1){o[d++]=v}}}else{var y=h*h-4*c*p;if(this.isAroundZero(y)){var m=h/c;var g=-l/s+m;var _=-m/2;if(g>=0&&g<=1){o[d++]=g}if(_>=0&&_<=1){o[d++]=_}}else if(y>0){var x=Math.sqrt(y);var b=c*l+1.5*s*(-h+x);var w=c*l+1.5*s*(-h-x);if(b<0){b=-Math.pow(-b,this.ONE_THIRD)}else{b=Math.pow(b,this.ONE_THIRD)}if(w<0){w=-Math.pow(-w,this.ONE_THIRD)}else{w=Math.pow(w,this.ONE_THIRD)}var S=(-l-(b+w))/(3*s);if(S>=0&&S<=1){o[d++]=S}}else{var C=(2*c*l-3*s*h)/(2*Math.sqrt(c*c*c));var T=Math.acos(C)/3;var P=Math.sqrt(c);var M=Math.cos(T);var I=(-l-2*P*M)/(3*s);var A=(-l+P*(M+this.THREE_SQRT*Math.sin(T)))/(3*s);var L=(-l+P*(M-this.THREE_SQRT*Math.sin(T)))/(3*s);if(I>=0&&I<=1){o[d++]=I}if(A>=0&&A<=1){o[d++]=A}if(L>=0&&L<=1){o[d++]=L}}}return d}},{key:"cubicExtrema",value:function e(t,r,i,n,a){var o=6*i-12*r+6*t;var s=9*r+3*n-3*t-9*i;var l=3*r-3*t;var u=0;if(this.isAroundZero(s)){if(this.isNotAroundZero(o)){var f=-l/o;if(f>=0&&f<=1){a[u++]=f}}}else{var c=o*o-4*s*l;if(this.isAroundZero(c)){a[0]=-o/(2*s)}else if(c>0){var h=Math.sqrt(c);var p=(-o+h)/(2*s);var d=(-o-h)/(2*s);if(p>=0&&p<=1){a[u++]=p}if(d>=0&&d<=1){a[u++]=d}}}return u}},{key:"cubicSubdivide",value:function e(t,r,i,n,a,o){var s=(r-t)*a+t;var l=(i-r)*a+r;var u=(n-i)*a+i;var f=(l-s)*a+s;var c=(u-l)*a+l;var h=(c-f)*a+f;o[0]=t;o[1]=s;o[2]=f;o[3]=h;o[4]=h;o[5]=c;o[6]=u;o[7]=n}},{key:"cubicProjectPoint",value:function e(t,r,i,n,a,o,s,l,u,f,c){var h=this.vector.create();var p=this.vector.create();var d=this.vector.create();var v;var y=.005;var m=Infinity;h[0]=u;h[1]=f;for(var g=0;g<1;g+=.05){p[0]=this.cubicAt(t,i,a,s,g);p[1]=this.cubicAt(r,n,o,l,g);var _=this.vector.distSquare(h,p);if(_<m){v=g;m=_}}m=Infinity;for(var x=0;x<32;x++){if(y<this.EPSILON){break}var b=v-y;var w=v+y;p[0]=this.cubicAt(t,i,a,s,b);p[1]=this.cubicAt(r,n,o,l,b);var S=this.vector.distSquare(p,h);if(b>=0&&S<m){v=b;m=S}else{d[0]=this.cubicAt(t,i,a,s,w);d[1]=this.cubicAt(r,n,o,l,w);var C=this.vector.distSquare(d,h);if(w<=1&&C<m){v=w;m=C}else{y*=.5}}}if(c){c[0]=this.cubicAt(t,i,a,s,v);c[1]=this.cubicAt(r,n,o,l,v)}return Math.sqrt(m)}},{key:"quadraticAt",value:function e(t,r,i,n){var a=1-n;return a*(a*t+2*n*r)+n*n*i}},{key:"quadraticDerivativeAt",value:function e(t,r,i,n){return 2*((1-n)*(r-t)+n*(i-r))}},{key:"quadraticRootAt",value:function e(t,r,i,n,a){var o=t-2*r+i;var s=2*(r-t);var l=t-n;var u=0;if(this.isAroundZero(o)){if(this.isNotAroundZero(s)){var f=-l/s;if(f>=0&&f<=1){a[u++]=f}}}else{var c=s*s-4*o*l;if(this.isAroundZero(c)){var h=-s/(2*o);if(h>=0&&h<=1){a[u++]=h}}else if(c>0){var p=Math.sqrt(c);var d=(-s+p)/(2*o);var v=(-s-p)/(2*o);if(d>=0&&d<=1){a[u++]=d}if(v>=0&&v<=1){a[u++]=v}}}return u}},{key:"quadraticExtremum",value:function e(t,r,i){var n=t+i-2*r;if(n===0){return.5}else{return(t-r)/n}}},{key:"quadraticProjectPoint",value:function e(t,r,i,n,a,o,s,l,u){var f=this.vector.create();var c=this.vector.create();var h=this.vector.create();var p;var d=.005;var v=Infinity;f[0]=s;f[1]=l;for(var y=0;y<1;y+=.05){c[0]=this.quadraticAt(t,i,a,y);c[1]=this.quadraticAt(r,n,o,y);var m=this.vector.distSquare(f,c);if(m<v){p=y;v=m}}v=Infinity;for(var g=0;g<32;g++){if(d<this.EPSILON){break}var _=p-d;var x=p+d;c[0]=this.quadraticAt(t,i,a,_);c[1]=this.quadraticAt(r,n,o,_);var b=this.vector.distSquare(c,f);if(_>=0&&b<v){p=_;v=b}else{h[0]=this.quadraticAt(t,i,a,x);h[1]=this.quadraticAt(r,n,o,x);var w=this.vector.distSquare(h,f);if(x<=1&&w<v){p=x;v=w}else{d*=.5}}}if(u){u[0]=this.quadraticAt(t,i,a,p);u[1]=this.quadraticAt(r,n,o,p)}return Math.sqrt(v)}}]);return e}();t.Curve=f;s.Zondy.LevelRenderer.Tool.Curve=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Vector=undefined;var i=r(1);var n=l(i);var a=r(5);var o=l(a);var s=r(0);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){(0,n.default)(this,e);this.ArrayCtor=typeof Float32Array==="undefined"?Array:Float32Array;this.CLASS_NAME="Zondy.LevelRenderer.Tool.Vector"}(0,o.default)(e,[{key:"create",value:function e(t,r){var i=this.ArrayCtor;var n=new i(2);n[0]=t||0;n[1]=r||0;return n}},{key:"copy",value:function e(t,r){t[0]=r[0];t[1]=r[1];return t}},{key:"set",value:function e(t,r,i){t[0]=r;t[1]=i;return t}},{key:"add",value:function e(t,r,i){t[0]=r[0]+i[0];t[1]=r[1]+i[1];return t}},{key:"scaleAndAdd",value:function e(t,r,i,n){t[0]=r[0]+i[0]*n;t[1]=r[1]+i[1]*n;return t}},{key:"sub",value:function e(t,r,i){t[0]=r[0]-i[0];t[1]=r[1]-i[1];return t}},{key:"len",value:function e(t){return Math.sqrt(this.lenSquare(t))}},{key:"lenSquare",value:function e(t){return t[0]*t[0]+t[1]*t[1]}},{key:"mul",value:function e(t,r,i){t[0]=r[0]*i[0];t[1]=r[1]*i[1];return t}},{key:"div",value:function e(t,r,i){t[0]=r[0]/i[0];t[1]=r[1]/i[1];return t}},{key:"dot",value:function e(t,r){return t[0]*r[0]+t[1]*r[1]}},{key:"scale",value:function e(t,r,i){t[0]=r[0]*i;t[1]=r[1]*i;return t}},{key:"normalize",value:function e(t,r){var i=this.len(r);if(i===0){t[0]=0;t[1]=0}else{t[0]=r[0]/i;t[1]=r[1]/i}return t}},{key:"distance",value:function e(t,r){return Math.sqrt((t[0]-r[0])*(t[0]-r[0])+(t[1]-r[1])*(t[1]-r[1]))}},{key:"distanceSquare",value:function e(t,r){return(t[0]-r[0])*(t[0]-r[0])+(t[1]-r[1])*(t[1]-r[1])}},{key:"negate",value:function e(t,r){t[0]=-r[0];t[1]=-r[1];return t}},{key:"lerp",value:function e(t,r,i,n){t[0]=r[0]+n*(i[0]-r[0]);t[1]=r[1]+n*(i[1]-r[1]);return t}},{key:"applyTransform",value:function e(t,r,i){var n=r[0];var a=r[1];t[0]=i[0]*n+i[2]*a+i[4];t[1]=i[1]*n+i[3]*a+i[5];return t}},{key:"min",value:function e(t,r,i){t[0]=Math.min(r[0],i[0]);t[1]=Math.min(r[1],i[1]);return t}},{key:"max",value:function e(t,r,i){t[0]=Math.max(r[0],i[0]);t[1]=Math.max(r[1],i[1]);return t}},{key:"length",value:function e(t){return this.len(t)}},{key:"lengthSquare",value:function e(t){return this.lenSquare(t)}},{key:"dist",value:function e(t,r){return this.distance(t,r)}},{key:"distSquare",value:function e(t,r){return this.distanceSquare(t,r)}}]);return e}();t.Vector=u;s.Zondy.LevelRenderer.Tool.Vector=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Point=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(7);var h=m(c);var p=r(4);var d=m(p);var v=r(0);var y=r(29);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,d.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r));i.x=!isNaN(e)?e:0;i.y=!isNaN(r)?r:0;i.r=6;i.CLASS_NAME="Zondy.Feature.ShapeParameters.Point";return i}(0,l.default)(t,[{key:"destroy",value:function e(){this.x=null;this.y=null;this.r=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}}]);return t}(y.ShapeParameters);t.Point=g;v.Zondy.Feature.ShapeParameters.Point=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Polygon=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(7);var h=m(c);var p=r(4);var d=m(p);var v=r(0);var y=r(29);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,d.default)(t,e);function t(e){(0,o.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));r.pointList=e;r.holePolygonPointLists=null;r.CLASS_NAME="Zondy.Feature.ShapeParameters.Polygon";return r}(0,l.default)(t,[{key:"destroy",value:function e(){this.pointList=null;this.holePolygonPointLists=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}}]);return t}(y.ShapeParameters);t.Polygon=g;v.Zondy.Feature.ShapeParameters.Polygon=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Sector=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(7);var h=m(c);var p=r(4);var d=m(p);var v=r(0);var y=r(29);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,d.default)(t,e);function t(e,r,i,a,s,l,u){(0,o.default)(this,t);var c=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i,a,s,l,u));c.x=!isNaN(e)?e:0;c.y=!isNaN(r)?r:0;c.r=!isNaN(i)?i:0;c.startAngle=!isNaN(a)?a:0;c.endAngle=!isNaN(s)?s:0;c.r0=!isNaN(l)?l:0;c.clockWise=u;c.CLASS_NAME="Zondy.Feature.ShapeParameters.Sector";return c}(0,l.default)(t,[{key:"destroy",value:function e(){this.x=null;this.y=null;this.r=null;this.startAngle=null;this.endAngle=null;this.r0=null;this.clockWise=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}}]);return t}(y.ShapeParameters);t.Sector=g;v.Zondy.Feature.ShapeParameters.Sector=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SmicPolygon=undefined;var i=r(2);var n=_(i);var a=r(1);var o=_(a);var s=r(5);var l=_(s);var u=r(3);var f=_(u);var c=r(7);var h=_(c);var p=r(4);var d=_(p);var v=r(0);var y=r(6);var m=r(16);var g=r(20);function _(e){return e&&e.__esModule?e:{default:e}}var x=function(e){(0,d.default)(t,e);function t(e){(0,o.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));r.type="smicpolygon";r.holePolygonPointLists=null;if(!r.refOriginalPosition||r.refOriginalPosition.length!==2){r.refOriginalPosition=[0,0]}r.CLASS_NAME="Zondy.LevelRenderer.Shape.SmicPolygon";return r}(0,l.default)(t,[{key:"destroy",value:function e(){this.type=null;this.holePolygonPointLists=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"brush",value:function e(t,r){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var i=this.style;if(r){i=this.getHighlightStyle(i,this.highlightStyle||{})}t.save();this.setContext(t,i);this.setTransform(t);var n=false;if(i.brushType==="fill"||i.brushType==="both"||typeof i.brushType==="undefined"){t.beginPath();if(i.lineType==="dashed"||i.lineType==="dotted"||i.lineType==="dot"||i.lineType==="dash"||i.lineType==="dashot"||i.lineType==="longdash"||i.lineType==="longdashdot"){this.buildPath(t,{lineType:"solid",lineWidth:i.lineWidth,pointList:i.pointList})}else{this.buildPath(t,i);n=true}t.closePath();this.setCtxGlobalAlpha(t,"fill",i);t.fill();this.setCtxGlobalAlpha(t,"reset",i)}if(i.lineWidth>0&&(i.brushType==="stroke"||i.brushType==="both")){if(!n){t.beginPath();this.buildPath(t,i)}this.setCtxGlobalAlpha(t,"stroke",i);t.stroke();this.setCtxGlobalAlpha(t,"reset",i)}this.drawText(t,i,this.style);var a=(0,y.cloneObject)(i);if(a.pointList){if(this.holePolygonPointLists&&this.holePolygonPointLists.length>0){var o=this.holePolygonPointLists;var s=o.length;for(var l=0;l<s;l++){var u=o[l];a.pointList=u;t.globalCompositeOperation="destination-out";n=false;if(a.brushType==="fill"||a.brushType==="both"||typeof a.brushType=="undefined"){t.beginPath();if(a.lineType==="dashed"||a.lineType==="dotted"||a.lineType==="dot"||a.lineType==="dash"||a.lineType==="dashot"||a.lineType==="longdash"||a.lineType==="longdashdot"){this.buildPath(t,{lineType:"solid",lineWidth:a.lineWidth,pointList:a.pointList})}else{this.buildPath(t,a);n=true}t.closePath();this.setCtxGlobalAlpha(t,"fill",a);t.fill();this.setCtxGlobalAlpha(t,"reset",a)}if(a.lineWidth>0&&(a.brushType==="stroke"||a.brushType==="both")){if(!n){t.beginPath();this.buildPath(t,a)}t.globalCompositeOperation="source-over";this.setCtxGlobalAlpha(t,"stroke",a);t.stroke();this.setCtxGlobalAlpha(t,"reset",a)}else{t.globalCompositeOperation="source-over"}}}}t.restore();return}},{key:"buildPath",value:function e(t,r){if(r.showShadow){t.shadowBlur=r.shadowBlur;t.shadowColor=r.shadowColor;t.shadowOffsetX=r.shadowOffsetX;t.shadowOffsetY=r.shadowOffsetY}if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var i=this.refOriginalPosition;var n=r.pointList;if(n.length<2){return}if(r.smooth&&r.smooth!=="spline"){var a=g.SUtil.SUtil_smoothBezier(n,r.smooth,true,r.smoothConstraint,i);t.moveTo(n[0][0]+i[0],n[0][1]+i[1]);var o;var s;var l;var u=n.length;for(var f=0;f<u;f++){o=a[f*2];s=a[f*2+1];l=[n[(f+1)%u][0]+i[0],n[(f+1)%u][1]+i[1]];t.bezierCurveTo(o[0],o[1],s[0],s[1],l[0],l[1])}}else{if(r.smooth==="spline"){n=g.SUtil.SUtil_smoothSpline(n,true,null,i)}if(!r.lineType||r.lineType==="solid"){t.moveTo(n[0][0]+i[0],n[0][1]+i[1]);for(var c=1;c<n.length;c++){t.lineTo(n[c][0]+i[0],n[c][1]+i[1])}t.lineTo(n[0][0]+i[0],n[0][1]+i[1])}else if(r.lineType==="dashed"||r.lineType==="dotted"||r.lineType==="dot"||r.lineType==="dash"||r.lineType==="longdash"){var h=r._dashLength||(r.lineWidth||1)*(r.lineType==="dashed"?5:1);r._dashLength=h;var p=r.lineWidth||1;var d=p;var v=p;if(r.lineType==="dashed"){d*=5;v*=5;if(r.lineCap&&r.lineCap!=="butt"){d-=p;v+=p}}if(r.lineType==="dotted"){if(r.lineCap&&r.lineCap!=="butt"){d=1;v+=p}}if(r.lineType==="dot"){v*=4;if(r.lineCap&&r.lineCap!=="butt"){d=1;v+=p}}if(r.lineType==="dash"){d*=4;v*=4;if(r.lineCap&&r.lineCap!=="butt"){d-=p;v+=p}}if(r.lineType==="longdash"){d*=8;v*=4;if(r.lineCap&&r.lineCap!=="butt"){d-=p;v+=p}}t.moveTo(n[0][0]+i[0],n[0][1]+i[1]);for(var y=1;y<n.length;y++){g.SUtil.SUtil_dashedLineTo(t,n[y-1][0]+i[0],n[y-1][1]+i[1],n[y][0]+i[0],n[y][1]+i[1],p,[d,v])}g.SUtil.SUtil_dashedLineTo(t,n[n.length-1][0]+i[0],n[n.length-1][1]+i[1],n[0][0]+i[0],n[0][1]+i[1],p,[d,v])}else if(r.lineType==="dashot"||r.lineType==="longdashdot"){var m=r._dashLength||(r.lineWidth||1)*(r.lineType==="dashed"?5:1);r._dashLength=m;var _=r.lineWidth||1;var x=_;var b=_;var w=_;var S=_;if(r.lineType==="dashot"){x*=4;b*=4;S*=4;if(r.lineCap&&r.lineCap!=="butt"){x-=_;b+=_;w=1;S+=_}}if(r.lineType==="longdashdot"){x*=8;b*=4;S*=4;if(r.lineCap&&r.lineCap!=="butt"){x-=_;b+=_;w=1;S+=_}}t.moveTo(n[0][0]+i[0],n[0][1]+i[1]);for(var C=1;C<n.length;C++){g.SUtil.SUtil_dashedLineTo(t,n[C-1][0]+i[0],n[C-1][1]+i[1],n[C][0]+i[0],n[C][1]+i[1],_,[x,b,w,S])}g.SUtil.SUtil_dashedLineTo(t,n[n.length-1][0]+i[0],n[n.length-1][1]+i[1],n[0][0]+i[0],n[0][1]+i[1],_,[x,b,w,S])}}return}},{key:"getRect",value:function e(t,r){var i;if(!r){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}i=this.refOriginalPosition}else{i=r}if(t.__rect){return t.__rect}var n=Number.MAX_VALUE;var a=Number.MIN_VALUE;var o=Number.MAX_VALUE;var s=Number.MIN_VALUE;var l=t.pointList;for(var u=0,f=l.length;u<f;u++){if(l[u][0]+i[0]<n){n=l[u][0]+i[0]}if(l[u][0]+i[0]>a){a=l[u][0]+i[0]}if(l[u][1]+i[1]<o){o=l[u][1]+i[1]}if(l[u][1]+i[1]>s){s=l[u][1]+i[1]}}var c;if(t.brushType==="stroke"||t.brushType==="fill"){c=t.lineWidth||1}else{c=0}t.__rect={x:Math.round(n-c/2),y:Math.round(o-c/2),width:a-n+c,height:s-o+c};return t.__rect}}]);return t}(m.Shape);t.SmicPolygon=x;v.Zondy.LevelRenderer.SmicPolygon=x},function(e,t,r){var i=r(11);var n=r(12).document;var a=i(n)&&i(n.createElement);e.exports=function(e){return a?n.createElement(e):{}}},function(e,t,r){var i=r(11);e.exports=function(e,t){if(!i(e))return e;var r,n;if(t&&typeof(r=e.toString)=="function"&&!i(n=r.call(e)))return n;if(typeof(r=e.valueOf)=="function"&&!i(n=r.call(e)))return n;if(!t&&typeof(r=e.toString)=="function"&&!i(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e){if(e==undefined)throw TypeError("Can't call method on  "+e);return e}},function(e,t){var r=Math.ceil;var i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:r)(e)}},function(e,t,r){var i=r(79)("keys");var n=r(53);e.exports=function(e){return i[e]||(i[e]=n(e))}},function(e,t,r){var i=r(8);var n=r(12);var a="__core-js_shared__";var o=n[a]||(n[a]={});(e.exports=function(e,t){return o[e]||(o[e]=t!==undefined?t:{})})("versions",[]).push({version:i.version,mode:r(47)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){e.exports={default:r(256),__esModule:true}},function(e,t,r){var i=r(83);var n=r(55);var a=r(36);var o=r(75);var s=r(34);var l=r(121);var u=Object.getOwnPropertyDescriptor;t.f=r(26)?u:function e(t,r){t=a(t);r=o(r,true);if(l)try{return u(t,r)}catch(e){}if(s(t,r))return n(!i.f.call(t,r),t[r])}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,r){e.exports={default:r(258),__esModule:true}},function(e,t,r){e.exports={default:r(263),__esModule:true}},function(e,t,r){var i=r(23);var n=r(122);var a=r(80);var o=r(78)("IE_PROTO");var s=function(){};var l="prototype";var u=function(){var e=r(74)("iframe");var t=a.length;var i="<";var n=">";var o;e.style.display="none";r(129).appendChild(e);e.src="javascript:";o=e.contentWindow.document;o.open();o.write(i+"script"+n+"document.F=Object"+i+"/script"+n);o.close();u=o.F;while(t--)delete u[l][a[t]];return u()};e.exports=Object.create||function e(t,r){var a;if(t!==null){s[l]=i(t);a=new s;s[l]=null;a[o]=t}else a=u();return r===undefined?a:n(a,r)}},function(e,t,r){"use strict";var i=r(267)(true);r(130)(String,"String",function(e){this._t=String(e);this._i=0},function(){var e=this._t;var t=this._i;var r;if(t>=e.length)return{value:undefined,done:true};r=i(e,t);this._i+=r.length;return{value:r,done:false}})},function(e,t,r){r(269);var i=r(12);var n=r(35);var a=r(48);var o=r(14)("toStringTag");var s=("CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,"+"DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,"+"MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,"+"SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,"+"TextTrackList,TouchList").split(",");for(var l=0;l<s.length;l++){var u=s[l];var f=i[u];var c=f&&f.prototype;if(c&&!c[o])n(c,o,u);a[u]=a.Array}},function(e,t,r){t.f=r(14)},function(e,t,r){var i=r(12);var n=r(8);var a=r(47);var o=r(89);var s=r(30).f;e.exports=function(e){var t=n.Symbol||(n.Symbol=a?{}:i.Symbol||{});if(e.charAt(0)!="_"&&!(e in t))s(t,e,{value:o.f(e)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.AnyLine=undefined;var i=r(0);var n=r(6);var a=function e(t,r){var i=r!==undefined?r:{};(0,n.extend)(this,i);this.Arcs=t!==undefined&&t!==null?t:null};t.AnyLine=a;i.Zondy.Object.AnyLine=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CPointInfo=undefined;var i=r(0);var n=r(6);var a=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.Angle=r.Angle!==undefined&&r.Angle!==null?r.Angle:1;this.Color=r.Color!==undefined&&r.Color!==null?r.Color:1;this.SymHeight=r.SymHeight!==undefined&&r.SymHeight!==null?r.SymHeight:1;this.SymID=r.SymID!==undefined&&r.SymID!==null?r.SymID:1;this.SymWidth=r.SymWidth!==undefined&&r.SymWidth!==null?r.SymWidth:1};t.CPointInfo=a;i.Zondy.Object.CPointInfo=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CRegionInfo=undefined;var i=r(0);var n=r(6);var a=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.EndColor=r.EndColor!==undefined&&r.EndColor!==null?r.EndColor:1;this.FillColor=r.FillColor!==undefined&&r.FillColor!==null?r.FillColor:1;this.FillMode=r.FillMode!==undefined&&r.FillMode!==null?r.FillMode:0;this.OutPenWidth=r.OutPenWidth!==undefined&&r.OutPenWidth!==null?r.OutPenWidth:1;this.PatAngle=r.PatAngle!==undefined&&r.PatAngle!==null?r.PatAngle:1;this.PatColor=r.PatColor!==undefined&&r.PatColor!==null?r.PatColor:1;this.PatHeight=r.PatHeight!==undefined&&r.PatHeight!==null?r.PatHeight:1;this.PatID=r.PatID!==undefined&&r.PatID!==null?r.PatID:1;this.PatWidth=r.PatWidth!==undefined&&r.PatWidth!==null?r.PatWidth:1};t.CRegionInfo=a;i.Zondy.Object.CRegionInfo=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Rectangle=undefined;var i=r(2);var n=d(i);var a=r(1);var o=d(a);var s=r(5);var l=d(s);var u=r(3);var f=d(u);var c=r(4);var h=d(c);var p=r(37);function d(e){return e&&e.__esModule?e:{default:e}}var v=function(e){(0,h.default)(t,e);function t(e,r,i,a,s){(0,o.default)(this,t);var l=s?s:{};var u=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,l));u.xmin=e;u.xmax=i;u.ymin=r;u.ymax=a;return u}(0,l.default)(t,[{key:"setByOL",value:function e(t){if(t===undefined||t===null){return}this.xmin=t[0];this.ymin=t[1];this.xmax=t[2];this.ymax=t[3]}},{key:"toString",value:function e(){return""+this.xmin+","+this.ymin+","+this.xmax+","+this.ymax}},{key:"getGeometryType",value:function e(){return"rect"}},{key:"convertToBound",value:function e(){var t=[this.xmin,this.ymin,this.xmax,this.ymax];return t}},{key:"intersectsBounds",value:function e(t,r){if(typeof r==="boolean"){r={inclusive:r}}r=r||{};if(r.inclusive===null){r.inclusive=true}var i=this;var n=false;var a=i.xmin===t.xmax||i.xmax===t.xmin||i.ymax===t.ymin||i.ymin===t.ymax;if(r.inclusive||!a){var o=t.ymin>=i.ymin&&t.ymin<=i.ymax||i.ymin>=t.ymin&&i.ymin<=t.ymax;var s=t.ymax>=i.ymin&&t.ymax<=i.ymax||i.ymax>t.ymin&&i.ymax<t.ymax;var l=t.xmin>=i.xmin&&t.xmin<=i.xmax||i.xmin>=t.xmin&&i.xmin<=t.xmax;var u=t.xmax>=i.xmin&&t.xmax<=i.xmax||i.xmax>=t.xmin&&i.xmax<=t.xmax;n=(o||s)&&(l||u)}return n}}]);return t}(p.Tangram);t.Rectangle=v;Zondy.Object.Rectangle=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GPoint=undefined;var i=r(2);var n=y(i);var a=r(1);var o=y(a);var s=r(5);var l=y(s);var u=r(3);var f=y(u);var c=r(4);var h=y(c);var p=r(0);var d=r(62);var v=r(19);function y(e){return e&&e.__esModule?e:{default:e}}var m=function(e){(0,h.default)(t,e);function t(e,r,i){(0,o.default)(this,t);var a=i?i:{};var s=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,a));if(e!==undefined&&e!==null&&r!==undefined&&r!==null){s.Dot=new v.Point2D(e,r)}return s}(0,l.default)(t,[{key:"setDot",value:function e(t){this.Dot=t!==undefined&&t!==null?t:null}}]);return t}(d.FeatureGraphicBase);t.GPoint=m;p.Zondy.Object.GPoint=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GLine=undefined;var i=r(2);var n=y(i);var a=r(1);var o=y(a);var s=r(5);var l=y(s);var u=r(3);var f=y(u);var c=r(4);var h=y(c);var p=r(0);var d=r(62);var v=r(91);function y(e){return e&&e.__esModule?e:{default:e}}var m=function(e){(0,h.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=r?r:{};var a=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,i));a.Line=e!==undefined&&e!==null?e:null;return a}(0,l.default)(t,[{key:"setLine",value:function e(t){this.Line=t!==undefined&&t!==null?t:null}}]);return t}(d.FeatureGraphicBase);t.GLine=m;p.Zondy.Object.GLine=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GRegion=undefined;var i=r(2);var n=y(i);var a=r(1);var o=y(a);var s=r(5);var l=y(s);var u=r(3);var f=y(u);var c=r(4);var h=y(c);var p=r(0);var d=r(62);var v=r(91);function y(e){return e&&e.__esModule?e:{default:e}}var m=function(e){(0,h.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=r?r:{};var a=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,i));a.Rings=e!==undefined&&e!==null&&Array.isArray(e)?e:null;return a}(0,l.default)(t,[{key:"setRings",value:function e(t){this.Rings=t!==undefined&&t!==null?t:null}}]);return t}(d.FeatureGraphicBase);t.GRegion=m;p.Zondy.Object.GRegion=m},function(e,t,r){var i=r(45);var n=r(309);var a=r(129);var o=r(74);var s=r(12);var l=s.process;var u=s.setImmediate;var f=s.clearImmediate;var c=s.MessageChannel;var h=s.Dispatch;var p=0;var d={};var v="onreadystatechange";var y,m,g;var _=function(){var e=+this;if(d.hasOwnProperty(e)){var t=d[e];delete d[e];t()}};var x=function(e){_.call(e.data)};if(!u||!f){u=function e(t){var r=[];var i=1;while(arguments.length>i)r.push(arguments[i++]);d[++p]=function(){n(typeof t=="function"?t:Function(t),r)};y(p);return p};f=function e(t){delete d[t]};if(r(46)(l)=="process"){y=function(e){l.nextTick(i(_,e,1))}}else if(h&&h.now){y=function(e){h.now(i(_,e,1))}}else if(c){m=new c;g=m.port2;m.port1.onmessage=x;y=i(g.postMessage,g,1)}else if(s.addEventListener&&typeof postMessage=="function"&&!s.importScripts){y=function(e){s.postMessage(e+"","*")};s.addEventListener("message",x,false)}else if(v in o("script")){y=function(e){a.appendChild(o("script"))[v]=function(){a.removeChild(this);_.call(e)}}}else{y=function(e){setTimeout(i(_,e,1),0)}}}e.exports={set:u,clear:f}},function(e,t,r){"use strict";var i=r(54);function n(e){var t,r;this.promise=new e(function(e,i){if(t!==undefined||r!==undefined)throw TypeError("Bad Promise constructor");t=e;r=i});this.resolve=i(t);this.reject=i(r)}e.exports.f=function(e){return new n(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.EditServiceBase=undefined;var i=r(2);var n=d(i);var a=r(1);var o=d(a);var s=r(3);var l=d(s);var u=r(4);var f=d(u);var c=r(0);var h=r(27);var p=r(6);function d(e){return e&&e.__esModule?e:{default:e}}var v=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.guid=r.guid!==undefined?r.guid:(0,p.newGuid)();i.baseUrl="igs/rest/mrfs";i.f=r.f!==undefined?r.f:"json";return i}return t}(h.ServiceBase);t.EditServiceBase=v;c.Zondy.Service.EditServiceBase=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.QueryParameter=undefined;var i=r(2);var n=y(i);var a=r(1);var o=y(a);var s=r(5);var l=y(s);var u=r(3);var f=y(u);var c=r(4);var h=y(c);var p=r(0);var d=r(6);var v=r(165);function y(e){return e&&e.__esModule?e:{default:e}}var m=function(e){(0,h.default)(t,e);function t(e){(0,o.default)(this,t);var r=e?e:{};return(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r))}(0,l.default)(t,[{key:"getParameterURL",value:function e(){var t="page="+this.pageIndex.toString();t+="&pageCount="+this.recordNumber.toString();t+="&f="+this.resultFormat;if(this.geometry){t+="&geometry="+this.geometry.toString();t+="&geometryType="+this.geometry.getGeometryType()}if(this.struct){t+="&structs="+(0,d.toJSON)(this.struct)}if(this.where){t+="&where="+this.where}if(this.rule){t+="&rule="+(0,d.toJSON)(this.rule)}if(this.objectIds){t+="&objectIds="+this.objectIds}if(this.orderField){t+="&orderField="+this.orderField}if(this.isAsc){t+="&isAsc="+this.isAsc}if(this.proj){t+="&srsIds="+this.proj}t+="&cursorType="+this.cursorType;return t}},{key:"getParameterObject",value:function e(){var t={};t.f=this.resultFormat;if(this.struct!==null){t.structs=this.struct.toJSON()}if(this.objectIds!==null){t.objectIds=this.objectIds;return t}t.page=this.pageIndex.toString();t.pageCount=this.recordNumber.toString();if(this.geometry!==null){t.geometry=this.geometry.toString();t.geometryType=this.geometry.getGeometryType()}if(this.where!==null){t.where=this.where}if(this.rule!==null){t.rule=this.rule.toJSON()}if(this.orderField!==null){t.orderField=this.orderField}if(this.isAsc!==null){t.isAsc=this.isAsc}t.cursorType=this.cursorType;return t}}]);return t}(v.QueryParameterBase);t.QueryParameter=m;p.Zondy.Service.QueryParameter=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.QueryFeatureStruct=undefined;var i=r(0);var n=r(6);var a=function e(t){var r=t?t:{};(0,n.extend)(this,r);this.IncludeAttribute=r.IncludeAttribute!==undefined&&typeof r.IncludeAttribute==="boolean"?r.IncludeAttribute:true;this.IncludeGeometry=r.IncludeGeometry!==undefined&&typeof r.IncludeGeometry==="boolean"?r.IncludeGeometry:false;this.IncludeWebGraphic=r.IncludeWebGraphic!==undefined&&typeof r.IncludeWebGraphic==="boolean"?r.IncludeWebGraphic:false};a.prototype.toJSON=function(){return(0,n.toJSON)(this)};t.QueryFeatureStruct=a;i.Zondy.Service.QueryFeatureStruct=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ClassBufferBase=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(28);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.srcInfo=r.srcInfo!==undefined?r.srcInfo:null;i.desInfo=r.desInfo!==undefined?r.desInfo:null;i.idstr=r.idstr!==undefined?r.idstr:"";i.angleType=r.angleType!==undefined?r.angleType:0;i.isDissolve=r.isDissolve!==undefined?r.isDissolve:true;i.isDynPrj=r.isDynPrj!==undefined?r.isDynPrj:false;return i}return t}(h.AnalysisBase);t.ClassBufferBase=d;c.Zondy.Service.ClassBufferBase=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FeatureBuffBase=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(28);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.sfGeometryXML=r.sfGeometryXML!==undefined?r.sfGeometryXML:null;i.attStrctXML=r.attStrctXML!==undefined?r.attStrctXML:null;i.attRowsXML=r.attRowsXML!==undefined?r.attRowsXML:null;i.traceRadius=r.traceRadius!==undefined?r.traceRadius:1e-4;i.resultName=r.resultName!==undefined?r.resultName:null;i.inFormat=r.inFormat!==undefined?r.inFormat:"json";return i}return t}(h.AnalysisBase);t.FeatureBuffBase=d;c.Zondy.Service.FeatureBuffBase=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.OverlayBase=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(28);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.srcInfo1=r.srcInfo1!==undefined?r.srcInfo1:null;i.desInfo=r.desInfo!==undefined?r.desInfo:null;i.attOptType=r.attOptType!==undefined?r.attOptType:1;i.infoOptType=r.infoOptType!==undefined?r.infoOptType:1;i.overType=r.overType!==undefined?r.overType:3;i.isCleanNode=r.isCleanNode!==undefined?r.isCleanNode:false;i.isLabelPnt=r.isLabelPnt!==undefined?r.isLabelPnt:false;i.isValidReg=r.isValidReg!==undefined?r.isValidReg:false;i.isReCalculate=r.isReCalculate!==undefined?r.isReCalculate:true;i.radius=r.radius!==undefined?r.radius:.001;return i}return t}(h.AnalysisBase);t.OverlayBase=d;c.Zondy.Service.OverlayBase=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ProjectBase=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(28);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.clsName=r.clsName!==undefined?r.clsName:null;i.desClsName=r.desClsName!==undefined?r.desClsName:null;i.resultName=r.resultName!==undefined?r.resultName:null;return i}return t}(h.AnalysisBase);t.ProjectBase=d;c.Zondy.Service.ProjectBase=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CalServiceBase=undefined;var i=r(9);var n=b(i);var a=r(2);var o=b(a);var s=r(1);var l=b(s);var u=r(5);var f=b(u);var c=r(3);var h=b(c);var p=r(4);var d=b(p);var v=r(0);var y=r(38);var m=r(19);var g=r(10);var _=r(108);var x=r(109);function b(e){return e&&e.__esModule?e:{default:e}}var w=function(e){(0,d.default)(t,e);function t(e){(0,l.default)(this,t);var r=e?e:{};var i=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,r));i.dots=r.dots!==undefined?r.dots:null;i.projectInfo=r.projectInfo!==undefined?r.projectInfo:null;i.projectInfoBySRSID=r.projectInfoBySRSID!==undefined?r.projectInfoBySRSID:null;return i}(0,f.default)(t,[{key:"execute",value:function e(t,r,i){if(t instanceof _.CProjectParam){this.projectInfo=t}if(t instanceof x.CProjectBySRSID){this.projectInfoBySrsID=t}var a={};a.Dots=this.dots;a.ProjectInfo=this.projectInfo;a.ProjectInfoBySrsID=this.projectInfoBySrsID;var o=this;var s=o.getFullUrl();var l=new g.IgsServiceBase(s,{eventListeners:{scope:o,processCompleted:r,processFailed:i}});l.processAsync({method:"POST",data:(0,n.default)(a),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}}]);return t}(y.GeometryAnalysisBase);t.CalServiceBase=w;v.Zondy.Service.CalServiceBase=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CProjectParam=undefined;var i=r(0);var n=r(6);var a=function e(t){var r=t?t:{};(0,n.extend)(this,r);this.ProjAngleUnit=r.ProjAngleUnit!==undefined?r.ProjAngleUnit:0;this.ProjLat=r.ProjLat!==undefined?r.ProjLat:0;this.ProjLat1=r.ProjLat1!==undefined?r.ProjLat1:0;this.ProjLat2=r.ProjLat2!==undefined?r.ProjLat2:0;this.ProjLon=r.ProjLon!==undefined?r.ProjLon:0;this.ProjRate=r.ProjRate!==undefined?r.ProjRate:0;this.ProjType=r.ProjType!==undefined?r.ProjType:0;this.ProjTypeID=r.ProjTypeID!==undefined?r.ProjTypeID:0;this.ProjUnit=r.ProjUnit!==undefined?r.ProjUnit:0;this.ProjZoneNO=r.ProjZoneNO!==undefined?r.ProjZoneNO:0;this.ProjZoneType=r.ProjZoneType!==undefined?r.ProjZoneType:0;this.SphereID=r.SphereID!==undefined?r.SphereID:0};t.CProjectParam=a;i.Zondy.Service.CProjectParam=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CProjectBySRSID=undefined;var i=r(0);var n=r(143);var a=function e(t,r){this.DesSrsID=t;this.GdbInfo=r};t.CProjectBySRSID=a;i.Zondy.Service.CProjectBySRSID=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FolderInfoAttribute=undefined;var i=r(0);var n=function e(t,r){this.name=t!==undefined?t:null;this.Value=r!==undefined?r:null};t.FolderInfoAttribute=n;i.Zondy.Object.Theme.FolderInfoAttribute=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ThemeLayer=undefined;var i=r(1);var n=p(i);var a=r(5);var o=p(a);var s=r(25);var l=p(s);var u=r(0);var f=r(191);var c=r(6);var h=r(135);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t,r){(0,n.default)(this,e);var i=r?r:{};this.name=t;this.id=i.id?i.id:(0,h.newGuid)();this.opacity=i.opacity?i.opacity:1;this.visibility=true;this.loadWhileAnimating=i.loadWhileAnimating===undefined?true:i.loadWhileAnimating;this.map=i.map?i.map:null;this.features=[];this.TFEvents=[];if(this.map){this.map.addLayer(this)}}(0,o.default)(e,[{key:"onAdd",value:function e(t){this.map=t;this._createCanvasContainer();this.addTFEvents();this.map.on("resize",this.resizeEvent.bind(this));this.map.on("zoomstart",this.zoomStartEvent.bind(this));this.map.on("zoomend",this.zoomEndEvent.bind(this));this.map.on("rotatestart",this.rotateStartEvent.bind(this));this.map.on("rotate",this.rotateEvent.bind(this));this.map.on("rotateend",this.rotateEndEvent.bind(this));this.map.on("dragend",this.dragEndEvent.bind(this));this.map.on("movestart",this.moveStartEvent.bind(this));this.map.on("move",this.moveEvent.bind(this));this.map.on("moveend",this.moveEndEvent.bind(this));this.map.on("remove",this.removeFromMap.bind(this));this.refresh()}},{key:"refresh",value:function e(){if(this.features.length===0){return}if(this.map){this.redrawThematicFeatures(this.map.getBounds())}}},{key:"_createCanvasContainer",value:function e(){this.movingOffset=[0,0];this.mapContainer=this.map.getCanvasContainer();this.div=document.createElement("div");this.div.id=this.id;this.div.style.position="absolute";var t=this.map.getCanvasContainer();var r=this.map.getCanvas();this.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px";this.div.style.width=r.style.width;this.div.style.height=r.style.height;this.div.className="themeLayer";this.div.width=parseInt(r.width);this.div.height=parseInt(r.height);t.appendChild(this.div);this.setOpacity(this.opacity);this.levelRenderer=new f.LevelRenderer;this.renderer=this.levelRenderer.init(this.div);this.renderer.clear()}},{key:"destroyFeatures",value:function e(t){var r=t===undefined;if(r){t=this.features}if(t){this.removeFeatures(t);for(var i=t.length-1;i>=0;i--){t[i].destroy()}}}},{key:"setVisibility",value:function e(t){if(t!==this.visibility){this.visibility=t;this.display(t);this.redrawThematicFeatures(this.map.getBounds())}}},{key:"display",value:function e(t){this.div.style.display=t?"block":"none"}},{key:"setOpacity",value:function e(t){if(t!==this.opacity){this.opacity=t;var r=this.div;(0,c.modifyDOMElement)(r,null,null,null,null,null,null,t);if(this.map!==null){window.mapboxgl.Evented.prototype.fire("changelayer",{layer:this,property:"opacity"})}}}},{key:"addFeatures",value:function e(t){}},{key:"removeFeatures",value:function e(t){if(!t||t.length===0){return}if(t===this.features){return this.removeAllFeatures()}if(!(0,c.isArray)(t)){t=[t]}var r=[];for(var i=t.length-1;i>=0;i--){var n=t[i];var a=(0,c.indexOf)(this.features,n);if(a===-1){r.push(n);continue}this.features.splice(a,1)}var o=[];for(var s=0,l=this.features.length;s<l;s++){n=this.features[s];o.push(n)}this.features=[];this.addFeatures(o);if(this.renderer){this.redrawThematicFeatures(this.map.getBounds())}var u=r.length===0?true:false;window.mapboxgl.Evented.prototype.fire("featuresremoved",{features:r,succeed:u})}},{key:"removeAllFeatures",value:function e(){if(this.renderer){this.renderer.clear()}this.features=[];window.mapboxgl.Evented.prototype.fire("featuresremoved",{features:[],succeed:true})}},{key:"getFeatures",value:function e(){var t=this.features.length;var r=new Array(t);for(var i=0;i<t;++i){r[i]=this.features[i]}return r}},{key:"getFeatureBy",value:function e(t,r){var i=null;for(var n in this.features){if(this.features[n][t]===r){i=this.features[n];break}}return i}},{key:"getFeatureById",value:function e(t){return this.getFeatureBy("FID",t)}},{key:"getFeaturesByAttribute",value:function e(t,r){var i,n=[];for(var a in this.features){i=this.features[a];if(i&&i.attributes){if(i.attributes[t]===r){n.push(i)}}}return n}},{key:"redrawThematicFeatures",value:function e(t){}},{key:"on",value:function e(t,r,i){if(this.renderer){this.renderer.on(t,r)}else{this.map.on(t,r)}return this}},{key:"off",value:function e(t,r,i){var n=this;if(n.renderer){n.renderer.off(t,r)}else{this.map.off(t,r)}return this}},{key:"addTFEvents",value:function e(){var t=this.TFEvents;var r=t.length;for(var i=0;i<r;i++){this.renderer.on(t[i][0],t[i][1])}}},{key:"WebMercator2lonLat",value:function e(t,r){var i=t/20037508.34*180;var n=r/20037508.34*180;n=180/Math.PI*(2*Math.atan(Math.exp(n*Math.PI/180))-Math.PI/2);return[i,n]}},{key:"lonLat2WebMercator",value:function e(t,r){var i=t*20037508.34/180;var n=Math.log(Math.tan((90+r)*Math.PI/360))/(Math.PI/180);n=n*20037508.34/180;return{x:i,y:n}}},{key:"getLocalXY",value:function e(t){var r,i=this.map;var n=null;if((0,c.isArray)(t)){t=this.WebMercator2lonLat(t[0],t[1]);n=i.project(t);r=[n.x,n.y]}return r}},{key:"moveEndEvent",value:function e(){if(this.loadWhileAnimating||!this.visibility){return}this.div.style.transform="";this.redrawThematicFeatures(this.map.getBounds());this._show()}},{key:"moveStartEvent",value:function e(){if(this.loadWhileAnimating||!this.visibility){return}this.startPitch=this.map.getPitch();this.startBearing=this.map.getBearing();var t=this.map.project(this.WebMercator2lonLat(0,0));this.startMoveX=t.x;this.startMoveY=t.y}},{key:"moveEvent",value:function e(){if(this.loadWhileAnimating||!this.visibility){this.redrawThematicFeatures(this.map.getBounds());return}if(this.rotating||this.zooming){return}if(this.map.getPitch()!==0){this._hide()}this.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px";var t=this.map.getPitch()-this.startPitch;var r=-this.map.getBearing()+this.startBearing;var i=this.map.project(this.WebMercator2lonLat(0,0));var n=i.x-this.startMoveX;var a=i.y-this.startMoveY;this.div.style.transform="rotateX("+t+"deg)"+" rotateZ("+r+"deg)"+" translate3d("+n+"px, "+a+"px, 0px)"}},{key:"zoomStartEvent",value:function e(){if(this.loadWhileAnimating||!this.visibility){return}this.zooming=true;this._hide()}},{key:"zoomEndEvent",value:function e(){if(this.loadWhileAnimating||!this.visibility){return}this.zooming=false;this._show()}},{key:"rotateStartEvent",value:function e(){if(this.loadWhileAnimating||!this.visibility){return}this.rotating=true}},{key:"rotateEvent",value:function e(){if(this.loadWhileAnimating||!this.visibility){return}if(this.map.getPitch()!==0){this._hide()}this.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px";var t=this.map.getPitch()-this.startPitch;var r=-this.map.getBearing()+this.startBearing;this.div.style.transform="rotateX("+t+"deg)"+" rotateZ("+r+"deg)"}},{key:"rotateEndEvent",value:function e(){if(this.loadWhileAnimating||!this.visibility){return}this.rotating=false;this._show()}},{key:"dragEndEvent",value:function e(){if(this.loadWhileAnimating||!this.visibility){return}this._hide()}},{key:"resizeEvent",value:function e(){this.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px";var t=this.map.getCanvas();this.div.style.width=t.style.width;this.div.style.height=t.style.height;this.div.width=parseInt(t.width);this.div.height=parseInt(t.height);this.renderer.resize()}},{key:"removeFromMap",value:function e(){this.mapContainer.removeChild(this.div);this.removeAllFeatures()}},{key:"moveTo",value:function e(t,r){var i=document.getElementById(this.div.id);r=r!==undefined?r:true;if(r){var n=document.getElementById(t);if(i&&n){n.parentNode.insertBefore(i,n)}return}var a=document.getElementById(t);if(i){if(a.nextSibling){a.parentNode.insertBefore(i,a.nextSibling);return}a.parentNode.appendChild(i)}}},{key:"_hide",value:function e(){this.renderer.painter.root.style.display="none"}},{key:"_show",value:function e(){this.renderer.painter.root.style.display="block"}}]);return e}();t.ThemeLayer=d;u.Zondy.Map.ThemeLayer=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Color=undefined;var i=r(1);var n=u(i);var a=r(5);var o=u(a);var s=r(0);var l=r(42);function u(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(){(0,n.default)(this,e);this.util=new l.Util;this._ctx=null;this.palette=["#ff9277"," #dddd00"," #ffc877"," #bbe3ff"," #d5ffbb","#bbbbff"," #ddb000"," #b0dd00"," #e2bbff"," #ffbbe3","#ff7777"," #ff9900"," #83dd00"," #77e3ff"," #778fff","#c877ff"," #ff77ab"," #ff6600"," #aa8800"," #77c7ff","#ad77ff"," #ff77ff"," #dd0083"," #777700"," #00aa00","#0088aa"," #8400dd"," #aa0088"," #dd0000"," #772e00"];this._palette=this.palette;this.highlightColor="rgba(0,0,255,1)";this._highlightColor=this.highlightColor;this.colorRegExp=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i;this._nameColors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#0ff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000",blanchedalmond:"#ffebcd",blue:"#00f",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#f0f",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#0f0",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#f0f",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#f00",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#fff",whitesmoke:"#f5f5f5",yellow:"#ff0",yellowgreen:"#9acd32"};this.CLASS_NAME="Zondy.LevelRenderer.Tool.Color"}(0,o.default)(e,[{key:"customPalette",value:function e(t){this.palette=t}},{key:"resetPalette",value:function e(){this.palette=this._palette}},{key:"getColor",value:function e(t,r){t=t|0;r=r||this.palette;return r[t%r.length]}},{key:"customHighlight",value:function e(t){this.highlightColor=t}},{key:"resetHighlight",value:function e(){this.highlightColor=this._highlightColor}},{key:"getHighlightColor",value:function e(){return this.highlightColor}},{key:"getRadialGradient",value:function e(t,r,i,n,a,o,s){var l=this.util;if(!this._ctx){this._ctx=l.getContext()}var u=this._ctx.createRadialGradient(t,r,i,n,a,o);for(var f=0,c=s.length;f<c;f++){u.addColorStop(s[f][0],s[f][1])}u.__nonRecursion=true;return u}},{key:"getLinearGradient",value:function e(t,r,i,n,a){var o=this.util;if(!this._ctx){this._ctx=o.getContext()}var s=this._ctx.createLinearGradient(t,r,i,n);for(var l=0,u=a.length;l<u;l++){s.addColorStop(a[l][0],a[l][1])}s.__nonRecursion=true;return s}},{key:"getStepColors",value:function e(t,r,i){t=this.toRGBA(t);r=this.toRGBA(r);t=this.getData(t);r=this.getData(r);var n=[];var a=(r[0]-t[0])/i;var o=(r[1]-t[1])/i;var s=(r[2]-t[2])/i;var l=(r[3]-t[3])/i;for(var u=0,f=t[0],c=t[1],h=t[2],p=t[3];u<i;u++){n[u]=this.toColor([this.adjust(Math.floor(f),[0,255]),this.adjust(Math.floor(c),[0,255]),this.adjust(Math.floor(h),[0,255]),p.toFixed(4)-0],"rgba");f+=a;c+=o;h+=s;p+=l}f=r[0];c=r[1];h=r[2];p=r[3];n[u]=this.toColor([f,c,h,p],"rgba");return n}},{key:"getGradientColors",value:function e(t,r){var i=[];var n=t.length;if(r===undefined){r=20}if(n===1){i=this.getStepColors(t[0],t[0],r)}else if(n>1){for(var a=0,o=n-1;a<o;a++){var s=this.getStepColors(t[a],t[a+1],r);if(a<o-1){s.pop()}i=i.concat(s)}}return i}},{key:"toColor",value:function e(t,r){r=r||"rgb";if(t&&(t.length===3||t.length===4)){t=this.map(t,function(e){return e>1?Math.ceil(e):e});if(r.indexOf("hex")>-1){return"#"+((1<<24)+(t[0]<<16)+(t[1]<<8)+ +t[2]).toString(16).slice(1)}else if(r.indexOf("hs")>-1){var i=this.map(t.slice(1,3),function(e){return e+"%"});t[1]=i[0];t[2]=i[1]}if(r.indexOf("a")>-1){if(t.length===3){t.push(1)}t[3]=this.adjust(t[3],[0,1]);return r+"("+t.slice(0,4).join(",")+")"}return r+"("+t.slice(0,3).join(",")+")"}}},{key:"toArray",value:function e(t){t=this.trim(t);if(t.indexOf("rgba")<0){t=this.toRGBA(t)}var r=[];var i=0;t.replace(/[\d.]+/g,function(e){if(i<3){e=e|0}else{e=+e}r[i++]=e});return r}},{key:"convert",value:function e(t,r){if(!this.isCalculableColor(t)){return t}var i=this.getData(t);var n=i[3];if(typeof n==="undefined"){n=1}if(t.indexOf("hsb")>-1){i=this._HSV_2_RGB(i)}else if(t.indexOf("hsl")>-1){i=this._HSL_2_RGB(i)}if(r.indexOf("hsb")>-1||r.indexOf("hsv")>-1){i=this._RGB_2_HSB(i)}else if(r.indexOf("hsl")>-1){i=this._RGB_2_HSL(i)}i[3]=n;return this.toColor(i,r)}},{key:"toRGBA",value:function e(t){return this.convert(t,"rgba")}},{key:"toRGB",value:function e(t){return this.convert(t,"rgb")}},{key:"toHex",value:function e(t){return this.convert(t,"hex")}},{key:"toHSVA",value:function e(t){return this.convert(t,"hsva")}},{key:"toHSV",value:function e(t){return this.convert(t,"hsv")}},{key:"toHSBA",value:function e(t){return this.convert(t,"hsba")}},{key:"toHSB",value:function e(t){return this.convert(t,"hsb")}},{key:"toHSLA",value:function e(t){return this.convert(t,"hsla")}},{key:"toHSL",value:function e(t){return this.convert(t,"hsl")}},{key:"toName",value:function e(t){for(var r in this._nameColors){if(this.toHex(this._nameColors[r])===this.toHex(t)){return r}}return null}},{key:"trim",value:function e(t){return String(t).replace(/\s+/g,"")}},{key:"normalize",value:function e(t){if(this._nameColors[t]){t=this._nameColors[t]}t=this.trim(t);t=t.replace(/hsv/i,"hsb");if(/^#[\da-f]{3}$/i.test(t)){t=parseInt(t.slice(1),16);var r=(t&3840)<<8;var i=(t&240)<<4;var n=t&15;t="#"+((1<<24)+(r<<4)+r+(i<<4)+i+(n<<4)+n).toString(16).slice(1)}return t}},{key:"lift",value:function e(t,r){if(!this.isCalculableColor(t)){return t}var i=r>0?1:-1;if(typeof r==="undefined"){r=0}r=Math.abs(r)>1?1:Math.abs(r);t=this.toRGB(t);var n=this.getData(t);for(var a=0;a<3;a++){if(i===1){n[a]=n[a]*(1-r)|0}else{n[a]=(255-n[a])*r+n[a]|0}}return"rgb("+n.join(",")+")"}},{key:"reverse",value:function e(t){if(!this.isCalculableColor(t)){return t}var r=this.getData(this.toRGBA(t));r=this.map(r,function(e){return 255-e});return this.toColor(r,"rgb")}},{key:"mix",value:function e(t,r,i){if(!this.isCalculableColor(t)||!this.isCalculableColor(r)){return t}if(typeof i==="undefined"){i=.5}i=1-this.adjust(i,[0,1]);var n=i*2-1;var a=this.getData(this.toRGBA(t));var o=this.getData(this.toRGBA(r));var s=a[3]-o[3];var l=((n*s===-1?n:(n+s)/(1+n*s))+1)/2;var u=1-l;var f=[];for(var c=0;c<3;c++){f[c]=a[c]*l+o[c]*u}var h=a[3]*i+o[3]*(1-i);h=Math.max(0,Math.min(1,h));if(a[3]===1&&o[3]===1){return this.toColor(f,"rgb")}f[3]=h;return this.toColor(f,"rgba")}},{key:"random",value:function e(){return"#"+Math.random().toString(16).slice(2,8)}},{key:"getData",value:function t(r){r=this.normalize(r);var i=r.match(this.colorRegExp);if(i===null){throw new Error("The color format error")}var n;var a;var o=[];var s;if(i[2]){n=i[2].replace("#","").split("");s=[n[0]+n[1],n[2]+n[3],n[4]+n[5]];o=this.map(s,function(t){return e.prototype.adjust.call(this,parseInt(t,16),[0,255])})}else if(i[4]){var l=i[4].split(",");a=l[3];s=l.slice(0,3);o=this.map(s,function(t){t=Math.floor(t.indexOf("%")>0?parseInt(t,0)*2.55:t);return e.prototype.adjust.call(this,t,[0,255])});if(typeof a!=="undefined"){o.push(this.adjust(parseFloat(a),[0,1]))}}else if(i[5]||i[6]){var u=(i[5]||i[6]).split(",");var f=parseInt(u[0],0)/360;var c=u[1];var h=u[2];a=u[3];o=this.map([c,h],function(t){return e.prototype.adjust.call(this,parseFloat(t)/100,[0,1])});o.unshift(f);if(typeof a!=="undefined"){o.push(this.adjust(parseFloat(a),[0,1]))}}return o}},{key:"alpha",value:function e(t,r){if(!this.isCalculableColor(t)){return t}if(r===null){r=1}var i=this.getData(this.toRGBA(t));i[3]=this.adjust(Number(r).toFixed(4),[0,1]);return this.toColor(i,"rgba")}},{key:"map",value:function e(t,r){if(typeof r!=="function"){throw new TypeError}var i=t?t.length:0;for(var n=0;n<i;n++){t[n]=r(t[n])}return t}},{key:"adjust",value:function e(t,r){if(t<=r[0]){t=r[0]}else if(t>=r[1]){t=r[1]}return t}},{key:"isCalculableColor",value:function e(t){return t instanceof Array||typeof t==="string"}},{key:"_HSV_2_RGB",value:function e(t){var r=t[0];var i=t[1];var n=t[2];var a;var o;var s;if(i===0){a=n*255;o=n*255;s=n*255}else{var l=r*6;if(l===6){l=0}var u=l|0;var f=n*(1-i);var c=n*(1-i*(l-u));var h=n*(1-i*(1-(l-u)));var p=0;var d=0;var v=0;if(u===0){p=n;d=h;v=f}else if(u===1){p=c;d=n;v=f}else if(u===2){p=f;d=n;v=h}else if(u===3){p=f;d=c;v=n}else if(u===4){p=h;d=f;v=n}else{p=n;d=f;v=c}a=p*255;o=d*255;s=v*255}return[a,o,s]}},{key:"_HSL_2_RGB",value:function e(t){var r=t[0];var i=t[1];var n=t[2];var a;var o;var s;if(i===0){a=n*255;o=n*255;s=n*255}else{var l;if(n<.5){l=n*(1+i)}else{l=n+i-i*n}var u=2*n-l;a=255*this._HUE_2_RGB(u,l,r+1/3);o=255*this._HUE_2_RGB(u,l,r);s=255*this._HUE_2_RGB(u,l,r-1/3)}return[a,o,s]}},{key:"_HUE_2_RGB",value:function e(t,r,i){if(i<0){i+=1}if(i>1){i-=1}if(6*i<1){return t+(r-t)*6*i}if(2*i<1){return r}if(3*i<2){return t+(r-t)*(2/3-i)*6}return t}},{key:"_RGB_2_HSB",value:function e(t){var r=t[0]/255;var i=t[1]/255;var n=t[2]/255;var a=Math.min(r,i,n);var o=Math.max(r,i,n);var s=o-a;var l=o;var u;var f;if(s===0){u=0;f=0}else{f=s/o;var c=((o-r)/6+s/2)/s;var h=((o-i)/6+s/2)/s;var p=((o-n)/6+s/2)/s;if(r===o){u=p-h}else if(i===o){u=1/3+c-p}else if(n===o){u=2/3+h-c}if(u<0){u+=1}if(u>1){u-=1}}u=u*360;f=f*100;l=l*100;return[u,f,l]}},{key:"_RGB_2_HSL",value:function e(t){var r=t[0]/255;var i=t[1]/255;var n=t[2]/255;var a=Math.min(r,i,n);var o=Math.max(r,i,n);var s=o-a;var l=(o+a)/2;var u;var f;if(s===0){u=0;f=0}else{if(l<.5){f=s/(o+a)}else{f=s/(2-o-a)}var c=((o-r)/6+s/2)/s;var h=((o-i)/6+s/2)/s;var p=((o-n)/6+s/2)/s;if(r===o){u=p-h}else if(i===o){u=1/3+c-p}else if(n===o){u=2/3+h-c}if(u<0){u+=1}if(u>1){u-=1}}u=u*360;f=f*100;l=l*100;return[u,f,l]}}]);return e}();t.Color=f;s.Zondy.LevelRenderer.Tool.Color=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Config=undefined;var i=r(1);var n=o(i);var a=r(0);function o(e){return e&&e.__esModule?e:{default:e}}var s=function e(){(0,n.default)(this,e)};s.EVENT={RESIZE:"resize",CLICK:"click",DBLCLICK:"dblclick",MOUSEWHEEL:"mousewheel",MOUSEMOVE:"mousemove",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",GLOBALOUT:"globalout",DRAGSTART:"dragstart",DRAGEND:"dragend",DRAGENTER:"dragenter",DRAGOVER:"dragover",DRAGLEAVE:"dragleave",DROP:"drop",touchClickDelay:300};s.catchBrushException=false;s.debugMode=0;t.Config=s;a.Zondy.LevelRenderer.Config=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SmicImage=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(7);var h=m(c);var p=r(4);var d=m(p);var v=r(0);var y=r(16);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,d.default)(t,e);function t(e){(0,o.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));r.type="smicimage";r._imageCache={};if(!r.refOriginalPosition||r.refOriginalPosition.length!==2){r.refOriginalPosition=[0,0]}r.CLASS_NAME="Zondy.LevelRenderer.Shape.SmicImage";return r}(0,l.default)(t,[{key:"destroy",value:function e(){this.type=null;this._imageCache=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"brush",value:function e(r,i,n){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var a=this.refOriginalPosition;var o=this.style||{};if(i){o=this.getHighlightStyle(o,this.highlightStyle||{})}var s=o.image;var l=this;if(typeof s==="string"){var u=s;if(this._imageCache[u]){s=this._imageCache[u]}else{s=new Image;s.onload=function(){s.onload=null;clearTimeout(t._refreshTimeout);t._needsRefresh.push(l);t._refreshTimeout=setTimeout(function(){n&&n(t._needsRefresh);t._needsRefresh=[]},10)};s.src=u;this._imageCache[u]=s}}if(s){if(s.nodeName.toUpperCase()==="IMG"){if(window.ActiveXObject){if(s.readyState!=="complete"){return}}else{if(!s.complete){return}}}var f=o.width||s.width;var c=o.height||s.height;var h=o.x+a[0];var p=o.y+a[1];if(!s.width||!s.height){return}r.save();this.doClip(r);this.setContext(r,o);this.setTransform(r);if(o.sWidth&&o.sHeight){var d=o.sx+a[0]||0;var v=o.sy+a[1]||0;r.drawImage(s,d,v,o.sWidth,o.sHeight,h,p,f,c)}else if(o.sx&&o.sy){var y=o.sx+a[0];var m=o.sy+a[1];var g=f-y;var _=c-m;r.drawImage(s,y,m,g,_,h,p,f,c)}else{r.drawImage(s,h,p,f,c)}if(!o.width){o.width=f}if(!o.height){o.height=c}if(!this.style.width){this.style.width=f}if(!this.style.height){this.style.height=c}this.drawText(r,o,this.style);r.restore()}}},{key:"getRect",value:function e(t){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var r=this.refOriginalPosition;return{x:t.x+r[0],y:t.y+r[1],width:t.width,height:t.height}}},{key:"clearCache",value:function e(){this._imageCache={}}}]);return t}(y.Shape);g._needsRefresh=[];g._refreshTimeout=null;t.SmicImage=g;v.Zondy.LevelRenderer.SmicImage=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Line=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(7);var h=m(c);var p=r(4);var d=m(p);var v=r(0);var y=r(29);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,d.default)(t,e);function t(e){(0,o.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));r.pointList=e;r.CLASS_NAME="Zondy.Feature.ShapeParameters.Line";return r}(0,l.default)(t,[{key:"destroy",value:function e(){this.pointList=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}}]);return t}(y.ShapeParameters);t.Line=g;v.Zondy.Feature.ShapeParameters.Line=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Circle=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(7);var h=m(c);var p=r(4);var d=m(p);var v=r(0);var y=r(29);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,d.default)(t,e);function t(e,r,i){(0,o.default)(this,t);var a=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i));a.x=!isNaN(e)?e:0;a.y=!isNaN(r)?r:0;a.r=!isNaN(i)?i:0;a.CLASS_NAME="Zondy.Feature.ShapeParameters.Circle";return a}(0,l.default)(t,[{key:"destroy",value:function e(){this.x=null;this.y=null;this.r=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}}]);return t}(y.ShapeParameters);t.Circle=g;v.Zondy.Feature.ShapeParameters.Circle=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SmicPoint=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(7);var h=m(c);var p=r(4);var d=m(p);var v=r(0);var y=r(16);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,d.default)(t,e);function t(e){(0,o.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));r.type="smicpoint";if(!r.refOriginalPosition||r.refOriginalPosition.length!==2){r.refOriginalPosition=[0,0]}r.CLASS_NAME="Zondy.LevelRenderer.Shape.SmicPoint";return r}(0,l.default)(t,[{key:"destroy",value:function e(){this.type=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"buildPath",value:function e(t,r){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var i=this.refOriginalPosition;t.arc(r.x+i[0],r.y+i[1],r.r,0,Math.PI*2,true);return}},{key:"getRect",value:function e(t){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var r=this.refOriginalPosition;if(t.__rect){return t.__rect}var i;if(t.brushType==="stroke"||t.brushType==="fill"){i=t.lineWidth||1}else{i=0}t.__rect={x:Math.round(t.x+r[0]-t.r-i/2),y:Math.round(t.y+r[1]-t.r-i/2),width:t.r*2+i,height:t.r*2+i};return t.__rect}}]);return t}(y.Shape);t.SmicPoint=g;v.Zondy.LevelRenderer.SmicPoint=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SmicBrokenLine=undefined;var i=r(2);var n=_(i);var a=r(1);var o=_(a);var s=r(5);var l=_(s);var u=r(3);var f=_(u);var c=r(7);var h=_(c);var p=r(4);var d=_(p);var v=r(0);var y=r(16);var m=r(73);var g=r(20);function _(e){return e&&e.__esModule?e:{default:e}}var x=function(e){(0,d.default)(t,e);function t(e){(0,o.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));r.brushTypeOnly="stroke";r.textPosition="end";r.type="smicbroken-line";if(!r.refOriginalPosition||r.refOriginalPosition.length!==2){r.refOriginalPosition=[0,0]}r.CLASS_NAME="Zondy.LevelRenderer.Shape.SmicBrokenLine";return r}(0,l.default)(t,[{key:"destroy",value:function e(){this.brushTypeOnly=null;this.textPosition=null;this.type=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"buildPath",value:function e(t,r){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var i=this.refOriginalPosition;var n=r.pointList;if(n.length<2){return}var a=Math.min(r.pointList.length,Math.round(r.pointListLength||r.pointList.length));if(r.smooth&&r.smooth!=="spline"){var o=g.SUtil.SUtil_smoothBezier(n,r.smooth,false,r.smoothConstraint,i);t.moveTo(n[0][0]+i[0],n[0][1]+i[1]);var s;var l;var u;for(var f=0;f<a-1;f++){s=o[f*2];l=o[f*2+1];u=[n[f+1][0]+i[0],n[f+1][1]+i[1]];t.bezierCurveTo(s[0],s[1],l[0],l[1],u[0],u[1])}}else{if(r.smooth==="spline"){n=g.SUtil.SUtil_smoothSpline(n,null,null,i);a=n.length}if(!r.lineType||r.lineType==="solid"){t.moveTo(n[0][0]+i[0],n[0][1]+i[1]);for(var c=1;c<a;c++){t.lineTo(n[c][0]+i[0],n[c][1]+i[1])}}else if(r.lineType==="dashed"||r.lineType==="dotted"||r.lineType==="dot"||r.lineType==="dash"||r.lineType==="longdash"){var h=r.lineWidth||1;var p=h;var d=h;if(r.lineType==="dashed"){p*=5;d*=5;if(r.lineCap&&r.lineCap!=="butt"){p-=h;d+=h}}if(r.lineType==="dotted"){if(r.lineCap&&r.lineCap!=="butt"){p=1;d+=h}}if(r.lineType==="dot"){d*=4;if(r.lineCap&&r.lineCap!=="butt"){p=1;d+=h}}if(r.lineType==="dash"){p*=4;d*=4;if(r.lineCap&&r.lineCap!=="butt"){p-=h;d+=h}}if(r.lineType==="longdash"){p*=8;d*=4;if(r.lineCap&&r.lineCap!=="butt"){p-=h;d+=h}}t.moveTo(n[0][0]+i[0],n[0][1]+i[1]);for(var v=1;v<a;v++){g.SUtil.SUtil_dashedLineTo(t,n[v-1][0]+i[0],n[v-1][1]+i[1],n[v][0]+i[0],n[v][1]+i[1],h,[p,d])}}else if(r.lineType==="dashot"||r.lineType==="longdashdot"){var y=r.lineWidth||1;var m=y;var _=y;var x=y;var b=y;if(r.lineType==="dashot"){m*=4;_*=4;b*=4;if(r.lineCap&&r.lineCap!=="butt"){m-=y;_+=y;x=1;b+=y}}if(r.lineType==="longdashdot"){m*=8;_*=4;b*=4;if(r.lineCap&&r.lineCap!=="butt"){m-=y;_+=y;x=1;b+=y}}y=(r.lineWidth||1)*(r.lineType==="dashed"?5:1);t.moveTo(n[0][0]+i[0],n[0][1]+i[1]);for(var w=1;w<a;w++){g.SUtil.SUtil_dashedLineTo(t,n[w-1][0]+i[0],n[w-1][1]+i[1],n[w][0]+i[0],n[w][1]+i[1],y,[m,_,x,b])}}}return}},{key:"getRect",value:function e(t){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var r=this.refOriginalPosition;return m.SmicPolygon.prototype.getRect.apply(this,[t,r])}}]);return t}(y.Shape);t.SmicBrokenLine=x;v.Zondy.LevelRenderer.SmicBrokenLine=x},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Theme3DLayer=undefined;var i=r(1);var n=f(i);var a=r(5);var o=f(a);var s=r(21);var l=r(0);var u=r(6);function f(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r){(0,n.default)(this,e);this.id=t;this.map=null;this.opacity=1;this.parseNumber=false;this.enableHighlight=false;this.highlight={color:"#ADA91E"};this.baseHeightField=null;this.height=null;this.heightField="height";this.themeField=this.heightField;this.showLegend=true;this.legendTitle=null;this.legendTheme="light";this.legendOrientation="horizontal";this.legendPosition="bottom-right";this.mousemoveOn=true;(0,u.extend)(this,r)}(0,o.default)(e,[{key:"setLayerOptions",value:function e(t){(0,u.extend)(this,t);return this}},{key:"setHighlightStyleOptions",value:function e(t){(0,u.extend)(this.highlight,t);return this}},{key:"setData",value:function e(t,r){var i=this;i.data=t;if(r!=null){i.parseNumber=r}i.parseNumber&&i.data&&i.data.features&&i.data.features.map(function(e){if(i.baseHeightField&&e.properties[i.baseHeightField]){e.properties[i.baseHeightField]=parseFloat(e.properties[i.baseHeightField])}if(i.heightField&&e.properties[i.heightField]){e.properties[i.heightField]=parseFloat(e.properties[i.heightField])}return e});return this}},{key:"WebMercator2lonLat",value:function e(t,r){var i=t/20037508.34*180;var n=r/20037508.34*180;n=180/Math.PI*(2*Math.atan(Math.exp(n*Math.PI/180))-Math.PI/2);return[i,n]}},{key:"convertData",value:function e(t){if(t!=null&&t.features!=null&&t.features.length>0){for(var r=0;r<t.features.length;r++){var i=t.features[r].geometry;if(i!=null&&i.coordinates!=null&&i.coordinates.length>0){if(i.type=="Polygon"){var n=i.coordinates;for(var a=0;a<n.length;a++){var o=n[a];if(o!=null&&o.length>0){for(var s=0;s<o.length;s++){t.features[r].geometry.coordinates[a][s]=this.WebMercator2lonLat(o[s][0],o[s][1])}}}}else if(i.type=="MultiPolygon"){var l=i.coordinates;for(var u=0;u<l.length;u++){var f=l[u];if(f!=null&&f.length>0){for(var a=0;a<f.length;a++){var o=f[a];if(o!=null&&o.length>0){for(var s=0;s<o.length;s++){t.features[r].geometry.coordinates[u][a][s]=this.WebMercator2lonLat(o[s][0],o[s][1])}}}}}}}}}return t}},{key:"getData",value:function e(){return this.data}},{key:"addTo",value:function e(t){this.map=t;if(!this.map){return this}this.show();return this}},{key:"show",value:function e(t){(0,u.extend)(this,t);this._addLayer();if(this.enableHighlight){this._addHighLightLayer()}if(this.showLegend){if(!this.legend){this.legend=this._createLegendControl()}this.map.addControl(this.legend,this.legendPosition)}return this}},{key:"remove",value:function e(){if(!this.map){return this}var t=this;t.mousemoveOn=false;var r=this.id?this.id:"theme3DLayer";if(this.map.getLayer(r)){this.map.removeLayer(r)}var i="highlightLayer";if(this.map.getLayer(i)){this.map.removeLayer(i)}if(this.legend){this.map.removeControl(this.legend)}return this}},{key:"getLayerStyleOptions",value:function e(){}},{key:"getHighlightStyleOptions",value:function e(){}},{key:"_createLegendControl",value:function e(t){var r=this;function i(){}i.prototype.onAdd=function(e){this._map=e;this._container=document.createElement("div");var i="mapboxgl-ctrl legend ";var n="legend-light";if(r.legendTheme==="dark"){n="legend-dark"}var a=" legend-horizontal";if(r.legendOrientation==="vertical"){a=" legend-vertical"}this._container.className=i+n+a;if(t){this._container.innerHTML=t}else{var o=r.legendTitle||"";var s=" <div class='legend-title'>"+o+"</div>";var l=r._createLegendElement.call(r)||"";var u="<div class='legend-content'>"+l+"</div>";this._container.innerHTML=s+u}r._appendLegendCSSStyle();return this._container};i.prototype.onRemove=function(){this._container.parentNode.removeChild(this._container);this._map=undefined};return new i}},{key:"_createLegendElement",value:function e(){}},{key:"_addLayer",value:function e(){var t=this.getLayerStyleOptions();var r=this.id?this.id:"theme3DLayer";this.id=r;var i=this.sourceId=r+"Source";if(!!this.map.getSource(i)){this.map.removeSource(i)}this.map.addSource(i,{type:"geojson",data:this.data});if(!!this.map.getLayer(r)){this.map.removeLayer(r)}this.map.addLayer({id:r,type:"fill-extrusion",source:i,paint:t});this.map.moveLayer(r)}},{key:"_addHighLightLayer",value:function e(){if(!this.map){return}var t=this.map;if(t.getSource("highlight")){t.removeSource("highlight")}t.addSource("highlight",{type:"geojson",data:{type:"FeatureCollection",features:[]}});if(!!t.getLayer("highlightLayer")){t.removeLayer("highlightLayer")}t.addLayer({id:"highlightLayer",type:"fill-extrusion",source:"highlight",paint:this.getHighlightStyleOptions()});var r=this;var i;t.on("mousemove",function(e){if(!r.mousemoveOn){return}r.mousemoveOn=true;var t=document.querySelector(".mapboxgl-canvas-container.mapboxgl-interactive");t.style.cursor="auto";var n=r.map.queryRenderedFeatures(e.point,{layers:[r.id]});if(r.highlight&&r.highlight.callback){r.highlight.callback(n,e)}if(!n||n.length<1){r._clearHighlight.call(r);return}var a=n[0].properties.fid;if(i===a){return}i=a;r._clearHighlight.call(r);var o=r.map.querySourceFeatures(r.sourceId,{filter:["==","fid",a]});var s,l=o.length;var u={type:"FeatureCollection",features:[]};for(s=0;s<l;s++){u["features"].push(o[s].toJSON())}r.map.getSource("highlight").setData(u)})}},{key:"_clearHighlight",value:function e(){if(this.map){if(!!this.map.getSource("highlight")){this.map.getSource("highlight").setData({type:"FeatureCollection",features:[]})}}}},{key:"_appendLegendCSSStyle",value:function e(){var t=document.createElement("style");t.type="text/css";var r="\n        .legend {\n            display: inline-block;\n            border-radius: 2px;\n            -moz-border-radius: 2px;\n            -webkit-border-radius: 2px;\n            font-size: 12px;\n            color: rgba(0, 0, 0, 0.8);\n            background-color: rgb(255, 255, 255);\n        }\n        .legend-light {\n            color: rgba(0, 0, 0, 0.8);\n            background-color: rgb(255, 255, 255);\n            box-shadow: 0px 0px 6px #bbbbbb;\n            -moz-box-shadow: 0px 6px 10px #bbbbbb;\n            -webkit-box-shadow: 0px 0px 6px #bbbbbb;\n        }\n        .legend-dark {\n            color: rgba(255, 255, 255, 0.8);\n            background-color: rgb(64, 64, 64);\n        }\n        .legend .legend-title {\n            min-height: 14px;\n            max-width: 500px;\n            padding:6px 10px;\n        }\n        .legend-light .legend-title {\n            color: rgba(0, 0, 0, 0.8);\n        }\n        .legend-dark .legend-title {\n            color: rgba(255, 255, 255, 0.8);\n        }\n        .legend-content{\n            padding:6px 10px;\n        }\n        ";t.innerHTML=r+this._legendCSSStyle();document.getElementsByTagName("head")[0].appendChild(t)}},{key:"_legendCSSStyle",value:function e(){return"  \n        .legend ul {\n            padding: 0;\n            margin: 0 16px;\n            height: 100%;\n            display: block;\n            list-style: none;\n        }\n\n        .legend li {\n            vertical-align: middle;\n        }\n\n        .legend li span:first-child {\n            vertical-align: middle;\n        }\n\n        .legend li span:last-child {\n            line-height: 28px;\n            max-width: 200px;\n            vertical-align: middle;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            -ms-text-overflow: ellipsis;\n        }\n\n        .legend-vertical li {\n            height: 28px;\n        }\n\n        .legend-vertical li span:first-child {\n            display: inline-block;\n            width: 60px;\n            height: 100%;\n        }\n\n        .legend-vertical li span:last-child {\n            display: inline-block;\n            margin-left: 16px;\n            height: 100%;\n        }\n\n        .legend-horizontal li {\n            height: 56px;\n            float: left;\n        }\n\n        .legend-horizontal li span:first-child {\n            display: block;\n            width: 100%;\n            height: 50%;\n        }\n\n        .legend-horizontal li span:last-child {\n            display: block;\n            vertical-align: middle;\n            width: 60px;\n            height: 50%;\n            text-align: center;\n        }\n        "}}]);return e}();t.Theme3DLayer=c;l.Zondy.Map.Theme3DLayer=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LayerEvent=t.BroadcastEvent=t.SubscribeEvent=t.BroadcastPrefix=t.SubscribePrefix=undefined;var i=r(39);var n=t.SubscribePrefix="/subscribe";var a=t.BroadcastPrefix="/broadcast";var o=t.SubscribeEvent={OPEN:"subscribeOpen",MESSAGE:"subscribeMessage",CLOSE:"subscribeClose",ERROR:"subscribeError"};var s=t.BroadcastEvent={OPEN:"broadcastOpen",MESSAGE:"broadcastMessage",CLOSE:"broadcastClose",ERROR:"broadcastError"};var l=t.LayerEvent={UPDATE:"layerupdate"};i.Zondy.Event.SubscribeEvent=o;i.Zondy.Event.BroadcastEvent=s;i.Zondy.Event.LayerEvent=s},function(e,t,r){e.exports=!r(26)&&!r(44)(function(){return Object.defineProperty(r(74)("div"),"a",{get:function(){return 7}}).a!=7})},function(e,t,r){var i=r(30);var n=r(23);var a=r(57);e.exports=r(26)?Object.defineProperties:function e(t,r){n(t);var o=a(r);var s=o.length;var l=0;var u;while(s>l)i.f(t,u=o[l++],r[u]);return t}},function(e,t,r){var i=r(34);var n=r(36);var a=r(246)(false);var o=r(78)("IE_PROTO");e.exports=function(e,t){var r=n(e);var s=0;var l=[];var u;for(u in r)if(u!=o)i(r,u)&&l.push(u);while(t.length>s)if(i(r,u=t[s++])){~a(l,u)||l.push(u)}return l}},function(e,t,r){var i=r(77);var n=Math.min;e.exports=function(e){return e>0?n(i(e),9007199254740991):0}},function(e,t,r){var i=r(34);var n=r(58);var a=r(78)("IE_PROTO");var o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){e=n(e);if(i(e,a))return e[a];if(typeof e.constructor=="function"&&e instanceof e.constructor){return e.constructor.prototype}return e instanceof Object?o:null}},function(e,t,r){var i=r(36);var n=r(127).f;var a={}.toString;var o=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];var s=function(e){try{return n(e)}catch(e){return o.slice()}};e.exports.f=function e(t){return o&&a.call(t)=="[object Window]"?s(t):n(i(t))}},function(e,t,r){var i=r(123);var n=r(80).concat("length","prototype");t.f=Object.getOwnPropertyNames||function e(t){return i(t,n)}},function(e,t,r){e.exports={default:r(260),__esModule:true}},function(e,t,r){var i=r(12).document;e.exports=i&&i.documentElement},function(e,t,r){"use strict";var i=r(47);var n=r(17);var a=r(131);var o=r(35);var s=r(48);var l=r(268);var u=r(59);var f=r(125);var c=r(14)("iterator");var h=!([].keys&&"next"in[].keys());var p="@@iterator";var d="keys";var v="values";var y=function(){return this};e.exports=function(e,t,r,m,g,_,x){l(r,t,m);var b=function(e){if(!h&&e in T)return T[e];switch(e){case d:return function t(){return new r(this,e)};case v:return function t(){return new r(this,e)}}return function t(){return new r(this,e)}};var w=t+" Iterator";var S=g==v;var C=false;var T=e.prototype;var P=T[c]||T[p]||g&&T[g];var M=P||b(g);var I=g?!S?M:b("entries"):undefined;var A=t=="Array"?T.entries||P:P;var L,E,k;if(A){k=f(A.call(new e));if(k!==Object.prototype&&k.next){u(k,w,true);if(!i&&typeof k[c]!="function")o(k,c,y)}}if(S&&P&&P.name!==v){C=true;M=function e(){return P.call(this)}}if((!i||x)&&(h||C||!T[c])){o(T,c,M)}s[t]=M;s[w]=y;if(g){L={values:S?M:b(v),keys:_?M:b(d),entries:I};if(x)for(E in L){if(!(E in T))a(T,E,L[E])}else n(n.P+n.F*(h||C),t,L)}return L}},function(e,t,r){e.exports=r(35)},function(e,t,r){"use strict";var i=r(12);var n=r(34);var a=r(26);var o=r(17);var s=r(131);var l=r(52).KEY;var u=r(44);var f=r(79);var c=r(59);var h=r(53);var p=r(14);var d=r(89);var v=r(90);var y=r(274);var m=r(275);var g=r(23);var _=r(11);var x=r(58);var b=r(36);var w=r(75);var S=r(55);var C=r(86);var T=r(126);var P=r(82);var M=r(133);var I=r(30);var A=r(57);var L=P.f;var E=I.f;var k=T.f;var D=i.Symbol;var B=i.JSON;var R=B&&B.stringify;var F="prototype";var O=p("_hidden");var z=p("toPrimitive");var U={}.propertyIsEnumerable;var N=f("symbol-registry");var j=f("symbols");var V=f("op-symbols");var G=Object[F];var Z=typeof D=="function"&&!!M.f;var q=i.QObject;var H=!q||!q[F]||!q[F].findChild;var W=a&&u(function(){return C(E({},"a",{get:function(){return E(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var i=L(G,t);if(i)delete G[t];E(e,t,r);if(i&&e!==G)E(G,t,i)}:E;var X=function(e){var t=j[e]=C(D[F]);t._k=e;return t};var Y=Z&&typeof D.iterator=="symbol"?function(e){return typeof e=="symbol"}:function(e){return e instanceof D};var K=function e(t,r,i){if(t===G)K(V,r,i);g(t);r=w(r,true);g(i);if(n(j,r)){if(!i.enumerable){if(!n(t,O))E(t,O,S(1,{}));t[O][r]=true}else{if(n(t,O)&&t[O][r])t[O][r]=false;i=C(i,{enumerable:S(0,false)})}return W(t,r,i)}return E(t,r,i)};var J=function e(t,r){g(t);var i=y(r=b(r));var n=0;var a=i.length;var o;while(a>n)K(t,o=i[n++],r[o]);return t};var $=function e(t,r){return r===undefined?C(t):J(C(t),r)};var Q=function e(t){var r=U.call(this,t=w(t,true));if(this===G&&n(j,t)&&!n(V,t))return false;return r||!n(this,t)||!n(j,t)||n(this,O)&&this[O][t]?r:true};var ee=function e(t,r){t=b(t);r=w(r,true);if(t===G&&n(j,r)&&!n(V,r))return;var i=L(t,r);if(i&&n(j,r)&&!(n(t,O)&&t[O][r]))i.enumerable=true;return i};var te=function e(t){var r=k(b(t));var i=[];var a=0;var o;while(r.length>a){if(!n(j,o=r[a++])&&o!=O&&o!=l)i.push(o)}return i};var re=function e(t){var r=t===G;var i=k(r?V:b(t));var a=[];var o=0;var s;while(i.length>o){if(n(j,s=i[o++])&&(r?n(G,s):true))a.push(j[s])}return a};if(!Z){D=function e(){if(this instanceof D)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:undefined);var r=function(e){if(this===G)r.call(V,e);if(n(this,O)&&n(this[O],t))this[O][t]=false;W(this,t,S(1,e))};if(a&&H)W(G,t,{configurable:true,set:r});return X(t)};s(D[F],"toString",function e(){return this._k});P.f=ee;I.f=K;r(127).f=T.f=te;r(83).f=Q;M.f=re;if(a&&!r(47)){s(G,"propertyIsEnumerable",Q,true)}d.f=function(e){return X(p(e))}}o(o.G+o.W+o.F*!Z,{Symbol:D});for(var ie="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;ie.length>ne;)p(ie[ne++]);for(var ae=A(p.store),oe=0;ae.length>oe;)v(ae[oe++]);o(o.S+o.F*!Z,"Symbol",{for:function(e){return n(N,e+="")?N[e]:N[e]=D(e)},keyFor:function e(t){if(!Y(t))throw TypeError(t+" is not a symbol!");for(var r in N)if(N[r]===t)return r},useSetter:function(){H=true},useSimple:function(){H=false}});o(o.S+o.F*!Z,"Object",{create:$,defineProperty:K,defineProperties:J,getOwnPropertyDescriptor:ee,getOwnPropertyNames:te,getOwnPropertySymbols:re});var se=u(function(){M.f(1)});o(o.S+o.F*se,"Object",{getOwnPropertySymbols:function e(t){return M.f(x(t))}});B&&o(o.S+o.F*(!Z||u(function(){var e=D();return R([e])!="[null]"||R({a:e})!="{}"||R(Object(e))!="{}"})),"JSON",{stringify:function e(t){var r=[t];var i=1;var n,a;while(arguments.length>i)r.push(arguments[i++]);a=n=r[1];if(!_(n)&&t===undefined||Y(t))return;if(!m(n))n=function(e,t){if(typeof a=="function")t=a.call(this,e,t);if(!Y(t))return t};r[1]=n;return R.apply(B,r)}});D[F][z]||r(35)(D[F],z,D[F].valueOf);c(D,"Symbol");c(Math,"Math",true);c(i.JSON,"JSON",true)},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t){},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.createCanvasContext2D=t.mixin=t.merge=t.DeepMerge=t.ChineseToUtf8=t.getTopAnalysisResult=t.bindAsEventListener=t.bind=t.newGuid=t.cloneObject=t.copyAttributesWithClip=t.copyAttributes=t.transformResult=t.toJSON=t.isInTheSameDomain=t.supportCanvas=t.isSupportCanvas=t.getBrowser=t.Browser=t.IS_GECKO=t.getParameters=t.urlAppend=t.getWFParameterString=t.getParameterString=t.applyDefaults=t.modifyDOMElement=t.indexOf=t.removeItem=t.isElement=t.getElement=t.reset=t.copyExcluce=t.copy=t.extendDeep=t.isArray=t.extend=t.WebGraphicsInfo=t.VectCls=t.Tangram=t.Rectangle=t.PolyLine=t.Polygon=t.Point2D=t.MultiPolygon=t.LablePntInfo=t.LabelRegInfo=t.LabelLinInfo=t.GRegion=t.GPoint=t.GLine=t.FeatureSet=t.FeatureGraphicBase=t.FeatureGeometry=t.Feature=t.LayerStatusType=t.MapType=t.CItemType=t.CLinStyleMakeType=t.CLinJointType=t.CLinHeadType=t.CLinAdjustType=t.NetElemType=t.NetAnalyType=t.ISShowArc=t.EightDirType=t.LineConstrain=t.LabelSpreadType=t.RepeatType=t.LabelPntType=t.LabelRegType=t.LabelLinType=t.FontShape=t.FeatureType=t.VectClsType=t.XClsType=t.DynShowStyle=t.DynNoteLableType=t.CRegionInfo=t.CPointInfo=t.CLineInfo=t.Circle=t.CGDBInfo=t.CDynNoteInfo=t.CDisplayStyleExtend=t.CDisplayStyle=t.CAttDataRow=t.CAttStruct=t.Zondy=t.Arc=t.AnyLine=undefined;var i=r(91);var n=r(288);var a=r(0);var o=r(60);var s=r(289);var l=r(290);var u=r(142);var f=r(137);var c=r(143);var h=r(292);var p=r(61);var d=r(92);var v=r(93);var y=r(138);var m=r(136);var g=r(15);var _=r(144);var x=r(145);var b=r(62);var w=r(63);var S=r(96);var C=r(95);var T=r(97);var P=r(140);var M=r(141);var I=r(139);var A=r(297);var L=r(19);var E=r(147);var k=r(298);var D=r(94);var B=r(37);var R=r(299);var F=r(146);var O=r(6);t.AnyLine=i.AnyLine;t.Arc=n.Arc;t.Zondy=a.Zondy;t.CAttStruct=o.CAttStruct;t.CAttDataRow=s.CAttDataRow;t.CDisplayStyle=l.CDisplayStyle;t.CDisplayStyleExtend=u.CDisplayStyleExtend;t.CDynNoteInfo=f.CDynNoteInfo;t.CGDBInfo=c.CGDBInfo;t.Circle=h.Circle;t.CLineInfo=p.CLineInfo;t.CPointInfo=d.CPointInfo;t.CRegionInfo=v.CRegionInfo;t.DynNoteLableType=y.DynNoteLableType;t.DynShowStyle=m.DynShowStyle;t.XClsType=g.XClsType;t.VectClsType=g.VectClsType;t.FeatureType=g.FeatureType;t.FontShape=g.FontShape;t.LabelLinType=g.LabelLinType;t.LabelRegType=g.LabelRegType;t.LabelPntType=g.LabelPntType;t.RepeatType=g.RepeatType;t.LabelSpreadType=g.LabelSpreadType;t.LineConstrain=g.LineConstrain;t.EightDirType=g.EightDirType;t.ISShowArc=g.ISShowArc;t.NetAnalyType=g.NetAnalyType;t.NetElemType=g.NetElemType;t.CLinAdjustType=g.CLinAdjustType;t.CLinHeadType=g.CLinHeadType;t.CLinJointType=g.CLinJointType;t.CLinStyleMakeType=g.CLinStyleMakeType;t.CItemType=g.CItemType;t.MapType=g.MapType;t.LayerStatusType=g.LayerStatusType;t.Feature=_.Feature;t.FeatureGeometry=x.FeatureGeometry;t.FeatureGraphicBase=b.FeatureGraphicBase;t.FeatureSet=w.FeatureSet;t.GLine=S.GLine;t.GPoint=C.GPoint;t.GRegion=T.GRegion;t.LabelLinInfo=P.LabelLinInfo;t.LabelRegInfo=M.LabelRegInfo;t.LablePntInfo=I.LablePntInfo;t.MultiPolygon=A.MultiPolygon;t.Point2D=L.Point2D;t.Polygon=E.Polygon;t.PolyLine=k.PolyLine;t.Rectangle=D.Rectangle;t.Tangram=B.Tangram;t.VectCls=R.VectCls;t.WebGraphicsInfo=F.WebGraphicsInfo;t.extend=O.extend;t.isArray=O.isArray;t.extendDeep=O.extendDeep;t.copy=O.copy;t.copyExcluce=O.copyExcluce;t.reset=O.reset;t.getElement=O.getElement;t.isElement=O.isElement;t.removeItem=O.removeItem;t.indexOf=O.indexOf;t.modifyDOMElement=O.modifyDOMElement;t.applyDefaults=O.applyDefaults;t.getParameterString=O.getParameterString;t.getWFParameterString=O.getWFParameterString;t.urlAppend=O.urlAppend;t.getParameters=O.getParameters;t.IS_GECKO=O.IS_GECKO;t.Browser=O.Browser;t.getBrowser=O.getBrowser;t.isSupportCanvas=O.isSupportCanvas;t.supportCanvas=O.supportCanvas;t.isInTheSameDomain=O.isInTheSameDomain;t.toJSON=O.toJSON;t.transformResult=O.transformResult;t.copyAttributes=O.copyAttributes;t.copyAttributesWithClip=O.copyAttributesWithClip;t.cloneObject=O.cloneObject;t.newGuid=O.newGuid;t.bind=O.bind;t.bindAsEventListener=O.bindAsEventListener;t.getTopAnalysisResult=O.getTopAnalysisResult;t.ChineseToUtf8=O.ChineseToUtf8;t.DeepMerge=O.DeepMerge;t.merge=O.merge;t.mixin=O.mixin;t.createCanvasContext2D=O.createCanvasContext2D},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DynShowStyle=undefined;var i=r(0);var n=r(6);var a=r(137);var o=r(15);var s=r(61);var l=r(92);var u=r(93);var f=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.Alpha=r.Alpha!==undefined?r.Alpha:0;this.BugSpare=r.BugSpare!==undefined?r.BugSpare:false;this.CustomRender=r.CustomRender!==undefined?r.CustomRender:false;this.CustomRenderPath=r.CustomRenderPath!==undefined?r.CustomRenderPath:null;this.DirectionLineClr=r.DirectionLineClr!==undefined?r.DirectionLineClr:0;this.DynNoteFlag=r.DynNoteFlag!==undefined?r.DynNoteFlag:false;this.DynNoteInfo=r.DynNoteInfo!==undefined?r.DynNoteInfo:null;this.IsShowArc=r.IsShowArc!==undefined?r.IsShowArc:0;this.ISShowLineDirection=r.ISShowLineDirection!==undefined?r.ISShowLineDirection:false;this.LineInfo=r.LineInfo!==undefined?r.LineInfo:null;this.MaxScale=r.MaxScale!==undefined?r.MaxScale:0;this.MinScale=r.MinScale!==undefined?r.MinScale:0;this.ShowCoordPnt=r.ShowCoordPnt!==undefined?r.ShowCoordPnt:false;this.SpareLineInfo=r.SpareLineInfo!==undefined?r.SpareLineInfo:null;this.SparePointInfo=r.SparePointInfo!==undefined?r.SparePointInfo:null;this.SpareRegInfo=r.SpareRegInfo!==undefined?r.SpareRegInfo:null;this.SymbleScale=r.SymbleScale!==undefined?r.SymbleScale:0};t.DynShowStyle=f;i.Zondy.Object.DynShowStyle=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CDynNoteInfo=undefined;var i=r(0);var n=r(6);var a=r(15);var o=r(138);var s=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.Angle=r.Angle!==undefined?r.Angle:0;this.Backclr=r.Backclr!==undefined?r.Backclr:0;this.Backexp=r.Backexp!==undefined?r.Backexp:0;this.Bold=r.Bold!==undefined?r.Bold:0;this.FieldName=r.FieldName!==undefined?r.FieldName:null;this.FontAngle=r.FontAngle!==undefined?r.FontAngle:0;this.FontColor=r.FontColor!==undefined?r.FontColor:0;this.FontSize=r.FontSize!==undefined?r.FontSize:0;this.FontStyle=r.FontStyle!==undefined?r.FontStyle:0;this.Ifnt=r.Ifnt!==undefined?r.Ifnt:0;this.Ifnx=r.Ifnx!==undefined?r.Ifnx:a.FontShape.Positive;this.IsFilled=r.IsFilled!==undefined?r.IsFilled:false;this.IsHzpl=r.IsHzpl!==undefined?r.IsHzpl:false;this.IsOvprnt=r.IsOvprnt!==undefined?r.IsOvprnt:false;this.LabelLevel=r.LabelLevel!==undefined?r.LabelLevel:0;this.LableType=r.LableType!==undefined?r.LableType:null;this.Offsetx=r.Offsetx!==undefined?r.Offsetx:0;this.Offsety=r.Offsety!==undefined?r.Offsety:0;this.Space=r.Space!==undefined?r.Space:0;this.StrikeThrough=r.StrikeThrough!==undefined?r.StrikeThrough:0;this.UnderLine=r.UnderLine!==undefined?r.UnderLine:0};t.CDynNoteInfo=s;i.Zondy.Object.CDynNoteInfo=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DynNoteLableType=undefined;var i=r(0);var n=r(6);var a=r(139);var o=r(140);var s=r(141);var l=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.PntInfo=r.PntInfo!==undefined&&r.PntInfo!==null?r.PntInfo:null;this.LinInfo=r.LinInfo!==undefined&&r.LinInfo!==null?r.LinInfo:null;this.RegInfo=r.RegInfo!==undefined&&r.RegInfo!==null?r.RegInfo:null};t.DynNoteLableType=l;i.Zondy.Object.DynNoteLableType=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LablePntInfo=undefined;var i=r(0);var n=r(6);var a=r(15);var o=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.Ang=r.Ang!==undefined&&r.Ang!==null?r.Ang:null;this.ClientOutLabel=r.ClientOutLabel!==undefined&&r.ClientOutLabel!==null?r.ClientOutLabel:false;this.Distance=r.Distance!==undefined&&r.Distance!==null?r.Distance:0;this.EightDirLableType=r.EightDirLableType!==undefined&&r.EightDirLableType!==null?r.EightDirLableType:null;this.PntType=r.PntType!==undefined&&r.PntType!==null?r.PntType:0};t.LablePntInfo=o;i.Zondy.Object.LablePntInfo=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LabelLinInfo=undefined;var i=r(0);var n=r(6);var a=r(15);var o=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.ClientOutLabel=r.ClientOutLabel!==undefined&&r.ClientOutLabel!==null?r.ClientOutLabel:false;this.DistFromLine=r.DistFromLine!==undefined&&r.DistFromLine!==null?r.DistFromLine:0;this.FromLineConstrain=r.FromLineConstrain!==undefined&&r.FromLineConstrain!==null?r.FromLineConstrain:0;this.Interval=r.Interval!==undefined&&r.Interval!==null?r.Interval:0;this.LinType=r.LinType!==undefined&&r.LinType!==null?r.LinType:0;this.Repeat=r.Repeat!==undefined&&r.Repeat!==null?r.Repeat:0;this.SpreadType=r.SpreadType!==undefined&&r.SpreadType!==null?r.SpreadType:null};t.LabelLinInfo=o;i.Zondy.Object.LabelLinInfo=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LabelRegInfo=undefined;var i=r(0);var n=r(6);var a=r(15);var o=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.ClientOutLabel=r.ClientOutLabel!==undefined&&r.ClientOutLabel!==null?r.ClientOutLabel:false;this.LabelMiniRegion=r.LabelMiniRegion!==undefined&&r.LabelMiniRegion!==null?r.LabelMiniRegion:0;this.MayPlaceOutside=r.MayPlaceOutside!==undefined&&r.MayPlaceOutside!==null?r.MayPlaceOutside:0;this.MiniRegionArea=r.MiniRegionArea!==undefined&&r.MiniRegionArea!==null?r.MiniRegionArea:0;this.Offset=r.Offset!==undefined&&r.Offset!==null?r.Offset:0;this.RegType=r.RegType!==undefined&&r.RegType!==null?r.RegType:0};t.LabelRegInfo=o;i.Zondy.Object.LabelRegInfo=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CDisplayStyleExtend=undefined;var i=r(0);var n=r(6);var a=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.Index=r.Index!==undefined?r.Index:0;this.SymbleShow=r.SymbleShow!==undefined?r.SymbleShow:false;this.LinPenWidFixed=r.LinPenWidFixed!==undefined?r.LinPenWidFixed:false;this.LinSizeFixed=r.LinSizeFixed!==undefined?r.LinSizeFixed:false;this.PntPenWidFixed=r.PntPenWidFixed!==undefined?r.PntPenWidFixed:false;this.PntSizeFixed=r.PntSizeFixed!==undefined?r.PntSizeFixed:false;this.RegPenWidFixed=r.RegPenWidFixed!==undefined?r.RegPenWidFixed:false;this.RegSizeFixed=r.RegSizeFixed!==undefined?r.RegSizeFixed:false;this.AnnSizeFixed=r.AnnSizeFixed!==undefined?r.AnnSizeFixed:false;this.FollowScale=r.FollowScale!==undefined?r.FollowScale:false;this.ShowCoordPnt=r.ShowCoordPnt!==undefined?r.ShowCoordPnt:false;this.ShowElemRect=r.ShowElemRect!==undefined?r.ShowElemRect:false;this.DriverQuality=r.DriverQuality!==undefined?r.DriverQuality:0;this.DynProjFlag=r.DynProjFlag!==undefined?r.DynProjFlag:false};t.CDisplayStyleExtend=a;i.Zondy.Object.CDisplayStyleExtend=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CGDBInfo=undefined;var i=r(0);var n=function e(t){var r=t?t:{};this.GDBSvrName=r.ServerName!==undefined?r.ServerName:null;this.GDBName=r.GDBName!==undefined?r.GDBName:null;this.User=r.User!==undefined?r.User:null;this.Password=r.Password!==undefined?r.Password:null};t.CGDBInfo=n;i.Zondy.Object.CGDBInfo=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Feature=undefined;var i=r(0);var n=r(6);var a=r(94);var o=r(145);var s=r(15);var l=r(146);var u=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.AttValue=r.AttValue!==undefined&&r.AttValue!==null?r.AttValue:null;this.FID=r.FID!==undefined&&r.FID!==null?r.FID:0;this.bound=r.bound!==undefined&&r.bound!==null?r.bound:null;this.fGeom=r.fGeom!==undefined&&r.fGeom!==null?r.fGeom:null;this.ftype=r.ftype!==undefined&&r.ftype!==null?r.ftype:0;this.GraphicInfo=r.GraphicInfo!==undefined&&r.GraphicInfo!==null?r.GraphicInfo:null};u.prototype.getAttValue=function(e){if(this.AttValue===null){return null}var t=this.AttValue.length;if(typeof e==="number"){if(e>=t){return null}return this.AttValue[e]}};u.prototype.getGraphicInfo=function(){if(this.GraphicInfo===null){return null}else{return new l.WebGraphicsInfo(this.GraphicInfo)}};u.prototype.getAttValueArray=function(){return this.AttValue};u.prototype.getRectBound=function(){var e=this.bound;if(e!==null){return new a.Rectangle(e)}else{return e}};u.prototype.getGeometry=function(){return this.fGeom};u.prototype.getFID=function(){return this.FID};u.prototype.setAttValues=function(e){this.AttValue=e};u.prototype.setBound=function(e){var t=null;if(typeof e==="string"){t=new a.Rectangle(e)}if(e instanceof String){t=new a.Rectangle(e)}if(e instanceof a.Rectangle){t=e}if(e instanceof ol.extent){t=new a.Rectangle;t.setByOL(e)}this.bound=t};u.prototype.setFID=function(e){this.FID=e};u.prototype.setFType=function(e){this.ftype=e};u.prototype.destroy=function(){this.AttValue=null;this.FID=null;this.bound=null;this.fGeom=null;this.ftype=null;this.GraphicInfo=null};t.Feature=u;i.Zondy.Object.Feature=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FeatureGeometry=undefined;var i=r(0);var n=r(6);var a=r(95);var o=r(96);var s=r(97);var l=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.PntGeom=r.PntGeom!==undefined&&r.PntGeom!==null?r.PntGeom:null;this.LinGeom=r.LinGeom!==undefined&&r.LinGeom!==null?r.LinGeom:null;this.RegGeom=r.RegGeom!==undefined&&r.RegGeom!==null?r.RegGeom:null};l.prototype.setPntGeom=function(e){this.PntGeom=e!==undefined&&e!==null&&Array.isArray(e)?e:null};l.prototype.setLine=function(e){this.LinGeom=e!==undefined&&e!==null&&Array.isArray(e)?e:null};l.prototype.setRegGeom=function(e){this.RegGeom=e!==undefined&&e!==null&&Array.isArray(e)?e:null};t.FeatureGeometry=l;i.Zondy.Object.FeatureGeometry=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.WebGraphicsInfo=undefined;var i=r(0);var n=r(6);var a=r(15);var o=r(92);var s=r(61);var l=r(93);var u=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.InfoType=r.InfoType!==undefined&&r.InfoType!==null?r.InfoType:0;this.PntInfo=r.PntInfo!==undefined&&r.PntInfo!==null?r.PntInfo:null;this.LinInfo=r.LinInfo!==undefined&&r.LinInfo!==null?r.LinInfo:null;this.RegInfo=r.RegInfo!==undefined&&r.RegInfo!==null?r.RegInfo:null};t.WebGraphicsInfo=u;i.Zondy.Object.WebGraphicsInfo=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Polygon=undefined;var i=r(2);var n=v(i);var a=r(1);var o=v(a);var s=r(5);var l=v(s);var u=r(3);var f=v(u);var c=r(4);var h=v(c);var p=r(37);var d=r(19);function v(e){return e&&e.__esModule?e:{default:e}}var y=function(e){(0,h.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=r?r:{};var a=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,i));a.pointArr=e!==undefined&&e!==null&&Array.isArray(e)?e:new Array;return a}(0,l.default)(t,[{key:"setByOL",value:function e(t){if(t!==undefined&&t!==null){var r=t.getLinearRing(0);var i=r.getCoordinates();var n=i.length;for(var a=0;a<n;a++){this.pointArr[a]=new d.Point2D(i[a][0],i[a][1])}}}},{key:"toString",value:function e(){if(this.pointArr===null||this.pointArr.length===0){return""}var t="";for(var r=0;r<this.pointArr.length;r++){t+=this.pointArr[r].x+","+this.pointArr[r].y+","}return t.substring(0,t.length-1)}},{key:"getGeometryType",value:function e(){return"polygon"}}]);return t}(p.Tangram);t.Polygon=y;Zondy.Object.Polygon=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ContourNoteParam=undefined;var i=r(0);var n=function e(t){var r=t!=undefined?t:{};this.IsClipLine=r.IsClipLine!=undefined?r.IsClipLine:true;this.isXYScaleOut=r.isXYScaleOut!=undefined?r.isXYScaleOut:false;this.NoteDirection=r.NoteDirection!=undefined?r.NoteDirection:1;this.LineWidth=r.LineWidth!=undefined?r.LineWidth:.05;this.MaxAngle=r.MaxAngle!=undefined?r.MaxAngle:90;this.MinDist=r.MinDist!=undefined?r.MinDist:10;this.IsAbs=r.IsAbs!=undefined?r.IsAbs:false;this.IsComma=r.IsComma!=undefined?r.IsComma:false;this.DigitNum=r.DigitNum!=undefined?r.DigitNum:0;this.FormatNo=r.FormatNo!=undefined?r.FormatNo:0;this.LogFlag=r.LogFlag!=undefined?r.LogFlag:0;this.Prefix=r.Prefix!=undefined?r.Prefix:"";this.Suffix=r.Suffix!=undefined?r.Suffix:"";this.ColorNo=r.ColorNo!=undefined?r.ColorNo:0;this.FixSize=r.FixSize!=undefined?r.FixSize:.01;this.FontNo=r.FontNo!=undefined?r.FontNo:0};t.ContourNoteParam=n;i.Zondy.Object.ContourAnalyse.ContourNoteParam=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ContourParam=undefined;var i=r(0);var n=r(148);var a=r(150);var o=r(151);var s=function e(t){var r=t!=undefined?t:{};this.IsSmoothLine=r.IsSmoothLine!=undefined?r.IsSmoothLine:false;this.SmoothGrade=r.SmoothGrade!=undefined?r.SmoothGrade:1;this.IsMakeReg=r.IsMakeReg!=undefined?r.IsMakeReg:false;this.IsMakeNote=r.IsMakeNote!=undefined?r.IsMakeNote:false;this.IsMakeSLin=r.IsMakeSLin!=undefined?r.IsMakeSLin:false;this.MapWay=r.MapWay!=undefined?r.MapWay:1;this.FrameWidth=r.FrameWidth!=undefined?r.FrameWidth:1;this.FrameHeight=r.FrameHeight!=undefined?r.FrameHeight:1;this.IsDrawColorScl=r.IsDrawColorScl!=undefined?r.IsDrawColorScl:false;this.IsSaveEdge=r.IsSaveEdge!=undefined?r.IsSaveEdge:false;this.NoteParam=r.NoteParam!=undefined?r.NoteParam:null;this.SlopLineParam=r.SlopLineParam!=undefined?r.SlopLineParam:null;this.ZValues=r.ZValues!=undefined?r.ZValues:null};t.ContourParam=s;i.Zondy.Object.ContourAnalyse.ContourParam=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SlopLineParam=undefined;var i=r(0);var n=function e(t){var r=t!=undefined?t:{};this.XScale=r.XScale!=undefined?r.XScale:2;this.YScale=r.YScale!=undefined?r.YScale:10;this.LineType=r.LineType!=undefined?r.LineType:0;this.SubLineType=r.SubLineType!=undefined?r.SubLineType:0};t.SlopLineParam=n;i.Zondy.Object.ContourAnalyse.SlopLineParam=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ContourZValue=undefined;var i=r(0);var n=r(61);var a=r(152);var o=function e(t){var r=t!=undefined?t:{};this.ZValue=r.ZValue!=undefined?r.ZValue:1;this.LineInfo=r.LineInfo!=undefined?r.LineInfo:null;this.RegInfo=r.RegInfo!=undefined?r.RegInfo:null;this.IsOutputNote=r.IsOutputNote!=undefined?r.IsOutputNote:false};t.ContourZValue=o;i.Zondy.Object.ContourAnalyse.ContourZValue=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ContourRegionInfo=undefined;var i=r(0);var n=function e(t){var r=t!=undefined?t:{};this.PatID=r.PatID!=undefined?r.PatID:0;this.FillMode=r.FillMode!=undefined?r.FillMode:0;this.FillColor=r.FillColor!=undefined?r.FillColor:1;this.PatHeight=r.PatHeight!=undefined?r.PatHeight:1;this.PatWidth=r.PatWidth!=undefined?r.PatWidth:1;this.PatAngle=r.PatAngle!=undefined?r.PatAngle:1;this.PatColor=r.PatColor!=undefined?r.PatColor:1;this.OutPenWidth=r.OutPenWidth!=undefined?r.OutPenWidth:1;this.OverMethod=r.OverMethod!=undefined?r.OverMethod:0};t.ContourRegionInfo=n;i.Zondy.Object.ContourAnalyse.ContourRegionInfo=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MeshingParam=undefined;var i=r(0);var n=function e(t){var r=t!=undefined?t:{};this.SfClsURL=r.SfClsURL!=undefined?r.SfClsURL:null;this.FieldName=r.FieldName!=undefined?r.FieldName:null;this.XCellNum=r.XCellNum!=undefined?r.XCellNum:200;this.Bound=r.Bound!=undefined?r.Bound:null};t.MeshingParam=n;i.Zondy.Object.ContourAnalyse.MeshingParam=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CommonServiceBase=undefined;var i=r(1);var n=h(i);var a=r(5);var o=h(a);var s=r(0);var l=r(6);var u=r(155);var f=r(156);var c=r(157);function h(e){return e&&e.__esModule?e:{default:e}}var p=function(){function e(t,r){(0,n.default)(this,e);var i=this;this.EVENT_TYPES=["processCompleted","processFailed"];this.events=null;this.eventListeners=null;this.url=null;this.urls=null;this.index=null;this.length=null;this.options=null;this.totalTimes=null;this.POLLING_TIMES=3;this._processSuccess=null;this._processFailed=null;this.isInTheSameDomain=null;if((0,l.isArray)(t)){i.urls=t;i.length=t.length;i.totalTimes=i.length;if(i.length===1){i.url=t[0]}else{i.index=parseInt(Math.random()*i.length);i.url=t[i.index]}}else{i.totalTimes=1;i.url=t}r=r||{};if(r){(0,l.extend)(this,r)}i.isInTheSameDomain=(0,l.isInTheSameDomain)(i.url);i.events=new u.Events(i,null,i.EVENT_TYPES,true);if(i.eventListeners instanceof Object){i.events.on(i.eventListeners)}}(0,o.default)(e,[{key:"destroy",value:function e(){var t=this;if((0,l.isArray)(t.urls)){t.urls=null;t.index=null;t.length=null;t.totalTimes=null}t.url=null;t.options=null;t._processSuccess=null;t._processFailed=null;t.isInTheSameDomain=null;t.EVENT_TYPES=null;if(t.events){t.events.destroy();t.events=null}if(t.eventListeners){t.eventListeners=null}}},{key:"request",value:function e(t){var r=this;t.url=t.url||r.url;t.isInTheSameDomain=r.isInTheSameDomain;r.calculatePollingTimes();r._processSuccess=t.success;r._processFailed=t.failure;t.scope=r;t.success=r.getUrlCompleted;t.failure=r.getUrlFailed;r.options=t;r._commit(r.options)}},{key:"getUrlCompleted",value:function e(t){var r=this;r._processSuccess(t)}},{key:"getUrlFailed",value:function e(t){var r=this;if(r.totalTimes>0){r.totalTimes--;r.ajaxPolling()}else{r._processFailed(t)}}},{key:"ajaxPolling",value:function e(){var t=this,r=t.options.url,i=/^http:\/\/([a-z]{9}|(\d+\.){3}\d+):\d{0,4}/;t.index=parseInt(Math.random()*t.length);t.url=t.urls[t.index];r=r.replace(i,i.exec(t.url)[0]);t.options.url=r;t.options.isInTheSameDomain=(0,l.isInTheSameDomain)(r);t._commit(t.options)}},{key:"calculatePollingTimes",value:function e(){var t=this;if(t.times){if(t.totalTimes>t.POLLING_TIMES){if(t.times>t.POLLING_TIMES){t.totalTimes=t.POLLING_TIMES}else{t.totalTimes=t.times}}else{if(t.times<t.totalTimes){t.totalTimes=t.times}}}else{if(t.totalTimes>t.POLLING_TIMES){t.totalTimes=t.POLLING_TIMES}}t.totalTimes--}},{key:"serviceProcessCompleted",value:function e(t){t=(0,l.transformResult)(t);this.events.triggerEvent("processCompleted",{result:t})}},{key:"serviceProcessFailed",value:function e(t){t=(0,l.transformResult)(t);var r=t.error||t;this.events.triggerEvent("processFailed",{error:r})}},{key:"_commit",value:function e(t){if(t.method==="POST"||t.method==="PUT"){if(t.params){t.url=(0,l.urlAppend)(t.url,(0,l.getParameterString)(t.params||{}))}t.params=t.data}c.FetchRequest.commit(t.method,t.url,t.params,{headers:t.headers,withCredentials:t.withCredentials,timeout:t.async?0:null,proxy:t.proxy}).then(function(e){if(e.text){return e.text()}return e.json()}).then(function(e){var r=null;if(typeof e==="string"&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")){r={};if(e.toLowerCase()==="true"){r.succeed=true}else{r.error=true}}else if(typeof e==="string"){r=(new f.JSONFormat).read(e)}if(!r&&isNaN(r)||r.error){if(r&&r.error){r={error:r.error}}else{r={error:true}}}if(r.error){var i=t.scope?(0,l.bind)(t.failure,t.scope):t.failure;i(r)}else{if(!isNaN(r)){r={value:r}}if(typeof r==="string"){r={value:r}}if(Object.prototype.toString.call(r)!=="[object Array]"){r.succeed=r.succeed===undefined?true:r.succeed}else{r={value:r,succeed:true}}var n=t.scope?(0,l.bind)(t.success,t.scope):t.success;n(r)}})}}]);return e}();t.CommonServiceBase=p;s.Zondy.Service.CommonServiceBase=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Events=undefined;var i=r(18);var n=o(i);var a=r(6);function o(e){return e&&e.__esModule?e:{default:e}}var s=function e(t,r,i,n){this.listeners={};this.object=t;this.eventTypes=[];this.extensions={};this.extensionCount={};(0,a.extend)(this,n);if(i!=null){for(var o=0,s=i.length;o<s;o++){this.addEventType(i[o])}}};s.prototype.destroy=function(){for(var e in this.extensions){if(typeof this.extensions[e]!=="boolean"){this.extensions[e].destroy()}}this.extensions=null;this.listeners=null;this.object=null;this.eventTypes=null};s.prototype.addEventType=function(e){if(!this.listeners[e]){this.eventTypes.push(e);this.listeners[e]=[]}};s.prototype.on=function(e){for(var t in e){if(t!=="scope"&&e.hasOwnProperty(t)){this.register(t,e.scope,e[t])}}};s.prototype.register=function(e,t,r,i){if(e in s&&!this.extensions[e]){this.extensions[e]=new s[e](this)}if(r!=null&&(0,a.indexOf)(this.eventTypes,e)!==-1){if(t==null){t=this.object}var o=this.listeners[e];if(!o){o=[];this.listeners[e]=o;this.extensionCount[e]=0}var l={obj:t,func:r};if(i){o.splice(this.extensionCount[e],0,l);if((typeof i==="undefined"?"undefined":(0,n.default)(i))==="object"&&i.extension){this.extensionCount[e]++}}else{o.push(l)}}};s.prototype.registerPriority=function(e,t,r){this.register(e,t,r,true)};s.prototype.un=function(e){for(var t in e){if(t!=="scope"&&e.hasOwnProperty(t)){this.unregister(t,e.scope,e[t])}}};s.prototype.unregister=function(e,t,r){if(t==null){t=this.object}var i=this.listeners[e];if(i!=null){for(var n=0,a=i.length;n<a;n++){if(i[n].obj===t&&i[n].func===r){i.splice(n,1);break}}}};s.prototype.remove=function(e){if(this.listeners[e]!=null){this.listeners[e]=[]}};s.prototype.triggerEvent=function(e,t){var r=this.listeners[e];if(!r||r.length==0){return undefined}if(t==null){t={}}t.object=this.object;if(!t.type){t.type=e}r=r.slice();var i;for(var n=0,a=r.length;n<a;n++){var o=r[n];i=o.func.apply(o.obj,[t.result]);if(i!=undefined&&i==false){break}}return i};t.Events=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.JSONFormat=undefined;var i=r(18);var n=l(i);var a=r(9);var o=l(a);var s=r(6);function l(e){return e&&e.__esModule?e:{default:e}}var u=function e(t){this.data=null;this.keepData=false;this.indent="    ";this.space=" ";this.newline="\n";this.level=0;this.pretty=false;this.nativeJSON=function(){return!!(window.JSON&&typeof JSON.parse==="function"&&typeof o.default==="function")}();(0,s.extend)(this,t);this.options=t;this.serialize={object:function e(t){if(t==null){return"null"}if(t.constructor===Date){return this.serialize.date.apply(this,[t])}if(t.constructor===Array){return this.serialize.array.apply(this,[t])}var r=["{"];this.level+=1;var i,n,a;var o=false;for(i in t){if(t.hasOwnProperty(i)){n=this.write.apply(this,[i,this.pretty]);a=this.write.apply(this,[t[i],this.pretty]);if(n!=null&&a!=null){if(o){r.push(",")}r.push(this.writeNewline(),this.writeIndent(),n,":",this.writeSpace(),a);o=true}}}this.level-=1;r.push(this.writeNewline(),this.writeIndent(),"}");return r.join("")},array:function e(t){var r;var i=["["];this.level+=1;for(var n=0,a=t.length;n<a;++n){r=this.write.apply(this,[t[n],this.pretty]);if(r!=null){if(n>0){i.push(",")}i.push(this.writeNewline(),this.writeIndent(),r)}}this.level-=1;i.push(this.writeNewline(),this.writeIndent(),"]");return i.join("")},string:function e(t){var r={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};if(/["\\\x00-\x1f]/.test(t)){return'"'+t.replace(/([\x00-\x1f\\"])/g,function(e,t){var i=r[t];if(i){return i}i=t.charCodeAt();return"\\u00"+Math.floor(i/16).toString(16)+(i%16).toString(16)})+'"'}return'"'+t+'"'},number:function e(t){return isFinite(t)?String(t):"null"},boolean:function e(t){return String(t)},date:function e(t){function r(e){return e<10?"0"+e:e}return'"'+t.getFullYear()+"-"+r(t.getMonth()+1)+"-"+r(t.getDate())+"T"+r(t.getHours())+":"+r(t.getMinutes())+":"+r(t.getSeconds())+'"'}}};u.prototype.read=function(e,t){var r;if(this.nativeJSON){try{r=JSON.parse(e,t)}catch(e){}}if(this.keepData){this.data=r}return r};u.prototype.write=function(e,t){this.pretty=!!t;var r=null;var i=typeof e==="undefined"?"undefined":(0,n.default)(e);if(this.serialize[i]){try{r=!this.pretty&&this.nativeJSON?(0,o.default)(e):this.serialize[i].apply(this,[e])}catch(e){Console.error("Trouble serializing: "+e)}}return r};u.prototype.writeIndent=function(){var e=[];if(this.pretty){for(var t=0;t<this.level;++t){e.push(this.indent)}}return e.join("")};u.prototype.writeNewline=function(){return this.pretty?this.newline:""};u.prototype.writeSpace=function(){return this.pretty?this.space:""};t.JSONFormat=u;Zondy.Service.JSONFormat=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FetchRequest=t.RequestTimeout=t.CORS=undefined;var i=r(18);var n=f(i);var a=r(158);var o=f(a);var s=r(9);var l=f(s);var u=r(6);r(317);r(322);function f(e){return e&&e.__esModule?e:{default:e}}var c=window.fetch;var h=Zondy.CORS=Zondy.CORS||window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest;var p=Zondy.RequestTimeout=Zondy.RequestTimeout||45e3;var d=Zondy.FetchRequest={commit:function e(t,r,i,n){t=t?t.toUpperCase():t;switch(t){case"GET":return this._get(r,i,n);case"POST":return this._post(r,i,n);case"PUT":return this._put(r,i,n);case"DELETE":return this._delete(r,i,n);default:return this._get(r,i,n)}},_get:function e(t,r,i){i=i||{};var n="GET";t=this._processUrl(t,i);t=Zondy.Util.urlAppend(t,this._getParameterString(r||{}));if(!this.urlIsLong(t)){return this._fetch(t,r,i,n)}return this._postSimulatie(n,t.substring(0,t.indexOf("?")-1),r,i)},_delete:function e(t,r,i){i=i||{};var n="DELETE";t=this._processUrl(t,i);t=Zondy.Util.urlAppend(t,this._getParameterString(r||{}));if(!this.urlIsLong(t)&&h){return this._fetch(t,r,i,n)}return this._postSimulatie(n,t.substring(0,t.indexOf("?")-1),r,i)},_post:function e(t,r,i){i=i||{};return this._fetch(this._processUrl(t,i),r,i,"POST")},_put:function e(t,r,i){i=i||{};return this._fetch(this._processUrl(t,i),r,i,"PUT")},urlIsLong:function e(t){var r=0,i=null;for(var n=0,a=t.length;n<a;n++){i=t.charCodeAt(n);if(i<127){r++}else if(128<=i&&i<=2047){r+=2}else if(2048<=i&&i<=65535){r+=3}}return r<2e3?false:true},_postSimulatie:function e(t,r,i,n){var a=r.indexOf("?")>-1?"&":"?";r+=a+"_method="+t;if(typeof i!=="string"){i=(0,l.default)(i)}return this._post(r,i,n)},_processUrl:function e(t,r){if(this._isMVTRequest(t)){return t}if(r&&r.proxy){if(typeof r.proxy==="function"){t=r.proxy(t)}else{t=decodeURIComponent(t);t=r.proxy+encodeURIComponent(t)}}return t},_fetch:function e(t,r,i,n){i=i||{};i.headers=i.headers||{};if(!i.headers["Content-Type"]){i.headers["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8"}if(i.timeout){return this._timeout(i.timeout,c(t,{method:n,headers:i.headers,body:n==="PUT"||n==="POST"?r:undefined,credentials:i.withCredentials?"include":"omit",mode:"cors",timeout:p}).then(function(e){return e}))}return c(t,{method:n,body:n==="PUT"||n==="POST"?r:undefined,headers:i.headers,credentials:i.withCredentials?"include":"omit",mode:"cors",timeout:p}).then(function(e){return e})},_timeout:function e(t,r){return new o.default(function(e,i){setTimeout(function(){i(new Error("timeout"))},t);r.then(e,i)})},_getParameterString:function e(t){var r=[];for(var i in t){var a=t[i];if(a!=null&&typeof a!=="function"){var o;if((typeof a==="undefined"?"undefined":(0,n.default)(a))==="object"&&a.constructor===Array){var s=[];var l;for(var u=0,f=a.length;u<f;u++){l=a[u];s.push(encodeURIComponent(l===null||l===undefined?"":l))}o="["+s.join(",")+"]"}else{o=encodeURIComponent(a)}r.push(encodeURIComponent(i)+"="+o)}}return r.join("&")},_isMVTRequest:function e(t){return t.indexOf(".mvt")>-1||t.indexOf(".pbf")>-1}};t.CORS=h;t.RequestTimeout=p;t.FetchRequest=d;Zondy.Service.FetchRequest=d;Zondy.Service.CORS=h;Zondy.Service.RequestTimeout=p},function(e,t,r){e.exports={default:r(303),__esModule:true}},function(e,t,r){var i=r(46);var n=r(14)("toStringTag");var a=i(function(){return arguments}())=="Arguments";var o=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,r,s;return e===undefined?"Undefined":e===null?"Null":typeof(r=o(t=Object(e),n))=="string"?r:a?i(t):(s=i(t))=="Object"&&typeof t.callee=="function"?"Arguments":s}},function(e,t,r){var i=r(159);var n=r(14)("iterator");var a=r(48);e.exports=r(8).getIteratorMethod=function(e){if(e!=undefined)return e[n]||e["@@iterator"]||a[i(e)]}},function(e,t,r){var i=r(23);var n=r(54);var a=r(14)("species");e.exports=function(e,t){var r=i(e).constructor;var o;return r===undefined||(o=i(r)[a])==undefined?t:n(o)}},function(e,t){e.exports=function(e){try{return{e:false,v:e()}}catch(e){return{e:true,v:e}}}},function(e,t,r){var i=r(23);var n=r(11);var a=r(99);e.exports=function(e,t){i(e);if(n(t)&&t.constructor===e)return t;var r=a.f(e);var o=r.resolve;o(t);return r.promise}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GDBInfo=undefined;var i=r(2);var n=y(i);var a=r(1);var o=y(a);var s=r(5);var l=y(s);var u=r(3);var f=y(u);var c=r(4);var h=y(c);var p=r(40);var d=r(10);var v=r(6);function y(e){return e&&e.__esModule?e:{default:e}}var m=function(e){(0,h.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.serverName=r.serverName!==undefined?r.serverName:null;i.gdbName=r.gdbName!==undefined?r.gdbName:null;i.dsName=r.dsName!==undefined?r.dsName:null;i.rcsName=r.rcsName!==undefined?r.rcsName:null;i.User=r.User!==undefined?r.User:null;i.Password=r.Password!==undefined?r.Password:null;i.containAll=r.containAll!==undefined?r.containAll:true;return i}(0,l.default)(t,[{key:"getServerList",value:function e(t,r){var i=this;i.partUrl="datasource?f=json";var n=i.getFullUrl();var a=new d.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getGDBList",value:function e(t,r){var i=this;if(i.serverName.toLowerCase()==="mapgislocal"){i.partUrl="datasource/"+i.serverName+"?f=json"}else{i.partUrl="datasource/"+i.serverName+"?user="+i.User+"&psw="+i.Password+"&f=json"}var n=i.getFullUrl();var a=new d.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getDsList",value:function e(t,r){var i=this;if(i.serverName.toLowerCase()==="mapgislocal"){i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/ds?containAll="+i.containAll+"&f=json"}else{i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/ds?user="+i.User+"&psw="+i.Password+"&containAll="+i.containAll+"&f=json"}var n=i.getFullUrl();var a=new d.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getRcsList",value:function e(t,r){var i=this;if(i.serverName.toLowerCase()==="mapgislocal"){i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/rcs?f=json"}else{i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/rcs?user="+i.User+"&psw="+i.Password+"&containAll="+i.containAll+"&f=json"}var n=i.getFullUrl();var a=new d.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getProjectList",value:function e(t,r){var i=this;i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"?f=json";var n=i.getFullUrl();var a=new d.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getProjectInfo",value:function e(t,r,i){var n=this;n.partUrl="datasource/"+n.serverName+"/"+n.gdbName+"/"+t+"?f=json";var a=n.getFullUrl();var o=new d.IgsServiceBase(a,{eventListeners:{scope:n,processCompleted:r,processFailed:i}});o.processAsync()}},{key:"AttachGDB",value:function e(t,r,i){var n=this;if(n.serverName===null||n.gdbName===null||t===null){return}n.partUrl="gdb/attach/"+n.gdbName+"?gdbSvrName="+n.serverName+"&path="+t+"&f=json";if(n.User!==null&&n.Password!==null){n.partUrl+="&gdbUserName="+n.User+"&gdbPwd="+n.Password}var a=n.getFullUrl();var o=new d.IgsServiceBase(a,{eventListeners:{scope:n,processCompleted:r,processFailed:i}});o.processAsync()}},{key:"DetachGDB",value:function e(t,r){var i=this;if(i.serverName===null||i.gdbName===null){return}i.partUrl="gdb/detach/"+i.gdbName+"?gdbSvrName="+i.serverName;if(i.User!==null&&i.Password!==null){i.partUrl+="&gdbUserName="+i.User+"&gdbPwd="+i.Password}var n=i.getFullUrl();var a=new d.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"CreateGDB",value:function e(t,r,i){var n=this;if(n.serverName===null||n.gdbName===null){return}if(n.serverName.toLowerCase()==="mapgislocal"&&t===null){return}n.partUrl="gdb/creat/"+n.gdbName+"?gdbSvrName="+n.serverName+"&path="+t+"&f=json";if(n.User!==null&&n.Password!==null){n.partUrl+="&gdbUserName="+n.User+"&gdbPwd="+n.Password}var a=n.getFullUrl();var o=new d.IgsServiceBase(a,{eventListeners:{scope:n,processCompleted:r,processFailed:i}});o.processAsync()}},{key:"DeleteGDB",value:function e(t,r){var i=this;if(i.serverName===null||i.gdbName===null){return}i.partUrl="gdb/delete/"+i.gdbName+"?gdbSvrName="+i.serverName;if(i.User!==null&&i.Password!==null){i.partUrl+="&gdbUserName="+i.User+"&gdbPwd="+i.Password}var n=i.getFullUrl();var a=new d.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}}]);return t}(p.CatalogService);t.GDBInfo=m;Zondy.Catalog.GDBInfo=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.QueryParameterBase=undefined;var i=r(1);var n=u(i);var a=r(0);var o=r(6);var s=r(102);var l=r(166);function u(e){return e&&e.__esModule?e:{default:e}}var f=function e(t){(0,n.default)(this,e);var r=t?t:{};(0,o.extend)(this,r);this.geometry=r.geometry!==undefined?r.geometry:null;this.where=r.where!==undefined?r.where:null;this.rule=r.rule!==undefined?r.rule:null;this.objectIds=r.objectIds!==undefined?r.objectIds:null;this.pageIndex=r.pageIndex!==undefined?r.pageIndex:0;this.recordNumber=r.recordNumber!==undefined?r.recordNumber:20;this.resultFormat=r.resultFormat!==undefined?r.resultFormat:"json";this.struct=r.struct!==undefined?r.struct:new s.QueryFeatureStruct;this.orderField=r.orderField!==undefined?r.orderField:null;this.isAsc=r.isAsc!==undefined?r.isAsc:false;this.cursorType=r.cursorType!==undefined?r.cursorType:"forward"};t.QueryParameterBase=f;a.Zondy.Service.QueryParameterBase=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.QueryFeatureRule=undefined;var i=r(0);var n=r(6);var a=function e(t){var r=t?t:{};(0,n.extend)(this,r);this.CompareRectOnly=r.CompareRectOnly!==undefined&&typeof r.CompareRectOnly==="boolean"?r.CompareRectOnly:false;this.EnableDisplayCondition=r.EnableDisplayCondition!==undefined&&typeof r.EnableDisplayCondition==="boolean"?r.EnableDisplayCondition:false;this.MustInside=r.MustInside!==undefined&&typeof r.MustInside==="boolean"?r.MustInside:false;this.Intersect=r.Intersect!==undefined&&typeof r.Intersect==="boolean"?r.Intersect:false};a.prototype.toJSON=function(){return(0,n.toJSON)(this)};t.QueryFeatureRule=a;i.Zondy.Service.QueryFeatureRule=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MultiGeoQueryParameter=undefined;var i=r(0);var n=r(6);var a=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.geometry=r.geometry!==undefined?r.geometry:null;this.geometryType=r.geometryType!==undefined?r.geometryType:null;this.resultFormat=r.resultFormat!==undefined?r.resultFormat:"json";this.nearDis=r.nearDis!==undefined?r.nearDis:1e-4};a.prototype.getParameterURL=function(){var e="";e+="?f="+this.resultFormat;e+="&geometryType="+this.geometryType;e+="&nearDis="+this.nearDis;return e};t.MultiGeoQueryParameter=a;i.Zondy.Service.MultiGeoQueryParameter=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ObjClsQueryParameter=undefined;var i=r(0);var n=r(6);var a=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.objectIds=r.objectIds!==undefined?r.objectIds:null;this.where=r.where!==undefined?r.where:null;this.resultFormat=r.resultFormat!==undefined?r.resultFormat:"json"};a.prototype.getParameterURL=function(){var e="";e+="&f="+this.resultFormat;if(this.objectIds!==null){e+="&objectIds="+this.objectIds}else{if(this.where!==null){e+="&where="+this.where}}return e};t.ObjClsQueryParameter=a;i.Zondy.Service.ObjClsQueryParameter=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CAllOtherDataItemInfoSource=undefined;var i=r(0);var n={DefaultThemeInfo:1,DataItemIntrinsicInfo:2};t.CAllOtherDataItemInfoSource=n;i.Zondy.Object.Theme.CAllOtherDataItemInfoSource=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CAnnInfo=undefined;var i=r(0);var n=r(6);var a=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.LibID=r.LibID!==undefined?r.LibID:0;this.Ovprnt=r.Ovprnt!==undefined?r.Ovprnt:false;this.Angle=r.Ovprnt!==undefined?r.Ovprnt:0;this.BackClr=r.BackClr!==undefined?r.BackClr:0;this.BackExp=r.BackExp!==undefined?r.BackExp:0;this.Chnt=r.Chnt!==undefined?r.Chnt:0;this.Color=r.Color!==undefined?r.Color:0;this.FontAngle=r.FontAngle!==undefined?r.FontAngle:0;this.Height=r.Height!==undefined?r.Height:0;this.Ifnt=r.Ifnt!==undefined?r.Ifnt:0;this.Ifnx=r.Ifnx!==undefined?r.Ifnx:0;this.IsFilled=r.IsFilled!==undefined?r.IsFilled:false;this.IsHzpl=r.IsHzpl!==undefined?r.IsHzpl:true;this.OffsetX=r.OffsetX!==undefined?r.OffsetX:0;this.OffsetY=r.OffsetY!==undefined?r.OffsetY:0;this.Space=r.Space!==undefined?r.Space:0;this.Width=r.Width!==undefined?r.Width:0};t.CAnnInfo=a;i.Zondy.Object.Theme.CAnnInfo=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CChartLabelFormat=undefined;var i=r(0);var n={Unknown:0,Value:1,Percent:2};t.CChartLabelFormat=n;i.Zondy.Object.Theme.CChartLabelFormat=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CChartTheme=undefined;var i=r(2);var n=y(i);var a=r(1);var o=y(a);var s=r(3);var l=y(s);var u=r(4);var f=y(u);var c=r(0);var h=r(22);var p=r(173);var d=r(174);var v=r(177);function y(e){return e&&e.__esModule?e:{default:e}}var m=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e?e:{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.ChartType=r.ChartType!==undefined?r.ChartType:p.CChartType.Bar;i.ChartThemeInfoArr=r.ChartThemeInfoArr!==undefined?r.ChartThemeInfoArr:null;i.RepresentInfo=r.RepresentInfo!==undefined?r.RepresentInfo:null;i.Type="CChartTheme";return i}return t}(h.CTheme);t.CChartTheme=m;c.Zondy.Object.Theme.CChartTheme=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CChartType=undefined;var i=r(0);var n={Unknown:0,Bar:1,Bar3D:2,Pie:3,Pie3D:4,Line:5,Line3D:6,Point:7};t.CChartType=n;i.Zondy.Object.Theme.CChartType=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CChartThemeInfo=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(32);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=r?r:{};var a=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,i));a.Expression=e!==undefined?e:"";return a}return t}(h.CThemeInfo);t.CChartThemeInfo=d;c.Zondy.Object.Theme.CChartThemeInfo=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CLinInfo=undefined;var i=r(0);var n=r(6);var a=r(15);var o=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.LibID=r.LibID!==undefined?r.LibID:0;this.Ovprnt=r.Ovprnt!==undefined?r.Ovprnt:false;this.AdjustFlg=r.AdjustFlg!==undefined?r.AdjustFlg:a.CLinAdjustType.Adjust;this.HeadType=r.HeadType!==undefined?r.HeadType:a.CLinHeadType.Round;this.JointType=r.JointType!==undefined?r.JointType:a.CLinJointType.Round;this.LinStyID=r.LinStyID!==undefined?r.LinStyID:0;this.MakeMethod=r.MakeMethod!==undefined?r.MakeMethod:a.CLinStyleMakeType.Byrule;this.OutClr=r.OutClr!==undefined?r.OutClr:[46,4,3];this.XScale=r.XScale!==undefined?r.XScale:10;this.YScale=r.YScale!==undefined?r.YScale:10;this.OutPenW=r.OutPenW!==undefined?r.OutPenW:[.05,.05,.05]};t.CLinInfo=o;i.Zondy.Object.Theme.CLinInfo=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CRegInfo=undefined;var i=r(0);var n=r(6);var a=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.LibID=r.LibID!==undefined?r.LibID:0;this.Ovprnt=r.Ovprnt!==undefined?r.Ovprnt:false;this.Angle=r.Angle!==undefined?r.Angle:0;this.EndClr=r.EndClr!==undefined?r.EndClr:0;this.FillClr=r.FillClr!==undefined?r.FillClr:46;this.FillMode=r.FillMode!==undefined?r.FillMode:0;this.FullPatFlg=r.FullPatFlg!==undefined?r.FullPatFlg:true;this.PatClr=r.PatClr!==undefined?r.PatClr:3;this.PatHeight=r.PatHeight!==undefined?r.PatHeight:5;this.PatID=r.PatID!==undefined?r.PatID:0;this.PatWidth=r.PatWidth!==undefined?r.PatWidth:5;this.OutPenW=r.OutPenW!==undefined?r.OutPenW:1};t.CRegInfo=a;i.Zondy.Object.Theme.CRegInfo=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CChartThemeRepresentInfo=undefined;var i=r(0);var n=r(6);var a=r(170);var o=r(171);var s=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.AnnInfoLabel=r.AnnInfoLabel!==undefined?r.AnnInfoLabel:new a.CAnnInfo;this.DigitLabel=r.DigitLabel!==undefined?r.DigitLabel:0;this.FormatLabel=r.FormatLabel!==undefined?r.FormatLabel:o.CChartLabelFormat.Unknown;this.IsDrawLabel=r.IsDrawLabel!==undefined?r.IsDrawLabel:true;this.LineColor=r.LineColor!==undefined?r.LineColor:-1;this.MaxLength=r.MaxLength!==undefined?r.MaxLength:30;this.MinRadius=r.MinRadius!==undefined?r.MinRadius:10;this.PieSizeFixFlag=r.PieSizeFixFlag!==undefined?r.PieSizeFixFlag:0;this.PieTiltedAngle=r.PieTiltedAngle!==undefined?r.PieTiltedAngle:30;this.PlotRadius=r.PlotRadius!==undefined?r.PlotRadius:1;this.ThickPersent=r.ThickPersent!==undefined?r.ThickPersent:10;this.Width=r.Width!==undefined?r.Width:3};t.CChartThemeRepresentInfo=s;i.Zondy.Object.Theme.CChartThemeRepresentInfo=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CDotDensityTheme=undefined;var i=r(2);var n=d(i);var a=r(1);var o=d(a);var s=r(3);var l=d(s);var u=r(4);var f=d(u);var c=r(0);var h=r(22);var p=r(65);function d(e){return e&&e.__esModule?e:{default:e}}var v=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e?e:{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.Expression=r.Expression!==undefined?r.Expression:"";i.Info=r.Info!==undefined?r.Info:null;i.Value=r.Value!==undefined?r.Value:null;i.Type="CDotDensityTheme";return i}return t}(h.CTheme);t.CDotDensityTheme=v;c.Zondy.Object.Theme.CDotDensityTheme=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CFourColorTheme=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(22);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e?e:{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.ClrInfo=r.ClrInfo!==undefined?r.ClrInfo:[25,57,89,121];i.Type="CFourColorTheme";return i}return t}(h.CTheme);t.CFourColorTheme=d;c.Zondy.Object.Theme.CFourColorTheme=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CGraduatedSymbolTheme=undefined;var i=r(2);var n=d(i);var a=r(1);var o=d(a);var s=r(3);var l=d(s);var u=r(4);var f=d(u);var c=r(0);var h=r(22);var p=r(65);function d(e){return e&&e.__esModule?e:{default:e}}var v=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e?e:{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.BaseValue=r.BaseValue!==undefined?r.BaseValue:141e-6;i.DispMinus=r.DispMinus!==undefined?r.DispMinus:false;i.DispZero=r.DispZero!==undefined?r.DispZero:false;i.Expression=r.Expression!==undefined?r.Expression:null;i.MinusPntInfo=r.MinusPntInfo!==undefined?r.MinusPntInfo:null;i.PlusPntInfo=r.PlusPntInfo!==undefined?r.PlusPntInfo:null;i.ZeroPntInfo=r.ZeroPntInfo!==undefined?r.ZeroPntInfo:null;i.Type="CGraduatedSymbolTheme";return i}return t}(h.CTheme);t.CGraduatedSymbolTheme=v;c.Zondy.Object.Theme.CGraduatedSymbolTheme=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CMultiClassTheme=undefined;var i=r(2);var n=v(i);var a=r(1);var o=v(a);var s=r(3);var l=v(s);var u=r(4);var f=v(u);var c=r(0);var h=r(22);var p=r(32);var d=r(182);function v(e){return e&&e.__esModule?e:{default:e}}var y=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e?e:{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.DefaultInfo=r.DefaultInfo!==undefined?r.DefaultInfo:null;i.ExpInfoArr=r.ExpInfoArr!==undefined?r.ExpInfoArr:null;i.MultiClassThemeInfoArr=r.MultiClassThemeInfoArr!==undefined?r.MultiClassThemeInfoArr:null;i.GeoInfoType=r.GeoInfoType!==undefined?r.GeoInfoType:null;i.Type="CMultiClassTheme";return i}return t}(h.CTheme);t.CMultiClassTheme=y;c.Zondy.Object.Theme.CMultiClassTheme=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ExpInfo=undefined;var i=r(0);var n=r(6);var a=function e(t,r,i){var a=i!==undefined?i:{};(0,n.extend)(this,a);this.Expression=t!==undefined?t:"";this.ItemValueArr=r!==undefined?r:null};t.ExpInfo=a;i.Zondy.Object.Theme.ExpInfo=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CRandomTheme=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(22);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e?e:{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.Type="CRandomTheme";return i}return t}(h.CTheme);t.CRandomTheme=d;c.Zondy.Object.Theme.CRandomTheme=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CRangeTheme=undefined;var i=r(2);var n=y(i);var a=r(1);var o=y(a);var s=r(3);var l=y(s);var u=r(4);var f=y(u);var c=r(0);var h=r(22);var p=r(169);var d=r(32);var v=r(185);function y(e){return e&&e.__esModule?e:{default:e}}var m=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e?e:{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.AllOtherDataItemInfoSource=r.AllOtherDataItemInfoSource!==undefined?r.AllOtherDataItemInfoSource:p.CAllOtherDataItemInfoSource.DefaultThemeInfo;i.Expression=r.Expression!==undefined?r.Expression:"";i.DefaultInfo=r.DefaultInfo!==undefined?r.DefaultInfo:null;i.RangeThemeInfoArr=r.RangeThemeInfoArr!==undefined?r.RangeThemeInfoArr:null;i.GeoInfoType=r.GeoInfoType!==undefined?r.GeoInfoType:null;i.Type="CRangeTheme";return i}return t}(h.CTheme);t.CRangeTheme=m;c.Zondy.Object.Theme.CRangeTheme=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CRangeThemeInfo=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(32);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e,r,i){(0,o.default)(this,t);var a=i?i:{};var s=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,a));s.StartValue=e!==undefined?e:"";s.EndValue=r!==undefined?r:"";return s}return t}(h.CThemeInfo);t.CRangeThemeInfo=d;c.Zondy.Object.Theme.CRangeThemeInfo=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CSimpleTheme=undefined;var i=r(2);var n=d(i);var a=r(1);var o=d(a);var s=r(3);var l=d(s);var u=r(4);var f=d(u);var c=r(0);var h=r(22);var p=r(32);function d(e){return e&&e.__esModule?e:{default:e}}var v=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e?e:{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.ThemeInfo=r.ThemeInfo!==undefined?r.ThemeInfo:new p.CThemeInfo;i.Type="CSimpleTheme";return i}return t}(h.CTheme);t.CSimpleTheme=v;c.Zondy.Object.Theme.CSimpleTheme=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CUniqueTheme=undefined;var i=r(2);var n=v(i);var a=r(1);var o=v(a);var s=r(3);var l=v(s);var u=r(4);var f=v(u);var c=r(0);var h=r(22);var p=r(32);var d=r(188);function v(e){return e&&e.__esModule?e:{default:e}}var y=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e?e:{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.DefaultInfo=r.DefaultInfo!==undefined?r.DefaultInfo:null;i.Expression=r.Expression!==undefined?r.Expression:"";i.UniqueThemeInfoArr=r.UniqueThemeInfoArr!==undefined?r.UniqueThemeInfoArr:null;i.GeoInfoType=r.GeoInfoType!==undefined?r.GeoInfoType:null;i.Type="CUniqueTheme";return i}return t}(h.CTheme);t.CUniqueTheme=y;c.Zondy.Object.Theme.CUniqueTheme=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CUniqueThemeInfo=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(32);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=r?r:{};var a=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,i));a.Value=e!==undefined?e:"";return a}return t}(h.CThemeInfo);t.CUniqueThemeInfo=d;c.Zondy.Object.Theme.CUniqueThemeInfo=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FolderInfo=undefined;var i=r(0);var n=r(110);var a=function e(t,r){this.name=t!==undefined?t:null;this.attribute=r!==undefined?r:null};t.FolderInfo=a;i.Zondy.Object.Theme.FolderInfo=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ThemesInfo=undefined;var i=r(0);var n=r(22);var a=function e(t,r){this.LayerName=t!==undefined?t:null;this.ThemeArr=r!==undefined?r:null};t.ThemesInfo=a;i.Zondy.Object.Theme.ThemesInfo=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.LevelRenderer=undefined;var i=r(1);var n=f(i);var a=r(5);var o=f(a);var s=r(0);var l=r(6);var u=r(192);function f(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(){(0,n.default)(this,e);e._instances={};e.Tool={};this.CLASS_NAME="Zondy.LevelRenderer"}(0,o.default)(e,[{key:"destroy",value:function e(){this.dispose()}},{key:"init",value:function t(r){var i=new u.Render((0,l.newGuid)(),r);e._instances[i.id]=i;return i}},{key:"dispose",value:function t(r){if(r){r.dispose();this.delInstance(r.id)}else{for(var i in e._instances){e._instances[i].dispose()}e._instances={}}return this}},{key:"getInstance",value:function t(r){return e._instances[r]}},{key:"delInstance",value:function t(r){delete e._instances[r];return this}}]);return e}();t.LevelRenderer=c;s.Zondy.LevelRenderer=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Render=undefined;var i=r(1);var n=p(i);var a=r(5);var o=p(a);var s=r(0);var l=r(6);var u=r(193);var f=r(202);var c=r(203);var h=r(204);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t,r){(0,n.default)(this,e);this.id=t;this.storage=new u.Storage;this.painter=new f.Painter(r,this.storage);this.handler=new c.Handler(r,this.storage,this.painter);this.animatingElements=[];this.animation=new h.Animation({stage:{update:e.getFrameCallback(this)}});this._needsRefreshNextFrame=false;this.animation.start();this.CLASS_NAME="Zondy.LevelRenderer.Render"}(0,o.default)(e,[{key:"destroy",value:function e(){this.id=null;this.storage=null;this.painter=null;this.handler=null;this.animatingElements=null;this.animation=null;this._needsRefreshNextFrame=null}},{key:"getId",value:function e(){return this.id}},{key:"addShape",value:function e(t){this.storage.addRoot(t);return this}},{key:"addGroup",value:function e(t){this.storage.addRoot(t);return this}},{key:"delShape",value:function e(t){this.storage.delRoot(t);return this}},{key:"delGroup",value:function e(t){this.storage.delRoot(t);return this}},{key:"modShape",value:function e(t,r){this.storage.mod(t,r);return this}},{key:"modGroup",value:function e(t,r){this.storage.mod(t,r);return this}},{key:"modLayer",value:function e(t,r){this.painter.modLayer(t,r);return this}},{key:"addHoverShape",value:function e(t){this.storage.addHover(t);return this}},{key:"render",value:function e(t){this.painter.render(t);this._needsRefreshNextFrame=false;return this}},{key:"refresh",value:function e(t){this.painter.refresh(t);this._needsRefreshNextFrame=false;return this}},{key:"refreshNextFrame",value:function e(){this._needsRefreshNextFrame=true;return this}},{key:"refreshHover",value:function e(t){this.painter.refreshHover(t);return this}},{key:"refreshShapes",value:function e(t,r){this.painter.refreshShapes(t,r);return this}},{key:"resize",value:function e(){this.painter.resize();return this}},{key:"animate",value:function e(t,r,i){if(typeof t==="string"){t=this.storage.get(t)}if(t){var n;if(r){var a=r.split(".");var o=t;for(var s=0,u=a.length;s<u;s++){if(!o){continue}o=o[a[s]]}if(o){n=o}}else{n=t}if(!n){return}var f=this.animatingElements;if(typeof t.__aniCount==="undefined"){t.__aniCount=0}if(t.__aniCount===0){f.push(t)}t.__aniCount++;return this.animation.animate(n,{loop:i}).done(function(){t.__aniCount--;if(t.__aniCount===0){var e=(0,l.indexOf)(f,t);f.splice(e,1)}})}}},{key:"clearAnimation",value:function e(){this.animation.clear()}},{key:"getWidth",value:function e(){return this.painter.getWidth()}},{key:"getHeight",value:function e(){return this.painter.getHeight()}},{key:"toDataURL",value:function e(t,r,i){return this.painter.toDataURL(t,r,i)}},{key:"shapeToImage",value:function e(t,r,i){var n=(0,l.newGuid)();return this.painter.shapeToImage(n,t,r,i)}},{key:"on",value:function e(t,r){this.handler.on(t,r);return this}},{key:"un",value:function e(t,r){this.handler.un(t,r);return this}},{key:"trigger",value:function e(t,r){this.handler.trigger(t,r);this.handler.dispatch(t,r);return this}},{key:"clear",value:function e(){this.storage.delRoot();this.painter.clear();return this}},{key:"dispose",value:function e(){this.animation.stop();this.clear();this.storage.dispose();this.painter.dispose();this.handler.dispose();this.animation=null;this.animatingElements=null;this.storage=null;this.painter=null;this.handler=null}},{key:"updateHoverShapes",value:function e(t){this.painter.updateHoverLayer(t);return this}},{key:"getAllShapes",value:function e(){return this.storage._shapeList}},{key:"clearAll",value:function e(){this.clear();this.painter.clearHover();return this}},{key:"getHoverOne",value:function e(){return this.handler.getLastHoverOne()}}],[{key:"getFrameCallback",value:function e(t){return function(){var e=t.animatingElements;if(e instanceof Array){for(var r=0,i=e.length;r<i;r++){t.storage.mod(e[r].id)}if(e.length||t._needsRefreshNextFrame){t.refresh()}}}}}]);return e}();t.Render=d;s.Zondy.LevelRenderer.Render=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Storage=undefined;var i=r(1);var n=f(i);var a=r(5);var o=f(a);var s=r(0);var l=r(6);var u=r(194);function f(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(){(0,n.default)(this,e);this._elements={};this._hoverElements=[];this._roots=[];this._shapeList=[];this._shapeListOffset=0;this.CLASS_NAME="Zondy.LevelRenderer.Storage"}(0,o.default)(e,[{key:"destroy",value:function e(){this.dispose();this._shapeList=null;this._shapeListOffset=null}},{key:"iterShape",value:function e(t,r){if(!r){var i={hover:false,normal:"down",update:false};r=i}if(r.hover){for(var n=0,a=this._hoverElements.length;n<a;n++){var o=this._hoverElements[n];o.updateTransform();if(t(o)){return this}}}if(r.update){this.updateShapeList()}switch(r.normal){case"down":{var s=this._shapeList.length;while(s--){if(t(this._shapeList[s])){return this}}break}default:{for(var l=0,u=this._shapeList.length;l<u;l++){if(t(this._shapeList[l])){return this}}break}}return this}},{key:"getHoverShapes",value:function t(r){var i=[],n=this._hoverElements.length;for(var a=0;a<n;a++){i.push(this._hoverElements[a]);var o=this._hoverElements[a].hoverConnect;if(o){var s;o=o instanceof Array?o:[o];for(var l=0,u=o.length;l<u;l++){s=o[l].id?o[l]:this.get(o[l]);if(s){i.push(s)}}}}i.sort(e.shapeCompareFunc);if(r){for(var f=0,c=i.length;f<c;f++){i[f].updateTransform()}}return i}},{key:"getShapeList",value:function e(t){if(t){this.updateShapeList()}return this._shapeList}},{key:"updateShapeList",value:function t(){this._shapeListOffset=0;var r=this._roots.length;for(var i=0;i<r;i++){var n=this._roots[i];this._updateAndAddShape(n)}this._shapeList.length=this._shapeListOffset;var a=this._shapeList.length;for(var o=0;o<a;o++){this._shapeList[o].__renderidx=o}this._shapeList.sort(e.shapeCompareFunc)}},{key:"_updateAndAddShape",value:function e(t,r){if(t.ignore){return}t.updateTransform();if(t.type==="group"){if(t.clipShape){t.clipShape.parent=t;t.clipShape.updateTransform();if(r){r=r.slice();r.push(t.clipShape)}else{r=[t.clipShape]}}for(var i=0;i<t._children.length;i++){var n=t._children[i];n.__dirty=t.__dirty||n.__dirty;this._updateAndAddShape(n,r)}t.__dirty=false}else{t.__clipShapes=r;this._shapeList[this._shapeListOffset++]=t}}},{key:"mod",value:function e(t,r){var i=this._elements[t];if(i){i.modSelf();if(r){if(r.parent||r._storage||r.__startClip){var n={};for(var a in r){if(a==="parent"||a==="_storage"||a==="__startClip"){continue}if(r.hasOwnProperty(a)){n[a]=r[a]}}(0,l.merge)(i,n,true)}else{(0,l.merge)(i,r,true)}}}return this}},{key:"drift",value:function e(t,r,i){var n=this._elements[t];if(n){n.needTransform=true;if(n.draggable==="horizontal"){i=0}else if(n.draggable==="vertical"){r=0}if(!n.ondrift||n.ondrift&&!n.ondrift(r,i)){n.drift(r,i)}}return this}},{key:"addHover",value:function e(t){t.updateNeedTransform();this._hoverElements.push(t);return this}},{key:"delHover",value:function e(){this._hoverElements=[];return this}},{key:"hasHoverShape",value:function e(){return this._hoverElements.length>0}},{key:"addRoot",value:function e(t){if(t instanceof u.Group){t.addChildrenToStorage(this)}this.addToMap(t);this._roots.push(t)}},{key:"delRoot",value:function e(t){if(typeof t=="undefined"){for(var r=0;r<this._roots.length;r++){var i=this._roots[r];if(i instanceof u.Group){i.delChildrenFromStorage(this)}}this._elements={};this._hoverElements=[];this._roots=[];return}if(t instanceof Array){var n=t.length;for(var a=0;a<n;a++){this.delRoot(t[a])}return}var o;if(typeof t=="string"){o=this._elements[t]}else{o=t}var s=(0,l.indexOf)(this._roots,o);if(s>=0){this.delFromMap(o.id);this._roots.splice(s,1);if(o instanceof u.Group){o.delChildrenFromStorage(this)}}}},{key:"addToMap",value:function e(t){if(t instanceof u.Group){t._storage=this}t.modSelf();this._elements[t.id]=t;return this}},{key:"get",value:function e(t){return this._elements[t]}},{key:"delFromMap",value:function e(t){var r=this._elements[t];if(r){delete this._elements[t];if(r instanceof u.Group){r._storage=null}}return this}},{key:"dispose",value:function e(){this._elements=null;this._roots=null;this._hoverElements=null}}],[{key:"shapeCompareFunc",value:function e(t,r){if(t.zlevel===r.zlevel){if(t.z===r.z){return t.__renderidx-r.__renderidx}return t.z-r.z}return t.zlevel-r.zlevel}}]);return e}();t.Storage=c;s.Zondy.LevelRenderer.Storage=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Group=undefined;var i=r(2);var n=_(i);var a=r(1);var o=_(a);var s=r(5);var l=_(s);var u=r(3);var f=_(u);var c=r(7);var h=_(c);var p=r(4);var d=_(p);var v=r(0);var y=r(6);var m=r(50);var g=r(67);function _(e){return e&&e.__esModule?e:{default:e}}var x=function(e){(0,d.default)(t,e);function t(e){(0,o.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));e=e||{};r.id=null;r.type="group";r.clipShape=null;r._children=[];r._storage=null;r.__dirty=true;r.ignore=false;(0,y.extend)(r,e);r.id=r.id||(0,y.newGuid)();r.CLASS_NAME="Zondy.LevelRenderer.Group";return r}(0,l.default)(t,[{key:"destroy",value:function e(){this.id=null;this.type=null;this.clipShape=null;this._children=null;this._storage=null;this.__dirty=null;this.ignore=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"children",value:function e(){return this._children.slice()}},{key:"childAt",value:function e(t){return this._children[t]}},{key:"addChild",value:function e(r){if(r===this){return}if(r.parent===this){return}if(r.parent){r.parent.removeChild(r)}this._children.push(r);r.parent=this;if(this._storage&&this._storage!==r._storage){this._storage.addToMap(r);if(r instanceof t){r.addChildrenToStorage(this._storage)}}}},{key:"removeChild",value:function e(r){var i=(0,y.indexOf)(this._children,r);this._children.splice(i,1);r.parent=null;if(this._storage){this._storage.delFromMap(r.id);if(r instanceof t){r.delChildrenFromStorage(this._storage)}}}},{key:"eachChild",value:function e(t,r){var i=!!r;for(var n=0;n<this._children.length;n++){var a=this._children[n];if(i){t.call(r,a)}else{t(a)}}}},{key:"traverse",value:function e(t,r){var i=!!r;for(var n=0;n<this._children.length;n++){var a=this._children[n];if(i){t.call(r,a)}else{t(a)}if(a.type==="group"){a.traverse(t,r)}}}},{key:"addChildrenToStorage",value:function e(t){for(var r=0;r<this._children.length;r++){var i=this._children[r];t.addToMap(i);if(i.type==="group"){i.addChildrenToStorage(t)}}}},{key:"delChildrenFromStorage",value:function e(t){for(var r=0;r<this._children.length;r++){var i=this._children[r];t.delFromMap(i.id);if(i.type==="group"){i.delChildrenFromStorage(t)}}}},{key:"modSelf",value:function e(){this.__dirty=true}}]);return t}((0,y.mixin)(m.Eventful,g.Transformable));t.Group=x;v.Zondy.LevelRenderer.Group=x},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Area=undefined;var i=r(1);var n=f(i);var a=r(5);var o=f(a);var s=r(0);var l=r(42);var u=r(68);function f(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(){(0,n.default)(this,e);this.util=new l.Util;this.curve=new u.Curve;this._ctx=null;this._textWidthCache={};this._textHeightCache={};this._textWidthCacheCounter=0;this._textHeightCacheCounter=0;this.TEXT_CACHE_MAX=5e3;this.PI2=Math.PI*2;this.roots=[-1,-1,-1];this.extrema=[-1,-1];this.CLASS_NAME="Zondy.LevelRenderer.Tool.Area"}(0,o.default)(e,[{key:"normalizeRadian",value:function e(t){t%=this.PI2;if(t<0){t+=this.PI2}return t}},{key:"isInside",value:function e(t,r,i,n){if(!r||!t){return false}var a=t.type;this._ctx=this._ctx||this.util.getContext();var o=this._mathMethod(t,r,i,n);if(typeof o!="undefined"){return o}if(t.buildPath&&this._ctx.isPointInPath){return this._buildPathMethod(t,this._ctx,r,i,n)}switch(a){case"ellipse":case"smicellipse":return true;case"trochoid":var s=r.location==="out"?r.r1+r.r2+r.d:r.r1-r.r2+r.d;return this.isInsideCircle(r,i,n,s);case"rose":return this.isInsideCircle(r,i,n,r.maxr);default:return false}}},{key:"_mathMethod",value:function e(t,r,i,n){var a=t.type;switch(a){case"bezier-curve":if(typeof r.cpX2==="undefined"){return this.isInsideQuadraticStroke(r.xStart,r.yStart,r.cpX1,r.cpY1,r.xEnd,r.yEnd,r.lineWidth,i,n)}return this.isInsideCubicStroke(r.xStart,r.yStart,r.cpX1,r.cpY1,r.cpX2,r.cpY2,r.xEnd,r.yEnd,r.lineWidth,i,n);case"line":return this.isInsideLine(r.xStart,r.yStart,r.xEnd,r.yEnd,r.lineWidth,i,n);case"broken-line":return this.isInsideBrokenLine(r.pointList,r.lineWidth,i,n);case"smicbroken-line":{var o=i;var s=n;if(t.refOriginalPosition){o=i-t.refOriginalPosition[0];s=n-t.refOriginalPosition[1]}return this.isInsideBrokenLine(r.pointList,r.lineWidth,o,s)}case"ring":return this.isInsideRing(r.x,r.y,r.r0,r.r,i,n);case"smicring":{var l=r.x;var u=r.y;if(t.refOriginalPosition){l=r.x+t.refOriginalPosition[0];u=r.y+t.refOriginalPosition[1]}return this.isInsideRing(l,u,r.r0,r.r,i,n)}case"circle":return this.isInsideCircle(r.x,r.y,r.r,i,n);case"smicpoint":{var f=i;var c=n;if(t.refOriginalPosition){f=i-t.refOriginalPosition[0];c=n-t.refOriginalPosition[1]}return this.isInsideCircle(r.x,r.y,r.r,f,c)}case"sector":{var h=r.startAngle*Math.PI/180;var p=r.endAngle*Math.PI/180;if(!r.clockWise){h=-h;p=-p}return this.isInsideSector(r.x,r.y,r.r0,r.r,h,p,!r.clockWise,i,n)}case"smicsector":{var d=r.startAngle*Math.PI/180;var v=r.endAngle*Math.PI/180;if(!r.clockWise){d=-d;v=-v}var y=r.x;var m=r.y;if(t.refOriginalPosition){y=r.x+t.refOriginalPosition[0];m=r.y+t.refOriginalPosition[1]}return this.isInsideSector(y,m,r.r0,r.r,d,v,!r.clockWise,i,n)}case"path":return this.isInsidePath(r.pathArray,Math.max(r.lineWidth,5),r.brushType,i,n);case"polygon":case"star":case"smicstar":case"isogon":case"smicisogon":return this.isInsidePolygon(r.pointList,i,n);case"smicpolygon":{var g=i;var _=n;if(t.refOriginalPosition){g=i-t.refOriginalPosition[0];_=n-t.refOriginalPosition[1]}if(t.holePolygonPointLists&&t.holePolygonPointLists.length>0){var x=this.isInsidePolygon(r.pointList,g,_);var b=t.holePolygonPointLists;var w=false;for(var S=0,C=b.length;S<C;S++){var T=b[S];var P=this.isInsidePolygon(T,g,_);if(P===true){w=true}}return x===true&&w===false}else{return this.isInsidePolygon(r.pointList,g,_)}}case"text":var M=r.__rect||t.getRect(r);return this.isInsideRect(M.x,M.y,M.width,M.height,i,n);case"smictext":var I=t.getTextBackground(r);return this.isInsidePolygon(I,i,n);case"rectangle":case"image":return this.isInsideRect(r.x,r.y,r.width,r.height,i,n);case"smicimage":{var A=r.x;var L=r.y;if(t.refOriginalPosition){A=r.x+t.refOriginalPosition[0];L=r.y+t.refOriginalPosition[1]}return this.isInsideRect(A,L,r.width,r.height,i,n)}}}},{key:"_buildPathMethod",value:function e(t,r,i,n,a){r.beginPath();t.buildPath(r,i);r.closePath();return r.isPointInPath(n,a)}},{key:"isOutside",value:function e(t,r,i,n){return!this.isInside(t,r,i,n)}},{key:"isInsideLine",value:function e(t,r,i,n,a,o,s){if(a===0){return false}var l=Math.max(a,5);var u=0;var f=0;if(s>r+l&&s>n+l||s<r-l&&s<n-l||o>t+l&&o>i+l||o<t-l&&o<i-l){return false}if(t!==i){u=(r-n)/(t-i);f=(t*n-i*r)/(t-i)}else{return Math.abs(o-t)<=l/2}var c=u*o-s+f;var h=c*c/(u*u+1);return h<=l/2*l/2}},{key:"isInsideCubicStroke",value:function e(t,r,i,n,a,o,s,l,u,f,c){if(u===0){return false}var h=Math.max(u,5);if(c>r+h&&c>n+h&&c>o+h&&c>l+h||c<r-h&&c<n-h&&c<o-h&&c<l-h||f>t+h&&f>i+h&&f>a+h&&f>s+h||f<t-h&&f<i-h&&f<a-h&&f<s-h){return false}var p=this.curve.cubicProjectPoint(t,r,i,n,a,o,s,l,f,c,null);return p<=h/2}},{key:"isInsideQuadraticStroke",value:function e(t,r,i,n,a,o,s,l,u){if(s===0){return false}var f=Math.max(s,5);if(u>r+f&&u>n+f&&u>o+f||u<r-f&&u<n-f&&u<o-f||l>t+f&&l>i+f&&l>a+f||l<t-f&&l<i-f&&l<a-f){return false}var c=this.curve.quadraticProjectPoint(t,r,i,n,a,o,l,u,null);return c<=f/2}},{key:"isInsideArcStroke",value:function e(t,r,i,n,a,o,s,l,u){var f=this.PI2;if(s===0){return false}var c=Math.max(s,5);l-=t;u-=r;var h=Math.sqrt(l*l+u*u);if(h-c>i||h+c<i){return false}if(Math.abs(n-a)>=f){return true}if(o){var p=n;n=this.normalizeRadian(a);a=this.normalizeRadian(p)}else{n=this.normalizeRadian(n);a=this.normalizeRadian(a)}if(n>a){a+=f}var d=Math.atan2(u,l);if(d<0){d+=f}return d>=n&&d<=a||d+f>=n&&d+f<=a}},{key:"isInsideBrokenLine",value:function e(t,r,i,n){var a=Math.max(r,10);for(var o=0,s=t.length-1;o<s;o++){var l=t[o][0];var u=t[o][1];var f=t[o+1][0];var c=t[o+1][1];if(this.isInsideLine(l,u,f,c,a,i,n)){return true}}return false}},{key:"isInsideRing",value:function e(t,r,i,n,a,o){var s=(a-t)*(a-t)+(o-r)*(o-r);return s<n*n&&s>i*i}},{key:"isInsideRect",value:function e(t,r,i,n,a,o){return a>=t&&a<=t+i&&o>=r&&o<=r+n}},{key:"isInsideCircle",value:function e(t,r,i,n,a){return(n-t)*(n-t)+(a-r)*(a-r)<i*i}},{key:"isInsideSector",value:function e(t,r,i,n,a,o,s,l,u){return this.isInsideArcStroke(t,r,(i+n)/2,a,o,s,n-i,l,u)}},{key:"isInsidePolygon",value:function e(t,r,i){var n=t.length;var a=0;for(var o=0,s=n-1;o<n;o++){var l=t[s][0];var u=t[s][1];var f=t[o][0];var c=t[o][1];a+=this.windingLine(l,u,f,c,r,i);s=o}return a!==0}},{key:"windingLine",value:function e(t,r,i,n,a,o){if(o>r&&o>n||o<r&&o<n){return 0}if(n==r){return 0}var s=n<r?1:-1;var l=(o-r)/(n-r);var u=l*(i-t)+t;return u>a?s:0}},{key:"swapExtrema",value:function e(){var t=this.extrema[0];this.extrema[0]=this.extrema[1];this.extrema[1]=t}},{key:"windingCubic",value:function e(t,r,i,n,a,o,s,l,u,f){var c=this.curve;var h=this.roots;var p=this.extrema;if(f>r&&f>n&&f>o&&f>l||f<r&&f<n&&f<o&&f<l){return 0}var d=c.cubicRootAt(r,n,o,l,f,h);if(d===0){return 0}else{var v=0;var y=-1;var m,g;for(var _=0;_<d;_++){var x=h[_];var b=c.cubicAt(t,i,a,s,x);if(b<u){continue}if(y<0){y=c.cubicExtrema(r,n,o,l,p);if(p[1]<p[0]&&y>1){this.swapExtrema()}m=c.cubicAt(r,n,o,l,p[0]);if(y>1){g=c.cubicAt(r,n,o,l,p[1])}}if(y===2){if(x<p[0]){v+=m<r?1:-1}else if(x<p[1]){v+=g<m?1:-1}else{v+=l<g?1:-1}}else{if(x<p[0]){v+=m<r?1:-1}else{v+=l<m?1:-1}}}return v}}},{key:"windingQuadratic",value:function e(t,r,i,n,a,o,s,l){var u=this.curve;var f=this.roots;if(l>r&&l>n&&l>o||l<r&&l<n&&l<o){return 0}var c=u.quadraticRootAt(r,n,o,l,f);if(c===0){return 0}else{var h=u.quadraticExtremum(r,n,o);if(h>=0&&h<=1){var p=0;var d=u.quadraticAt(r,n,o,h);for(var v=0;v<c;v++){var y=u.quadraticAt(t,i,a,f[v]);if(y>s){continue}if(f[v]<h){p+=d<r?1:-1}else{p+=o<d?1:-1}}return p}else{var m=u.quadraticAt(t,i,a,f[0]);if(m>s){return 0}return o<r?1:-1}}}},{key:"windingArc",value:function e(t,r,i,n,a,o,s,l){var u=this.roots;var f=this.PI2;l-=r;if(l>i||l<-i){return 0}var c=Math.sqrt(i*i-l*l);u[0]=-c;u[1]=c;if(Math.abs(n-a)>=f){n=0;a=f;var h=o?1:-1;if(s>=u[0]+t&&s<=u[1]+t){return h}else{return 0}}if(o){var p=n;n=this.normalizeRadian(a);a=this.normalizeRadian(p)}else{n=this.normalizeRadian(n);a=this.normalizeRadian(a)}if(n>a){a+=f}var d=0;for(var v=0;v<2;v++){var y=u[v];if(y+t>s){var m=Math.atan2(l,y);var g=o?1:-1;if(m<0){m=f+m}if(m>=n&&m<=a||m+f>=n&&m+f<=a){if(m>Math.PI/2&&m<Math.PI*1.5){g=-g}d+=g}}}return d}},{key:"isInsidePath",value:function e(t,r,i,n,a){var o=0;var s=0;var l=0;var u=0;var f=0;var c=true;var h=true;i=i||"fill";var p=i==="stroke"||i==="both";var d=i==="fill"||i==="both";for(var v=0;v<t.length;v++){var y=t[v];var m=y.points;if(c||y.command==="M"){if(v>0){if(d){o+=this.windingLine(s,l,u,f,n,a)}if(o!==0){return true}}u=m[m.length-2];f=m[m.length-1];c=false;if(h&&y.command!=="A"){h=false;s=u;l=f}}switch(y.command){case"M":s=m[0];l=m[1];break;case"L":if(p){if(this.isInsideLine(s,l,m[0],m[1],r,n,a)){return true}}if(d){o+=this.windingLine(s,l,m[0],m[1],n,a)}s=m[0];l=m[1];break;case"C":if(p){if(this.isInsideCubicStroke(s,l,m[0],m[1],m[2],m[3],m[4],m[5],r,n,a)){return true}}if(d){o+=this.windingCubic(s,l,m[0],m[1],m[2],m[3],m[4],m[5],n,a)}s=m[4];l=m[5];break;case"Q":if(p){if(this.isInsideQuadraticStroke(s,l,m[0],m[1],m[2],m[3],r,n,a)){return true}}if(d){o+=this.windingQuadratic(s,l,m[0],m[1],m[2],m[3],n,a)}s=m[2];l=m[3];break;case"A":var g=m[0];var _=m[1];var x=m[2];var b=m[3];var w=m[4];var S=m[5];var C=Math.cos(w)*x+g;var T=Math.sin(w)*b+_;if(!h){o+=this.windingLine(s,l,C,T)}else{h=false;u=C;f=T}var P=(n-g)*b/x+g;if(p){if(this.isInsideArcStroke(g,_,b,w,w+S,1-m[7],r,P,a)){return true}}if(d){o+=this.windingArc(g,_,b,w,w+S,1-m[7],P,a)}s=Math.cos(w+S)*x+g;l=Math.sin(w+S)*b+_;break;case"z":if(p){if(this.isInsideLine(s,l,u,f,r,n,a)){return true}}c=true;break}}if(d){o+=this.windingLine(s,l,u,f,n,a)}return o!==0}},{key:"getTextWidth",value:function e(t,r){var i=t+":"+r;if(this._textWidthCache[i]){return this._textWidthCache[i]}this._ctx=this._ctx||this.util.getContext();this._ctx.save();if(r){this._ctx.font=r}t=(t+"").split("\n");var n=0;for(var a=0,o=t.length;a<o;a++){n=Math.max(this._ctx.measureText(t[a]).width,n)}this._ctx.restore();this._textWidthCache[i]=n;if(++this._textWidthCacheCounter>this.TEXT_CACHE_MAX){this._textWidthCacheCounter=0;this._textWidthCache={}}return n}},{key:"getTextHeight",value:function e(t,r){var i=t+":"+r;if(this._textHeightCache[i]){return this._textHeightCache[i]}this._ctx=this._ctx||this.util.getContext();this._ctx.save();if(r){this._ctx.font=r}t=(t+"").split("\n");var n=(this._ctx.measureText("ZH").width+2)*t.length;this._ctx.restore();this._textHeightCache[i]=n;if(++this._textHeightCacheCounter>this.TEXT_CACHE_MAX){this._textHeightCacheCounter=0;this._textHeightCache={}}return n}}]);return e}();t.Area=c;s.Zondy.LevelRenderer.Tool.Area=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ComputeBoundingBox=undefined;var i=r(1);var n=f(i);var a=r(5);var o=f(a);var s=r(0);var l=r(68);var u=r(69);function f(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(){(0,n.default)(this,e);if(arguments.length===3){this.computeBoundingBox(arguments)}this.CLASS_NAME="Zondy.LevelRenderer.Tool.ComputeBoundingBox"}(0,o.default)(e,[{key:"computeBoundingBox",value:function e(t,r,i){if(t.length===0){return}var n=t[0][0];var a=t[0][0];var o=t[0][1];var s=t[0][1];for(var l=1;l<t.length;l++){var u=t[l];if(u[0]<n){n=u[0]}if(u[0]>a){a=u[0]}if(u[1]<o){o=u[1]}if(u[1]>s){s=u[1]}}r[0]=n;r[1]=o;i[0]=a;i[1]=s}},{key:"cubeBezier",value:function e(t,r,i,n,a,o){var s=new l.Curve;var u=[];s.cubicExtrema(t[0],r[0],i[0],n[0],u);for(var f=0;f<u.length;f++){u[f]=s.cubicAt(t[0],r[0],i[0],n[0],u[f])}var c=[];s.cubicExtrema(t[1],r[1],i[1],n[1],c);for(var h=0;h<c.length;h++){c[h]=s.cubicAt(t[1],r[1],i[1],n[1],c[h])}u.push(t[0],n[0]);c.push(t[1],n[1]);var p=Math.min.apply(null,u);var d=Math.max.apply(null,u);var v=Math.min.apply(null,c);var y=Math.max.apply(null,c);a[0]=p;a[1]=v;o[0]=d;o[1]=y}},{key:"quadraticBezier",value:function e(t,r,i,n,a){var o=new l.Curve;var s=o.quadraticExtremum(t[0],r[0],i[0]);var u=o.quadraticExtremum(t[1],r[1],i[1]);s=Math.max(Math.min(s,1),0);u=Math.max(Math.min(u,1),0);var f=1-s;var c=1-u;var h=f*f*t[0]+2*f*s*r[0]+s*s*i[0];var p=f*f*t[1]+2*f*s*r[1]+s*s*i[1];var d=c*c*t[0]+2*c*u*r[0]+u*u*i[0];var v=c*c*t[1]+2*c*u*r[1]+u*u*i[1];n[0]=Math.min(t[0],i[0],h,d);n[1]=Math.min(t[1],i[1],p,v);a[0]=Math.max(t[0],i[0],h,d);a[1]=Math.max(t[1],i[1],p,v)}},{key:"arc",value:function e(t,r,i,n,a,o,s,l){var f=new u.Vector;var c=f.create();var h=f.create();var p=f.create();c[0]=Math.cos(n)*i+t;c[1]=Math.sin(n)*i+r;h[0]=Math.cos(a)*i+t;h[1]=Math.sin(a)*i+r;f.min(s,c,h);f.max(l,c,h);n=n%(Math.PI*2);if(n<0){n=n+Math.PI*2}a=a%(Math.PI*2);if(a<0){a=a+Math.PI*2}if(n>a&&!o){a+=Math.PI*2}else if(n<a&&o){n+=Math.PI*2}if(o){var d=a;a=n;n=d}for(var v=0;v<a;v+=Math.PI/2){if(v>n){p[0]=Math.cos(v)*i+t;p[1]=Math.sin(v)*i+r;f.min(s,p,s);f.max(l,p,l)}}}}]);return e}();t.ComputeBoundingBox=c;s.Zondy.LevelRenderer.Tool.ComputeBoundingBox=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Env=undefined;var i=r(1);var n=l(i);var a=r(5);var o=l(a);var s=r(0);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){(0,n.default)(this,e);this.CLASS_NAME="Zondy.LevelRenderer.Tool.Env";var t=this;function r(e){var r=t.os={};var i=t.browser={};var n=e.match(/Web[kK]it[\/]{0,1}([\d.]+)/);var a=e.match(/(Android);?[\s\/]+([\d.]+)?/);var o=e.match(/(iPad).*OS\s([\d_]+)/);var s=e.match(/(iPod)(.*OS\s([\d_]+))?/);var l=!o&&e.match(/(iPhone\sOS)\s([\d_]+)/);var u=e.match(/(webOS|hpwOS)[\s\/]([\d.]+)/);var f=u&&e.match(/TouchPad/);var c=e.match(/Kindle\/([\d.]+)/);var h=e.match(/Silk\/([\d._]+)/);var p=e.match(/(BlackBerry).*Version\/([\d.]+)/);var d=e.match(/(BB10).*Version\/([\d.]+)/);var v=e.match(/(RIM\sTablet\sOS)\s([\d.]+)/);var y=e.match(/PlayBook/);var m=e.match(/Chrome\/([\d.]+)/)||e.match(/CriOS\/([\d.]+)/);var g=e.match(/Firefox\/([\d.]+)/);var _=e.match(/MSIE ([\d.]+)/);var x=n&&e.match(/Mobile\//)&&!m;var b=e.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/)&&!m;if(i.webkit=!!n){i.version=n[1]}if(a){r.android=true;r.version=a[2]}if(l&&!s){r.ios=r.iphone=true;r.version=l[2].replace(/_/g,".")}if(o){r.ios=r.ipad=true;r.version=o[2].replace(/_/g,".")}if(s){r.ios=r.ipod=true;r.version=s[3]?s[3].replace(/_/g,"."):null}if(u){r.webos=true;r.version=u[2]}if(f){r.touchpad=true}if(p){r.blackberry=true;r.version=p[2]}if(d){r.bb10=true;r.version=d[2]}if(v){r.rimtabletos=true;r.version=v[2]}if(y){i.playbook=true}if(c){r.kindle=true;r.version=c[1]}if(h){i.silk=true;i.version=h[1]}if(!h&&r.android&&e.match(/Kindle Fire/)){i.silk=true}if(m){i.chrome=true;i.version=m[1]}if(g){i.firefox=true;i.version=g[1]}if(_){i.ie=true;i.version=_[1]}if(x&&(e.match(/Safari/)||!!r.ios)){i.safari=true}if(b){i.webview=true}if(_){i.ie=true;i.version=_[1]}r.tablet=!!(o||y||a&&!e.match(/Mobile/)||g&&e.match(/Tablet/)||_&&!e.match(/Phone/)&&e.match(/Touch/));r.phone=!!(!r.tablet&&!r.ipod&&(a||l||u||p||d||m&&e.match(/Android/)||m&&e.match(/CriOS\/([\d.]+)/)||g&&e.match(/Mobile/)||_&&e.match(/Touch/)));return{browser:i,os:r,canvasSupported:document.createElement("canvas").getContext?true:false}}return r(navigator.userAgent)}(0,o.default)(e,[{key:"destory",value:function e(){return true}}]);return e}();t.Env=u;s.Zondy.LevelRenderer.Tool.Env=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Event=undefined;var i=r(1);var n=l(i);var a=r(5);var o=l(a);var s=r(0);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){(0,n.default)(this,e);this.stop=typeof window.addEventListener==="function"?function(e){e.preventDefault();e.stopPropagation();e.cancelBubble=true}:function(e){e.returnValue=false;e.cancelBubble=true};this.CLASS_NAME="Zondy.LevelRenderer.Tool.Event"}(0,o.default)(e,[{key:"getX",value:function e(t){return typeof t.zrenderX!="undefined"&&t.zrenderX||typeof t.offsetX!="undefined"&&t.offsetX||typeof t.layerX!="undefined"&&t.layerX||typeof t.clientX!="undefined"&&t.clientX}},{key:"getY",value:function e(t){return typeof t.zrenderY!="undefined"&&t.zrenderY||typeof t.offsetY!="undefined"&&t.offsetY||typeof t.layerY!="undefined"&&t.layerY||typeof t.clientY!="undefined"&&t.clientY}},{key:"getDelta",value:function e(t){return typeof t.zrenderDelta!="undefined"&&t.zrenderDelta||typeof t.wheelDelta!="undefined"&&t.wheelDelta||typeof t.detail!="undefined"&&-t.detail}}]);return e}();t.Event=u;s.Zondy.LevelRenderer.Tool.Event=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Http=undefined;var i=r(18);var n=f(i);var a=r(1);var o=f(a);var s=r(5);var l=f(s);var u=r(0);function f(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(){(0,o.default)(this,e);this.CLASS_NAME="Zondy.LevelRenderer.Tool.Http"}(0,l.default)(e,[{key:"get",value:function e(t,r,i){if((typeof t==="undefined"?"undefined":(0,n.default)(t))==="object"){var a=t;t=a.url;r=a.onsuccess;i=a.onerror}var o=window.XMLHttpRequest?new XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");o.open("GET",t,true);o.onreadystatechange=function(){if(o.readyState===4){if(o.status>=200&&o.status<300||o.status===304){r&&r(o.responseText)}else{i&&i()}o.onreadystatechange=new Function;o=null}};o.send(null)}}]);return e}();t.Http=c;u.Zondy.LevelRenderer.Tool.Http=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Math=undefined;var i=r(1);var n=l(i);var a=r(5);var o=l(a);var s=r(0);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){(0,n.default)(this,e);this._radians=window.Math.PI/180;this.CLASS_NAME="Zondy.LevelRenderer.Tool.Math"}(0,o.default)(e,[{key:"sin",value:function e(t,r){return window.Math.sin(r?t*this._radians:t)}},{key:"cos",value:function e(t,r){return window.Math.cos(r?t*this._radians:t)}},{key:"degreeToRadian",value:function e(t){return t*this._radians}},{key:"radianToDegree",value:function e(t){return t/this._radians}}]);return e}();t.Math=u;s.Zondy.LevelRenderer.Tool.Math=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Matrix=undefined;var i=r(1);var n=l(i);var a=r(5);var o=l(a);var s=r(0);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){(0,n.default)(this,e);this.ArrayCtor=typeof Float32Array==="undefined"?Array:Float32Array;this.CLASS_NAME="Zondy.LevelRenderer.Tool.Matrix"}(0,o.default)(e,[{key:"create",value:function e(){var t=this.ArrayCtor;var r=new t(6);this.identity(r);return r}},{key:"identity",value:function e(t){t[0]=1;t[1]=0;t[2]=0;t[3]=1;t[4]=0;t[5]=0;return t}},{key:"copy",value:function e(t,r){t[0]=r[0];t[1]=r[1];t[2]=r[2];t[3]=r[3];t[4]=r[4];t[5]=r[5];return t}},{key:"mul",value:function e(t,r,i){t[0]=r[0]*i[0]+r[2]*i[1];t[1]=r[1]*i[0]+r[3]*i[1];t[2]=r[0]*i[2]+r[2]*i[3];t[3]=r[1]*i[2]+r[3]*i[3];t[4]=r[0]*i[4]+r[2]*i[5]+r[4];t[5]=r[1]*i[4]+r[3]*i[5]+r[5];return t}},{key:"translate",value:function e(t,r,i){t[0]=r[0];t[1]=r[1];t[2]=r[2];t[3]=r[3];t[4]=r[4]+i[0];t[5]=r[5]+i[1];return t}},{key:"rotate",value:function e(t,r,i){var n=r[0];var a=r[2];var o=r[4];var s=r[1];var l=r[3];var u=r[5];var f=Math.sin(i);var c=Math.cos(i);t[0]=n*c+s*f;t[1]=-n*f+s*c;t[2]=a*c+l*f;t[3]=-a*f+c*l;t[4]=c*o+f*u;t[5]=c*u-f*o;return t}},{key:"scale",value:function e(t,r,i){var n=i[0];var a=i[1];t[0]=r[0]*n;t[1]=r[1]*a;t[2]=r[2]*n;t[3]=r[3]*a;t[4]=r[4]*n;t[5]=r[5]*a;return t}},{key:"invert",value:function e(t,r){var i=r[0];var n=r[2];var a=r[4];var o=r[1];var s=r[3];var l=r[5];var u=i*s-o*n;if(!u){return null}u=1/u;t[0]=s*u;t[1]=-o*u;t[2]=-n*u;t[3]=i*u;t[4]=(n*l-s*a)*u;t[5]=(o*a-i*l)*u;return t}},{key:"mulVector",value:function e(t,r,i){var n=r[0];var a=r[2];var o=r[4];var s=r[1];var l=r[3];var u=r[5];t[0]=i[0]*n+i[1]*a+o;t[1]=i[0]*s+i[1]*l+u;return t}}]);return e}();t.Matrix=u;s.Zondy.LevelRenderer.Tool.Matrix=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.PaintLayer=t.Painter=undefined;var i=r(2);var n=x(i);var a=r(3);var o=x(a);var s=r(4);var l=x(s);var u=r(1);var f=x(u);var c=r(5);var h=x(c);var p=r(0);var d=r(6);var v=r(42);var y=r(67);var m=r(113);var g=r(20);var _=r(114);function x(e){return e&&e.__esModule?e:{default:e}}var b=function(){function e(t,r){(0,f.default)(this,e);this.root=t;this.storage=r;this._domRoot=null;this._layers={};this._zlevelList=[];this._layerConfig={};this._bgDom=null;this.shapeToImage=null;e.devicePixelRatio=Math.max(window.devicePixelRatio||1,1);this.CLASS_NAME="Zondy.LevelRenderer.Painter";this.root.innerHTML="";this._width=this._getWidth();this._height=this._getHeight();var i=document.createElement("div");this._domRoot=i;i.style.position="relative";i.style.overflow="hidden";i.style.width=this._width+"px";i.style.height=this._height+"px";this.root.appendChild(i);this.shapeToImage=this._createShapeToImageProcessor();this._bgDom=e.createDom((0,d.newGuid)(),"div",this);i.appendChild(this._bgDom);this._bgDom.onselectstart=o;this._bgDom.style["-webkit-user-select"]="none";this._bgDom.style["user-select"]="none";this._bgDom.style["-webkit-touch-callout"]="none";var n=new w((0,d.newGuid)(),this);this._layers["hover"]=n;i.appendChild(n.dom);n.initContext();n.dom.onselectstart=o;n.dom.style["-webkit-user-select"]="none";n.dom.style["user-select"]="none";n.dom.style["-webkit-touch-callout"]="none";var a=this;this.updatePainter=function(e,t){a.refreshShapes(e,t)};function o(){return false}function s(){}}(0,h.default)(e,[{key:"destroy",value:function e(){this.dispose();this._zlevelList=null;this._layerConfig=null;this._bgDom=null;this.shapeToImage=null}},{key:"render",value:function e(t){this.refresh(t,true);return this}},{key:"refresh",value:function e(t,r){var i=this.storage.getShapeList(true);this._paintList(i,r);if(typeof t=="function"){t()}return this}},{key:"_paintList",value:function e(t,r){if(typeof r=="undefined"){r=false}this._updateLayerStatus(t);var i;var n;var a;for(var o in this._layers){if(o!=="hover"){this._layers[o].unusedCount++;this._layers[o].updateTransform()}}var s=[];for(var l=0,u=t.length;l<u;l++){var f=t[l];if(n!==f.zlevel){if(i&&i.needTransform){a.restore()}i=this.getLayer(f.zlevel);a=i.ctx;n=f.zlevel;i.unusedCount=0;if(i.dirty||r){i.clear()}if(i.needTransform){a.save();i.setTransform(a)}}if(a&&f.__startClip){var c=f.__startClip;a.save();if(c.needTransform){var h=c.transform;g.SUtil.Util_matrix.invert(s,h);a.transform(h[0],h[1],h[2],h[3],h[4],h[5])}a.beginPath();c.buildPath(a,c.style);a.clip();if(c.needTransform){var p=s;a.transform(p[0],p[1],p[2],p[3],p[4],p[5])}}if((i&&i.dirty||r)&&!f.invisible){if(!f.onbrush||f.onbrush&&!f.onbrush(a,false)){if(m.Config.catchBrushException){try{f.brush(a,false,this.updatePainter)}catch(e){}}else{f.brush(a,false,this.updatePainter)}}}if(a&&f.__stopClip){a.restore()}f.__dirty=false}if(a&&i&&i.needTransform){a.restore()}for(var d in this._layers){if(d!=="hover"){var v=this._layers[d];v.dirty=false;if(v.unusedCount===1){v.clear()}}}}},{key:"getLayer",value:function e(t){var r=this._layers[t];if(!r){var i=this._zlevelList.length;var n=null;var a=-1;if(i>0&&t>this._zlevelList[0]){for(a=0;a<i-1;a++){if(this._zlevelList[a]<t&&this._zlevelList[a+1]>t){break}}n=this._layers[this._zlevelList[a]]}this._zlevelList.splice(a+1,0,t);r=new w((0,d.newGuid)(),this);var o=n?n.dom:this._bgDom;if(o.nextSibling){o.parentNode.insertBefore(r.dom,o.nextSibling)}else{o.parentNode.appendChild(r.dom)}r.initContext();this._layers[t]=r;if(this._layerConfig[t]){(new v.Util).merge(r,this._layerConfig[t],true)}r.updateTransform()}return r}},{key:"getLayers",value:function e(){return this._layers}},{key:"_updateLayerStatus",value:function e(t){var r=this._layers;var i={};for(var n in r){if(n!=="hover"){i[n]=r[n].elCount;r[n].elCount=0}}for(var a=0;a<t.length;a++){var o=t[a];var s=o.zlevel;var l=r[s];if(l){l.elCount++;if(l.dirty){continue}l.dirty=o.__dirty}}for(var u in r){if(u!=="hover"){if(i[u]!==r[u].elCount){r[u].dirty=true}}}}},{key:"refreshShapes",value:function e(t,r){for(var i=0,n=t.length;i<n;i++){var a=t[i];this.storage.mod(a.id)}this.refresh(r);return this}},{key:"clear",value:function e(){for(var t in this._layers){if(t==="hover"){continue}this._layers[t].clear()}return this}},{key:"modLayer",value:function e(t,r){if(r){if(!this._layerConfig[t]){this._layerConfig[t]=r}else{(new v.Util).merge(this._layerConfig[t],r,true)}var i=this._layers[t];if(i){(new v.Util).merge(i,this._layerConfig[t],true)}}}},{key:"delLayer",value:function e(t){var r=this._layers[t];if(!r){return}this.modLayer(t,{position:r.position,rotation:r.rotation,scale:r.scale});r.dom.parentNode.removeChild(r.dom);delete this._layers[t];this._zlevelList.splice((new v.Util).indexOf(this._zlevelList,t),1)}},{key:"refreshHover",value:function e(){this.clearHover();var t=this.storage.getHoverShapes(true);for(var r=0,i=t.length;r<i;r++){this._brushHover(t[r])}this.storage.delHover();return this}},{key:"clearHover",value:function e(){var t=this._layers.hover;t&&t.clear();return this}},{key:"resize",value:function e(){var t=this._domRoot;t.style.display="none";var r=this._getWidth();var i=this._getHeight();t.style.display="";if(this._width!==r||i!==this._height){this._width=r;this._height=i;t.style.width=r+"px";t.style.height=i+"px";for(var n in this._layers){this._layers[n].resize(r,i)}this.refresh(null,true)}return this}},{key:"clearLayer",value:function e(t){var r=this._layers[t];if(r){r.clear()}}},{key:"dispose",value:function e(){this.root.innerHTML="";this.root=null;this.storage=null;this._domRoot=null;this._layers=null}},{key:"getDomHover",value:function e(){return this._layers.hover.dom}},{key:"toDataURL",value:function t(r,i,n){var a=e.createDom((0,d.newGuid)(),"canvas",this);this._bgDom.appendChild(a);var o=a.getContext("2d");e.devicePixelRatio!==1&&o.scale(e.devicePixelRatio,e.devicePixelRatio);o.fillStyle=i||"#fff";o.rect(0,0,this._width*e.devicePixelRatio,this._height*e.devicePixelRatio);o.fill();var s=this;this.storage.iterShape(function(e){if(!e.invisible){if(!e.onbrush||e.onbrush&&!e.onbrush(o,false)){if(m.Config.catchBrushException){try{e.brush(o,false,s.updatePainter)}catch(e){}}else{e.brush(o,false,s.updatePainter)}}}},{normal:"up",update:true});var l=a.toDataURL(r,n);o=null;this._bgDom.removeChild(a);return l}},{key:"getWidth",value:function e(){return this._width}},{key:"getHeight",value:function e(){return this._height}},{key:"_getWidth",value:function e(){var t=this.root;var r=t.currentStyle||document.defaultView.getComputedStyle(t);return((t.clientWidth||parseInt(r.width,10))-parseInt(r.paddingLeft,10)-parseInt(r.paddingRight,10)).toFixed(0)-0}},{key:"_getHeight",value:function e(){var t=this.root;var r=t.currentStyle||document.defaultView.getComputedStyle(t);return((t.clientHeight||parseInt(r.height,10))-parseInt(r.paddingTop,10)-parseInt(r.paddingBottom,10)).toFixed(0)-0}},{key:"_brushHover",value:function e(t){var r=this._layers.hover.ctx;if(!t.onbrush||t.onbrush&&!t.onbrush(r,true)){var i=this.getLayer(t.zlevel);if(i.needTransform){r.save();i.setTransform(r)}if(m.Config.catchBrushException){try{t.brush(r,true,this.updatePainter)}catch(e){}}else{t.brush(r,true,this.updatePainter)}if(i.needTransform){r.restore()}}}},{key:"_shapeToImage",value:function e(t,r,i,n,a){var o=document.createElement("canvas");var s=o.getContext("2d");var l=a||window.devicePixelRatio||1;o.style.width=i+"px";o.style.height=n+"px";o.setAttribute("width",i*l);o.setAttribute("height",n*l);s.clearRect(0,0,i*l,n*l);var u={position:r.position,rotation:r.rotation,scale:r.scale};r.position=[0,0,0];r.rotation=0;r.scale=[1,1];if(r){r.brush(s,false)}var f=new _.SmicImage({id:t,style:{x:0,y:0,image:o}});if(u.position!=null){f.position=r.position=u.position}if(u.rotation!=null){f.rotation=r.rotation=u.rotation}if(u.scale!=null){f.scale=r.scale=u.scale}return f}},{key:"_createShapeToImageProcessor",value:function t(){var r=this;return function(t,i,n,a){return r._shapeToImage(t,i,n,a,e.devicePixelRatio)}}},{key:"updateHoverLayer",value:function e(t){if(!(t instanceof Array)){return this}this.clearHover();this.storage.delHover();for(var r=0;r<t.length;r++){this.storage.addHover(t[r]);this._brushHover(t[r])}}}],[{key:"createDom",value:function t(r,i,n){var a=document.createElement(i);var o=n._width;var s=n._height;a.style.position="absolute";a.style.left=0;a.style.top=0;a.style.width=o+"px";a.style.height=s+"px";a.setAttribute("width",o*e.devicePixelRatio);a.setAttribute("height",s*e.devicePixelRatio);a.setAttribute("id",r);return a}}]);return e}();var w=function(e){(0,l.default)(t,e);function t(e,r){(0,f.default)(this,t);var i=(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r));i.dom=null;i.domBack=null;i.ctxBack=null;i.painter=r;i.unusedCount=0;i.config=null;i.dirty=true;i.elCount=0;i.clearColor=0;i.motionBlur=false;i.lastFrameAlpha=.7;i.zoomable=false;i.panable=false;i.maxZoom=Infinity;i.minZoom=0;i.ctx=null;i.dom=b.createDom((0,d.newGuid)(),"canvas",r);i.dom.onselectstart=a;i.dom.style["-webkit-user-select"]="none";i.dom.style["user-select"]="none";i.dom.style["-webkit-touch-callout"]="none";function a(){return false}i.CLASS_NAME="Zondy.LevelRenderer.Painter.Layer";return i}(0,h.default)(t,[{key:"destroy",value:function e(){this.dom=null;this.domBack=null;this.ctxBack=null;this.painter=null;this.unusedCount=null;this.config=null;this.dirty=null;this.elCount=null;this.clearColor=null;this.motionBlur=null;this.lastFrameAlpha=null;this.zoomable=null;this.panable=null;this.maxZoom=null;this.minZoom=null;this.ctx=null;y.Transformable.destroy.apply(this,arguments)}},{key:"initContext",value:function e(){this.ctx=this.dom.getContext("2d");if(b.devicePixelRatio!==1){this.ctx.scale(b.devicePixelRatio,b.devicePixelRatio)}}},{key:"createBackBuffer",value:function e(){this.domBack=b.createDom((0,d.newGuid)(),"canvas",this.painter);this.ctxBack=this.domBack.getContext("2d");if(b.devicePixelRatio!==1){this.ctxBack.scale(b.devicePixelRatio,b.devicePixelRatio)}}},{key:"resize",value:function e(t,r){this.dom.style.width=t+"px";this.dom.style.height=r+"px";this.dom.setAttribute("width",t*b.devicePixelRatio);this.dom.setAttribute("height",r*b.devicePixelRatio);if(b.devicePixelRatio!==1){this.ctx.scale(b.devicePixelRatio,b.devicePixelRatio)}if(this.domBack){this.domBack.setAttribute("width",t*b.devicePixelRatio);this.domBack.setAttribute("height",r*b.devicePixelRatio);if(b.devicePixelRatio!==1){this.ctxBack.scale(b.devicePixelRatio,b.devicePixelRatio)}}}},{key:"clear",value:function e(){var t=this.dom;var r=this.ctx;var i=t.width;var n=t.height;var a=this.clearColor;var o=this.motionBlur;var s=this.lastFrameAlpha;if(o){if(!this.domBack){this.createBackBuffer()}this.ctxBack.globalCompositeOperation="copy";this.ctxBack.drawImage(t,0,0,i/b.devicePixelRatio,n/b.devicePixelRatio)}if(a){r.save();r.fillStyle=this.config.clearColor;r.fillRect(0,0,i/b.devicePixelRatio,n/b.devicePixelRatio);r.restore()}else{r.clearRect(0,0,i/b.devicePixelRatio,n/b.devicePixelRatio)}if(o){var l=this.domBack;r.save();r.globalAlpha=s;r.drawImage(l,0,0,i/b.devicePixelRatio,n/b.devicePixelRatio);r.restore()}}}]);return t}(y.Transformable);t.Painter=b;p.Zondy.LevelRenderer.Painter=b;t.PaintLayer=w;p.Zondy.LevelRenderer.PaintLayer=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Handler=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(4);var h=m(c);var p=r(0);var d=r(50);var v=r(113);var y=r(20);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,h.default)(t,e);function t(e,r,i){(0,o.default)(this,t);var a=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i));a.root=e;a.storage=r;a.painter=i;a._lastX=0;a._lastY=0;a._mouseX=0;a._mouseY=0;a._findHover=null;a._domHover=null;a._findHover=u(h,a);a._domHover=i.getDomHover();a.CLASS_NAME="Zondy.LevelRenderer.Handler";var s={resize:function e(t){t=t||window.event;this._lastHover=null;this._isMouseDown=0;this.dispatch(v.Config.EVENT.RESIZE,t)},click:function e(t){t=this._zrenderEventFixed(t);var r=this._lastHover;if(r&&r.clickable||!r){if(this._clickThreshold<10){this._dispatchAgency(r,v.Config.EVENT.CLICK,t)}}this._mousemoveHandler(t)},dblclick:function e(t){t=t||window.event;t=this._zrenderEventFixed(t);var r=this._lastHover;if(r&&r.clickable||!r){if(this._clickThreshold<5){this._dispatchAgency(r,v.Config.EVENT.DBLCLICK,t)}}this._mousemoveHandler(t)},mousewheel:function e(t){t=this._zrenderEventFixed(t);var r=t.wheelDelta||-t.detail;var i=r>0?1.1:1/1.1;var n=this.painter.getLayers();var a=false;for(var o in n){if(o!=="hover"){var s=n[o];var l=s.position;if(s.zoomable){s.__zoom=s.__zoom||1;var u=s.__zoom;u*=i;u=Math.max(Math.min(s.maxZoom,u),s.minZoom);i=u/s.__zoom;s.__zoom=u;l[0]-=(this._mouseX-l[0])*(i-1);l[1]-=(this._mouseY-l[1])*(i-1);s.scale[0]*=i;s.scale[1]*=i;s.dirty=true;a=true}}}if(a){this.painter.refresh()}this._dispatchAgency(this._lastHover,v.Config.EVENT.MOUSEWHEEL,t);this._mousemoveHandler(t)},mousemove:function e(t){this._clickThreshold++;t=this._zrenderEventFixed(t);this._lastX=this._mouseX;this._lastY=this._mouseY;this._mouseX=y.SUtil.Util_event.getX(t);this._mouseY=y.SUtil.Util_event.getY(t);var r=this._mouseX-this._lastX;var i=this._mouseY-this._lastY;this._processDragStart(t);this._hasfound=0;this._event=t;this._iterateAndFindHover();if(!this._hasfound){if(!this._draggingTarget||this._lastHover&&this._lastHover!==this._draggingTarget){this._processOutShape(t);this._processDragLeave(t)}this._lastHover=null;this.storage.delHover();this.painter.clearHover()}var n="";if(this._draggingTarget){this.storage.drift(this._draggingTarget.id,r,i);this._draggingTarget.modSelf();this.storage.addHover(this._draggingTarget)}else if(this._isMouseDown){var a=this.painter.getLayers();var o=false;for(var s in a){if(s!=="hover"){var l=a[s];if(l.panable){n="move";l.position[0]+=r;l.position[1]+=i;o=true;l.dirty=true}}}if(o){this.painter.refresh()}}if(this._draggingTarget||this._hasfound&&this._lastHover.draggable){n="move"}else if(this._hasfound&&this._lastHover.clickable){n="pointer"}this.root.style.cursor=n;this._dispatchAgency(this._lastHover,v.Config.EVENT.MOUSEMOVE,t);if(this._draggingTarget||this._hasfound||this.storage.hasHoverShape()){this.painter.refreshHover()}},mouseout:function e(t){t=this._zrenderEventFixed(t);var r=t.toElement||t.relatedTarget;if(r!==this.root){while(r&&r.nodeType!==9){if(r===this.root){this._mousemoveHandler(t);return}r=r.parentNode}}t.zrenderX=this._lastX;t.zrenderY=this._lastY;this.root.style.cursor="";this._isMouseDown=0;this._processOutShape(t);this._processDrop(t);this._processDragEnd(t);this.painter.refreshHover();this.dispatch(v.Config.EVENT.GLOBALOUT,t)},mousedown:function e(t){this._clickThreshold=0;if(this._lastDownButton===2){this._lastDownButton=t.button;this._mouseDownTarget=null;return}this._lastMouseDownMoment=new Date;t=this._zrenderEventFixed(t);this._isMouseDown=1;this._mouseDownTarget=this._lastHover;this._dispatchAgency(this._lastHover,v.Config.EVENT.MOUSEDOWN,t);this._lastDownButton=t.button},mouseup:function e(t){t=this._zrenderEventFixed(t);this.root.style.cursor="";this._isMouseDown=0;this._mouseDownTarget=null;this._dispatchAgency(this._lastHover,v.Config.EVENT.MOUSEUP,t);this._processDrop(t);this._processDragEnd(t)},touchstart:function e(t){t=this._zrenderEventFixed(t,true);this._lastTouchMoment=new Date;this._mobildFindFixed(t);this._mousedownHandler(t)},touchmove:function e(t){t=this._zrenderEventFixed(t,true);this._mousemoveHandler(t);if(this._isDragging){y.SUtil.Util_event.stop(t)}},touchend:function e(t){t=this._zrenderEventFixed(t,true);this._mouseupHandler(t);var r=new Date;if(r-this._lastTouchMoment<v.Config.EVENT.touchClickDelay){this._mobildFindFixed(t);this._clickHandler(t);if(r-this._lastClickMoment<v.Config.EVENT.touchClickDelay/2){this._dblclickHandler(t);if(this._lastHover&&this._lastHover.clickable){y.SUtil.Util_event.stop(t)}}this._lastClickMoment=r}this.painter.clearHover()}};c(a);if(window.addEventListener){window.addEventListener("resize",a._resizeHandler);if(y.SUtil.Util_env.os.tablet||y.SUtil.Util_env.os.phone){e.addEventListener("touchstart",a._touchstartHandler);e.addEventListener("touchmove",a._touchmoveHandler);e.addEventListener("touchend",a._touchendHandler)}else{e.addEventListener("click",a._clickHandler);e.addEventListener("dblclick",a._dblclickHandler);e.addEventListener("mousewheel",a._mousewheelHandler);e.addEventListener("mousemove",a._mousemoveHandler);e.addEventListener("mousedown",a._mousedownHandler);e.addEventListener("mouseup",a._mouseupHandler)}e.addEventListener("DOMMouseScroll",a._mousewheelHandler);e.addEventListener("mouseout",a._mouseoutHandler)}else{window.attachEvent("onresize",a._resizeHandler);e.attachEvent("onclick",a._clickHandler);e.ondblclick=a._dblclickHandler;e.attachEvent("onmousewheel",a._mousewheelHandler);e.attachEvent("onmousemove",a._mousemoveHandler);e.attachEvent("onmouseout",a._mouseoutHandler);e.attachEvent("onmousedown",a._mousedownHandler);e.attachEvent("onmouseup",a._mouseupHandler)}function l(e,t){return function(r){return e.call(t,r)}}function u(e,t){return function(r,i,n){return e.call(t,r,i,n)}}function c(e){var t=["resize","click","dblclick","mousewheel","mousemove","mouseout","mouseup","mousedown","touchstart","touchend","touchmove"];var r=t.length;while(r--){var i=t[r];e["_"+i+"Handler"]=l(s[i],e)}}function h(e,t,r){var i=this;if(i._draggingTarget&&i._draggingTarget.id===e.id||e.isSilent()){return false}var n=i._event;if(e.isCover(t,r)){if(e.hoverable){if(e.isHoverByRefDataID&&e.isHoverByRefDataID===true){if(e.refDataID){var a=e.refDataID;var o=null;if(e.refDataHoverGroup){o=e.refDataHoverGroup}var s=i.storage._shapeList;for(var l=0,u=s.length;l<u;l++){var f=s[l];if(f.refDataID&&a===f.refDataID){if(o){if(f.refDataHoverGroup&&o===f.refDataHoverGroup){i.storage.addHover(f)}}else{i.storage.addHover(f)}}}}}else{i.storage.addHover(e)}}var c=e.parent;while(c){if(c.clipShape&&!c.clipShape.isCover(i._mouseX,i._mouseY)){return false}c=c.parent}if(i._lastHover!==e){i._processOutShape(n);i._processDragLeave(n);i._lastHover=e;i._processDragEnter(n)}i._processOverShape(n);i._processDragOver(n);i._hasfound=1;return true}return false}return a}(0,l.default)(t,[{key:"destroy",value:function e(){this.dispose();this._lastX=null;this._lastY=null;this._mouseX=null;this._mouseY=null;this._findHover=null;d.Eventful.prototype.destroy.apply(this,arguments)}},{key:"on",value:function e(t,r){this.bind(t,r);return this}},{key:"un",value:function e(t,r){this.unbind(t,r);return this}},{key:"trigger",value:function e(t,r){var i=v.Config.EVENT;switch(t){case i.RESIZE:case i.CLICK:case i.DBLCLICK:case i.MOUSEWHEEL:case i.MOUSEMOVE:case i.MOUSEDOWN:case i.MOUSEUP:case i.MOUSEOUT:this["_"+t+"Handler"](r);break}}},{key:"dispose",value:function e(){var t=this.root;if(window.removeEventListener){window.removeEventListener("resize",this._resizeHandler);if(y.SUtil.Util_env.os.tablet||y.SUtil.Util_env.os.phone){t.removeEventListener("touchstart",this._touchstartHandler);t.removeEventListener("touchmove",this._touchmoveHandler);t.removeEventListener("touchend",this._touchendHandler)}else{t.removeEventListener("click",this._clickHandler);t.removeEventListener("dblclick",this._dblclickHandler);t.removeEventListener("mousewheel",this._mousewheelHandler);t.removeEventListener("mousemove",this._mousemoveHandler);t.removeEventListener("mousedown",this._mousedownHandler);t.removeEventListener("mouseup",this._mouseupHandler)}t.removeEventListener("DOMMouseScroll",this._mousewheelHandler);t.removeEventListener("mouseout",this._mouseoutHandler)}else{window.detachEvent("onresize",this._resizeHandler);t.detachEvent("onclick",this._clickHandler);t.detachEvent("dblclick",this._dblclickHandler);t.detachEvent("onmousewheel",this._mousewheelHandler);t.detachEvent("onmousemove",this._mousemoveHandler);t.detachEvent("onmouseout",this._mouseoutHandler);t.detachEvent("onmousedown",this._mousedownHandler);t.detachEvent("onmouseup",this._mouseupHandler)}this.root=null;this._domHover=null;this.storage=null;this.painter=null;this.un()}},{key:"_processDragStart",value:function e(t){var r=this._lastHover;if(this._isMouseDown&&r&&r.draggable&&!this._draggingTarget&&this._mouseDownTarget===r){if(r.dragEnableTime&&new Date-this._lastMouseDownMoment<r.dragEnableTime){return}var i=r;this._draggingTarget=i;this._isDragging=1;i.invisible=true;this.storage.mod(i.id);this._dispatchAgency(i,v.Config.EVENT.DRAGSTART,t);this.painter.refresh()}}},{key:"_processDragEnter",value:function e(t){if(this._draggingTarget){this._dispatchAgency(this._lastHover,v.Config.EVENT.DRAGENTER,t,this._draggingTarget)}}},{key:"_processDragOver",value:function e(t){if(this._draggingTarget){this._dispatchAgency(this._lastHover,v.Config.EVENT.DRAGOVER,t,this._draggingTarget)}}},{key:"_processDragLeave",value:function e(t){if(this._draggingTarget){this._dispatchAgency(this._lastHover,v.Config.EVENT.DRAGLEAVE,t,this._draggingTarget)}}},{key:"_processDrop",value:function e(t){if(this._draggingTarget){this._draggingTarget.invisible=false;this.storage.mod(this._draggingTarget.id);this.painter.refresh();this._dispatchAgency(this._lastHover,v.Config.EVENT.DROP,t,this._draggingTarget)}}},{key:"_processDragEnd",value:function e(t){if(this._draggingTarget){this._dispatchAgency(this._draggingTarget,v.Config.EVENT.DRAGEND,t);this._lastHover=null}this._isDragging=0;this._draggingTarget=null}},{key:"_processOverShape",value:function e(t){this._dispatchAgency(this._lastHover,v.Config.EVENT.MOUSEOVER,t)}},{key:"_processOutShape",value:function e(t){this._dispatchAgency(this._lastHover,v.Config.EVENT.MOUSEOUT,t)}},{key:"_dispatchAgency",value:function e(t,r,i,n){var a="on"+r;var o={type:r,event:i,target:t,cancelBubble:false};var s=t;if(n){o.dragged=n}while(s){s[a]&&(o.cancelBubble=s[a](o));s.dispatch(r,o);s=s.parent;if(o.cancelBubble){break}}if(t){if(!o.cancelBubble){this.dispatch(r,o)}}else if(!n){this.dispatch(r,{type:r,event:i})}}},{key:"_iterateAndFindHover",value:function e(){var t=y.SUtil.Util_matrix.create();var r=this.storage.getShapeList();var i;var n;var a=[0,0];for(var o=r.length-1;o>=0;o--){var s=r[o];if(i!==s.zlevel){n=this.painter.getLayer(s.zlevel,n);a[0]=this._mouseX;a[1]=this._mouseY;if(n.needTransform){y.SUtil.Util_matrix.invert(t,n.transform);y.SUtil.Util_vector.applyTransform(a,a,t)}}if(this._findHover(s,a[0],a[1])){break}}}},{key:"_mobildFindFixed",value:function e(t){var r=[{x:10},{x:-20},{x:10,y:10},{y:-20}];this._lastHover=null;this._mouseX=t.zrenderX;this._mouseY=t.zrenderY;this._event=t;this._iterateAndFindHover();for(var i=0;!this._lastHover&&i<r.length;i++){var n=r[i];n.x&&(this._mouseX+=n.x);n.y&&(this._mouseX+=n.y);this._iterateAndFindHover()}if(this._lastHover){t.zrenderX=this._mouseX;t.zrenderY=this._mouseY}}},{key:"_zrenderEventFixed",value:function e(t,r){if(t.zrenderFixed){return t}if(!r){t=t||window.event;var i=t.toElement||t.relatedTarget||t.srcElement||t.target;if(i&&i!==this._domHover){t.zrenderX=(typeof t.offsetX!="undefined"?t.offsetX:t.layerX)+i.offsetLeft;t.zrenderY=(typeof t.offsetY!="undefined"?t.offsetY:t.layerY)+i.offsetTop}}else{var n=t.type!=="touchend"?t.targetTouches[0]:t.changedTouches[0];if(n){var a=this.root.getBoundingClientRect();t.zrenderX=n.clientX-a.left;t.zrenderY=n.clientY-a.top}}t.zrenderFixed=1;return t}},{key:"getLastHoverOne",value:function e(){if(this._lastHover){return this._lastHover}return null}}]);return t}(d.Eventful);t.Handler=g;p.Zondy.LevelRenderer.Handler=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Animator=t.Animation=undefined;var i=r(18);var n=b(i);var a=r(2);var o=b(a);var s=r(1);var l=b(s);var u=r(5);var f=b(u);var c=r(3);var h=b(c);var p=r(4);var d=b(p);var v=r(0);var y=r(6);var m=r(42);var g=r(50);var _=r(205);var x=r(20);function b(e){return e&&e.__esModule?e:{default:e}}var w=function(e){(0,d.default)(t,e);function t(e){(0,l.default)(this,t);var r=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));e=e||{};r.stage={};r.onframe=function(){};r._clips=[];r._running=false;r._time=0;(0,y.extend)(r,e);r.CLASS_NAME="Zondy.LevelRenderer.Animation";return r}(0,f.default)(t,[{key:"add",value:function e(t){this._clips.push(t)}},{key:"remove",value:function e(t){var r=(new m.Util).indexOf(this._clips,t);if(r>=0){this._clips.splice(r,1)}}},{key:"_update",value:function e(){var t=(new Date).getTime();var r=t-this._time;var i=this._clips;var n=i.length;var a=[];var o=[];for(var s=0;s<n;s++){var l=i[s];var u=l.step(t);if(u){a.push(u);o.push(l)}}if(this.stage.update){this.stage.update()}for(var f=0;f<n;){if(i[f]._needsRemove){i[f]=i[n-1];i.pop();n--}else{f++}}n=a.length;for(var c=0;c<n;c++){o[c].fire(a[c])}this._time=t;this.onframe(r);this.dispatch("frame",r)}},{key:"start",value:function e(){var t=window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){setTimeout(e,16)};var r=this;this._running=true;function i(){if(r._running){r._update();t(i)}}this._time=(new Date).getTime();t(i)}},{key:"stop",value:function e(){this._running=false}},{key:"clear",value:function e(){this._clips=[]}},{key:"animate",value:function e(t,r){r=r||{};var i=new S(t,r.loop,r.getter,r.setter);i.animation=this;return i}}],[{key:"_interpolateNumber",value:function e(t,r,i){return(r-t)*i+t}},{key:"_interpolateArray",value:function e(r,i,n,a,o){var s=r.length;if(o===1){for(var l=0;l<s;l++){a[l]=t._interpolateNumber(r[l],i[l],n)}}else{var u=r[0].length;for(var f=0;f<s;f++){for(var c=0;c<u;c++){a[f][c]=t._interpolateNumber(r[f][c],i[f][c],n)}}}}},{key:"_isArrayLike",value:function e(t){switch(typeof t==="undefined"?"undefined":(0,n.default)(t)){case"undefined":case"string":return false}return typeof t.length!=="undefined"}},{key:"_catmullRomInterpolateArray",value:function e(r,i,n,a,o,s,l,u,f){var c=r.length;if(f===1){for(var h=0;h<c;h++){u[h]=t._catmullRomInterpolate(r[h],i[h],n[h],a[h],o,s,l)}}else{var p=r[0].length;for(var d=0;d<c;d++){for(var v=0;v<p;v++){u[d][v]=t._catmullRomInterpolate(r[d][v],i[d][v],n[d][v],a[d][v],o,s,l)}}}}},{key:"_catmullRomInterpolate",value:function e(t,r,i,n,a,o,s){var l=(i-t)*.5;var u=(n-r)*.5;return(2*(r-i)+l+u)*s+(-3*(r-i)-2*l-u)*o+l*a+r}},{key:"_cloneValue",value:function e(r){var i=Array.prototype.slice;if(t._isArrayLike(r)){var n=r.length;if(t._isArrayLike(r[0])){var a=[];for(var o=0;o<n;o++){a.push(i.call(r[o]))}return a}else{return i.call(r)}}else{return r}}},{key:"rgba2String",value:function e(t){t[0]=Math.floor(t[0]);t[1]=Math.floor(t[1]);t[2]=Math.floor(t[2]);return"rgba("+t.join(",")+")"}}]);return t}(g.Eventful);var S=function(){function e(t,r,i,n){(0,l.default)(this,e);this._tracks={};this._target=t;this._loop=r||false;this._getter=i||a;this._setter=n||o;this._clipCount=0;this._delay=0;this._doneList=[];this._onframeList=[];this._clipList=[];this.CLASS_NAME="Zondy.LevelRenderer.Animation.Animator";function a(e,t){return e[t]}function o(e,t,r){e[t]=r}}(0,f.default)(e,[{key:"when",value:function e(t,r){for(var i in r){if(!this._tracks[i]){this._tracks[i]=[];if(t!==0){this._tracks[i].push({time:0,value:w._cloneValue(this._getter(this._target,i))})}}this._tracks[i].push({time:parseInt(t,10),value:r[i]})}return this}},{key:"during",value:function e(t){this._onframeList.push(t);return this}},{key:"start",value:function e(t){var r=this;var i=this._setter;var n=this._getter;var a=r._onframeList.length;var o=t==="spline";var s=function e(){r._clipCount--;if(r._clipCount===0){r._tracks={};var t=r._doneList.length;for(var i=0;i<t;i++){r._doneList[i].call(r)}}};var l=function e(l,u){var f=l.length;if(!f){return}var c=l[0].value;var h=w._isArrayLike(c);var p=false;var d=h&&w._isArrayLike(c[0])?2:1;l.sort(function(e,t){return e.time-t.time});var v=l[f-1].time;var y=[];var m=[];for(var g=0;g<f;g++){y.push(l[g].time/v);var b=l[g].value;if(typeof b=="string"){b=x.SUtil.Util_color.toArray(b);if(b.length===0){b[0]=b[1]=b[2]=0;b[3]=1}p=true}m.push(b)}var S=0;var C=0;var T;var P;var M;var I;var A;var L;var E;if(p){var k=[0,0,0,0]}var D=function e(t,s){if(s<C){T=Math.min(S+1,f-1);for(P=T;P>=0;P--){if(y[P]<=s){break}}P=Math.min(P,f-2)}else{for(P=S;P<f;P++){if(y[P]>s){break}}P=Math.min(P-1,f-2)}S=P;C=s;var l=y[P+1]-y[P];if(l===0){return}else{M=(s-y[P])/l}if(o){A=m[P];I=m[P===0?P:P-1];L=m[P>f-2?f-1:P+1];E=m[P>f-3?f-1:P+2];if(h){w._catmullRomInterpolateArray(I,A,L,E,M,M*M,M*M*M,n(t,u),d)}else{var c=void 0;if(p){c=w.rgba2String(k)}else{c=w._catmullRomInterpolate(I,A,L,E,M,M*M,M*M*M)}i(t,u,c)}}else{if(h){w._interpolateArray(m[P],m[P+1],M,n(t,u),d)}else{var v=void 0;if(p){w._interpolateArray(m[P],m[P+1],M,k,1);v=w.rgba2String(k)}else{v=w._interpolateNumber(m[P],m[P+1],M)}i(t,u,v)}}for(P=0;P<a;P++){r._onframeList[P](t,s)}};var B=new _.Clip({target:r._target,life:v,loop:r._loop,delay:r._delay,onframe:D,ondestroy:s});if(t&&t!=="spline"){B.easing=t}r._clipList.push(B);r._clipCount++;r.animation.add(B)};for(var u in this._tracks){l(this._tracks[u],u)}return this}},{key:"stop",value:function e(){for(var t=0;t<this._clipList.length;t++){var r=this._clipList[t];this.animation.remove(r)}this._clipList=[]}},{key:"delay",value:function e(t){this._delay=t;return this}},{key:"done",value:function e(t){if(t){this._doneList.push(t)}return this}}]);return e}();t.Animation=w;v.Zondy.LevelRenderer.Animation=w;t.Animator=S;v.Zondy.LevelRenderer.Animation.Animator=S},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Clip=undefined;var i=r(1);var n=u(i);var a=r(5);var o=u(a);var s=r(0);var l=r(206);function u(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t){(0,n.default)(this,e);this._targetPool=t.target||{};if(!(this._targetPool instanceof Array)){this._targetPool=[this._targetPool]}this._life=t.life||1e3;this._delay=t.delay||0;this._startTime=(new Date).getTime()+this._delay;this._endTime=this._startTime+this._life*1e3;this.loop=typeof t.loop=="undefined"?false:t.loop;this.gap=t.gap||0;this.easing=t.easing||"Linear";this.onframe=t.onframe;this.ondestroy=t.ondestroy;this.onrestart=t.onrestart;this.CLASS_NAME="Zondy.LevelRenderer.Animation.Clip"}(0,o.default)(e,[{key:"destroy",value:function e(){}},{key:"step",value:function e(t){var r=new l.Easing;var i=(t-this._startTime)/this._life;if(i<0){return}i=Math.min(i,1);var n=typeof this.easing=="string"?r[this.easing]:this.easing;var a=typeof n==="function"?n(i):i;this.fire("frame",a);if(i===1){if(this.loop){this.restart();return"restart"}this._needsRemove=true;return"destroy"}return null}},{key:"restart",value:function e(){var t=(new Date).getTime();var r=(t-this._startTime)%this._life;this._startTime=(new Date).getTime()-r+this.gap}},{key:"fire",value:function e(t,r){for(var i=0,n=this._targetPool.length;i<n;i++){if(this["on"+t]){this["on"+t](this._targetPool[i],r)}}}}]);return e}();t.Clip=f;s.Zondy.LevelRenderer.Animation.Clip=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Easing=undefined;var i=r(1);var n=l(i);var a=r(5);var o=l(a);var s=r(0);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){(0,n.default)(this,e);this.CLASS_NAME="Zondy.LevelRenderer.Animation.Easing"}(0,o.default)(e,[{key:"destroy",value:function e(){}},{key:"Linear",value:function e(t){return t}},{key:"QuadraticIn",value:function e(t){return t*t}},{key:"QuadraticOut",value:function e(t){return t*(2-t)}},{key:"QuadraticInOut",value:function e(t){if((t*=2)<1){return.5*t*t}return-.5*(--t*(t-2)-1)}},{key:"CubicIn",value:function e(t){return t*t*t}},{key:"CubicOut",value:function e(t){return--t*t*t+1}},{key:"CubicInOut",value:function e(t){if((t*=2)<1){return.5*t*t*t}return.5*((t-=2)*t*t+2)}},{key:"QuarticIn",value:function e(t){return t*t*t*t}},{key:"QuarticOut",value:function e(t){return 1- --t*t*t*t}},{key:"QuarticInOut",value:function e(t){if((t*=2)<1){return.5*t*t*t*t}return-.5*((t-=2)*t*t*t-2)}},{key:"QuinticIn",value:function e(t){return t*t*t*t*t}},{key:"QuinticOut",value:function e(t){return--t*t*t*t*t+1}},{key:"QuinticInOut",value:function e(t){if((t*=2)<1){return.5*t*t*t*t*t}return.5*((t-=2)*t*t*t*t+2)}},{key:"SinusoidalIn",value:function e(t){return 1-Math.cos(t*Math.PI/2)}},{key:"SinusoidalOut",value:function e(t){return Math.sin(t*Math.PI/2)}},{key:"SinusoidalInOut",value:function e(t){return.5*(1-Math.cos(Math.PI*t))}},{key:"ExponentialIn",value:function e(t){return t===0?0:Math.pow(1024,t-1)}},{key:"ExponentialOut",value:function e(t){return t===1?1:1-Math.pow(2,-10*t)}},{key:"ExponentialInOut",value:function e(t){if(t===0){return 0}if(t===1){return 1}if((t*=2)<1){return.5*Math.pow(1024,t-1)}return.5*(-Math.pow(2,-10*(t-1))+2)}},{key:"CircularIn",value:function e(t){return 1-Math.sqrt(1-t*t)}},{key:"CircularOut",value:function e(t){return Math.sqrt(1- --t*t)}},{key:"CircularInOut",value:function e(t){if((t*=2)<1){return-.5*(Math.sqrt(1-t*t)-1)}return.5*(Math.sqrt(1-(t-=2)*t)+1)}},{key:"ElasticIn",value:function e(t){var r;var i=.1;var n=.4;if(t===0){return 0}if(t===1){return 1}if(!i||i<1){i=1;r=n/4}else{r=n*Math.asin(1/i)/(2*Math.PI)}return-(i*Math.pow(2,10*(t-=1))*Math.sin((t-r)*(2*Math.PI)/n))}},{key:"ElasticOut",value:function e(t){var r;var i=.1;var n=.4;if(t===0){return 0}if(t===1){return 1}if(!i||i<1){i=1;r=n/4}else{r=n*Math.asin(1/i)/(2*Math.PI)}return i*Math.pow(2,-10*t)*Math.sin((t-r)*(2*Math.PI)/n)+1}},{key:"ElasticInOut",value:function e(t){var r;var i=.1;var n=.4;if(t===0){return 0}if(t===1){return 1}if(!i||i<1){i=1;r=n/4}else{r=n*Math.asin(1/i)/(2*Math.PI)}if((t*=2)<1){return-.5*(i*Math.pow(2,10*(t-=1))*Math.sin((t-r)*(2*Math.PI)/n))}return i*Math.pow(2,-10*(t-=1))*Math.sin((t-r)*(2*Math.PI)/n)*.5+1}},{key:"BackIn",value:function e(t){var r=1.70158;return t*t*((r+1)*t-r)}},{key:"BackOut",value:function e(t){var r=1.70158;return--t*t*((r+1)*t+r)+1}},{key:"BackInOut",value:function e(t){var r=1.70158*1.525;if((t*=2)<1){return.5*(t*t*((r+1)*t-r))}return.5*((t-=2)*t*((r+1)*t+r)+2)}},{key:"BounceIn",value:function e(t){return 1-this.BounceOut(1-t)}},{key:"BounceOut",value:function e(t){if(t<1/2.75){return 7.5625*t*t}else if(t<2/2.75){return 7.5625*(t-=1.5/2.75)*t+.75}else if(t<2.5/2.75){return 7.5625*(t-=2.25/2.75)*t+.9375}else{return 7.5625*(t-=2.625/2.75)*t+.984375}}},{key:"BounceInOut",value:function e(t){if(t<.5){return this.BounceIn(t*2)*.5}return this.BounceOut(t*2-1)*.5+.5}}]);return e}();t.Easing=u;s.Zondy.LevelRenderer.Animation.Easing=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Rectangle=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(7);var h=m(c);var p=r(4);var d=m(p);var v=r(0);var y=r(29);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,d.default)(t,e);function t(e,r,i,a){(0,o.default)(this,t);var s=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i,a));s.x=!isNaN(e)?e:0;s.y=!isNaN(e)?r:0;s.width=!isNaN(i)?i:0;s.height=!isNaN(a)?a:0;s.CLASS_NAME="Zondy.Feature.ShapeParameters.Rectangle";return s}(0,l.default)(t,[{key:"destroy",value:function e(){this.x=null;this.y=null;this.width=null;this.height=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}}]);return t}(y.ShapeParameters);t.Rectangle=g;v.Zondy.Feature.ShapeParameters.Rectangle=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Label=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(7);var h=m(c);var p=r(4);var d=m(p);var v=r(0);var y=r(29);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,d.default)(t,e);function t(e,r,i){(0,o.default)(this,t);var a=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i));a.x=e;a.y=r;a.text=i;a.CLASS_NAME="Zondy.Feature.ShapeParameters.Label";return a}(0,l.default)(t,[{key:"destroy",value:function e(){this.x=null;this.y=null;this.text=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}}]);return t}(y.ShapeParameters);t.Label=g;v.Zondy.Feature.ShapeParameters.Label=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Image=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(7);var h=m(c);var p=r(4);var d=m(p);var v=r(0);var y=r(29);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,d.default)(t,e);function t(e,r,i,a,s,l,u,c,h){(0,o.default)(this,t);var p=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i,a,s,l,u,c,h));p.x=e;p.y=r;p.image=i;p.width=a;p.height=s;p.sx=l;p.sy=u;p.sWidth=c;p.sHeight=h;p.CLASS_NAME="Zondy.Feature.ShapeParameters.Image";return p}(0,l.default)(t,[{key:"destroy",value:function e(){this.x=null;this.y=null;this.image=null;this.width=null;this.height=null;this.sx=null;this.sy=null;this.sWidth=null;this.sHeight=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}}]);return t}(y.ShapeParameters);t.Image=g;v.Zondy.Feature.ShapeParameters.Image=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SmicText=undefined;var i=r(2);var n=g(i);var a=r(1);var o=g(a);var s=r(5);var l=g(s);var u=r(3);var f=g(u);var c=r(7);var h=g(c);var p=r(4);var d=g(p);var v=r(0);var y=r(16);var m=r(20);function g(e){return e&&e.__esModule?e:{default:e}}var _=function(e){(0,d.default)(t,e);function t(e){(0,o.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));r.type="smictext";if(!r.refOriginalPosition||r.refOriginalPosition.length!==2){r.refOriginalPosition=[0,0]}r.CLASS_NAME="Zondy.LevelRenderer.SmicText";return r}(0,l.default)(t,[{key:"destroy",value:function e(){this.type=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"brush",value:function e(t,r){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var i=this.refOriginalPosition;var n=this.style;if(r){n=this.getHighlightStyle(n,this.highlightStyle||{})}if(typeof n.text=="undefined"||n.text===false){return}t.save();this.doClip(t);this.setContext(t,n);this.setTransform(t);if(n.textFont){t.font=n.textFont}t.textAlign=n.textAlign||"start";t.textBaseline=n.textBaseline||"middle";var a=(n.text+"").split("\n");var o=m.SUtil.Util_area.getTextHeight("ZH",n.textFont);var s=this.getRectNoRotation(n);var l=n.x+i[0];var u;if(n.textBaseline==="top"){u=s.y}else if(n.textBaseline==="bottom"){u=s.y+o}else{u=s.y+o/2}var f=n.x+i[0];var c=n.y+i[1];for(var h=0,p=a.length;h<p;h++){if(n.labelRect){t.fillRect(s.x-2,s.y,s.width+4,s.height);t.fillStyle=n.strokeColor;t.strokeRect(s.x-2,s.y,s.width+4,s.height);t.fillStyle=n.textColor}switch(n.brushType){case"stroke":this.setCtxGlobalAlpha(t,"stroke",n);if(n.textRotation&&n.textRotation!==0){t.save();t.translate(f,c);t.rotate(n.textRotation*Math.PI/180);if(n.textBaseline==="top"){if(n.maxWidth){t.strokeText(a[h],0,o*h,n.maxWidth)}else{t.strokeText(a[h],0,o*h)}}else if(n.textBaseline==="bottom"){if(n.maxWidth){t.strokeText(a[h],0,o*(h+1)-s.height,n.maxWidth)}else{t.strokeText(a[h],0,o*(h+1)-s.height)}}else{if(n.maxWidth){t.strokeText(a[h],0,o*(h+1)-s.height/2-o/2,n.maxWidth)}else{t.strokeText(a[h],0,o*(h+1)-s.height/2-o/2)}}t.restore()}else{if(n.maxWidth){t.strokeText(a[h],l,u,n.maxWidth)}else{t.strokeText(a[h],l,u)}}this.setCtxGlobalAlpha(t,"reset",n);break;case"both":if(n.textRotation&&n.textRotation!==0){t.save();t.translate(f,c);t.rotate(n.textRotation*Math.PI/180);if(n.textBaseline==="top"){if(n.maxWidth){this.setCtxGlobalAlpha(t,"fill",n);t.fillText(a[h],0,o*h,n.maxWidth);this.setCtxGlobalAlpha(t,"reset",n);this.setCtxGlobalAlpha(t,"stroke",n);t.strokeText(a[h],0,o*h,n.maxWidth);this.setCtxGlobalAlpha(t,"reset",n)}else{this.setCtxGlobalAlpha(t,"fill",n);t.fillText(a[h],0,o*h);this.setCtxGlobalAlpha(t,"reset",n);this.setCtxGlobalAlpha(t,"stroke",n);t.strokeText(a[h],0,o*h);this.setCtxGlobalAlpha(t,"reset",n)}}else if(n.textBaseline==="bottom"){if(n.maxWidth){this.setCtxGlobalAlpha(t,"fill",n);t.fillText(a[h],0,o*(h+1)-s.height,n.maxWidth);this.setCtxGlobalAlpha(t,"reset",n);this.setCtxGlobalAlpha(t,"stroke",n);t.strokeText(a[h],0,o*(h+1)-s.height,n.maxWidth);this.setCtxGlobalAlpha(t,"reset",n)}else{this.setCtxGlobalAlpha(t,"fill",n);t.fillText(a[h],0,o*(h+1)-s.height);this.setCtxGlobalAlpha(t,"reset",n);this.setCtxGlobalAlpha(t,"stroke",n);t.strokeText(a[h],0,o*(h+1)-s.height);this.setCtxGlobalAlpha(t,"reset",n)}}else{if(n.maxWidth){this.setCtxGlobalAlpha(t,"fill",n);t.fillText(a[h],0,o*(h+1)-s.height/2-o/2,n.maxWidth);this.setCtxGlobalAlpha(t,"reset",n);this.setCtxGlobalAlpha(t,"stroke",n);t.strokeText(a[h],0,o*(h+1)-s.height/2-o/2,n.maxWidth);this.setCtxGlobalAlpha(t,"reset",n)}else{this.setCtxGlobalAlpha(t,"fill",n);t.fillText(a[h],0,o*(h+1)-s.height/2-o/2);this.setCtxGlobalAlpha(t,"reset",n);this.setCtxGlobalAlpha(t,"stroke",n);t.strokeText(a[h],0,o*(h+1)-s.height/2-o/2);this.setCtxGlobalAlpha(t,"reset",n)}}t.restore()}else{if(n.maxWidth){this.setCtxGlobalAlpha(t,"fill",n);t.fillText(a[h],l,u,n.maxWidth);this.setCtxGlobalAlpha(t,"reset",n);this.setCtxGlobalAlpha(t,"stroke",n);t.strokeText(a[h],l,u,n.maxWidth);this.setCtxGlobalAlpha(t,"reset",n)}else{this.setCtxGlobalAlpha(t,"fill",n);t.fillText(a[h],l,u);this.setCtxGlobalAlpha(t,"reset",n);this.setCtxGlobalAlpha(t,"stroke",n);t.strokeText(a[h],l,u);this.setCtxGlobalAlpha(t,"reset",n)}}break;default:this.setCtxGlobalAlpha(t,"fill",n);if(n.textRotation&&n.textRotation!==0){t.save();t.translate(f,c);t.rotate(n.textRotation*Math.PI/180);if(n.textBaseline==="top"){if(n.maxWidth){t.fillText(a[h],0,o*h,n.maxWidth)}else{t.fillText(a[h],0,o*h)}}else if(n.textBaseline==="bottom"){if(n.maxWidth){t.fillText(a[h],0,o*(h+1)-s.height,n.maxWidth)}else{t.fillText(a[h],0,o*(h+1)-s.height)}}else{if(n.maxWidth){t.fillText(a[h],0,o*(h+1)-s.height/2-o/2,n.maxWidth)}else{t.fillText(a[h],0,o*(h+1)-s.height/2-o/2)}}t.restore()}else{if(n.maxWidth){t.fillText(a[h],l,u,n.maxWidth)}else{t.fillText(a[h],l,u)}}this.setCtxGlobalAlpha(t,"reset",n)}u+=o}t.restore();return}},{key:"getRect",value:function e(t){if(t.__rect){return t.__rect}var r,i,n,a;var o=this.getTextBackground(t,true);for(var s=0,l=o.length;s<l;s++){var u=o[s];if(s===0){r=u[0];n=u[0];i=u[1];a=u[1]}else{if(u[0]<r){r=u[0]}if(u[0]>n){n=u[0]}if(u[1]<i){i=u[1]}if(u[1]>a){a=u[1]}}}t.__rect={x:r,y:i,width:n-r,height:a-i};return t.__rect}},{key:"getRectNoRotation",value:function e(t){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var r=this.refOriginalPosition;var i=m.SUtil.Util_area.getTextHeight("ZH",t.textFont);var n=m.SUtil.Util_area.getTextWidth(t.text,t.textFont);var a=m.SUtil.Util_area.getTextHeight(t.text,t.textFont);var o=t.x+r[0];if(t.textAlign==="end"||t.textAlign==="right"){o-=n}else if(t.textAlign==="center"){o-=n/2}var s;if(t.textBaseline==="top"){s=t.y+r[1]}else if(t.textBaseline==="bottom"){s=t.y+r[1]-a}else{s=t.y+r[1]-a/2}var l=false;var u;if(t.maxWidth){var f=parseInt(t.maxWidth);if(f<n){u=n;l=true;n=f}o=t.x+r[0];if(t.textAlign==="end"||t.textAlign==="right"){o-=n}else if(t.textAlign==="center"){o-=n/2}}if(t.textFont){var c=t.textFont;var h=c.toLowerCase();if(h.indexOf("italic")>-1){if(u&&l===true){n+=i/3*(n/u)}else{n+=i/3}}}var p={x:o,y:s,width:n,height:a};return p}},{key:"getTextBackground",value:function e(t,r){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var i=this.refOriginalPosition;if((!r||r===false)&&t.__textBackground){return t.__textBackground}var n=this.getRectNoRotation(t);var a=t.x+i[0];var o=t.y+i[1];var s=[];if(t.textRotation&&t.textRotation!==0){var l=t.textRotation;var u=this.getRotatedLocation(n.x,n.y,a,o,l);var f=this.getRotatedLocation(n.x+n.width,n.y,a,o,l);var c=this.getRotatedLocation(n.x+n.width,n.y+n.height,a,o,l);var h=this.getRotatedLocation(n.x,n.y+n.height,a,o,l);s.push(u);s.push(f);s.push(c);s.push(h)}else{var p=[n.x,n.y];var d=[n.x+n.width,n.y];var v=[n.x+n.width,n.y+n.height];var y=[n.x,n.y+n.height];s.push(p);s.push(d);s.push(v);s.push(y)}t.__textBackground=s;return t.__textBackground}},{key:"getRotatedLocation",value:function e(t,r,i,n,a){var o=new Array,s,l;r=-r;n=-n;a=-a;s=(t-i)*Math.cos(a/180*Math.PI)-(r-n)*Math.sin(a/180*Math.PI)+i;l=(t-i)*Math.sin(a/180*Math.PI)+(r-n)*Math.cos(a/180*Math.PI)+n;o[0]=s;o[1]=-l;return o}}]);return t}(y.Shape);t.SmicText=_;v.Zondy.LevelRenderer.SmicText=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SmicCircle=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(7);var h=m(c);var p=r(4);var d=m(p);var v=r(0);var y=r(16);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,d.default)(t,e);function t(e){(0,o.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));r.type="smiccircle";if(!r.refOriginalPosition||r.refOriginalPosition.length!==2){r.refOriginalPosition=[0,0]}r.CLASS_NAME="Zondy.LevelRenderer.SmicCircle";return r}(0,l.default)(t,[{key:"destroy",value:function e(){this.type=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"buildPath",value:function e(t,r){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var i=this.refOriginalPosition;var n=r.x+i[0];var a=r.y+i[1];t.moveTo(n+r.r,a);t.arc(n,a,r.r,0,Math.PI*2,true);return true}},{key:"getRect",value:function e(t){if(t.__rect){return t.__rect}if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var r=this.refOriginalPosition;var i=t.x+r[0];var n=t.y+r[1];var a=t.r;var o;if(t.brushType==="stroke"||t.brushType==="fill"){o=t.lineWidth||1}else{o=0}t.__rect={x:Math.round(i-a-o/2),y:Math.round(n-a-o/2),width:a*2+o,height:a*2+o};return t.__rect}}]);return t}(y.Shape);t.SmicCircle=g;v.Zondy.LevelRenderer.SmicCircle=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SmicRectangle=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(7);var h=m(c);var p=r(4);var d=m(p);var v=r(0);var y=r(16);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,d.default)(t,e);function t(e){(0,o.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));r.type="smicrectangle";if(!r.refOriginalPosition||r.refOriginalPosition.length!==2){r.refOriginalPosition=[0,0]}r.CLASS_NAME="Zondy.LevelRenderer.Shape.SmicRectangle";return r}(0,l.default)(t,[{key:"destroy",value:function e(){this.type=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"_buildRadiusPath",value:function e(t,r){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var i=this.refOriginalPosition;var n=r.x+i[0];var a=r.y+i[1];var o=r.width;var s=r.height;var l=r.radius;var u;var f;var c;var h;if(typeof l==="number"){u=f=c=h=l}else if(l instanceof Array){if(l.length===1){u=f=c=h=l[0]}else if(l.length===2){u=c=l[0];f=h=l[1]}else if(l.length===3){u=l[0];f=h=l[1];c=l[2]}else{u=l[0];f=l[1];c=l[2];h=l[3]}}else{u=f=c=h=0}var p;if(u+f>o){p=u+f;u*=o/p;f*=o/p}if(c+h>o){p=c+h;c*=o/p;h*=o/p}if(f+c>s){p=f+c;f*=s/p;c*=s/p}if(u+h>s){p=u+h;u*=s/p;h*=s/p}t.moveTo(n+u,a);t.lineTo(n+o-f,a);f!==0&&t.quadraticCurveTo(n+o,a,n+o,a+f);t.lineTo(n+o,a+s-c);c!==0&&t.quadraticCurveTo(n+o,a+s,n+o-c,a+s);t.lineTo(n+h,a+s);h!==0&&t.quadraticCurveTo(n,a+s,n,a+s-h);t.lineTo(n,a+u);u!==0&&t.quadraticCurveTo(n,a,n+u,a)}},{key:"buildPath",value:function e(t,r){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var i=this.refOriginalPosition;if(!r.radius){t.moveTo(r.x+i[0],r.y+i[1]);t.lineTo(r.x+i[0]+r.width,r.y+i[1]);t.lineTo(r.x+i[0]+r.width,r.y+i[1]+r.height);t.lineTo(r.x+i[0],r.y+i[1]+r.height);t.lineTo(r.x+i[0],r.y+i[1])}else{this._buildRadiusPath(t,r)}t.closePath();return}},{key:"getRect",value:function e(t){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var r=this.refOriginalPosition;if(t.__rect){return t.__rect}var i;if(t.brushType==="stroke"||t.brushType==="fill"){i=t.lineWidth||1}else{i=0}t.__rect={x:Math.round(t.x+r[0]-i/2),y:Math.round(t.y+r[1]-i/2),width:t.width+i,height:t.height+i};return t.__rect}}]);return t}(y.Shape);t.SmicRectangle=g;v.Zondy.LevelRenderer.SmicRectangle=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SmicSector=undefined;var i=r(2);var n=g(i);var a=r(1);var o=g(a);var s=r(5);var l=g(s);var u=r(3);var f=g(u);var c=r(7);var h=g(c);var p=r(4);var d=g(p);var v=r(0);var y=r(16);var m=r(20);function g(e){return e&&e.__esModule?e:{default:e}}var _=function(e){(0,d.default)(t,e);function t(e){(0,o.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));r.type="smicsector";if(!r.refOriginalPosition||r.refOriginalPosition.length!==2){r.refOriginalPosition=[0,0]}r.CLASS_NAME="Zondy.LevelRenderer.Shape.SmicSector";return r}(0,l.default)(t,[{key:"destroy",value:function e(){this.type=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"buildPath",value:function e(t,r){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var i=this.refOriginalPosition;var n=r.x+i[0];var a=r.y+i[1];var o=r.r0||0;var s=r.r;var l=r.startAngle;var u=r.endAngle;var f=r.clockWise||false;l=m.SUtil.Util_math.degreeToRadian(l);u=m.SUtil.Util_math.degreeToRadian(u);if(!f){l=-l;u=-u}var c=m.SUtil.Util_math.cos(l);var h=m.SUtil.Util_math.sin(l);t.moveTo(c*o+n,h*o+a);t.lineTo(c*s+n,h*s+a);t.arc(n,a,s,l,u,!f);t.lineTo(m.SUtil.Util_math.cos(u)*o+n,m.SUtil.Util_math.sin(u)*o+a);if(o!==0){t.arc(n,a,o,u,l,f)}t.closePath();return}},{key:"getRect",value:function e(t){if(t.__rect){return t.__rect}if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var r=this.refOriginalPosition;var i=m.SUtil.Util_vector.create();var n=m.SUtil.Util_vector.create();var a=m.SUtil.Util_vector.create();var o=m.SUtil.Util_vector.create();var s=t.x+r[0];var l=t.y+r[1];var u=t.r0||0;var f=t.r;var c=m.SUtil.Util_math.degreeToRadian(t.startAngle);var h=m.SUtil.Util_math.degreeToRadian(t.endAngle);var p=t.clockWise;if(!p){c=-c;h=-h}if(u>1){m.SUtil.Util_computeBoundingBox.arc(s,l,u,c,h,!p,i,a)}else{i[0]=a[0]=s;i[1]=a[1]=l}m.SUtil.Util_computeBoundingBox.arc(s,l,f,c,h,!p,n,o);m.SUtil.Util_vector.min(i,i,n);m.SUtil.Util_vector.max(a,a,o);t.__rect={x:i[0],y:i[1],width:a[0]-i[0],height:a[1]-i[1]};return t.__rect}}]);return t}(y.Shape);t.SmicSector=_;v.Zondy.LevelRenderer.SmicSector=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.rangeThemeLayer=t.RangeThemeLayer=undefined;var i=r(2);var n=x(i);var a=r(1);var o=x(a);var s=r(5);var l=x(s);var u=r(3);var f=x(u);var c=r(4);var h=x(c);var p=r(25);var d=x(p);var v=r(0);var y=r(6);var m=r(66);var g=r(51);var _=r(13);function x(e){return e&&e.__esModule?e:{default:e}}var b=function(e){(0,h.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r));i.style=r.style;i.isHoverAble=r.isHoverAble;i.highlightStyle=r.highlightStyle;i.themeField=r.themeField;i.styleGroups=r.styleGroups;return i}(0,l.default)(t,[{key:"createThematicFeature",value:function e(t){var r=this.getStyleByData(t);var i={};i.nodesClipPixel=this.nodesClipPixel;i.isHoverAble=this.isHoverAble;i.isMultiHover=this.isMultiHover;i.isClickAble=this.isClickAble;i.highlightStyle=_.ShapeFactory.transformStyle(this.highlightStyle);var n=new g.ThemeVector(t,this,_.ShapeFactory.transformStyle(r),i);for(var a=0;a<n.shapes.length;a++){this.renderer.addShape(n.shapes[a])}return n}},{key:"getStyleByData",value:function e(t){var r={};var i=t;r=(0,y.copyAttributesWithClip)(r,this.style);if(this.themeField&&this.styleGroups&&this.styleGroups.length>0&&i.attributes){var n=this.themeField;var a=i.attributes;var o=this.styleGroups;var s=false;var l=null;for(var u in a){if(n===u){s=true;l=a[u];break}}if(s){for(var f=0,c=o.length;f<c;f++){if(l>=o[f].start&&l<o[f].end){var h=o[f].style;r=(0,y.copyAttributesWithClip)(r,h)}}}}if(i.style&&this.isAllowFeatureStyle===true){r=(0,y.copyAttributesWithClip)(i.style)}return r}}]);return t}(m.GeoFeatureThemeLayer);t.RangeThemeLayer=b;var w=t.rangeThemeLayer=function e(t,r){return new b(t,r)};v.Zondy.Map.rangeThemeLayer=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SUtil=t.LevelRendererVector=t.Util=t.Transformable=t.Storage=t.SmicText=t.SmicStar=t.SmicSector=t.SmicRing=t.SmicRectangle=t.SmicPolygon=t.SmicPoint=t.SmicIsogon=t.SmicImage=t.SmicEllipse=t.SmicCircle=t.SmicBrokenLine=t.Shape=t.PaintLayer=t.Painter=t.Matrix=t.Math=t.Http=t.Handler=t.Group=t.Eventful=t.LevelRendererEvent=t.Env=t.Easing=t.LevelRendererCurve=t.Config=t.ComputeBoundingBox=t.Color=t.Clip=t.Area=t.Animator=t.Animation=t.Render=t.LevelRenderer=t.FeatureTheme=t.Sector=t.FeatureRectangle=t.FeaturePolygon=t.Point=t.FeatureLine=t.Label=t.Image=t.FeatureCircle=t.ShapeParameters=t.ShapeFactory=t.ThemeVector=t.Ring=t.RankSymbol=t.OverlayPoint=t.Pie=t.Line=t.Graph=t.OverlayCircle=t.Bar3D=t.Bar=undefined;var i=r(372);var n=r(373);var a=r(374);var o=r(33);var s=r(375);var l=r(376);var u=r(377);var f=r(216);var c=r(378);var h=r(51);var p=r(379);var d=r(380);t.Bar=i.Bar;t.Bar3D=n.Bar3D;t.OverlayCircle=a.Circle;t.Graph=o.Graph;t.Line=s.Line;t.Pie=l.Pie;t.OverlayPoint=u.Point;t.RankSymbol=f.RankSymbol;t.Ring=c.Ring;t.ThemeVector=h.ThemeVector;t.ShapeFactory=p.ShapeFactory;t.ShapeParameters=p.ShapeParameters;t.FeatureCircle=p.FeatureCircle;t.Image=p.Image;t.Label=p.Label;t.FeatureLine=p.FeatureLine;t.Point=p.Point;t.FeaturePolygon=p.FeaturePolygon;t.FeatureRectangle=p.FeatureRectangle;t.Sector=p.Sector;t.FeatureTheme=p.FeatureTheme;t.LevelRenderer=d.LevelRenderer;t.Render=d.Render;t.Animation=d.Animation;t.Animator=d.Animator;t.Area=d.Area;t.Clip=d.Clip;t.Color=d.Color;t.ComputeBoundingBox=d.ComputeBoundingBox;t.Config=d.Config;t.LevelRendererCurve=d.LevelRendererCurve;t.Easing=d.Easing;t.Env=d.Env;t.LevelRendererEvent=d.LevelRendererEvent;t.Eventful=d.Eventful;t.Group=d.Group;t.Handler=d.Handler;t.Http=d.Http;t.Math=d.Math;t.Matrix=d.Matrix;t.Painter=d.Painter;t.PaintLayer=d.PaintLayer;t.Shape=d.Shape;t.SmicBrokenLine=d.SmicBrokenLine;t.SmicCircle=d.SmicCircle;t.SmicEllipse=d.SmicEllipse;t.SmicImage=d.SmicImage;t.SmicIsogon=d.SmicIsogon;t.SmicPoint=d.SmicPoint;t.SmicPolygon=d.SmicPolygon;t.SmicRectangle=d.SmicRectangle;t.SmicRing=d.SmicRing;t.SmicSector=d.SmicSector;t.SmicStar=d.SmicStar;t.SmicText=d.SmicText;t.Storage=d.Storage;t.Transformable=d.Transformable;t.Util=d.Util;t.LevelRendererVector=d.LevelRendererVector;t.SUtil=d.SUtil},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.RankSymbol=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(7);var h=m(c);var p=r(4);var d=m(p);var v=r(0);var y=r(33);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,d.default)(t,e);function t(e,r,i,a,s,l){(0,o.default)(this,t);var u=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i,a,s,l));u.setting=null;if(a&&a.codomain){u.setting=a;u.DVBCodomain=u.setting.codomain}u.CLASS_NAME="Zondy.Theme.RankSymbol";return u}(0,l.default)(t,[{key:"destroy",value:function e(){this.setting=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"initBaseParameter",value:function e(){var t=true;if(!this.setting){return false}var r=this.setting;if(r.XOffset){this.XOffset=r.XOffset}if(r.YOffset){this.YOffset=r.YOffset}this.XOffset=r.XOffset?r.XOffset:0;this.YOffset=r.YOffset?r.YOffset:0;this.origonPoint=[];this.chartBox=[];this.dataViewBox=[];this.DVBParameter=r.dataViewBoxParameter?r.dataViewBoxParameter:[0,0,0,0];this.DVBOrigonPoint=[];this.DVBCenterPoint=[];this.origonPointOffset=[];this.resetLocation();var i=this.width;var n=this.height;var a=this.location;this.origonPoint=[a[0]-i/2,a[1]-n/2];var o=this.origonPoint;this.chartBox=[o[0],o[1]+n,o[0]+i,o[1]];var s=this.chartBox;var l=this.DVBParameter;this.dataViewBox=[s[0]+l[0],s[1]-l[1],s[2]-l[2],s[3]+l[3]];var u=this.dataViewBox;if(u[0]>=u[2]||u[1]<=u[3]){return false}this.DVBOrigonPoint=[u[0],u[3]];this.DVBWidth=Math.abs(u[2]-u[0]);this.DVBHeight=Math.abs(u[1]-u[3]);this.DVBCenterPoint=[this.DVBOrigonPoint[0]+this.DVBWidth/2,this.DVBOrigonPoint[1]+this.DVBHeight/2];this.origonPointOffset=[this.DVBOrigonPoint[0]-o[0],this.DVBOrigonPoint[1]-o[1]];return t}}]);return t}(y.Graph);t.RankSymbol=g;v.Zondy.Theme.RankSymbol=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GraphThemeLayer=t.graphThemeLayer=undefined;var i=r(2);var n=w(i);var a=r(1);var o=w(a);var s=r(5);var l=w(s);var u=r(3);var f=w(u);var c=r(7);var h=w(c);var p=r(4);var d=w(p);var v=r(25);var y=w(v);var m=r(0);var g=r(111);var _=r(43);var x=r(19);var b=r(63);function w(e){return e&&e.__esModule?e:{default:e}}var S=function(e){(0,d.default)(t,e);function t(e,r,i){(0,o.default)(this,t);var a=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,i));a.chartsSetting=i.chartsSetting||{};a.themeFields=i.themeFields||null;a.overlayWeightField=i.overlayWeightField||null;a.isOverLay=i.isOverLay||true;a.charts=i.charts||[];a.cache=i.cache||{};a.chartsType=r;a.options={calGravity:i.calGravity||true};return a}(0,l.default)(t,[{key:"setChartsType",value:function e(t){this.chartsType=t;this.redraw()}},{key:"addFeatures",value:function e(t){var r=this;window.mapboxgl.Evented.prototype.fire("beforefeaturesadded",{features:t});if(t instanceof b.FeatureSet){var i=null;var n=t.AttStruct;var a=t.SFEleArray;if(a!=null&&a.length>0){for(var o=0;o<a.length;o++){var s=a[o];if(s.AttValue!=null&&s.AttValue.length>0){var i={};for(var l=0;l<s.AttValue.length;l++){i[n.FldName[l]]=s.AttValue[l]}i["FID"]=s.FID}s.attributes=i;r.features.push(s)}}}if(this.renderer){this.redrawThematicFeatures(this.map.getBounds())}}},{key:"redrawThematicFeatures",value:function e(t){this.clearCache();this.renderer.clearAll();var r=this.features;for(var i=0,n=r.length;i<n;i++){var a=r[i];var o=this.cache;var s=a.FID;if(o[s]){continue}o[s]=s;var l=this.createThematicFeature(a);if(l&&this.overlayWeightField){if(a.attributes[this.overlayWeightField]&&!isNaN(a.attributes[this.overlayWeightField])){l["__overlayWeight"]=a.attributes[this.overlayWeightField]}}if(l){this.charts.push(l)}}this.drawCharts()}},{key:"createThematicFeature",value:function e(t){var r;if(_.Theme[this.chartsType]&&this.themeFields&&this.chartsSetting){r=new _.Theme[this.chartsType](t,this,this.themeFields,this.chartsSetting,null,this.options)}if(!r){return false}r.assembleShapes();return r}},{key:"drawCharts",value:function e(){if(!this.renderer){return}var t=this.charts;if(this.overlayWeightField){t.sort(function(e,t){if(typeof e["__overlayWeight"]=="undefined"&&typeof t["__overlayWeight"]=="undefined"){return 0}else if(typeof e["__overlayWeight"]!="undefined"&&typeof t["__overlayWeight"]=="undefined"){return-1}else if(typeof e["__overlayWeight"]=="undefined"&&typeof t["__overlayWeight"]!="undefined"){return 1}else if(typeof e["__overlayWeight"]!="undefined"&&typeof t["__overlayWeight"]!="undefined"){if(parseFloat(e["__overlayWeight"])<parseFloat(t["__overlayWeight"])){return 1}else{return-1}}return 0})}if(!this.isOverLay){for(var r=0,i=t.length;r<i;r++){var n=t[r];var a=n.resetLocation();var o=n.shapes;for(var s=0,l=o.length;s<l;s++){o[s].refOriginalPosition=a;this.renderer.addShape(o[s])}}}else{var u=[];for(var f=0,c=t.length;f<c;f++){var h=t[f];var p=h.resetLocation();var d=h.chartBounds;var v=[{x:d.xmin,y:d.ymin},{x:d.xmin,y:d.ymax},{x:d.xmax,y:d.ymax},{x:d.xmax,y:d.ymin},{x:d.xmin,y:d.ymax}];var y=false;if(f!==0){for(var m=0;m<u.length;m++){if(this.isQuadrilateralOverLap(v,u[m])){y=true;break}}}if(y){continue}else{u.push(v)}var g=h.shapes;for(var _=0,x=g.length;_<x;_++){g[_].refOriginalPosition=p;this.renderer.addShape(g[_])}}}this.renderer.render()}},{key:"getShapesByFeatureID",value:function e(t){var r=[];var i=this.renderer.getAllShapes();if(!t){return i}for(var n=0,a=i.length;n<a;n++){var o=i[n];if(o.refDataID&&t===o.refDataID){r.push(o)}}return r}},{key:"isQuadrilateralOverLap",value:function e(t,r){var i=t.length,n=r.length;if(i!==5||n!==5){return null}var a=false;for(var o=0;o<i;o++){if(this.isPointInPoly(t[o],r)){a=true;break}}for(var s=0;s<n;s++){if(this.isPointInPoly(r[s],t)){a=true;break}}for(var l=0;l<i-1;l++){if(a){break}for(var u=0;u<n-1;u++){var f=this.lineIntersection(t[l],t[l+1],r[u],r[u+1]);if(f.CLASS_NAME==="Zondy.Object.Point2D"){a=true;break}}}return a}},{key:"lineIntersection",value:function e(t,r,i,n){var a=null;var o;var s;var l=(n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x);var u=(r.x-t.x)*(t.y-i.y)-(r.y-t.y)*(t.x-i.x);var f=(n.y-i.y)*(r.x-t.x)-(n.x-i.x)*(r.y-t.y);if(f!==0){o=l/f;s=u/f;if(o>=0&&s<=1&&o<=1&&s>=0){a=new x.Point2D(t.x+o*(r.x-t.x),t.y+o*(r.y-t.y))}else{a="No Intersection"}}else{if(l===0&&u===0){var c=Math.max(t.y,r.y);var h=Math.min(t.y,r.y);var p=Math.max(t.x,r.x);var d=Math.min(t.x,r.x);if((i.y>=h&&i.y<=c||n.y>=h&&n.y<=c)&&i.x>=d&&i.x<=p||n.x>=d&&n.x<=p){a="Coincident"}else{a="Parallel"}}else{a="Parallel"}}return a}},{key:"isPointInPoly",value:function e(t,r){for(var i=false,n=-1,a=r.length,o=a-1;++n<a;o=n){(r[n].y<=t.y&&t.y<r[o].y||r[o].y<=t.y&&t.y<r[n].y)&&t.x<(r[o].x-r[n].x)*(t.y-r[n].y)/(r[o].y-r[n].y)+r[n].x&&(i=!i)}return i}},{key:"isChartInMap",value:function e(t,r){var i=t;var n=false;for(var a=0,o=r.length;a<o;a++){var s=r[a];if(s.x>=i.xmin&&s.x<=i.xmax&&s.y>=i.ymin&&s.y<=i.ymax){n=true;break}}return n}},{key:"clearCache",value:function e(){this.cache={};this.charts=[]}},{key:"removeFeatures",value:function e(r){this.clearCache();(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"removeFeatures",this).call(this,r)}},{key:"removeAllFeatures",value:function e(){this.clearCache();(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"removeAllFeatures",this).call(this)}},{key:"redraw",value:function e(){this.clearCache();if(this.renderer){this.redrawThematicFeatures(this.map.getBounds());return true}return false}},{key:"clear",value:function e(){if(this.renderer){this.renderer.clearAll();this.renderer.refresh()}this.removeAllFeatures();this.clearCache()}}]);return t}(g.ThemeLayer);var C=t.graphThemeLayer=function e(t,r,i){return new S(t,r,i)};t.GraphThemeLayer=S;m.Zondy.Map.graphThemeLayer=C},function(e,t){e.exports=function(){try{return echarts}catch(e){return{}}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MapvLayer=undefined;var i=r(1);var n=f(i);var a=r(5);var o=f(a);var s=r(21);var l=f(s);r(39);var u=r(394);function f(e){return e&&e.__esModule?e:{default:e}}var c=t.MapvLayer=function(){function e(t,r,i){(0,n.default)(this,e);this.map=t;this.layerID=i.layerID;delete i["layerID"];this.mapvBaseLayer=new u.MapvBaseLayer(t,r,i,this);this.mapVOptions=i;this.initDevicePixelRatio();this.canvas=this._createCanvas();this.render=this.render.bind(this);this.bindEvent();this.mapContainer=t.getCanvasContainer();this.mapContainer.appendChild(this.canvas);this.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px";this._reset()}(0,o.default)(e,[{key:"initDevicePixelRatio",value:function e(){this.devicePixelRatio=window.devicePixelRatio||1}},{key:"bindEvent",value:function e(){var t=this.map;this.innerMoveStart=this.moveStartEvent.bind(this);this.innerMoveEnd=this.moveEndEvent.bind(this);this.innnerZoomStart=this.zoomStartEvent.bind(this);this.innnerZoomEnd=this.zoomEndEvent.bind(this);this.innnerRotateStart=this.rotateStartEvent.bind(this);this.innnerRotateEnd=this.rotateEndEvent.bind(this);this.innerResize=this.resizeEvent.bind(this);this.innerRemove=this.removeEvent.bind(this);t.on("resize",this.innerResize);t.on("zoomstart",this.innnerZoomStart);t.on("zoomend",this.innnerZoomEnd);t.on("rotatestart",this.innnerRotateStart);t.on("rotateend",this.innnerRotateEnd);t.on("movestart",this.innerMoveStart);t.on("moveend",this.innerMoveEnd);this.map.on("remove",this.innerRemove)}},{key:"unbindEvent",value:function e(){var t=this.map;t.off("resize",this.innerResize);t.off("zoomstart",this.innnerZoomStart);t.off("zoomend",this.innnerZoomEnd);t.off("rotatestart",this.innnerRotateStart);t.off("rotateend",this.innnerRotateEnd);t.off("movestart",this.innerMoveStart);t.off("moveend",this.innerMoveEnd)}},{key:"moveStartEvent",value:function e(){this.mapvBaseLayer.animatorMovestartEvent();this._unvisiable()}},{key:"moveEndEvent",value:function e(){this.mapvBaseLayer.animatorMoveendEvent();this._reset();this._visiable()}},{key:"zoomStartEvent",value:function e(){this._unvisiable()}},{key:"zoomEndEvent",value:function e(){this._unvisiable()}},{key:"rotateStartEvent",value:function e(){this.mapvBaseLayer.animatorMovestartEvent();this._unvisiable()}},{key:"rotateEndEvent",value:function e(){this.mapvBaseLayer.animatorMoveendEvent();this._reset();this._visiable()}},{key:"resizeEvent",value:function e(){this._reset();this._visiable()}},{key:"removeEvent",value:function e(){this.mapContainer.removeChild(this.canvas)}},{key:"addData",value:function e(t,r){this.mapvBaseLayer.addData(t,r)}},{key:"updateData",value:function e(t,r){this.mapvBaseLayer.updateData(t,r)}},{key:"getData",value:function e(){if(this.mapvBaseLayer){this.dataSet=this.mapvBaseLayer.getData()}return this.dataSet}},{key:"removeData",value:function e(t){this.mapvBaseLayer&&this.mapvBaseLayer.removeData(t)}},{key:"removeAllData",value:function e(){this.mapvBaseLayer.clearData()}},{key:"_visiable",value:function e(){this.canvas.style.display="block";return this}},{key:"_unvisiable",value:function e(){this.canvas.style.display="none";return this}},{key:"_createCanvas",value:function e(){var t=document.createElement("canvas");t.id=this.layerID;t.style.position="absolute";t.style.top="0px";t.style.left="0px";t.width=parseInt(this.map.getCanvas().style.width);t.height=parseInt(this.map.getCanvas().style.height);t.style.width=this.map.getCanvas().style.width;t.style.height=this.map.getCanvas().style.height;var r=this.devicePixelRatio;if(this.mapVOptions.context=="2d"){t.getContext(this.mapVOptions.context).scale(r,r)}return t}},{key:"_reset",value:function e(){if(this.canvas==null){return}this.resizeCanvas();this.fixPosition();this.onResize();this.render()}},{key:"draw",value:function e(){return this._reset()}},{key:"show",value:function e(){this._visiable()}},{key:"hide",value:function e(){this._unvisiable()}},{key:"update",value:function e(t){if(t==undefined){return}this.updateData(t.data,t.options)}},{key:"resizeCanvas",value:function e(){this.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px";var t=this.canvas;t.style.position="absolute";t.style.top="0px";t.style.left="0px";t.width=parseInt(this.map.getCanvas().style.width);t.height=parseInt(this.map.getCanvas().style.height);t.style.width=this.map.getCanvas().style.width;t.style.height=this.map.getCanvas().style.height}},{key:"fixPosition",value:function e(){}},{key:"onResize",value:function e(){}},{key:"originPosition",value:function e(){this.originPitch=this.map.getPitch();this.originBearing=this.map.getBearing();var t=this.map.project(new l.default.LngLat(0,0));this.originX=t.x;this.originY=t.y}},{key:"render",value:function e(){this.mapvBaseLayer._canvasUpdate()}},{key:"moveTo",value:function e(t,r){var i=document.getElementById(this.layerID);r=r!==undefined?r:true;if(r){var n=document.getElementById(t);if(i&&n){n.parentNode.insertBefore(i,n)}return}var a=document.getElementById(t);if(i){if(a.nextSibling){a.parentNode.insertBefore(i,a.nextSibling);return}a.parentNode.appendChild(i)}}},{key:"remove",value:function e(){this.removeAllData();this.unbindEvent();this.mapContainer.removeChild(this.canvas);this.disposeFlag=true}},{key:"destroy",value:function e(){this.removeAllData();this.unbindEvent();this.mapContainer.removeChild(this.canvas);this.disposeFlag=true}}]);return e}();l.default.zondy.MapvLayer=c},function(e,t,r){"use strict";r(221)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.StreamLayer=t.MapvLayer=t.EchartsLayer=t.ThemesInfo=t.ThemeOper=t.ItemValue=t.FolderInfoAttribute=t.FolderInfo=t.ExpInfo=t.CUniqueThemeInfo=t.CUniqueTheme=t.CThemeInfo=t.CTheme=t.CSimpleTheme=t.CRegInfo=t.CRangeThemeInfo=t.CRangeTheme=t.CRandomTheme=t.CPntInfo=t.CMultiClassTheme=t.CLinInfo=t.CGraduatedSymbolTheme=t.CFourColorTheme=t.CDotDensityTheme=t.CChartType=t.CChartThemeRepresentInfo=t.CChartThemeInfo=t.CChartTheme=t.CChartLabelFormat=t.CAnnInfo=t.CAllOtherDataItemInfoSource=t.MapServiceBase=t.GetTileImageService=t.GetMapInfoService=t.GetMapImageService=t.GetLayerImageService=t.GetDocImageService=t.TopAnalysis=t.Smooth=t.ProjectRang=t.ProjectDots=t.GeometryAnalysisBase=t.CProjectParam=t.CProjectBySRSID=t.CalServiceBase=t.CalPolyLineLength=t.CalArea=t.ProjectBySRID=t.ProjectByLayer=t.ProjectBase=t.OverlayByPolygon=t.OverlayByLayer=t.OverlayBase=t.NetAnalysis=t.FeatureBuffBySingleRing=t.FeatureBuffByMultiplyRing=t.FeatureBuffBase=t.ContourAnalyse=t.ClipByPolygon=t.ClipByLayer=t.ClipByCircle=t.ClipBase=t.ClassBufferBySingleRing=t.ClassBufferByMultiplyRing=t.ClassBufferBase=t.AnalysisBase=t.QueryServiceBase=t.QueryParameterBase=t.QueryParameter=t.QueryLayerFeature=t.QueryFeatureStruct=t.QueryFeatureRule=t.QueryDocFeature=t.QueryByLayerParameter=t.ObjClsQueryParameter=t.ObjClsQuery=t.MultiGeoQueryParameter=undefined;t.MultiGeoQuery=t.EditServiceBase=t.EditLayerFeature=t.EditDocFeature=t.VectorLayer=t.TileLayer=t.CatalogService=t.MapDoc=t.GDBInfo=t.ColorInfo=t.JSONFormat=t.IgsServiceBase=t.FetchRequest=t.RequestTimeout=t.CORS=t.Events=t.CommonServiceBase=t.SlopLineParam=t.NetAnalysisExtent=t.NetAnalyse=t.MeshingParam=t.ContourRegionInfo=t.ContourZValue=t.ContourParam=t.ContourNoteParam=t.mixin=t.merge=t.DeepMerge=t.ChineseToUtf8=t.getTopAnalysisResult=t.bindAsEventListener=t.bind=t.newGuid=t.cloneObject=t.copyAttributesWithClip=t.copyAttributes=t.transformResult=t.toJSON=t.isInTheSameDomain=t.supportCanvas=t.isSupportCanvas=t.getBrowser=t.Browser=t.IS_GECKO=t.getParameters=t.urlAppend=t.getWFParameterString=t.getParameterString=t.applyDefaults=t.modifyDOMElement=t.indexOf=t.removeItem=t.isElement=t.getElement=t.reset=t.copyExcluce=t.copy=t.extendDeep=t.isArray=t.extend=t.WebGraphicsInfo=t.VectCls=t.Tangram=t.Rectangle=t.PolyLine=t.Polygon=t.Point2D=t.MultiPolygon=t.LablePntInfo=t.LabelRegInfo=t.LabelLinInfo=t.GRegion=t.GPoint=t.GLine=t.FeatureSet=t.FeatureGraphicBase=t.FeatureGeometry=t.Feature=t.LayerStatusType=t.MapType=t.CItemType=t.CLinStyleMakeType=t.CLinJointType=t.CLinHeadType=t.CLinAdjustType=t.NetElemType=t.NetAnalyType=t.ISShowArc=t.EightDirType=t.LineConstrain=t.LabelSpreadType=t.RepeatType=t.LabelPntType=t.LabelRegType=t.LabelLinType=t.FontShape=t.FeatureType=t.VectClsType=t.XClsType=t.DynShowStyle=undefined;t.DynNoteLableType=t.CRegionInfo=t.CPointInfo=t.CLineInfo=t.Circle=t.CGDBInfo=t.CDynNoteInfo=t.CDisplayStyleExtend=t.CDisplayStyle=t.CAttDataRow=t.CAttStruct=t.Zondy=t.Arc=t.AnyLine=t.ServiceBase=t.SUtil=t.LevelRendererVector=t.Util=t.Transformable=t.Storage=t.SmicText=t.SmicStar=t.SmicSector=t.SmicRing=t.SmicRectangle=t.SmicPolygon=t.SmicPoint=t.SmicIsogon=t.SmicImage=t.SmicEllipse=t.SmicCircle=t.SmicBrokenLine=t.Shape=t.PaintLayer=t.Painter=t.Matrix=t.Math=t.Http=t.Handler=t.Group=t.Eventful=t.LevelRendererEvent=t.Env=t.Easing=t.LevelRendererCurve=t.Config=t.ComputeBoundingBox=t.Color=t.Clip=t.Area=t.Animator=t.Animation=t.Render=t.LevelRenderer=t.FeatureTheme=t.Sector=t.FeatureRectangle=t.FeaturePolygon=t.Point=t.FeatureLine=t.Label=t.Image=t.FeatureCircle=t.ShapeParameters=t.ShapeFactory=t.ThemeVector=t.Ring=t.RankSymbol=t.OverlayPoint=t.Pie=t.Line=t.Graph=t.OverlayCircle=t.Bar3D=t.Bar=t.uniqueTheme3DLayer=t.UniqueTheme3DLayer=t.rangeTheme3DLayer=t.RangeTheme3DLayer=t.Theme3DLayer=t.ThemeStyle=t.RankSymbolThemeLayer=t.SimpleThemeLayer=t.RandomThemeLayer=t.graphThemeLayer=t.GraphThemeLayer=t.UniqueThemeLayer=t.rangeThemeLayer=t.RangeThemeLayer=t.ThemeLayer=t.GeoFeatureThemeLayer=t.TDTLayer=t.ArcGISLayer=t.MapVectorLayer=t.MapWMTSLayer=t.MapWmsLayer=t.MapTileLayer=t.MapDocLayer=t.mapboxgl=t.MapExtend=undefined;var i=r(222);var n=r(278);var a=r(27);var o=r(135);var s=r(300);var l=r(323);var u=r(324);var f=r(330);var c=r(338);var h=r(353);var p=r(361);var d=r(367);var v=r(370);var y=r(215);var m=r(391);t.MapExtend=i.MapExtend;t.mapboxgl=n.mapboxgl;t.MapDocLayer=n.MapDocLayer;t.MapTileLayer=n.MapTileLayer;t.MapWmsLayer=n.MapWmsLayer;t.MapWMTSLayer=n.MapWMTSLayer;t.MapVectorLayer=n.MapVectorLayer;t.ArcGISLayer=n.ArcGISLayer;t.TDTLayer=n.TDTLayer;t.GeoFeatureThemeLayer=v.GeoFeatureThemeLayer;t.ThemeLayer=v.ThemeLayer;t.RangeThemeLayer=v.RangeThemeLayer;t.rangeThemeLayer=v.rangeThemeLayer;t.UniqueThemeLayer=v.UniqueThemeLayer;t.GraphThemeLayer=v.GraphThemeLayer;t.graphThemeLayer=v.graphThemeLayer;t.RandomThemeLayer=v.RandomThemeLayer;t.SimpleThemeLayer=v.SimpleThemeLayer;t.RankSymbolThemeLayer=v.RankSymbolThemeLayer;t.ThemeStyle=v.ThemeStyle;t.Theme3DLayer=v.Theme3DLayer;t.RangeTheme3DLayer=v.RangeTheme3DLayer;t.rangeTheme3DLayer=v.rangeTheme3DLayer;t.UniqueTheme3DLayer=v.UniqueTheme3DLayer;t.uniqueTheme3DLayer=v.uniqueTheme3DLayer;t.Bar=y.Bar;t.Bar3D=y.Bar3D;t.OverlayCircle=y.OverlayCircle;t.Graph=y.Graph;t.Line=y.Line;t.Pie=y.Pie;t.OverlayPoint=y.OverlayPoint;t.RankSymbol=y.RankSymbol;t.Ring=y.Ring;t.ThemeVector=y.ThemeVector;t.ShapeFactory=y.ShapeFactory;t.ShapeParameters=y.ShapeParameters;t.FeatureCircle=y.FeatureCircle;t.Image=y.Image;t.Label=y.Label;t.FeatureLine=y.FeatureLine;t.Point=y.Point;t.FeaturePolygon=y.FeaturePolygon;t.FeatureRectangle=y.FeatureRectangle;t.Sector=y.Sector;t.FeatureTheme=y.FeatureTheme;t.LevelRenderer=y.LevelRenderer;t.Render=y.Render;t.Animation=y.Animation;t.Animator=y.Animator;t.Area=y.Area;t.Clip=y.Clip;t.Color=y.Color;t.ComputeBoundingBox=y.ComputeBoundingBox;t.Config=y.Config;t.LevelRendererCurve=y.LevelRendererCurve;t.Easing=y.Easing;t.Env=y.Env;t.LevelRendererEvent=y.LevelRendererEvent;t.Eventful=y.Eventful;t.Group=y.Group;t.Handler=y.Handler;t.Http=y.Http;t.Math=y.Math;t.Matrix=y.Matrix;t.Painter=y.Painter;t.PaintLayer=y.PaintLayer;t.Shape=y.Shape;t.SmicBrokenLine=y.SmicBrokenLine;t.SmicCircle=y.SmicCircle;t.SmicEllipse=y.SmicEllipse;t.SmicImage=y.SmicImage;t.SmicIsogon=y.SmicIsogon;t.SmicPoint=y.SmicPoint;t.SmicPolygon=y.SmicPolygon;t.SmicRectangle=y.SmicRectangle;t.SmicRing=y.SmicRing;t.SmicSector=y.SmicSector;t.SmicStar=y.SmicStar;t.SmicText=y.SmicText;t.Storage=y.Storage;t.Transformable=y.Transformable;t.Util=y.Util;t.LevelRendererVector=y.LevelRendererVector;t.SUtil=y.SUtil;t.ServiceBase=a.ServiceBase;t.AnyLine=o.AnyLine;t.Arc=o.Arc;t.Zondy=o.Zondy;t.CAttStruct=o.CAttStruct;t.CAttDataRow=o.CAttDataRow;t.CDisplayStyle=o.CDisplayStyle;t.CDisplayStyleExtend=o.CDisplayStyleExtend;t.CDynNoteInfo=o.CDynNoteInfo;t.CGDBInfo=o.CGDBInfo;t.Circle=o.Circle;t.CLineInfo=o.CLineInfo;t.CPointInfo=o.CPointInfo;t.CRegionInfo=o.CRegionInfo;t.DynNoteLableType=o.DynNoteLableType;t.DynShowStyle=o.DynShowStyle;t.XClsType=o.XClsType;t.VectClsType=o.VectClsType;t.FeatureType=o.FeatureType;t.FontShape=o.FontShape;t.LabelLinType=o.LabelLinType;t.LabelRegType=o.LabelRegType;t.LabelPntType=o.LabelPntType;t.RepeatType=o.RepeatType;t.LabelSpreadType=o.LabelSpreadType;t.LineConstrain=o.LineConstrain;t.EightDirType=o.EightDirType;t.ISShowArc=o.ISShowArc;t.NetAnalyType=o.NetAnalyType;t.NetElemType=o.NetElemType;t.CLinAdjustType=o.CLinAdjustType;t.CLinHeadType=o.CLinHeadType;t.CLinJointType=o.CLinJointType;t.CLinStyleMakeType=o.CLinStyleMakeType;t.CItemType=o.CItemType;t.MapType=o.MapType;t.LayerStatusType=o.LayerStatusType;t.Feature=o.Feature;t.FeatureGeometry=o.FeatureGeometry;t.FeatureGraphicBase=o.FeatureGraphicBase;t.FeatureSet=o.FeatureSet;t.GLine=o.GLine;t.GPoint=o.GPoint;t.GRegion=o.GRegion;t.LabelLinInfo=o.LabelLinInfo;t.LabelRegInfo=o.LabelRegInfo;t.LablePntInfo=o.LablePntInfo;t.MultiPolygon=o.MultiPolygon;t.Point2D=o.Point2D;t.Polygon=o.Polygon;t.PolyLine=o.PolyLine;t.Rectangle=o.Rectangle;t.Tangram=o.Tangram;t.VectCls=o.VectCls;t.WebGraphicsInfo=o.WebGraphicsInfo;t.extend=o.extend;t.isArray=o.isArray;t.extendDeep=o.extendDeep;t.copy=o.copy;t.copyExcluce=o.copyExcluce;t.reset=o.reset;t.getElement=o.getElement;t.isElement=o.isElement;t.removeItem=o.removeItem;t.indexOf=o.indexOf;t.modifyDOMElement=o.modifyDOMElement;t.applyDefaults=o.applyDefaults;t.getParameterString=o.getParameterString;t.getWFParameterString=o.getWFParameterString;t.urlAppend=o.urlAppend;t.getParameters=o.getParameters;t.IS_GECKO=o.IS_GECKO;t.Browser=o.Browser;t.getBrowser=o.getBrowser;t.isSupportCanvas=o.isSupportCanvas;t.supportCanvas=o.supportCanvas;t.isInTheSameDomain=o.isInTheSameDomain;t.toJSON=o.toJSON;t.transformResult=o.transformResult;t.copyAttributes=o.copyAttributes;t.copyAttributesWithClip=o.copyAttributesWithClip;t.cloneObject=o.cloneObject;t.newGuid=o.newGuid;t.bind=o.bind;t.bindAsEventListener=o.bindAsEventListener;t.getTopAnalysisResult=o.getTopAnalysisResult;t.ChineseToUtf8=o.ChineseToUtf8;t.DeepMerge=o.DeepMerge;t.merge=o.merge;t.mixin=o.mixin;t.ContourNoteParam=s.ContourNoteParam;t.ContourParam=s.ContourParam;t.ContourZValue=s.ContourZValue;t.ContourRegionInfo=s.ContourRegionInfo;t.MeshingParam=s.MeshingParam;t.NetAnalyse=s.NetAnalyse;t.NetAnalysisExtent=s.NetAnalysisExtent;t.SlopLineParam=s.SlopLineParam;t.CommonServiceBase=l.CommonServiceBase;t.Events=l.Events;t.CORS=l.CORS;t.RequestTimeout=l.RequestTimeout;t.FetchRequest=l.FetchRequest;t.IgsServiceBase=l.IgsServiceBase;t.JSONFormat=l.JSONFormat;t.ColorInfo=u.ColorInfo;t.GDBInfo=u.GDBInfo;t.MapDoc=u.MapDoc;t.CatalogService=u.CatalogService;t.TileLayer=u.TileLayer;t.VectorLayer=u.VectorLayer;t.EditDocFeature=f.EditDocFeature;t.EditLayerFeature=f.EditLayerFeature;t.EditServiceBase=f.EditServiceBase;t.MultiGeoQuery=f.MultiGeoQuery;t.MultiGeoQueryParameter=f.MultiGeoQueryParameter;t.ObjClsQuery=f.ObjClsQuery;t.ObjClsQueryParameter=f.ObjClsQueryParameter;t.QueryByLayerParameter=f.QueryByLayerParameter;t.QueryDocFeature=f.QueryDocFeature;t.QueryFeatureRule=f.QueryFeatureRule;t.QueryFeatureStruct=f.QueryFeatureStruct;t.QueryLayerFeature=f.QueryLayerFeature;t.QueryParameter=f.QueryParameter;t.QueryParameterBase=f.QueryParameterBase;t.QueryServiceBase=f.QueryServiceBase;t.AnalysisBase=c.AnalysisBase;t.ClassBufferBase=c.ClassBufferBase;t.ClassBufferByMultiplyRing=c.ClassBufferByMultiplyRing;t.ClassBufferBySingleRing=c.ClassBufferBySingleRing;t.ClipBase=c.ClipBase;t.ClipByCircle=c.ClipByCircle;t.ClipByLayer=c.ClipByLayer;t.ClipByPolygon=c.ClipByPolygon;t.ContourAnalyse=c.ContourAnalyse;t.FeatureBuffBase=c.FeatureBuffBase;t.FeatureBuffByMultiplyRing=c.FeatureBuffByMultiplyRing;t.FeatureBuffBySingleRing=c.FeatureBuffBySingleRing;t.NetAnalysis=c.NetAnalysis;t.OverlayBase=c.OverlayBase;t.OverlayByLayer=c.OverlayByLayer;t.OverlayByPolygon=c.OverlayByPolygon;t.ProjectBase=c.ProjectBase;t.ProjectByLayer=c.ProjectByLayer;t.ProjectBySRID=c.ProjectBySRID;t.CalArea=h.CalArea;t.CalPolyLineLength=h.CalPolyLineLength;t.CalServiceBase=h.CalServiceBase;t.CProjectBySRSID=h.CProjectBySRSID;t.CProjectParam=h.CProjectParam;t.GeometryAnalysisBase=h.GeometryAnalysisBase;t.ProjectDots=h.ProjectDots;t.ProjectRang=h.ProjectRang;t.Smooth=h.Smooth;t.TopAnalysis=h.TopAnalysis;t.GetDocImageService=p.GetDocImageService;t.GetLayerImageService=p.GetLayerImageService;t.GetMapImageService=p.GetMapImageService;t.GetMapInfoService=p.GetMapInfoService;t.GetTileImageService=p.GetTileImageService;t.MapServiceBase=p.MapServiceBase;t.CAllOtherDataItemInfoSource=d.CAllOtherDataItemInfoSource;t.CAnnInfo=d.CAnnInfo;t.CChartLabelFormat=d.CChartLabelFormat;t.CChartTheme=d.CChartTheme;t.CChartThemeInfo=d.CChartThemeInfo;t.CChartThemeRepresentInfo=d.CChartThemeRepresentInfo;t.CChartType=d.CChartType;t.CDotDensityTheme=d.CDotDensityTheme;t.CFourColorTheme=d.CFourColorTheme;t.CGraduatedSymbolTheme=d.CGraduatedSymbolTheme;t.CLinInfo=d.CLinInfo;t.CMultiClassTheme=d.CMultiClassTheme;t.CPntInfo=d.CPntInfo;t.CRandomTheme=d.CRandomTheme;t.CRangeTheme=d.CRangeTheme;t.CRangeThemeInfo=d.CRangeThemeInfo;t.CRegInfo=d.CRegInfo;t.CSimpleTheme=d.CSimpleTheme;t.CTheme=d.CTheme;t.CThemeInfo=d.CThemeInfo;t.CUniqueTheme=d.CUniqueTheme;t.CUniqueThemeInfo=d.CUniqueThemeInfo;t.ExpInfo=d.ExpInfo;t.FolderInfo=d.FolderInfo;t.FolderInfoAttribute=d.FolderInfoAttribute;t.ItemValue=d.ItemValue;t.ThemeOper=d.ThemeOper;t.ThemesInfo=d.ThemesInfo;t.EchartsLayer=m.EchartsLayer;t.MapvLayer=m.MapvLayer;t.StreamLayer=m.StreamLayer},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MapExtend=undefined;var i=r(25);var n=a(i);function a(e){return e&&e.__esModule?e:{default:e}}var o=function(){n.default.Map.prototype.overlayLayersManager={};n.default.Map.prototype.addLayerBak=n.default.Map.prototype.addLayer;n.default.Map.prototype.addLayer=function(t,r){if(t.source||t.type==="custom"){this.addLayerBak(t,r);return this}if(this.overlayLayersManager[t.id]||this.style._layers[t.id]){this.fire("error",{error:new Error("A layer with this id already exists.")});return}e(t,this);this.overlayLayersManager[t.id]=t;return this};n.default.Map.prototype.getLayer=function(e){if(this.overlayLayersManager[e]){return this.overlayLayersManager[e]}return this.style.getLayer(e)};n.default.Map.prototype.moveLayer=function(e,t){if(this.overlayLayersManager[e]){i(e,t);return this}if(this.style._layers[e]){this.style.moveLayer(e,t);this._update(true);return this}};n.default.Map.prototype.removeLayer=function(e){if(this.overlayLayersManager[e]){t(this.overlayLayersManager[e]);delete this.overlayLayersManager[e];return this}this.style.removeLayer(e);this._update(true);return this};n.default.Map.prototype.setLayoutProperty=function(e,t,i){if(this.overlayLayersManager[e]){if(t==="visibility"){if(i==="visible"){i=true}else{i=false}r(this.overlayLayersManager[e],i);this.style.fire("data",{dataType:"style"})}return this}this.style.setLayoutProperty(e,t,i);this._update(true);return this};n.default.Map.prototype.updateTransform=function(e,t,r,i,a,o,s){this.transform.units=e;this.transform.latRange=[this._tileExtent[1],this._tileExtent[3]];this.transform.lngRange=[this._tileExtent[0],this._tileExtent[2]];var l=this.mercatorZfromAltitude;n.default.MercatorCoordinate.fromLngLat=function(e,i){i=i||0;var a=n.default.LngLat.convert(e);return new n.default.MercatorCoordinate((a.lng-t)/o,(r-a.lat)/s,l(i,a.lat))};n.default.MercatorCoordinate.prototype.toLngLat=function(){return new n.default.LngLat(this.x*o+t,r-this.y*s)};this.customConvertPoint=window.URL.createObjectURL(new Blob(["customConvertPoint = {projectX:function(x){return (x - "+i+") / "+o+" + 0.5},projectY:function(y){y = 0.5 - ((y - "+a+") / "+s+");return y < 0 ? 0 : y > 1 ? 1 : y;},toY:function(y){return (0.5-y)*"+s+"+"+a+";}}"],{type:"text/javascript"}))};function e(e,t){e.onAdd(t)}function t(e){e.removeFromMap()}function r(e,t){e.setVisibility(t)}function i(e,t){var r=document.getElementById(e);if(t){var i=document.getElementById(t);if(!i){n.default.Evented.prototype.fire("error",{error:new Error('Layer with id "'+t+'" does not exist on this document.')})}}if(r&&i){i.parentNode.insertBefore(r,i)}else{r.parentNode.appendChild(r)}}}();var s=t.MapExtend=function e(){return new o}},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(1,eval)("this")}catch(e){if(typeof window==="object")r=window}e.exports=r},function(e,t){var r=e.exports={};var i;var n;function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){i=setTimeout}else{i=a}}catch(e){i=a}try{if(typeof clearTimeout==="function"){n=clearTimeout}else{n=o}}catch(e){n=o}})();function s(e){if(i===setTimeout){return setTimeout(e,0)}if((i===a||!i)&&setTimeout){i=setTimeout;return setTimeout(e,0)}try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}function l(e){if(n===clearTimeout){return clearTimeout(e)}if((n===o||!n)&&clearTimeout){n=clearTimeout;return clearTimeout(e)}try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}var u=[];var f=false;var c;var h=-1;function p(){if(!f||!c){return}f=false;if(c.length){u=c.concat(u)}else{h=-1}if(u.length){d()}}function d(){if(f){return}var e=s(p);f=true;var t=u.length;while(t){c=u;u=[];while(++h<t){if(c){c[h].run()}}h=-1;t=u.length}c=null;f=false;l(e)}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}u.push(new v(e,t));if(u.length===1&&!f){s(d)}};function v(e,t){this.fun=e;this.array=t}v.prototype.run=function(){this.fun.apply(null,this.array)};r.title="browser";r.browser=true;r.env={};r.argv=[];r.version="";r.versions={};function y(){}r.on=y;r.addListener=y;r.once=y;r.off=y;r.removeListener=y;r.removeAllListeners=y;r.emit=y;r.prependListener=y;r.prependOnceListener=y;r.listeners=function(e){return[]};r.binding=function(e){throw new Error("process.binding is not supported")};r.cwd=function(){return"/"};r.chdir=function(e){throw new Error("process.chdir is not supported")};r.umask=function(){return 0}},function(e,t,r){e.exports={default:r(226),__esModule:true}},function(e,t,r){r(227);e.exports=r(8).Object.preventExtensions},function(e,t,r){var i=r(11);var n=r(52).onFreeze;r(24)("preventExtensions",function(e){return function t(r){return e&&i(r)?e(n(r)):r}})},function(e,t,r){e.exports={default:r(229),__esModule:true}},function(e,t,r){r(230);e.exports=r(8).Object.seal},function(e,t,r){var i=r(11);var n=r(52).onFreeze;r(24)("seal",function(e){return function t(r){return e&&i(r)?e(n(r)):r}})},function(e,t,r){r(232);var i=r(8).Object;e.exports=function e(t,r,n){return i.defineProperty(t,r,n)}},function(e,t,r){var i=r(17);i(i.S+i.F*!r(26),"Object",{defineProperty:r(30).f})},function(e,t,r){e.exports={default:r(234),__esModule:true}},function(e,t,r){r(235);e.exports=r(8).Object.isExtensible},function(e,t,r){var i=r(11);r(24)("isExtensible",function(e){return function t(r){return i(r)?e?e(r):true:false}})},function(e,t,r){e.exports={default:r(237),__esModule:true}},function(e,t,r){r(238);e.exports=r(8).Object.isFrozen},function(e,t,r){var i=r(11);r(24)("isFrozen",function(e){return function t(r){return i(r)?e?e(r):false:true}})},function(e,t,r){e.exports={default:r(240),__esModule:true}},function(e,t,r){r(241);e.exports=r(8).Object.isSealed},function(e,t,r){var i=r(11);r(24)("isSealed",function(e){return function t(r){return i(r)?e?e(r):false:true}})},function(e,t,r){e.exports={default:r(243),__esModule:true}},function(e,t,r){r(244);var i=r(8).Object;e.exports=function e(t,r){return i.defineProperties(t,r)}},function(e,t,r){var i=r(17);i(i.S+i.F*!r(26),"Object",{defineProperties:r(122)})},function(e,t,r){var i=r(46);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return i(e)=="String"?e.split(""):Object(e)}},function(e,t,r){var i=r(36);var n=r(124);var a=r(247);e.exports=function(e){return function(t,r,o){var s=i(t);var l=n(s.length);var u=a(o,l);var f;if(e&&r!=r)while(l>u){f=s[u++];if(f!=f)return true}else for(;l>u;u++)if(e||u in s){if(s[u]===r)return e||u||0}return!e&&-1}}},function(e,t,r){var i=r(77);var n=Math.max;var a=Math.min;e.exports=function(e,t){e=i(e);return e<0?n(e+t,0):a(e,t)}},function(e,t,r){e.exports={default:r(249),__esModule:true}},function(e,t,r){r(250);e.exports=9007199254740991},function(e,t,r){var i=r(17);i(i.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,r){e.exports={default:r(252),__esModule:true}},function(e,t,r){r(253);e.exports=r(8).Object.freeze},function(e,t,r){var i=r(11);var n=r(52).onFreeze;r(24)("freeze",function(e){return function t(r){return e&&i(r)?e(n(r)):r}})},function(e,t,r){r(255);e.exports=r(8).Object.getPrototypeOf},function(e,t,r){var i=r(58);var n=r(125);r(24)("getPrototypeOf",function(){return function e(t){return n(i(t))}})},function(e,t,r){r(257);var i=r(8).Object;e.exports=function e(t,r){return i.getOwnPropertyDescriptor(t,r)}},function(e,t,r){var i=r(36);var n=r(82).f;r(24)("getOwnPropertyDescriptor",function(){return function e(t,r){return n(i(t),r)}})},function(e,t,r){r(259);var i=r(8).Object;e.exports=function e(t){return i.getOwnPropertyNames(t)}},function(e,t,r){r(24)("getOwnPropertyNames",function(){return r(126).f})},function(e,t,r){r(261);e.exports=r(8).Object.keys},function(e,t,r){var i=r(58);var n=r(57);r(24)("keys",function(){return function e(t){return n(i(t))}})},function(e,t,r){var i=r(8);var n=i.JSON||(i.JSON={stringify:JSON.stringify});e.exports=function e(t){return n.stringify.apply(n,arguments)}},function(e,t,r){r(264);var i=r(8).Object;e.exports=function e(t,r){return i.create(t,r)}},function(e,t,r){var i=r(17);i(i.S,"Object",{create:r(86)})},function(e,t,r){e.exports={default:r(266),__esModule:true}},function(e,t,r){r(87);r(88);e.exports=r(89).f("iterator")},function(e,t,r){var i=r(77);var n=r(76);e.exports=function(e){return function(t,r){var a=String(n(t));var o=i(r);var s=a.length;var l,u;if(o<0||o>=s)return e?"":undefined;l=a.charCodeAt(o);return l<55296||l>56319||o+1===s||(u=a.charCodeAt(o+1))<56320||u>57343?e?a.charAt(o):l:e?a.slice(o,o+2):(l-55296<<10)+(u-56320)+65536}}},function(e,t,r){"use strict";var i=r(86);var n=r(55);var a=r(59);var o={};r(35)(o,r(14)("iterator"),function(){return this});e.exports=function(e,t,r){e.prototype=i(o,{next:n(1,r)});a(e,t+" Iterator")}},function(e,t,r){"use strict";var i=r(270);var n=r(271);var a=r(48);var o=r(36);e.exports=r(130)(Array,"Array",function(e,t){this._t=o(e);this._i=0;this._k=t},function(){var e=this._t;var t=this._k;var r=this._i++;if(!e||r>=e.length){this._t=undefined;return n(1)}if(t=="keys")return n(0,r);if(t=="values")return n(0,e[r]);return n(0,[r,e[r]])},"values");a.Arguments=a.Array;i("keys");i("values");i("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){e.exports={default:r(273),__esModule:true}},function(e,t,r){r(132);r(134);r(276);r(277);e.exports=r(8).Symbol},function(e,t,r){var i=r(57);var n=r(133);var a=r(83);e.exports=function(e){var t=i(e);var r=n.f;if(r){var o=r(e);var s=a.f;var l=0;var u;while(o.length>l)if(s.call(e,u=o[l++]))t.push(u)}return t}},function(e,t,r){var i=r(46);e.exports=Array.isArray||function e(t){return i(t)=="Array"}},function(e,t,r){r(90)("asyncIterator")},function(e,t,r){r(90)("observable")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TDTLayer=t.ArcGISLayer=t.MapVectorLayer=t.MapWMTSLayer=t.MapWmsLayer=t.MapTileLayer=t.MapDocLayer=t.mapboxgl=undefined;var i=r(31);var n=r(279);var a=r(282);var o=r(283);var s=r(284);var l=r(285);var u=r(286);var f=r(287);t.mapboxgl=i.mapboxgl;t.MapDocLayer=n.MapDocLayer;t.MapTileLayer=a.MapTileLayer;t.MapWmsLayer=o.MapWmsLayer;t.MapWMTSLayer=s.MapWMTSLayer;t.MapVectorLayer=l.MapVectorLayer;t.ArcGISLayer=u.ArcGISLayer;t.TDTLayer=f.TDTLayer},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MapDocLayer=undefined;var i=r(9);var n=s(i);var a=r(31);var o=r(6);function s(e){return e&&e.__esModule?e:{default:e}}var l=function e(t,r){var r=r?r:{};var i=r&&r.domain?r.domain:"";if(i===""){this.networkProtocol=r.networkProtocol!==undefined?r.networkProtocol:location.protocol.split(":")[0]||"http";var n=r&&r.ip?r.ip:"localhost";var a=r&&r.port?r.port:"6163";this.url=this._url=encodeURI(this.networkProtocol+"://"+n+":"+a+"/igs/rest/mrms/docs/"+t)}else{this.url=this._url=encodeURI(i+"/igs/rest/mrms/docs/"+t)}this.options={layers:null,filters:null,style:null,f:null,proj:null,guid:null,keepCache:true,attribution:"Zondy Map doc Data"};this.layerID=null;this.sourceID=null;this.map=null;(0,o.extend)(this.options,r)};l.prototype.addToMap=function(e){this.map=e;this._initLayerUrl();var t=this.sourceID||"source_"+(0,o.newGuid)();var r=this.layerID||"layer_"+(0,o.newGuid)();this.map_source={type:"raster",tiles:[this._layerUrl],tileSize:this.options.tileSize||512};this.mLayer={id:r,type:"raster",source:t};if(this.map.style){if(this.map.getSource(t)===undefined){this.map.addSource(t,this.map_source);this.sourceID=t}if(this.map.getLayer(r)===undefined){this.map.addLayer(this.mLayer);this.layerID=r}return this}else{this.map.setStyle({version:8,sources:{},layers:[]});var i=this;i.map.on("load",function(){i.map.addSource(t,i.map_source);i.sourceID=t;i.map.addLayer(i.mLayer);i.layerID=r;return i})}};l.prototype._initLayerUrl=function(){var e=this;var t=e.url+"?";t+=encodeURI(e._initAllRequestParams().join("&"));t+="&bbox={bbox}";this._layerUrl=t};l.prototype._initAllRequestParams=function(){var e=this,t=e.options||{},r=[];var i=t.f||"png";r.push("f="+i);var a=this.options.tileSize||512;var s,l;if(typeof a==="number"){s=l=a}else{r.push("w="+a.x||512);r.push("h="+a.y||512)}r.push("w="+s);r.push("h="+l);if(t.layers){r.push("layers="+t.layers)}if(t.filters){r.push("filters="+t.filters)}if(t.style){r.push("style="+(0,n.default)(t.style))}var u=t.guid||(0,o.newGuid)();r.push("guid="+u);if(t.proj){r.push("proj="+t.proj)}if(t.cache!==undefined&&t.isAntialiasing!==null){r.push("cache="+t.cache)}if(t.update!==undefined&&t.isAntialiasing!==null){r.push("update="+t.update)}if(t.mode){r.push("mode="+t.mode)}if(t.isAntialiasing!==undefined&&t.isAntialiasing!==null){r.push("isAntialiasing="+t.isAntialiasing)}return r};l.prototype.refreshMap=function(e){if(e){this.options.guid=e}this._initLayerUrl();this.map.removeLayer(this.layerID);this.map.removeSource(this.sourceID);this.map_source["tiles"]=[this._layerUrl];this.map.addSource(this.sourceID,this.map_source);this.map.addLayer(this.mLayer)};t.MapDocLayer=l;a.Zondy.Map.MapDocLayer=l},function(e,t,r){e.exports={default:r(281),__esModule:true}},function(e,t,r){r(132);e.exports=r(8).Object.getOwnPropertySymbols},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MapTileLayer=undefined;var i=r(31);var n=r(6);var a=function e(t,r){var r=r?r:{};var i=r&&r.domain?r.domain:"";if(i===""){this.networkProtocol=r.networkProtocol!==undefined?r.networkProtocol:location.protocol.split(":")[0]||"http";var a=r&&r.ip?r.ip:"localhost";var o=r&&r.port?r.port:"6163";this.url=this._url=encodeURI(this.networkProtocol+"://"+a+":"+o+"/igs/rest/mrms/tile/"+t)}else{this.url=this._url=encodeURI(i+"/igs/rest/mrms/tile/"+t)}this.options={tileExtent:[-180,-90,180,90],zoomOffset:0,yAxis:"down",origin:[-180,90],tileSize:512,attribution:"Zondy Map Tile Data"};this.map=null;(0,n.extend)(this.options,r)};a.prototype.addToMap=function(e){this.map=e;this._initLayerUrl();var t=this.options.zoomOffset;mapboxgl.CanonicalTileID.prototype.url=function(e,r){var i=this.getTileBBox();if(t>this.z){t=0}var n=o(this.z-t,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z-t)).replace("{x}",String(this.x)).replace("{y}",String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",n).replace("{bbox-epsg-3857}",i)};var r=this.sourceID||"source_"+(0,n.newGuid)();var i=this.layerID||"layer_"+(0,n.newGuid)();var a={type:"raster",tiles:[this._layerUrl],tileSize:this.options.tileSize||512};var s={id:i,type:"raster",source:r};if(this.map.getStyle()){if(this.map.getSource(r)===undefined){this.map.addSource(r,a);this.sourceID=r}if(this.map.getLayer(i)===undefined){this.map.addLayer(s);this.layerID=i}return this}else{this.map.setStyle({version:8,sources:{},layers:[]});var l=this;l.map.on("load",function(){l.map.addSource(r,a);l.sourceID=r;l.map.addLayer(s);l.layerID=i;return l})}};a.prototype._initLayerUrl=function(){var e=this;var t=e.url+"/{z}/{y}/{x}";this._layerUrl=t};function o(e,t,r){var i="",n=void 0;for(var a=e;a>0;a--){n=1<<a-1;i+=(t&n?1:0)+(r&n?2:0)}return i}t.MapTileLayer=a;i.Zondy.Map.MapTileLayer=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MapWmsLayer=undefined;var i=r(9);var n=s(i);var a=r(31);var o=r(6);function s(e){return e&&e.__esModule?e:{default:e}}var l=function e(t){var t=t?t:{};var r=t&&t.domain?t.domain:"";if(r===""){this.networkProtocol=t.networkProtocol!==undefined?t.networkProtocol:location.protocol.split(":")[0]||"http";var i=t&&t.ip?t.ip:"localhost";var n=t&&t.port?t.port:"6163";this.url=this._url=encodeURI(this.networkProtocol+"://"+i+":"+n+"/igs/rest/ogc/"+t.serverType+"/"+t.serverName+"/WMSServer")}else{this.url=this._url=encodeURI(r+"/igs/rest/ogc/"+t.serverType+"/"+t.serverName+"/WMSServer")}this.options={layers:null,styles:null,format:"image/png",service:"WMS",version:"1.1.1",request:"GetMap",width:"256",height:"256",srs:"EPSG:4326",crs:"EPSG:4326",guid:null,keepCache:true,attribution:"Zondy WMS Data"};this.layerID=null;this.sourceID=null;this.map=null;(0,o.extend)(this.options,t)};l.prototype.addToMap=function(e){this.map=e;this._initLayerUrl();var t=this.sourceID||"source_"+(0,o.newGuid)();var r=this.layerID||"layer_"+(0,o.newGuid)();this.wms_source={type:"raster",tiles:[this._layerUrl],tileSize:this.options.tileSize||512};this.mLayer={id:r,type:"raster",source:t};if(this.map.getStyle()){if(this.map.getSource(t)===undefined){this.map.addSource(t,this.wms_source);this.sourceID=t}if(this.map.getLayer(r)===undefined){this.map.addLayer(this.mLayer);this.layerID=r}return this}else{this.map.setStyle({version:8,sources:{},layers:[]});var i=this;i.map.on("load",function(){i.map.addSource(t,i.wms_source);i.sourceID=t;i.map.addLayer(i.mLayer);i.layerID=r;return i})}};l.prototype._initLayerUrl=function(){var e=this;var t=e.url+"?";t+=encodeURI(e._initAllRequestParams().join("&"));t+="&bbox={bbox}";this._layerUrl=t};l.prototype._initAllRequestParams=function(){var e=this,t=e.options||{},r=[];if(t.version){r.push("version="+t.version)}if(t.request){r.push("request="+t.request)}if(t.version==="1.1.1"){r.push("srs="+t.srs)}else if(t.version==="1.3.0"){r.push("crs="+t.crs)}if(t.service){r.push("service="+t.service)}if(t.layers){r.push("layers="+t.layers)}if(t.filters){r.push("filters="+t.filters)}if(t.styles){r.push("styles="+(0,n.default)(t.styles))}else{r.push("styles=")}if(t.format){r.push("format="+t.format)}else{r.push("format=image/png")}r.push("width="+t.width);r.push("height="+t.height);if(t.guid){r.push("guid="+t.guid)}if(!t.keepCache){r.push("temp="+Math.random())}return r};l.prototype.refreshMap=function(e){if(e){this.options.guid=e}this._initLayerUrl();this.map.removeLayer(this.layerID);this.map.removeSource(this.sourceID);this.wms_source["tiles"]=[this._layerUrl];this.map.addSource(this.sourceID,this.wms_source);this.map.addLayer(this.mLayer)};t.MapWmsLayer=l;a.Zondy.Map.MapWmsLayer=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MapWMTSLayer=undefined;var i=r(9);var n=s(i);var a=r(31);var o=r(6);function s(e){return e&&e.__esModule?e:{default:e}}var l=function e(t){var t=t?t:{};var r=t&&t.domain?t.domain:"";if(r===""){this.networkProtocol=t.networkProtocol!==undefined?t.networkProtocol:location.protocol.split(":")[0]||"http";var i=t&&t.ip?t.ip:"localhost";var n=t&&t.port?t.port:"6163";this.url=this._url=encodeURI(this.networkProtocol+"://"+i+":"+n+"/igs/rest/ogc/WMTSServer")}else{this.url=this._url=encodeURI(r+"/igs/rest/ogc/WMTSServer")}this.options={layer:"",style:null,format:"image/png",service:"WMTS",version:"1.0.0",request:"GetTile",tileMatrixSet:null,tileMatrix:"{z}",tileRow:"{y}",tileCol:"{x}",guid:null,keepCache:true,attribution:"Zondy WMTS Data"};this.layerID=null;this.sourceID=null;this.map=null;(0,o.extend)(this.options,t)};l.prototype.addToMap=function(e){this.map=e;this._initLayerUrl();this.map.crs=this.options.crs;var t=this.sourceID||"source_"+(0,o.newGuid)();var r=this.layerID||"layer_"+(0,o.newGuid)();this.wmts_source={type:"raster",tiles:[this._layerUrl]};this.mLayer={id:r,type:"raster",source:t};if(this.map.getStyle()){if(this.map.getSource(t)===undefined){this.map.addSource(t,this.wmts_source);this.sourceID=t}if(this.map.getLayer(r)===undefined){this.map.addLayer(this.mLayer);this.layerID=r}return this}else{this.map.setStyle({version:8,sources:{},layers:[]});var i=this;i.map.on("load",function(){i.map.addSource(t,i.wmts_source);i.sourceID=t;i.map.addLayer(i.mLayer);i.layerID=r;return i})}};l.prototype._initLayerUrl=function(){var e=this;var t=e.url+"?";t+=e._initAllRequestParams().join("&");this._layerUrl=t};l.prototype._initAllRequestParams=function(){var e=this,t=e.options||{},r=[];if(t.version){r.push("version="+t.version)}if(t.request){r.push("request="+t.request)}if(t.service){r.push("service="+t.service)}if(t.layer){r.push("layer="+t.layer)}if(t.style){r.push("style="+(0,n.default)(t.style))}else{r.push("style=")}if(t.format){r.push("format="+t.format)}else{r.push("format=image/png")}if(t.tileMatrixSet){r.push("tileMatrixSet="+t.tileMatrixSet)}if(t.tileMatrix){r.push("tileMatrix="+t.tileMatrix)}if(t.tileRow){r.push("tileRow="+t.tileRow)}if(t.tileCol){r.push("tileCol="+t.tileCol)}if(t.guid){r.push("guid="+t.guid)}if(!t.keepCache){r.push("temp="+Math.random())}return r};l.prototype.refreshMap=function(e){if(e){this.options.guid=e}this._initLayerUrl();this.map.removeLayer(this.layerID);this.map.removeSource(this.sourceID);this.wmts_source["tiles"]=[this._layerUrl];this.map.addSource(this.sourceID,this.wmts_source);this.map.addLayer(this.mLayer)};t.MapWMTSLayer=l;a.Zondy.Map.MapWMTSLayer=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MapVectorLayer=undefined;var i=r(9);var n=s(i);var a=r(31);var o=r(6);function s(e){return e&&e.__esModule?e:{default:e}}var l=function e(t,r){var r=r?r:{};var i=r&&r.domain?r.domain:"";if(i===""){this.networkProtocol=r.networkProtocol!==undefined?r.networkProtocol:location.protocol.split(":")[0]||"http";var n=r&&r.ip?r.ip:"localhost";var a=r&&r.port?r.port:"6163";this.url=this._url=encodeURI(this.networkProtocol+"://"+n+":"+a+"/igs/rest/mrms/layers")}else{this.url=this._url=encodeURI(i+"/igs/rest/mrms/layers")}this.options={gdbps:t,filters:null,style:null,f:null,guid:null,keepCache:true,attribution:"Zondy Map vector Data"};this.layerID=null;this.sourceID=null;this.map=null;(0,o.extend)(this.options,r)};l.prototype.addToMap=function(e){this.map=e;this._initLayerUrl();var t=this.sourceID||"source_"+(0,o.newGuid)();var r=this.layerID||"layer_"+(0,o.newGuid)();this.vector_source={type:"raster",tiles:[this._layerUrl],tileSize:this.options.tileSize||512};this.mLayer={id:r,type:"raster",source:t};if(this.map.getStyle()){if(this.map.getSource(t)===undefined){this.map.addSource(t,this.vector_source);this.sourceID=t}if(this.map.getLayer(r)===undefined){this.map.addLayer(this.mLayer);this.layerID=r}return this}else{this.map.setStyle({version:8,sources:{},layers:[]});var i=this;i.map.on("load",function(){i.map.addSource(t,i.vector_source);i.sourceID=t;i.map.addLayer(i.mLayer);i.layerID=r;return i})}};l.prototype._initLayerUrl=function(){var e=this;var t=e.url+"?";t+=encodeURI(e._initAllRequestParams().join("&"));t+="&bbox={bbox}";this._layerUrl=t};l.prototype._initAllRequestParams=function(){var e=this,t=e.options||{},r=[];var i=this.options.tileSize||512;r.push("width="+i);r.push("height="+i);if(t.gdbps){r.push("gdbps="+t.gdbps)}if(t.filters){r.push("filters="+t.filters)}if(t.style){r.push("style="+(0,n.default)(t.style))}if(t.f){r.push("f="+t.style)}else{r.push("f=png")}if(t.guid){r.push("guid="+t.guid)}if(!t.keepCache){r.push("temp="+Math.random())}return r};l.prototype.refreshMap=function(e){if(e){this.options.guid=e}this._initLayerUrl();this.map.removeLayer(this.layerID);this.map.removeSource(this.sourceID);this.vector_source["tiles"]=[this._layerUrl];this.map.addSource(this.sourceID,this.vector_source);this.map.addLayer(this.mLayer)};t.MapVectorLayer=l;a.Zondy.Map.MapVectorLayer=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ArcGISLayer=undefined;var i=r(31);var n=r(6);var a=function e(t){this.options={layerType:"NGS_Topo_US_2D",url:"http://services.arcgisonline.com/ArcGIS/rest/services/{layerType}/MapServer/tile/{z}/{y}/{x}.jpg",tileSize:256,f:"image",format:"png",dpi:96,transparent:true,attribution:"ArcGIS"};this.layerID=null;this.sourceID=null;this.map=null;(0,n.extend)(this.options,t)};a.prototype.addToMap=function(e){this.map=e;this._initLayerUrl();var t=this.sourceID||"source_"+(0,n.newGuid)();var r=this.layerID||"layer_"+(0,n.newGuid)();this.map_source={type:"raster",tiles:[this._layerUrl],tileSize:this.options.tileSize||512};this.mLayer={id:r,type:"raster",source:t};if(this.map.style){if(this.map.getSource(t)===undefined){this.map.addSource(t,this.map_source);this.sourceID=t}if(this.map.getLayer(r)===undefined){this.map.addLayer(this.mLayer);this.layerID=r}return this}else{this.map.setStyle({version:8,sources:{},layers:[]});var i=this;i.map.on("load",function(){i.map.addSource(t,i.map_source);i.sourceID=t;i.map.addLayer(i.mLayer);i.layerID=r;return i})}};a.prototype._initLayerUrl=function(){this._url=this.options.url;if(this.options.layerType&&this._url.indexOf("{layerType}/MapServer/tile/{z}/{y}/{x}")>0){this._url=this.options.url.replace("{layerType}",this.options.layerType)}else{this._crs=this.options.crs||this.map.options.crs}this._layerUrl=this._url};a.prototype.refreshMap=function(e){if(e){this.options.guid=e}this._initLayerUrl();this.map.removeLayer(this.layerID);this.map.removeSource(this.sourceID);this.map_source["tiles"]=[this._layerUrl];this.map.addSource(this.sourceID,this.map_source);this.map.addLayer(this.mLayer)};t.ArcGISLayer=a;i.Zondy.Map.ArcGISLayer=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TDTLayer=undefined;var i=r(31);var n=r(6);var a=function e(t){this.layerLabelMap={vec:"cva",ter:"cta",img:"cia"};this.layerZoomMap={vec:18,ter:14,img:18};this.options={layerType:"vec",isLabel:false,url:"http://t"+Math.round(Math.random()*7)+".tianditu.gov.cn/{layer}_{proj}/wmts?",zoomOffset:1,dpi:96,style:"default",format:"tiles",subdomains:[0,1,2,3,4,5,6,7],version:"1.0.0",tilematrixSet:"",tileSize:256,matrixIds:null,layer:"",attribution:"天地图"};this.layerID=null;this.sourceID=null;this.map=null;this.initialize(t);(0,n.extend)(this.options,t)};a.prototype.initialize=function(e){e=e||{};if(this.options.baseURL){var t=this.options.baseURL.split("gov.cn/")[1];if(this.options.baseURL.indexOf("?")>0){t=t.split("?")[0]}this.options.layerType=t.substring(0,t.length-7)}this.options.layer=this.options.isLabel&&this.layerLabelMap[this.options.layerType]?this.layerLabelMap[this.options.layerType]:this.options.layerType;if(this.options.layerType==="ter"){this.options.maxZoom=14}else{this.options.maxZoom=18}this._url=this.options.url;this.options.ip=this.options.ip?this.options.ip:"localhost";this.options.port=this.options.port?this.options.port:"6163"};a.prototype.addToMap=function(e){this.map=e;this._initLayerUrl();var t=this.sourceID||"source_"+(0,n.newGuid)();var r=this.layerID||"layer_"+(0,n.newGuid)();this.map_source={type:"raster",tiles:[this._layerUrl],tileSize:this.options.tileSize||512};this.mLayer={id:r,type:"raster",source:t};if(this.map.style){if(this.map.getSource(t)===undefined){this.map.addSource(t,this.map_source);this.sourceID=t}if(this.map.getLayer(r)===undefined){this.map.addLayer(this.mLayer);this.layerID=r}return this}else{this.map.setStyle({version:8,sources:{},layers:[]});var i=this;i.map.on("load",function(){i.map.addSource(t,i.map_source);i.sourceID=t;i.map.addLayer(i.mLayer);i.layerID=r;return i})}};a.prototype._initLayerUrl=function(){this._crs=this.options.crs||map.crs.epsgCode;this.options.tilematrixSet=this._crs==="EPSG:4326"?"c":"w";var e=[];if(this.options.layerType.indexOf("igs")>0){var t="http://{ip}:{port}/igs/rest/cts/tianditu/{layerType}/{x}/{y}/{z}?";var r=this.options&&this.options.domain?this.options.domain:"";if(r===""){this.networkProtocol=this.options.networkProtocol!==undefined?this.options.networkProtocol:location.protocol.split(":")[0]||"http";t=this.networkProtocol+"://"+this.options.ip+":"+this.options.port+"/igs/rest/cts/tianditu/{layerType}/{x}/{y}/{z}?"}else{t=r+"/igs/rest/cts/tianditu/{layerType}/{x}/{y}/{z}?"}var i;switch(this.options.layerType){case"vec_igs":i="vector";break;case"img_igs":i="raster";break;case"cva_igs":i="vectorAnno";break;case"cia_igs":i="rasterAnno";break;default:i="vector";break}this._url=t.replace("{layerType}",i)}else if(this.options.baseURL){this._url=this.options.baseURL;if(this.options.baseURL.indexOf("?")<0){this._url+="?"}}else{this._url=this._url.replace("{layer}",this.options.layer).replace("{proj}",this.options.tilematrixSet)}if(this.options.layerType.indexOf("igs")<0){e.push("request=GetTile");if(this.options.version){e.push("version="+this.options.version)}if(this.options.style){e.push("style="+this.options.style)}if(this.options.tilematrixSet){e.push("tilematrixSet="+this.options.tilematrixSet)}if(this.options.format){e.push("format="+this.options.format)}if(this.options.tileSize){e.push("width="+this.options.tileSize);e.push("height="+this.options.tileSize)}if(this.options.layer){e.push("layer="+this.options.layer)}e.push("tilematrix={z}");e.push("tilerow={y}");e.push("tilecol={x}")}if(this.options.token){e.push("tk="+this.options.token)}e.push("service=WMTS");this._url+=e.join("&");this._layerUrl=this._url};a.prototype.refreshMap=function(e){if(e){this.options.guid=e}this._initLayerUrl();this.map.removeLayer(this.layerID);this.map.removeSource(this.sourceID);this.map_source["tiles"]=[this._layerUrl];this.map.addSource(this.sourceID,this.map_source);this.map.addLayer(this.mLayer)};t.TDTLayer=a;i.Zondy.Map.TDTLayer=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Arc=undefined;var i=r(0);var n=r(6);var a=function e(t,r){this.ArcID=0;var i=r!==undefined?r:{};(0,n.extend)(this,i);this.Dots=t!==undefined&&t!==null?t:null};t.Arc=a;i.Zondy.Object.Arc=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CAttDataRow=undefined;var i=r(0);var n=r(6);var a=function e(t,r,i){var a=i!==undefined?i:{};(0,n.extend)(this,a);this.FID=r!==undefined?r:0;this.Values=t!==undefined?t:null};t.CAttDataRow=a;i.Zondy.Object.CAttDataRow=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CDisplayStyle=undefined;var i=r(0);var n=r(6);var a=r(136);var o=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.AnnSizeFixed=r.AnnSizeFixed!==undefined?r.AnnSizeFixed:false;this.DriverQuality=r.DriverQuality!==undefined?r.DriverQuality:0;this.DynProjFlag=r.DynProjFlag!==undefined?r.DynProjFlag:false;this.FollowScale=r.FollowScale!==undefined?r.FollowScale:false;this.LinPenWidFixed=r.LinPenWidFixed!==undefined?r.LinPenWidFixed:false;this.LinSizeFixed=r.LinSizeFixed!==undefined?r.LinSizeFixed:false;this.PntPenWidFixed=r.PntPenWidFixed!==undefined?r.PntPenWidFixed:false;this.PntSizeFixed=r.PntSizeFixed!==undefined?r.PntSizeFixed:false;this.RegPenWidFixed=r.RegPenWidFixed!==undefined?r.RegPenWidFixed:false;this.RegSizeFixed=r.RegSizeFixed!==undefined?r.RegSizeFixed:false;this.ShowCoordPnt=r.ShowCoordPnt!==undefined?r.ShowCoordPnt:false;this.ShowElemRect=r.ShowElemRect!==undefined?r.ShowElemRect:false;this.ShowStyle=r.ShowStyle!==undefined?r.ShowStyle:null;this.SymbleShow=r.SymbleShow!==undefined?r.SymbleShow:false};t.CDisplayStyle=o;i.Zondy.Object.CDisplayStyle=o},function(e,t,r){"use strict";t.__esModule=true;var i=r(56);var n=a(i);function a(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,r){if(t in e){(0,n.default)(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Circle=undefined;var i=r(2);var n=y(i);var a=r(1);var o=y(a);var s=r(5);var l=y(s);var u=r(3);var f=y(u);var c=r(4);var h=y(c);var p=r(0);var d=r(37);var v=r(19);function y(e){return e&&e.__esModule?e:{default:e}}var m=function(e){(0,h.default)(t,e);function t(e,r,i){(0,o.default)(this,t);var a=i?i:{};var s=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,a));s.point=e!==undefined&&e!==null?e:null;s.radious=r!==undefined&&r!==null?r:null;return s}(0,l.default)(t,[{key:"setByOL",value:function e(t){if(t!==undefined&&t!==null){var r=t.getCenter();var i=t.getRadius();this.point=new p.Zondy.Object.Point2D(r[0],r[1]);this.radious=i}}},{key:"toString",value:function e(){if(this.point===null||this.point.length===0||this.radious===null){return""}return this.point.x+","+this.point.y+","+this.radious}},{key:"getGeometryType",value:function e(){return"Circle"}}]);return t}(d.Tangram);t.Circle=m;p.Zondy.Object.Circle=m},function(e,t,r){e.exports={default:r(294),__esModule:true}},function(e,t,r){r(295);e.exports=r(8).Object.setPrototypeOf},function(e,t,r){var i=r(17);i(i.S,"Object",{setPrototypeOf:r(296).set})},function(e,t,r){var i=r(11);var n=r(23);var a=function(e,t){n(e);if(!i(t)&&t!==null)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,i){try{i=r(45)(Function.call,r(82).f(Object.prototype,"__proto__").set,2);i(e,[]);t=!(e instanceof Array)}catch(e){t=true}return function e(r,n){a(r,n);if(t)r.__proto__=n;else i(r,n);return r}}({},false):undefined),check:a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MultiPolygon=undefined;var i=r(2);var n=y(i);var a=r(1);var o=y(a);var s=r(5);var l=y(s);var u=r(3);var f=y(u);var c=r(4);var h=y(c);var p=r(37);var d=r(19);var v=r(147);function y(e){return e&&e.__esModule?e:{default:e}}var m=function(e){(0,h.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=r?r:{};var a=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,i));a.polygonArr=e!==undefined&&e!==null&&Array.isArray(e)?e:new Array;return a}(0,l.default)(t,[{key:"setByOL",value:function e(t){if(t!==undefined&&t!==null){this.polygonArr=[];var r=t.getLinearRingCount();var i=t.getLinearRings();for(var n=0;n<r;n++){var a=i[n].getCoordinates();var o=a.length;var s=[];for(var l=0;l<o;l++){s[l]=new d.Point2D(a[l][0],a[l][1])}this.polygonArr[n]=new v.Polygon(s)}}}},{key:"toString",value:function e(){if(this.polygonArr===undefined||this.polygonArr===null||this.polygonArr.length===0)return"";var t="";for(var r=0;r<this.polygonArr.length;r++){t+=this.polygonArr[r].toString()+";"}return t.substring(0,t.length-1)}},{key:"getGeometryType",value:function e(){return"multiPolygon"}}]);return t}(p.Tangram);t.MultiPolygon=m;Zondy.Object.MultiPolygon=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.PolyLine=undefined;var i=r(2);var n=v(i);var a=r(1);var o=v(a);var s=r(5);var l=v(s);var u=r(3);var f=v(u);var c=r(4);var h=v(c);var p=r(37);var d=r(19);function v(e){return e&&e.__esModule?e:{default:e}}var y=function(e){(0,h.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=r?r:{};var a=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,i));a.nearDis=i.nearDis!==undefined&&i.nearDis!==null?parseFloat(i.nearDis):null;a.pointArr=e!==undefined&&e!==null&&Array.isArray(e)?e:new Array;return a}(0,l.default)(t,[{key:"setByOL",value:function e(t){if(t!==undefined&&t!==null){var r=t.getCoordinates();var i=r.length;for(var n=0;n<i;n++){this.pointArr[n]=new d.Point2D(r[n][0],r[n][1])}}}},{key:"toString",value:function e(){if(this.pointArr===null||this.pointArr.length===0)return"";var t=this.pointArr[0].x+","+this.pointArr[0].y;for(var r=1;r<this.pointArr.length;r++){t+=","+this.pointArr[r].x+","+this.pointArr[r].y}if(this.nearDis!==undefined&&this.nearDis!==null){t+=";"+this.nearDis}else{t=t.substring(0,t.length-1)}return this.Trim(t,"g")}},{key:"getGeometryType",value:function e(){return"line"}}]);return t}(p.Tangram);t.PolyLine=y;Zondy.Object.PolyLine=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.VectCls=undefined;var i=r(0);var n=r(6);var a=r(15);var o=r(60);var s=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.clsType=r.clsType!==undefined?r.clsType:a.VectClsType.SFCls;this.clsName=r.clsName!==undefined?r.clsName:null;this.geoType=r.geoType!==undefined?r.geoType:1;this.srefName=r.srefName!==undefined?encodeURI(r.srefName):"";this.dsName=r.dsName!==undefined?encodeURI(r.dsName):"";this.attStruct=r.attStruct!==undefined?r.attStruct:null};t.VectCls=s;i.Zondy.Object.VectCls=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SlopLineParam=t.NetAnalysisExtent=t.NetAnalyse=t.MeshingParam=t.ContourRegionInfo=t.ContourZValue=t.ContourParam=t.ContourNoteParam=undefined;var i=r(148);var n=r(149);var a=r(151);var o=r(152);var s=r(153);var l=r(301);var u=r(302);var f=r(150);t.ContourNoteParam=i.ContourNoteParam;t.ContourParam=n.ContourParam;t.ContourZValue=a.ContourZValue;t.ContourRegionInfo=o.ContourRegionInfo;t.MeshingParam=s.MeshingParam;t.NetAnalyse=l.NetAnalyse;t.NetAnalysisExtent=u.NetAnalysisExtent;t.SlopLineParam=f.SlopLineParam},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NetAnalyse=undefined;var i=r(0);var n=r(6);var a=function e(t){var r=t!==undefined?t:{};(0,n.extend)(this,r);this.netCls=r.netCls!==undefined?r.netCls:null;this.flagPosStr=r.flagPosStr!==undefined?r.flagPosStr:null;this.barrierPosStr=r.barrierPosStr!==undefined?r.barrierPosStr:null;this.weight=r.weight!==undefined?r.weight:null;this.mode=r.mode!==undefined?r.mode:null;this.isTour=r.isTour!==undefined?r.isTour:false;this.isTravel=r.isTravel!==undefined?r.isTravel:false;this.usedTWgt=r.usedTWgt!==undefined?r.usedTWgt:false;this.turnWgt=r.turnWgt!==undefined?r.turnWgt:null;this.roadName=r.roadName!==undefined?r.roadName:"name"};t.NetAnalyse=a;i.Zondy.Object.NetAnalyse=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NetAnalysisExtent=undefined;var i=r(9);var n=_(i);var a=r(2);var o=_(a);var s=r(1);var l=_(s);var u=r(5);var f=_(u);var c=r(3);var h=_(c);var p=r(4);var d=_(p);var v=r(0);var y=r(6);var m=r(27);var g=r(10);function _(e){return e&&e.__esModule?e:{default:e}}var x=function(e){(0,d.default)(t,e);function t(e){(0,l.default)(this,t);var r=e||{};var i=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,r));i.netClsUrl=r.netClsUrl!==undefined?r.netClsUrl:null;i.flagPosStr=r.flagPosStr!==undefined?r.flagPosStr:null;i.analyTp=r.analyTp!==undefined?r.analyTp:"UserMode";i.weight=r.weight!==undefined?r.weight:",Weight1,Weight1";i.outFormat=r.outFormat!==undefined?r.outFormat:"JSON";i.elementType=r.elementType!==undefined?r.elementType:2;i.nearDis=r.nearDis!==undefined?r.nearDis:.001;i.barrierPosStr=r.barrierPosStr!==undefined?r.barrierPosStr:null;i.roadName=r.roadName!==undefined?r.roadName:"name";i.baseUrl="igs/rest/netAnaly";return i}(0,f.default)(t,[{key:"getNetInfo",value:function e(t,r,i,n){if(t==null||t==undefined){t="weight"}this.partUrl="netClsInfo?netCls="+this.netClsUrl+"&type="+t;var a=this;var o=a.getFullUrl();var s=new g.IgsServiceBase(o,{eventListeners:{scope:a,processCompleted:r,processFailed:i}});s.processAsync()}},{key:"addNetFlag",value:function e(t,r,i,a,o){var s=null;var l={};if(a!=null&&a.toUpperCase()=="POST"){l.dotVal=t;this.partUrl="netClsFlag?netCls="+this.netClsUrl+"&type="+this.elementType+"&nearDis="+this.nearDis}else{this.partUrl="netClsFlag?netCls="+this.netClsUrl+"&type="+this.elementType+"&value="+t+"&nearDis="+this.nearDis}var u=this;var f=u.getFullUrl();var c=new g.IgsServiceBase(f,{eventListeners:{scope:u,processCompleted:r,processFailed:i}});if(a!=null&&a.toUpperCase()=="POST"){c.processAsync({method:"POST",data:(0,n.default)(l),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}else{c.processAsync()}}},{key:"netAnalyse",value:function e(t,r,i,a){this.partUrl="netAnalyse";var o=this;var s=o.getFullUrl();var l=new g.IgsServiceBase(s,{eventListeners:{scope:o,processCompleted:r,processFailed:i}});l.processAsync({method:"POST",data:(0,n.default)(t),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}},{key:"comNetAnalyse",value:function e(t,r,i,a){this.partUrl="comNetAnalyse";var o=this;var s=o.getFullUrl();var l=new g.IgsServiceBase(s,{eventListeners:{scope:o,processCompleted:r,processFailed:i}});l.processAsync({method:"POST",data:(0,n.default)(t),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}},{key:"pluNetAnalyse",value:function e(t,r,i,a){this.partUrl="pluNetAnalyse";var o=this;var s=o.getFullUrl();var l=new g.IgsServiceBase(s,{eventListeners:{scope:o,processCompleted:r,processFailed:i}});l.processAsync({method:"POST",data:(0,n.default)(t),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}}]);return t}(m.ServiceBase);t.NetAnalysisExtent=x;v.Zondy.Service.NetAnalysisExtent=x},function(e,t,r){r(134);r(87);r(88);r(304);r(315);r(316);e.exports=r(8).Promise},function(e,t,r){"use strict";var i=r(47);var n=r(12);var a=r(45);var o=r(159);var s=r(17);var l=r(11);var u=r(54);var f=r(305);var c=r(306);var h=r(161);var p=r(98).set;var d=r(310)();var v=r(99);var y=r(162);var m=r(311);var g=r(163);var _="Promise";var x=n.TypeError;var b=n.process;var w=b&&b.versions;var S=w&&w.v8||"";var C=n[_];var T=o(b)=="process";var P=function(){};var M,I,A,L;var E=I=v.f;var k=!!function(){try{var e=C.resolve(1);var t=(e.constructor={})[r(14)("species")]=function(e){e(P,P)};return(T||typeof PromiseRejectionEvent=="function")&&e.then(P)instanceof t&&S.indexOf("6.6")!==0&&m.indexOf("Chrome/66")===-1}catch(e){}}();var D=function(e){var t;return l(e)&&typeof(t=e.then)=="function"?t:false};var B=function(e,t){if(e._n)return;e._n=true;var r=e._c;d(function(){var i=e._v;var n=e._s==1;var a=0;var o=function(t){var r=n?t.ok:t.fail;var a=t.resolve;var o=t.reject;var s=t.domain;var l,u,f;try{if(r){if(!n){if(e._h==2)O(e);e._h=1}if(r===true)l=i;else{if(s)s.enter();l=r(i);if(s){s.exit();f=true}}if(l===t.promise){o(x("Promise-chain cycle"))}else if(u=D(l)){u.call(l,a,o)}else a(l)}else o(i)}catch(e){if(s&&!f)s.exit();o(e)}};while(r.length>a)o(r[a++]);e._c=[];e._n=false;if(t&&!e._h)R(e)})};var R=function(e){p.call(n,function(){var t=e._v;var r=F(e);var i,a,o;if(r){i=y(function(){if(T){b.emit("unhandledRejection",t,e)}else if(a=n.onunhandledrejection){a({promise:e,reason:t})}else if((o=n.console)&&o.error){o.error("Unhandled promise rejection",t)}});e._h=T||F(e)?2:1}e._a=undefined;if(r&&i.e)throw i.v})};var F=function(e){return e._h!==1&&(e._a||e._c).length===0};var O=function(e){p.call(n,function(){var t;if(T){b.emit("rejectionHandled",e)}else if(t=n.onrejectionhandled){t({promise:e,reason:e._v})}})};var z=function(e){var t=this;if(t._d)return;t._d=true;t=t._w||t;t._v=e;t._s=2;if(!t._a)t._a=t._c.slice();B(t,true)};var U=function(e){var t=this;var r;if(t._d)return;t._d=true;t=t._w||t;try{if(t===e)throw x("Promise can't be resolved itself");if(r=D(e)){d(function(){var i={_w:t,_d:false};try{r.call(e,a(U,i,1),a(z,i,1))}catch(e){z.call(i,e)}})}else{t._v=e;t._s=1;B(t,false)}}catch(e){z.call({_w:t,_d:false},e)}};if(!k){C=function e(t){f(this,C,_,"_h");u(t);M.call(this);try{t(a(U,this,1),a(z,this,1))}catch(e){z.call(this,e)}};M=function e(t){this._c=[];this._a=undefined;this._s=0;this._d=false;this._v=undefined;this._h=0;this._n=false};M.prototype=r(312)(C.prototype,{then:function e(t,r){var i=E(h(this,C));i.ok=typeof t=="function"?t:true;i.fail=typeof r=="function"&&r;i.domain=T?b.domain:undefined;this._c.push(i);if(this._a)this._a.push(i);if(this._s)B(this,false);return i.promise},catch:function(e){return this.then(undefined,e)}});A=function(){var e=new M;this.promise=e;this.resolve=a(U,e,1);this.reject=a(z,e,1)};v.f=E=function(e){return e===C||e===L?new A(e):I(e)}}s(s.G+s.W+s.F*!k,{Promise:C});r(59)(C,_);r(313)(_);L=r(8)[_];s(s.S+s.F*!k,_,{reject:function e(t){var r=E(this);var i=r.reject;i(t);return r.promise}});s(s.S+s.F*(i||!k),_,{resolve:function e(t){return g(i&&this===L?C:this,t)}});s(s.S+s.F*!(k&&r(314)(function(e){C.all(e)["catch"](P)})),_,{all:function e(t){var r=this;var i=E(r);var n=i.resolve;var a=i.reject;var o=y(function(){var e=[];var i=0;var o=1;c(t,false,function(t){var s=i++;var l=false;e.push(undefined);o++;r.resolve(t).then(function(t){if(l)return;l=true;e[s]=t;--o||n(e)},a)});--o||n(e)});if(o.e)a(o.v);return i.promise},race:function e(t){var r=this;var i=E(r);var n=i.reject;var a=y(function(){c(t,false,function(e){r.resolve(e).then(i.resolve,n)})});if(a.e)n(a.v);return i.promise}})},function(e,t){e.exports=function(e,t,r,i){if(!(e instanceof t)||i!==undefined&&i in e){throw TypeError(r+": incorrect invocation!")}return e}},function(e,t,r){var i=r(45);var n=r(307);var a=r(308);var o=r(23);var s=r(124);var l=r(160);var u={};var f={};var t=e.exports=function(e,t,r,c,h){var p=h?function(){return e}:l(e);var d=i(r,c,t?2:1);var v=0;var y,m,g,_;if(typeof p!="function")throw TypeError(e+" is not iterable!");if(a(p))for(y=s(e.length);y>v;v++){_=t?d(o(m=e[v])[0],m[1]):d(e[v]);if(_===u||_===f)return _}else for(g=p.call(e);!(m=g.next()).done;){_=n(g,d,m.value,t);if(_===u||_===f)return _}};t.BREAK=u;t.RETURN=f},function(e,t,r){var i=r(23);e.exports=function(e,t,r,n){try{return n?t(i(r)[0],r[1]):t(r)}catch(t){var a=e["return"];if(a!==undefined)i(a.call(e));throw t}}},function(e,t,r){var i=r(48);var n=r(14)("iterator");var a=Array.prototype;e.exports=function(e){return e!==undefined&&(i.Array===e||a[n]===e)}},function(e,t){e.exports=function(e,t,r){var i=r===undefined;switch(t.length){case 0:return i?e():e.call(r);case 1:return i?e(t[0]):e.call(r,t[0]);case 2:return i?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){var i=r(12);var n=r(98).set;var a=i.MutationObserver||i.WebKitMutationObserver;var o=i.process;var s=i.Promise;var l=r(46)(o)=="process";e.exports=function(){var e,t,r;var u=function(){var i,n;if(l&&(i=o.domain))i.exit();while(e){n=e.fn;e=e.next;try{n()}catch(i){if(e)r();else t=undefined;throw i}}t=undefined;if(i)i.enter()};if(l){r=function(){o.nextTick(u)}}else if(a&&!(i.navigator&&i.navigator.standalone)){var f=true;var c=document.createTextNode("");new a(u).observe(c,{characterData:true});r=function(){c.data=f=!f}}else if(s&&s.resolve){var h=s.resolve(undefined);r=function(){h.then(u)}}else{r=function(){n.call(i,u)}}return function(i){var n={fn:i,next:undefined};if(t)t.next=n;if(!e){e=n;r()}t=n}}},function(e,t,r){var i=r(12);var n=i.navigator;e.exports=n&&n.userAgent||""},function(e,t,r){var i=r(35);e.exports=function(e,t,r){for(var n in t){if(r&&e[n])e[n]=t[n];else i(e,n,t[n])}return e}},function(e,t,r){"use strict";var i=r(12);var n=r(8);var a=r(30);var o=r(26);var s=r(14)("species");e.exports=function(e){var t=typeof n[e]=="function"?n[e]:i[e];if(o&&t&&!t[s])a.f(t,s,{configurable:true,get:function(){return this}})}},function(e,t,r){var i=r(14)("iterator");var n=false;try{var a=[7][i]();a["return"]=function(){n=true};Array.from(a,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!n)return false;var r=false;try{var a=[7];var o=a[i]();o.next=function(){return{done:r=true}};a[i]=function(){return o};e(a)}catch(e){}return r}},function(e,t,r){"use strict";var i=r(17);var n=r(8);var a=r(12);var o=r(161);var s=r(163);i(i.P+i.R,"Promise",{finally:function(e){var t=o(this,n.Promise||a.Promise);var r=typeof e=="function";return this.then(r?function(r){return s(t,e()).then(function(){return r})}:e,r?function(r){return s(t,e()).then(function(){throw r})}:e)}})},function(e,t,r){"use strict";var i=r(17);var n=r(99);var a=r(162);i(i.S,"Promise",{try:function(e){var t=n.f(this);var r=a(e);(r.e?t.reject:t.resolve)(r.v);return t.promise}})},function(e,t,r){"use strict";var i=r(318);var n=a(i);function a(e){return e&&e.__esModule?e:{default:e}}window.Promise=n.default},function(e,t,r){"use strict";var i,n;var a=r(319);var o=u(a);var s=r(18);var l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}(function(a,o){(false?undefined:(0,l.default)(t))==="object"&&typeof e!=="undefined"?e.exports=o():true?!(i=o,n=typeof i==="function"?i.call(t,r,t,e):i,n!==undefined&&(e.exports=n)):undefined})(undefined,function(){"use strict";var e=setTimeout;function t(){}function r(e,t){return function(){e.apply(t,arguments)}}function i(e,t){while(e._state===3){e=e._value}if(e._state===0){e._deferreds.push(t);return}e._handled=true;c._immediateFn(function(){var r=e._state===1?t.onFulfilled:t.onRejected;if(r===null){(e._state===1?n:a)(t.promise,e._value);return}var i;try{i=r(e._value)}catch(e){a(t.promise,e);return}n(t.promise,i)})}function n(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&((typeof t==="undefined"?"undefined":(0,l.default)(t))==="object"||typeof t==="function")){var i=t.then;if(t instanceof c){e._state=3;e._value=t;s(e);return}else if(typeof i==="function"){f(r(i,t),e);return}}e._state=1;e._value=t;s(e)}catch(t){a(e,t)}}function a(e,t){e._state=2;e._value=t;s(e)}function s(e){if(e._state===2&&e._deferreds.length===0){c._immediateFn(function(){if(!e._handled){c._unhandledRejectionFn(e._value)}})}for(var t=0,r=e._deferreds.length;t<r;t++){i(e,e._deferreds[t])}e._deferreds=null}function u(e,t,r){this.onFulfilled=typeof e==="function"?e:null;this.onRejected=typeof t==="function"?t:null;this.promise=r}function f(e,t){var r=false;try{e(function(e){if(r)return;r=true;n(t,e)},function(e){if(r)return;r=true;a(t,e)})}catch(e){if(r)return;r=true;a(t,e)}}function c(e){if(!(this instanceof c))throw new TypeError("Promises must be constructed via new");if(typeof e!=="function")throw new TypeError("not a function");this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];f(e,this)}var h=c.prototype;h.catch=function(e){return this.then(null,e)};h.then=function(e,r){var n=new this.constructor(t);i(this,new u(e,r,n));return n};c.all=function(e){return new c(function(t,r){if(!e||typeof e.length==="undefined")throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(e);if(i.length===0)return t([]);var n=i.length;function a(e,o){try{if(o&&((typeof o==="undefined"?"undefined":(0,l.default)(o))==="object"||typeof o==="function")){var s=o.then;if(typeof s==="function"){s.call(o,function(t){a(e,t)},r);return}}i[e]=o;if(--n===0){t(i)}}catch(e){r(e)}}for(var o=0;o<i.length;o++){a(o,i[o])}})};c.resolve=function(e){if(e&&(typeof e==="undefined"?"undefined":(0,l.default)(e))==="object"&&e.constructor===c){return e}return new c(function(t){t(e)})};c.reject=function(e){return new c(function(t,r){r(e)})};c.race=function(e){return new c(function(t,r){for(var i=0,n=e.length;i<n;i++){e[i].then(t,r)}})};c._immediateFn=typeof o.default==="function"&&function(e){(0,o.default)(e)}||function(t){e(t,0)};c._unhandledRejectionFn=function e(t){if(typeof console!=="undefined"&&console){console.warn("Possible Unhandled Promise Rejection:",t)}};return c})},function(e,t,r){e.exports={default:r(320),__esModule:true}},function(e,t,r){r(321);e.exports=r(8).setImmediate},function(e,t,r){var i=r(17);var n=r(98);i(i.G+i.B,{setImmediate:n.set,clearImmediate:n.clear})},function(e,t,r){"use strict";var i=r(158);var n=s(i);var a=r(84);var o=s(a);function s(e){return e&&e.__esModule?e:{default:e}}(function(t){"use strict";if(!t.__disableNativeFetch&&t.fetch){return}function r(e){if(typeof e!=="string"){e=String(e)}if(/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e)){throw new TypeError("Invalid character in header field name")}return e.toLowerCase()}function i(e){if(typeof e!=="string"){e=String(e)}return e}function a(e){this.map={};if(e instanceof a){e.forEach(function(e,t){this.append(t,e)},this)}else if(e){(0,o.default)(e).forEach(function(t){this.append(t,e[t])},this)}}a.prototype.append=function(e,t){e=r(e);t=i(t);var n=this.map[e];if(!n){n=[];this.map[e]=n}n.push(t)};a.prototype["delete"]=function(e){delete this.map[r(e)]};a.prototype.get=function(e){var t=this.map[r(e)];return t?t[0]:null};a.prototype.getAll=function(e){return this.map[r(e)]||[]};a.prototype.has=function(e){return this.map.hasOwnProperty(r(e))};a.prototype.set=function(e,t){this.map[r(e)]=[i(t)]};a.prototype.forEach=function(e,t){(0,o.default)(this.map).forEach(function(r){this.map[r].forEach(function(i){e.call(t,i,r,this)},this)},this)};function s(e){if(e.bodyUsed){return n.default.reject(new TypeError("Already read"))}e.bodyUsed=true}function l(e){return new n.default(function(t,r){e.onload=function(){t(e.result)};e.onerror=function(){r(e.error)}})}function u(e){var t=new FileReader;t.readAsArrayBuffer(e);return l(t)}function f(e,t){var r=new FileReader;var i=t.headers.map["content-type"]?t.headers.map["content-type"].toString():"";var n=/charset\=[0-9a-zA-Z\-\_]*;?/;var a=e.type.match(n)||i.match(n);var o=[e];if(a){o.push(a[0].replace(/^charset\=/,"").replace(/;$/,""))}r.readAsText.apply(r,o);return l(r)}var c={blob:"FileReader"in t&&"Blob"in t&&function(){try{new Blob;return true}catch(e){return false}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};function h(){this.bodyUsed=false;this._initBody=function(e,t){this._bodyInit=e;if(typeof e==="string"){this._bodyText=e}else if(c.blob&&Blob.prototype.isPrototypeOf(e)){this._bodyBlob=e;this._options=t}else if(c.formData&&FormData.prototype.isPrototypeOf(e)){this._bodyFormData=e}else if(!e){this._bodyText=""}else if(c.arrayBuffer&&ArrayBuffer.prototype.isPrototypeOf(e)){}else{throw new Error("unsupported BodyInit type")}};if(c.blob){this.blob=function(){var e=s(this);if(e){return e}if(this._bodyBlob){return n.default.resolve(this._bodyBlob)}else if(this._bodyFormData){throw new Error("could not read FormData body as blob")}else{return n.default.resolve(new Blob([this._bodyText]))}};this.arrayBuffer=function(){return this.blob().then(u)};this.text=function(){var e=s(this);if(e){return e}if(this._bodyBlob){return f(this._bodyBlob,this._options)}else if(this._bodyFormData){throw new Error("could not read FormData body as text")}else{return n.default.resolve(this._bodyText)}}}else{this.text=function(){var e=s(this);return e?e:n.default.resolve(this._bodyText)}}if(c.formData){this.formData=function(){return this.text().then(y)}}this.json=function(){return this.text().then(JSON.parse)};return this}var p=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function d(e){var t=e.toUpperCase();return p.indexOf(t)>-1?t:e}function v(e,t){t=t||{};var r=t.body;if(v.prototype.isPrototypeOf(e)){if(e.bodyUsed){throw new TypeError("Already read")}this.url=e.url;this.credentials=e.credentials;if(!t.headers){this.headers=new a(e.headers)}this.method=e.method;this.mode=e.mode;if(!r){r=e._bodyInit;e.bodyUsed=true}}else{this.url=e}this.credentials=t.credentials||this.credentials||"omit";if(t.headers||!this.headers){this.headers=new a(t.headers)}this.method=d(t.method||this.method||"GET");this.mode=t.mode||this.mode||null;this.referrer=null;if((this.method==="GET"||this.method==="HEAD")&&r){throw new TypeError("Body not allowed for GET or HEAD requests")}this._initBody(r,t)}v.prototype.clone=function(){return new v(this)};function y(e){var t=new FormData;e.trim().split("&").forEach(function(e){if(e){var r=e.split("=");var i=r.shift().replace(/\+/g," ");var n=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(i),decodeURIComponent(n))}});return t}function m(e){var t=new a;var r=e.getAllResponseHeaders().trim().split("\n");r.forEach(function(e){var r=e.trim().split(":");var i=r.shift().trim();var n=r.join(":").trim();t.append(i,n)});return t}h.call(v.prototype);function g(e,t){if(!t){t={}}this._initBody(e,t);this.type="default";this.status=t.status;this.ok=this.status>=200&&this.status<300;this.statusText=t.statusText;this.headers=t.headers instanceof a?t.headers:new a(t.headers);this.url=t.url||""}h.call(g.prototype);g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new a(this.headers),url:this.url})};g.error=function(){var e=new g(null,{status:0,statusText:""});e.type="error";return e};var _=[301,302,303,307,308];g.redirect=function(e,t){if(_.indexOf(t)===-1){throw new RangeError("Invalid status code")}return new g(null,{status:t,headers:{location:e}})};t.Headers=a;t.Request=v;t.Response=g;t.fetch=function(e,t){return new n.default(function(r,i){var n;if(v.prototype.isPrototypeOf(e)&&!t){n=e}else{n=new v(e,t)}var a=new XMLHttpRequest;function o(){if("responseURL"in a){return a.responseURL}if(/^X-Request-URL:/m.test(a.getAllResponseHeaders())){return a.getResponseHeader("X-Request-URL")}return}var s=false;function l(){if(a.readyState!==4){return}var e=a.status===1223?204:a.status;if(e<100||e>599){if(s){return}else{s=true}i(new TypeError("Network request failed"));return}var t={status:e,statusText:a.statusText,headers:m(a),url:o()};var n="response"in a?a.response:a.responseText;if(s){return}else{s=true}r(new g(n,t))}a.onreadystatechange=l;a.onload=l;a.onerror=function(){if(s){return}else{s=true}i(new TypeError("Network request failed"))};a.open(n.method,n.url,true);try{if(n.credentials==="include"){if("withCredentials"in a){a.withCredentials=true}else{console&&console.warn&&console.warn("withCredentials is not supported, you can ignore this warning")}}}catch(e){console&&console.warn&&console.warn("set withCredentials error:"+e)}if("responseType"in a&&c.blob){a.responseType="blob"}n.headers.forEach(function(e,t){a.setRequestHeader(t,e)});a.send(typeof n._bodyInit==="undefined"?null:n._bodyInit)})};t.fetch.polyfill=true;if(typeof e!=="undefined"&&e.exports){e.exports=t.fetch}})(typeof self!=="undefined"?self:undefined)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.JSONFormat=t.IgsServiceBase=t.FetchRequest=t.RequestTimeout=t.CORS=t.Events=t.CommonServiceBase=undefined;var i=r(154);var n=r(155);var a=r(157);var o=r(10);var s=r(156);t.CommonServiceBase=i.CommonServiceBase;t.Events=n.Events;t.CORS=a.CORS;t.RequestTimeout=a.RequestTimeout;t.FetchRequest=a.FetchRequest;t.IgsServiceBase=o.IgsServiceBase;t.JSONFormat=s.JSONFormat},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SystomInfo=t.VectorLayer=t.TileLayer=t.CatalogService=t.MapDoc=t.GDBInfo=t.ColorInfo=undefined;var i=r(325);var n=r(164);var a=r(326);var o=r(40);var s=r(327);var l=r(328);var u=r(329);t.ColorInfo=i.ColorInfo;t.GDBInfo=n.GDBInfo;t.MapDoc=a.MapDoc;t.CatalogService=o.CatalogService;t.TileLayer=s.TileLayer;t.VectorLayer=l.VectorLayer;t.SystomInfo=u.SystomInfo},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ColorInfo=undefined;var i=r(2);var n=v(i);var a=r(1);var o=v(a);var s=r(5);var l=v(s);var u=r(3);var f=v(u);var c=r(4);var h=v(c);var p=r(40);var d=r(10);function v(e){return e&&e.__esModule?e:{default:e}}var y=function(e){(0,h.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.SystemLibID=r.SystemLibID!==undefined?r.SystemLibID:0;i.ColorNO=r.ColorNO!==undefined?r.ColorNO:6;i.Red=r.Red!==undefined?r.Red:0;i.Green=r.Green!==undefined?r.Green:0;i.Blue=r.Blue!==undefined?r.Blue:0;i.addNew=r.addNew!==undefined?r.addNew:false;return i}(0,l.default)(t,[{key:"getColorNO",value:function e(t,r,i){var n=this;if(t!==null&&t!==undefined){if(t.SystemLibID!==undefined){n.SystemLibID=t.SystemLibID}if(t.Red!==undefined){n.Red=t.Red}if(t.Green!==undefined){n.Green=t.Green}if(t.Blue!==undefined){n.Blue=t.Blue}if(t.addNew!==undefined){n.addNew=t.addNew}}n.partUrl="ColorLib/getColorNO?f=json&libID="+n.SystemLibID+"&r="+n.Red+"&g="+n.Green+"&b="+n.Blue+"&addNew="+n.addNew;var a=n.getFullUrl();var o=new d.IgsServiceBase(a,{eventListeners:{scope:n,processCompleted:r,processFailed:i}});o.processAsync()}},{key:"getColorRGB",value:function e(t,r,i){var n=this;if(t!==null&&t!==undefined){if(t.SystemLibID!==undefined){n.SystemLibID=t.SystemLibID}if(t.ColorNO!==undefined){n.ColorNO=t.ColorNO}}n.partUrl="ColorLib/getColorRGB?f=json&libID="+n.SystemLibID+"&colorNO="+n.ColorNO;var a=n.getFullUrl();var o=new d.IgsServiceBase(a,{eventListeners:{scope:n,processCompleted:r,processFailed:i}});o.processAsync()}}]);return t}(p.CatalogService);t.ColorInfo=y;Zondy.Catalog.ColorInfo=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MapDoc=undefined;var i=r(9);var n=_(i);var a=r(2);var o=_(a);var s=r(1);var l=_(s);var u=r(5);var f=_(u);var c=r(3);var h=_(c);var p=r(4);var d=_(p);var v=r(0);var y=r(6);var m=r(40);var g=r(10);function _(e){return e&&e.__esModule?e:{default:e}}var x=function(e){(0,d.default)(t,e);function t(e){(0,l.default)(this,t);var r=e||{};var i=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,r));i.docName=r.docName!==undefined?r.docName:null;i.mapIndex=r.mapIndex!==undefined?r.mapIndex:0;i.layerID=r.layerID!==undefined?r.layerID:0;i.version=r.version!==undefined?r.version:2;i.include=r.include!==undefined?r.include:"{includeDetails:true,includeSubs:false}";i.returnFullStyle=r.returnFullStyle!==undefined?r.returnFullStyle:false;i.guid=r.guid!==undefined?r.guid:(0,y.newGuid)();return i}(0,f.default)(t,[{key:"getMapDocList",value:function e(t,r){var i=this;i.partUrl="docs?v="+this.version+"&f=json";var n=i.getFullUrl();var a=new g.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getMapDocInfo",value:function e(t,r,i,n,a){var o=this;if(typeof a==="boolean"){o.returnFullStyle=a}if(typeof r==="boolean"||typeof i==="boolean"){var s={includeDetails:typeof r==="boolean"?r:true,includeSubs:typeof i==="boolean"?i:false};o.include=(0,y.toJSON)(s)}o.partUrl="docs/"+o.docName+"?include="+o.include+"&returnFullStyle="+o.returnFullStyle+"&guid="+o.guid+"&f=json";var l=o.getFullUrl();var u=new g.IgsServiceBase(l,{eventListeners:{scope:o,processCompleted:t,processFailed:n}});u.processAsync()}},{key:"getMapInfo",value:function e(t,r,i){var n=this;if(typeof r==="boolean"){n.returnFullStyle=r}n.partUrl="docs/"+n.docName+"/"+n.mapIndex+"?returnFullStyle="+n.returnFullStyle+"&guid="+n.guid+"&f=json";var a=n.getFullUrl();var o=new g.IgsServiceBase(a,{eventListeners:{scope:n,processCompleted:t,processFailed:i}});o.processAsync()}},{key:"getMapDocTree",value:function e(t,r){var i=this;i.partUrl="docs/"+i.docName+"?tree=true&guid="+i.guid+"&f=json";var n=i.getFullUrl();var a=new g.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getLayerInfo",value:function e(t,r){var i=this;i.partUrl="docs/"+i.docName+"/"+i.mapIndex+"/"+i.layerID+"?returnFullStyle="+i.returnFullStyle+"&guid="+i.guid+"&f=json";var n=i.getFullUrl();var a=new g.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getLayersInfo",value:function e(t,r){var i=this;i.partUrl="docs/"+i.docName+"/"+i.mapIndex+"/layers?f=json";var n=i.getFullUrl();var a=new g.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"deleteLayer",value:function e(t,r){var i=this;i.partUrl="docs/"+i.docName+"/"+i.mapIndex+"/layers/delete?layerIDs="+i.layerID+"&guid="+i.guid+"&f=json";var n=i.getFullUrl();var a=new g.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"addLayer",value:function e(t,r,i){var a=this;a.partUrl="docs/"+a.docName+"/"+a.mapIndex+"/layers/add?guid="+a.guid+"&f=json";var o=a.getFullUrl();var s=new g.IgsServiceBase(o,{eventListeners:{scope:a,processCompleted:r,processFailed:i}});s.processAsync({method:"POST",data:(0,n.default)(t),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}},{key:"changeIndex",value:function e(t,r,i){var a=this;a.partUrl="docs/"+a.docName+"/"+a.mapIndex+"/layers/index?guid="+a.guid+"&f=json";var o=a.getFullUrl();var s=new g.IgsServiceBase(o,{eventListeners:{scope:a,processCompleted:r,processFailed:i}});s.processAsync({method:"POST",data:(0,n.default)(t),header:{"Content-Type":"text/plain;charset=UTF-8"}})}},{key:"getLegendInfo",value:function e(t,r,i,n){var a=this;a.partUrl="legendInfo/"+a.docName+"?f=json&layerIndexes="+t+"&fields="+r;var o=a.getFullUrl();var s=new g.IgsServiceBase(o,{eventListeners:{scope:a,processCompleted:i,processFailed:n}});s.processAsync()}}]);return t}(m.CatalogService);t.MapDoc=x;v.Zondy.Catalog.MapDoc=x},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TileLayer=undefined;var i=r(2);var n=v(i);var a=r(1);var o=v(a);var s=r(5);var l=v(s);var u=r(3);var f=v(u);var c=r(4);var h=v(c);var p=r(40);var d=r(10);function v(e){return e&&e.__esModule?e:{default:e}}var y=function(e){(0,h.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.tileName=r.tileName!==undefined?r.tileName:null;i.version=r.version!==undefined?r.version:"2.0";return i}(0,l.default)(t,[{key:"getTileList",value:function e(t,r){var i=this;i.partUrl="tiles?f=json";if(this.version){if(i.version==="2.0"){i.partUrl+="&v=2"}else{i.partUrl+="&v="+i.version}}var n=i.getFullUrl();var a=new d.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getTileInfo",value:function e(t,r){var i=this;i.partUrl="tiles/"+i.tileName+"?f=json";if(i.version){i.partUrl+="&v="+i.version}var n=i.getFullUrl();var a=new d.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}}]);return t}(p.CatalogService);t.TileLayer=y;Zondy.Catalog.TileLayer=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.VectorLayer=undefined;var i=r(9);var n=_(i);var a=r(2);var o=_(a);var s=r(1);var l=_(s);var u=r(5);var f=_(u);var c=r(3);var h=_(c);var p=r(4);var d=_(p);var v=r(6);var y=r(164);var m=r(10);var g=r(60);function _(e){return e&&e.__esModule?e:{default:e}}var x=function(e){(0,d.default)(t,e);function t(e){(0,l.default)(this,t);var r=e||{};return(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,r))}(0,f.default)(t,[{key:"getSfclsList",value:function e(t,r){var i=this;if(i.serverName.toLowerCase()==="mapgislocal")i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/sfcls?containAll="+i.containAll+"&f=json";else i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/sfcls?user="+i.User+"&psw="+i.Password+"&containAll="+this.containAll+"&f=json";var n=i.getFullUrl();var a=new m.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getAclsList",value:function e(t,r){var i=this;if(i.serverName.toLowerCase()==="mapgislocal")i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/acls?containAll="+i.containAll+"&f=json";else i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/acls?user="+i.User+"&psw="+i.Password+"&containAll="+i.containAll+"&f=json";var n=i.getFullUrl();var a=new m.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getOclsList",value:function e(t,r){var i=this;if(i.serverName.toLowerCase()==="mapgislocal")i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/ocls?containAll="+i.containAll+"&f=json";else i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/ocls?user="+i.User+"&psw="+i.Password+"&containAll="+i.containAll+"&f=json";var n=i.getFullUrl();var a=new m.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getNclsList",value:function e(t,r){var i=this;if(i.serverName.toLowerCase()==="mapgislocal")i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/ncls?containAll="+i.containAll+"&f=json";else i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/ncls?user="+i.User+"&psw="+i.Password+"&containAll="+i.containAll+"&f=json";var n=i.getFullUrl();var a=new m.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getRdsList",value:function e(t,r){var i=this;if(i.serverName.toLowerCase()==="mapgislocal")i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/rds?containAll="+i.containAll+"&f=json";else i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/rds?user="+i.User+"&psw="+i.Password+"&containAll="+i.containAll+"&f=json";var n=i.getFullUrl();var a=new m.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getDsSfclsList",value:function e(t,r){var i=this;if(i.serverName.toLowerCase()==="mapgislocal")i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/"+i.dsName+"/sfcls?f=json";else i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/"+i.dsName+"/sfcls?user="+i.User+"&psw="+i.Password+"&f=json";var n=i.getFullUrl();var a=new m.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getDsAclsList",value:function e(t,r){var i=this;if(i.serverName.toLowerCase()==="mapgislocal")i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/"+i.dsName+"/acls?f=json";else i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/"+i.dsName+"/acls?user="+i.User+"&psw="+i.Password+"&f=json";var n=i.getFullUrl();var a=new m.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getDsOclsList",value:function e(t,r){var i=this;if(i.serverName.toLowerCase()==="mapgislocal")i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/"+i.dsName+"/ocls?f=json";else i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/"+i.dsName+"/ocls?user="+i.User+"&psw="+i.Password+"&f=json";var n=i.getFullUrl();var a=new m.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getDsNclsList",value:function e(t,r){var i=this;if(i.serverName.toLowerCase()==="mapgislocal")i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/"+i.dsName+"/ncls?f=json";else i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/"+i.dsName+"/ncls?user="+i.User+"&psw="+i.Password+"&f=json";var n=i.getFullUrl();var a=new m.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getRdsListInRcs",value:function e(t,r){var i=this;if(i.serverName.toLowerCase()==="mapgislocal")i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/"+i.rcsName+"/rds?f=json";else i.partUrl="datasource/"+i.serverName+"/"+i.gdbName+"/"+i.rcsName+"/rds?user="+i.User+"&psw="+i.Password+"&f=json";var n=i.getFullUrl();var a=new m.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getLayerList",value:function e(t,r,i){var n=this;if(n.serverName.toLowerCase()==="mapgislocal")n.partUrl="datasource/"+n.serverName+"/"+n.gdbName+"/"+t+"?containAll="+n.containAll+"&f=json";else n.partUrl="datasource/"+n.serverName+"/"+n.gdbName+"/"+t+"?user="+n.User+"&psw="+n.Password+"&containAll="+n.containAll+"&f=json";var a=n.getFullUrl();var o=new m.IgsServiceBase(a,{eventListeners:{scope:n,processCompleted:r,processFailed:i}});o.processAsync()}},{key:"getLayerListInDS",value:function e(t,r,i){var n=this;if(n.serverName.toLowerCase()==="mapgislocal")n.partUrl="datasource/"+n.serverName+"/"+n.gdbName+"/"+n.dsName+"/"+t+"?f=json";else n.partUrl="datasource/"+n.serverName+"/"+n.gdbName+"/"+n.dsName+"/"+t+"?user="+n.User+"&psw="+n.Password+"&f=json";var a=n.getFullUrl();var o=new m.IgsServiceBase(a,{eventListeners:{scope:n,processCompleted:r,processFailed:i}});o.processAsync()}},{key:"getLayerInfo",value:function e(t,r,i,n){var a=this;a.partUrl="layerinfo?gdbpUrl="+t+"&f=json"+"&encryptPassword="+n+"&proj="+this.proj;var o=a.getFullUrl();var s=new m.IgsServiceBase(o,{eventListeners:{scope:a,processCompleted:r,processFailed:i}});s.processAsync()}},{key:"CreateVectCls",value:function e(t,r,i){var a=this;t=t!==null?t:null;if(t===null||a.serverName===null||a.gdbName===null){return}if(a.User!==null&&a.Password!==null){a.partUrl="datasource/"+a.User+":"+a.Password+"@"}else{a.partUrl="datasource/"}if(t.clsName===null){t.clsName=(0,v.newGuid)()}a.partUrl+=a.serverName+"/"+a.gdbName+"/"+t.clsType+"/"+t.clsName+"/create?"+"geoType="+t.geoType+"&srefName="+t.srefName+"&dsName="+t.dsName+"&f=json";if(t.attStruct===null){t.attStruct=new g.CAttStruct}var o=a.getFullUrl();var s=new m.IgsServiceBase(o,{eventListeners:{scope:a,processCompleted:r,processFailed:i}});s.processAsync({method:"POST",data:(0,n.default)(t.attStruct),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}},{key:"deleteXCls",value:function e(t,r,i,n){var a=this;if(a.serverName===null||a.gdbName===null||t===null||r===null){return}a.partUrl="datasource/"+a.serverName+"/"+a.gdbName+"/"+t+"/"+r+"/delete?f=json";var o=a.getFullUrl();var s=new m.IgsServiceBase(o,{eventListeners:{scope:a,processCompleted:i,processFailed:n}});s.processAsync()}}]);return t}(y.GDBInfo);t.VectorLayer=x;Zondy.Catalog.VectorLayer=x},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SystomInfo=undefined;var i=r(2);var n=v(i);var a=r(1);var o=v(a);var s=r(5);var l=v(s);var u=r(3);var f=v(u);var c=r(4);var h=v(c);var p=r(40);var d=r(10);function v(e){return e&&e.__esModule?e:{default:e}}var y=function(e){(0,h.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.f=r.f||"json";i.page=r.page||0;i.pageCount=r.pageCount||20;i.systemLib=r.systemLib||null;i.type=r.type||null;return i}(0,l.default)(t,[{key:"GetSystemLibrary",value:function e(t,r){var i=this;i.partUrl="systemlibraries?f="+i.f;var n=i.getFullUrl();var a=new d.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"GetSymbol",value:function e(t,r){var i=this;var n="symbols?&systemLib="+i.systemLib+"&type="+i.type;if(i.f){n+="&f="+i.f}if(i.page){n+="&page="+i.page}if(i.size){n+="&size="+i.pageCount}i.partUrl=n;var a=i.getFullUrl();var o=new d.IgsServiceBase(a,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});o.processAsync()}}]);return t}(p.CatalogService);t.SystomInfo=y;Zondy.Catalog.SystomInfo=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.QueryServiceBase=t.QueryParameterBase=t.QueryParameter=t.QueryLayerFeature=t.QueryFeatureStruct=t.QueryFeatureRule=t.QueryDocFeature=t.QueryByLayerParameter=t.ObjClsQueryParameter=t.ObjClsQuery=t.MultiGeoQueryParameter=t.MultiGeoQuery=t.EditServiceBase=t.EditLayerFeature=t.EditDocFeature=undefined;var i=r(331);var n=r(332);var a=r(100);var o=r(333);var s=r(167);var l=r(334);var u=r(168);var f=r(335);var c=r(336);var h=r(166);var p=r(102);var d=r(337);var v=r(101);var y=r(165);var m=r(49);t.EditDocFeature=i.EditDocFeature;t.EditLayerFeature=n.EditLayerFeature;t.EditServiceBase=a.EditServiceBase;t.MultiGeoQuery=o.MultiGeoQuery;t.MultiGeoQueryParameter=s.MultiGeoQueryParameter;t.ObjClsQuery=l.ObjClsQuery;t.ObjClsQueryParameter=u.ObjClsQueryParameter;t.QueryByLayerParameter=f.QueryByLayerParameter;t.QueryDocFeature=c.QueryDocFeature;t.QueryFeatureRule=h.QueryFeatureRule;t.QueryFeatureStruct=p.QueryFeatureStruct;t.QueryLayerFeature=d.QueryLayerFeature;t.QueryParameter=v.QueryParameter;t.QueryParameterBase=y.QueryParameterBase;t.QueryServiceBase=m.QueryServiceBase},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.EditDocFeature=undefined;var i=r(9);var n=g(i);var a=r(2);var o=g(a);var s=r(1);var l=g(s);var u=r(5);var f=g(u);var c=r(3);var h=g(c);var p=r(4);var d=g(p);var v=r(0);var y=r(100);var m=r(10);function g(e){return e&&e.__esModule?e:{default:e}}var _=function(e){(0,d.default)(t,e);function t(e,r,i){(0,l.default)(this,t);var n=i?i:{};var a=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,n));a.docName=e!==undefined?e:null;a.mapIndex=0;a.layerIndex=r!==undefined?r:0;return a}(0,f.default)(t,[{key:"add",value:function e(t,r,i){var a=this;if(t===undefined){return}a.partUrl="docs/"+a.docName+"/"+a.mapIndex+"/"+a.layerIndex+"/addFeatures?f="+a.f+"&guid="+a.guid;var o=a.getFullUrl();var s=new m.IgsServiceBase(o,{eventListeners:{scope:a,processCompleted:r,processFailed:i}});s.processAsync({method:"POST",data:(0,n.default)(t),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}},{key:"update",value:function e(t,r,i){var a=this;if(t===undefined){return}a.partUrl="docs/"+a.docName+"/"+a.mapIndex+"/"+a.layerIndex+"/updateFeatures?f="+a.f+"&guid="+a.guid;var o=a.getFullUrl();var s=new m.IgsServiceBase(o,{eventListeners:{scope:a,processCompleted:r,processFailed:i}});s.processAsync({method:"POST",data:(0,n.default)(t),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}},{key:"deletes",value:function e(t,r,i){var n=this;if(t===undefined){return}n.partUrl="docs/"+n.docName+"/"+n.mapIndex+"/"+n.layerIndex+"/deleteFeatures?f="+n.f+"&objectIds="+t+"&guid="+n.guid;var a=n.getFullUrl();var o=new m.IgsServiceBase(a,{eventListeners:{scope:n,processCompleted:r,processFailed:i}});o.processAsync()}}]);return t}(y.EditServiceBase);t.EditDocFeature=_;v.Zondy.Service.EditDocFeature=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.EditLayerFeature=undefined;var i=r(9);var n=g(i);var a=r(2);var o=g(a);var s=r(1);var l=g(s);var u=r(5);var f=g(u);var c=r(3);var h=g(c);var p=r(4);var d=g(p);var v=r(0);var y=r(100);var m=r(10);function g(e){return e&&e.__esModule?e:{default:e}}var _=function(e){(0,d.default)(t,e);function t(e,r){(0,l.default)(this,t);var i=r?r:{};var n=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,i));n.gdbp=e!==undefined?e:null;return n}(0,f.default)(t,[{key:"add",value:function e(t,r,i){var a=this;if(t===undefined){return}a.partUrl="layer/addFeatures?f="+a.f+"&gdbp="+a.gdbp+"&guid="+a.guid;var o=a.getFullUrl();var s=new m.IgsServiceBase(o,{eventListeners:{scope:a,processCompleted:r,processFailed:i}});s.processAsync({method:"POST",data:(0,n.default)(t),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}},{key:"update",value:function e(t,r,i){var a=this;if(t===undefined){return}a.partUrl="layer/updateFeatures?f="+a.f+"&gdbp="+a.gdbp+"&guid="+a.guid;var o=a.getFullUrl();var s=new m.IgsServiceBase(o,{eventListeners:{scope:a,processCompleted:r,processFailed:i}});s.processAsync({method:"POST",data:(0,n.default)(t),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}},{key:"deletes",value:function e(t,r,i){var n=this;if(t===undefined){return}n.partUrl="layer/deleteFeatures?f="+n.f+"&objectIds="+t+"&gdbp="+n.gdbp+"&guid="+n.guid;var a=n.getFullUrl();var o=new m.IgsServiceBase(a,{eventListeners:{scope:n,processCompleted:r,processFailed:i}});o.processAsync()}}]);return t}(y.EditServiceBase);t.EditLayerFeature=_;v.Zondy.Service.EditLayerFeature=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MultiGeoQuery=undefined;var i=r(9);var n=_(i);var a=r(2);var o=_(a);var s=r(1);var l=_(s);var u=r(5);var f=_(u);var c=r(3);var h=_(c);var p=r(4);var d=_(p);var v=r(0);var y=r(49);var m=r(167);var g=r(10);function _(e){return e&&e.__esModule?e:{default:e}}var x=function(e){(0,d.default)(t,e);function t(e,r,i,n){(0,l.default)(this,t);var a=n?n:{};var s=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,a));s.queryParam=e;s.mapName=r;s.mapIndex=0;s.layerIndex=i;s.baseUrl="igs/rest/extend/MultiGeo";s.partUrl="docs/"+s.mapName+"/"+s.mapIndex.toString()+"/"+s.layerIndex+"/Geoquery";s.partUrl+=e.getParameterURL();return s}(0,f.default)(t,[{key:"query",value:function e(t,r){if(this.queryParam===null||!(this.queryParam instanceof m.MultiGeoQueryParameter)){return}var i=null;if(this.queryParam.geometryType==="point"){i={pointArr:this.queryParam.geometry}}else if(this.queryParam.geometryType==="line"){i={lineArr:this.queryParam.geometry}}else if(this.queryParam.geometryType==="polygon"){i={PolygonObjs:this.queryParam.geometry}}var a=this;var o=a.getFullUrl();var s=new g.IgsServiceBase(o,{eventListeners:{scope:a,processCompleted:t,processFailed:r}});s.processAsync({method:"POST",data:(0,n.default)(i),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}}]);return t}(y.QueryServiceBase);t.MultiGeoQuery=x;v.Zondy.Service.MultiGeoQuery=x},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ObjClsQuery=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(4);var h=m(c);var p=r(0);var d=r(49);var v=r(168);var y=r(10);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,h.default)(t,e);function t(e,r,i){(0,o.default)(this,t);var a=i?i:{};var s=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,a));s.queryParam=e;s.gdbp=r;s.baseUrl="igs/rest/extend/dxlcz";s.partUrl="objlayer/query?gdbp="+r;s.partUrl+=e.getParameterURL();return s}(0,l.default)(t,[{key:"query",value:function e(t,r){if(this.queryParam===null||!(this.queryParam instanceof v.ObjClsQueryParameter)){return}var i=this;var n=i.getFullUrl();var a=new y.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}}]);return t}(d.QueryServiceBase);t.ObjClsQuery=g;p.Zondy.Service.ObjClsQuery=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.QueryByLayerParameter=undefined;var i=r(2);var n=g(i);var a=r(1);var o=g(a);var s=r(5);var l=g(s);var u=r(3);var f=g(u);var c=r(7);var h=g(c);var p=r(4);var d=g(p);var v=r(0);var y=r(101);var m=r(102);function g(e){return e&&e.__esModule?e:{default:e}}var _=function(e){(0,d.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=r?r:{};var a=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,i));a.gdbp=e!==undefined?encodeURI(e):null;return a}(0,l.default)(t,[{key:"getParameterURL",value:function e(){var r=(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"getParameterURL",this).call(this);return r+"&gdbp="+this.gdbp}},{key:"getParameterObject",value:function e(){var r=(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"getParameterObject",this).call(this,this);r.gdbp=this.gdbp;return r}}]);return t}(y.QueryParameter);t.QueryByLayerParameter=_;v.Zondy.Service.QueryByLayerParameter=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.QueryDocFeature=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(49);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e,r,i,a){(0,o.default)(this,t);var s=a?a:{};var u=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,s));u.queryParam=e;u.docName=r;u.layerIndex=i;u.mapIndex=0;u.partUrl="docs/"+u.docName+"/"+u.mapIndex.toString()+"/"+u.layerIndex.toString()+"/query";return u}return t}(h.QueryServiceBase);t.QueryDocFeature=d;c.Zondy.Service.QueryDocFeature=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.QueryLayerFeature=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(49);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=r?r:{};var a=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,i));a.queryParam=e;a.partUrl="layer/query";return a}return t}(h.QueryServiceBase);t.QueryLayerFeature=d;c.Zondy.Service.QueryLayerFeature=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FunctionWareService=t.ProjectBySRID=t.ProjectByLayer=t.ProjectBase=t.OverlayByPolygon=t.OverlayByLayer=t.OverlayBase=t.NetAnalysis=t.FeatureBuffBySingleRing=t.FeatureBuffByMultiplyRing=t.FeatureBuffBase=t.ContourAnalyse=t.ClipByPolygon=t.ClipByLayer=t.ClipByCircle=t.ClipBase=t.ClassBufferBySingleRing=t.ClassBufferByMultiplyRing=t.ClassBufferBase=t.AnalysisBase=undefined;var i=r(28);var n=r(103);var a=r(339);var o=r(340);var s=r(64);var l=r(341);var u=r(342);var f=r(343);var c=r(344);var h=r(104);var p=r(345);var d=r(346);var v=r(347);var y=r(105);var m=r(348);var g=r(349);var _=r(106);var x=r(350);var b=r(351);var w=r(352);t.AnalysisBase=i.AnalysisBase;t.ClassBufferBase=n.ClassBufferBase;t.ClassBufferByMultiplyRing=a.ClassBufferByMultiplyRing;t.ClassBufferBySingleRing=o.ClassBufferBySingleRing;t.ClipBase=s.ClipBase;t.ClipByCircle=l.ClipByCircle;t.ClipByLayer=u.ClipByLayer;t.ClipByPolygon=f.ClipByPolygon;t.ContourAnalyse=c.ContourAnalyse;t.FeatureBuffBase=h.FeatureBuffBase;t.FeatureBuffByMultiplyRing=p.FeatureBuffByMultiplyRing;t.FeatureBuffBySingleRing=d.FeatureBuffBySingleRing;t.NetAnalysis=v.NetAnalysis;t.OverlayBase=y.OverlayBase;t.OverlayByLayer=m.OverlayByLayer;t.OverlayByPolygon=g.OverlayByPolygon;t.ProjectBase=_.ProjectBase;t.ProjectByLayer=x.ProjectByLayer;t.ProjectBySRID=b.ProjectBySRID;t.FunctionWareService=w.FunctionWareService},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ClassBufferByMultiplyRing=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(103);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.flowID="600232";i.radiusStr=r.radiusStr!==undefined?r.radiusStr:"2,4,8,10";return i}return t}(h.ClassBufferBase);t.ClassBufferByMultiplyRing=d;c.Zondy.Service.ClassBufferByMultiplyRing=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ClassBufferBySingleRing=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(103);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.leftRad=r.leftRad!==undefined?r.leftRad:.001;i.rightRad=r.rightRad!==undefined?r.rightRad:.001;i.isByAtt=r.isByAtt!==undefined?r.isByAtt:true;i.fldName=r.fldName!==undefined?r.fldName:null;i.dynPrjRad=r.dynPrjRad!==undefined?r.dynPrjRad:0;i.flowID="600231";return i}return t}(h.ClassBufferBase);t.ClassBufferBySingleRing=d;c.Zondy.Service.ClassBufferBySingleRing=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ClipByCircle=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(64);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.srcInfo=r.srcInfo!==undefined?r.srcInfo:null;i.center=r.center!==undefined?r.center:null;i.radius=r.radius!==undefined?r.radius:null;i.step=r.step!==undefined?r.step:.001;i.flowID="600229";return i}return t}(h.ClipBase);t.ClipByCircle=d;c.Zondy.Service.ClipByCircle=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ClipByLayer=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(64);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.srcInfo1=r.srcInfo1!==undefined?r.srcInfo1:null;i.srcInfo2=r.srcInfo2!==undefined?r.srcInfo2:null;i.flowID="600230";return i}return t}(h.ClipBase);t.ClipByLayer=d;c.Zondy.Service.ClipByLayer=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ClipByPolygon=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(64);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.srcInfo=r.srcInfo!==undefined?r.srcInfo:null;i.strPos=r.strPos!==undefined?r.strPos:null;i.flowID="600228";return i}return t}(h.ClipBase);t.ClipByPolygon=d;c.Zondy.Service.ClipByPolygon=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ContourAnalyse=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(3);var l=m(s);var u=r(4);var f=m(u);var c=r(0);var h=r(6);var p=r(28);var d=r(10);var v=r(153);var y=r(149);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.flowID="600320";i.linSfclsURL=r.linSfclsURL!==undefined?r.linSfclsURL:null;i.regSfclsURL=r.regSfclsURL!==undefined?r.regSfclsURL:null;i.annoClsURL=r.annoClsURL!==undefined?r.annoClsURL:null;i.meshingParam=r.meshingParam!==undefined?r.meshingParam:null;i.contourParam=r.contourParam!==undefined?r.contourParam:null;return i}return t}(p.AnalysisBase);t.ContourAnalyse=g;c.Zondy.Service.ContourAnalyse=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FeatureBuffByMultiplyRing=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(104);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.radiusStr=r.radiusStr!==undefined?r.radiusStr:"0.003,0.002,0.001";i.flowID="600239";return i}return t}(h.FeatureBuffBase);t.FeatureBuffByMultiplyRing=d;c.Zondy.Service.FeatureBuffByMultiplyRing=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FeatureBuffBySingleRing=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(104);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.leftRad=r.leftRad!==undefined?r.leftRad:.001;i.rightRad=r.rightRad!==undefined?r.rightRad:.001;i.flowID="600238";return i}return t}(h.FeatureBuffBase);t.FeatureBuffBySingleRing=d;c.Zondy.Service.FeatureBuffBySingleRing=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.NetAnalysis=undefined;var i=r(2);var n=d(i);var a=r(1);var o=d(a);var s=r(3);var l=d(s);var u=r(4);var f=d(u);var c=r(0);var h=r(28);var p=r(15);function d(e){return e&&e.__esModule?e:{default:e}}var v=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.netClsUrl=r.netClsUrl!==undefined?r.netClsUrl:null;i.flagPosStr=r.flagPosStr!==undefined?r.flagPosStr:null;i.barrierPosStr=r.barrierPosStr!==undefined?r.barrierPosStr:null;i.analyType=r.analyType!==undefined?r.analyType:p.NetAnalyType.UserMode;i.weight=r.weight!==undefined?r.weight:",Weight1,Weight1";i.elementType=r.elementType!==undefined?r.elementType:p.NetElemType.Edge;i.nearDis=r.nearDis!==undefined?r.nearDis:.001;i.outFormat=r.outFormat!==undefined?r.outFormat:"json";i.flowID="600233";return i}return t}(h.AnalysisBase);t.NetAnalysis=v;c.Zondy.Service.NetAnalysis=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.OverlayByLayer=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(105);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.srcInfo2=r.srcInfo2!==undefined?r.srcInfo2:null;i.flowID="600227";return i}return t}(h.OverlayBase);t.OverlayByLayer=d;c.Zondy.Service.OverlayByLayer=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.OverlayByPolygon=undefined;var i=r(2);var n=p(i);var a=r(1);var o=p(a);var s=r(3);var l=p(s);var u=r(4);var f=p(u);var c=r(0);var h=r(105);function p(e){return e&&e.__esModule?e:{default:e}}var d=function(e){(0,f.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.strGRegionXML=r.strGRegionXML!==undefined?r.strGRegionXML:null;i.inFormat=r.inFormat!==undefined?r.inFormat:"json";i.flowID="600237";return i}return t}(h.OverlayBase);t.OverlayByPolygon=d;c.Zondy.Service.OverlayByPolygon=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ProjectByLayer=undefined;var i=r(2);var n=d(i);var a=r(1);var o=d(a);var s=r(3);var l=d(s);var u=r(4);var f=d(u);var c=r(0);var h=r(106);var p=r(6);function d(e){return e&&e.__esModule?e:{default:e}}var v=function(e){(0,f.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=r||{};(0,p.extend)(i,e);var a=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,i));a.flowID="600235";return a}return t}(h.ProjectBase);t.ProjectByLayer=v;c.Zondy.Service.ProjectByLayer=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ProjectBySRID=undefined;var i=r(2);var n=d(i);var a=r(1);var o=d(a);var s=r(3);var l=d(s);var u=r(4);var f=d(u);var c=r(0);var h=r(106);var p=r(6);function d(e){return e&&e.__esModule?e:{default:e}}var v=function(e){(0,f.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=r||{};(0,p.extend)(i,e);var a=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,i));a.flowID="600234";a.srID=i.srID!==undefined?i.srID:32;return a}return t}(h.ProjectBase);t.ProjectBySRID=v;c.Zondy.Service.ProjectBySRID=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FunctionWareService=undefined;var i=r(9);var n=_(i);var a=r(2);var o=_(a);var s=r(1);var l=_(s);var u=r(5);var f=_(u);var c=r(3);var h=_(c);var p=r(4);var d=_(p);var v=r(0);var y=r(28);var m=r(10);var g=r(6);function _(e){return e&&e.__esModule?e:{default:e}}var x=function(e){(0,d.default)(t,e);function t(e){(0,l.default)(this,t);var r=e||{};var i=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,r));i.guid=r.guid?r.guid:(0,g.newGuid)();i.f=r.f!==undefined?r.f:"json";return i}(0,f.default)(t,[{key:"executeWorkFlow",value:function e(t,r,i,a,o,s){if(!i){i=false}var l={};if(s!==null&&s.toUpperCase()==="POST"){l.paraValues=r;this.partUrl="execute/"+t+"?f="+this.f+"&isAsy="+i+"&guid="+this.guid}else{this.partUrl="execute/"+t+"?paraValues="+r+"&f="+this.f+"&isAsy="+i+"&guid="+this.guid}var u=this;var f=u.getFullUrl();var c=new m.IgsServiceBase(f,{eventListeners:{scope:u,processCompleted:a,processFailed:o}});if(s!==null&&s.toUpperCase()==="POST"){c.processAsync({method:"POST",data:(0,n.default)(l)})}else{c.processAsync()}}},{key:"getInstanceMessage",value:function e(t,r,i){this.partUrl="instanceLogs/"+t+"?f="+this.f+"&guid="+this.guid;var n=this;var a=n.getFullUrl();var o=new m.IgsServiceBase(a,{eventListeners:{scope:n,processCompleted:r,processFailed:i}});o.processAsync()}},{key:"getInstanceOutPutValue",value:function e(t,r,i,n){this.partUrl="outputvalues/"+t+"?name="+r+"&f="+this.f+"&guid="+this.guid;var a=this;var o=a.getFullUrl();var s=new m.IgsServiceBase(o,{eventListeners:{scope:a,processCompleted:i,processFailed:n}});s.processAsync()}},{key:"getInstanceResult",value:function e(t,r,i){this.partUrl="results/"+t+"?f="+this.f+"&guid="+this.guid;var n=this;var a=n.getFullUrl();var o=new m.IgsServiceBase(a,{eventListeners:{scope:n,processCompleted:r,processFailed:i}});o.processAsync()}},{key:"getInstanceStatus",value:function e(t,r,i){this.partUrl="status/"+t+"?f="+this.f+"&guid="+this.guid;var n=this;var a=n.getFullUrl();var o=new m.IgsServiceBase(a,{eventListeners:{scope:n,processCompleted:r,processFailed:i}});o.processAsync()}},{key:"getWorkFlowGroups",value:function e(t,r){this.partUrl="groups/?f="+this.f+"&guid="+this.guid;var i=this;var n=i.getFullUrl();var a=new m.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getWorkFlowInfoByID",value:function e(t,r,i){this.partUrl="workflows/"+t+"?f="+this.f+"&guid="+this.guid;var n=this;var a=n.getFullUrl();var o=new m.IgsServiceBase(a,{eventListeners:{scope:n,processCompleted:r,processFailed:i}});o.processAsync()}},{key:"getWorkFlowInfos",value:function e(t,r){this.partUrl="workflows?f="+this.f+"&guid="+this.guid;var i=this;var n=i.getFullUrl();var a=new m.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getWorkFlowInfosByGroup",value:function e(t,r,i){this.partUrl="workflowsbygroup/"+t+"?f="+this.f+"&guid="+this.guid;var n=this;var a=n.getFullUrl();var o=new m.IgsServiceBase(a,{eventListeners:{scope:n,processCompleted:r,processFailed:i}});o.processAsync()}},{key:"getFolder1",value:function e(t,r){this.partUrl="folderInfos?f="+this.f+"&guid="+this.guid;var i=this;var n=i.getFullUrl();var a=new m.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getFolder2",value:function e(t,r){this.partUrl="folderInfos/workflow?f="+this.f+"&guid="+this.guid;var i=this;var n=i.getFullUrl();var a=new m.IgsServiceBase(n,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});a.processAsync()}},{key:"getFolder3",value:function e(t,r,i){this.partUrl="folderInfos/workflow/"+t+"?f="+this.f+"&guid="+this.guid;var n=this;var a=n.getFullUrl();var o=new m.IgsServiceBase(a,{eventListeners:{scope:n,processCompleted:r,processFailed:i}});o.processAsync()}}]);return t}(y.AnalysisBase);t.FunctionWareService=x;v.Zondy.Service.FunctionWareService=x},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CoordinateElpTrans=t.TopAnalysis=t.Smooth=t.ProjectRang=t.ProjectDots=t.GeometryAnalysisBase=t.CProjectParam=t.CProjectBySRSID=t.CalServiceBase=t.CalPolyLineLength=t.CalArea=undefined;var i=r(354);var n=r(355);var a=r(107);var o=r(109);var s=r(108);var l=r(38);var u=r(356);var f=r(357);var c=r(358);var h=r(359);var p=r(360);t.CalArea=i.CalArea;t.CalPolyLineLength=n.CalPolyLineLength;t.CalServiceBase=a.CalServiceBase;t.CProjectBySRSID=o.CProjectBySRSID;t.CProjectParam=s.CProjectParam;t.GeometryAnalysisBase=l.GeometryAnalysisBase;t.ProjectDots=u.ProjectDots;t.ProjectRang=f.ProjectRang;t.Smooth=c.Smooth;t.TopAnalysis=h.TopAnalysis;t.CoordinateElpTrans=p.CoordinateElpTrans},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CalArea=undefined;var i=r(2);var n=v(i);var a=r(1);var o=v(a);var s=r(3);var l=v(s);var u=r(4);var f=v(u);var c=r(0);var h=r(107);var p=r(6);var d=r(19);function v(e){return e&&e.__esModule?e:{default:e}}var y=function(e){(0,f.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=r?r:{};(0,p.extend)(i,{dots:e});var a=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,i));a.partUrl="geomservice/calArea?f=json";return a}return t}(h.CalServiceBase);t.CalArea=y;c.Zondy.Service.CalArea=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CalPolyLineLength=undefined;var i=r(2);var n=v(i);var a=r(1);var o=v(a);var s=r(3);var l=v(s);var u=r(4);var f=v(u);var c=r(0);var h=r(107);var p=r(6);var d=r(19);function v(e){return e&&e.__esModule?e:{default:e}}var y=function(e){(0,f.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=r?r:{};(0,p.extend)(i,{dots:e});var a=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,i));a.partUrl="geomservice/calLength?f=json";return a}return t}(h.CalServiceBase);t.CalPolyLineLength=y;c.Zondy.Service.CalPolyLineLength=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ProjectDots=undefined;var i=r(9);var n=x(i);var a=r(2);var o=x(a);var s=r(1);var l=x(s);var u=r(5);var f=x(u);var c=r(3);var h=x(c);var p=r(4);var d=x(p);var v=r(0);var y=r(38);var m=r(19);var g=r(108);var _=r(10);function x(e){return e&&e.__esModule?e:{default:e}}var b=function(e){(0,d.default)(t,e);function t(e,r,i,n){(0,l.default)(this,t);var a=n?n:{};var s=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,a));s.InputDots=e;s.SrcProjParam=r;s.DesProjParm=i;return s}(0,f.default)(t,[{key:"execute",value:function e(t,r){this.partUrl="geomservice/projectdots?f=json";var i={};i["InputDots"]=this.InputDots;i["SrcProjParam"]=this.SrcProjParam;i["DesProjParm"]=this.DesProjParm;var a=this.getFullUrl();var o=this;var s=new _.IgsServiceBase(a,{eventListeners:{scope:o,processCompleted:t,processFailed:r}});s.processAsync({method:"POST",data:(0,n.default)(i),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}}]);return t}(y.GeometryAnalysisBase);t.ProjectDots=b;v.Zondy.Service.ProjectDots=b},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ProjectRang=undefined;var i=r(2);var n=y(i);var a=r(1);var o=y(a);var s=r(5);var l=y(s);var u=r(3);var f=y(u);var c=r(4);var h=y(c);var p=r(0);var d=r(38);var v=r(10);function y(e){return e&&e.__esModule?e:{default:e}}var m=function(e){(0,h.default)(t,e);function t(e){(0,o.default)(this,t);var r=e?e:{};var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.gdbsvrName=r.gdbsvrName!==undefined?r.gdbsvrName:"MapGISLocal";i.gdbName=r.gdbName!==undefined?r.gdbName:null;i.srefID=r.srefID!==undefined?r.srefID:0;i.desfID=r.desfID!==undefined?r.desfID:0;i.userName=r.userName!==undefined?r.userName:null;i.password=r.password!==undefined?r.password:null;return i}(0,l.default)(t,[{key:"execute",value:function e(t,r,i){var n="";if(t){n=t.xmin+"$"+t.ymin+"$"+t.xmax+"$"+t.ymax}if(this.userName===null||this.password===null){this.partUrl="geomservice/"+this.gdbsvrName+"/"+this.gdbName+"/"+this.srefID+"/"+this.desfID+"?f=json&rang="+n}else{this.partUrl="geomservice/"+this.gdbsvrName+"/"+this.gdbName+"/"+this.srefID+"/"+this.desfID+"?f=json&rang="+n+"&userName="+this.userName+"&password="+this.password}var a=this.getFullUrl();var o=this;var s=new v.IgsServiceBase(a,{eventListeners:{scope:o,processCompleted:r,processFailed:i}});s.processAsync()}}]);return t}(d.GeometryAnalysisBase);t.ProjectRang=m;p.Zondy.Service.ProjectRang=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Smooth=undefined;var i=r(9);var n=_(i);var a=r(2);var o=_(a);var s=r(1);var l=_(s);var u=r(5);var f=_(u);var c=r(3);var h=_(c);var p=r(4);var d=_(p);var v=r(0);var y=r(38);var m=r(19);var g=r(10);function _(e){return e&&e.__esModule?e:{default:e}}var x=function(e){(0,d.default)(t,e);function t(e){(0,l.default)(this,t);var r=e?e:{};var i=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,r));i.type=r.type!==undefined?r.type:0;i.step=r.step!==undefined?r.step:1;return i}(0,f.default)(t,[{key:"setType",value:function e(t){this.type=t}},{key:"setStep",value:function e(t){this.step=t}},{key:"execute",value:function e(t,r,i){if(this.type==2){if(t.length<4){alert("当前选中的为三次Beizer样条，最少需四个点");return}}else{if(t.length<3){alert("当前选中的类型最少需三个点");return}}this.partUrl="geomservice/smooth?f=json&type="+this.type+"&step="+this.step;var a=this.getFullUrl();var o=this;var s=new g.IgsServiceBase(a,{eventListeners:{scope:o,processCompleted:r,processFailed:i}});s.processAsync({method:"POST",data:(0,n.default)(t),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}}]);return t}(y.GeometryAnalysisBase);t.Smooth=x;v.Zondy.Service.Smooth=x},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.TopAnalysis=undefined;var i=r(9);var n=w(i);var a=r(2);var o=w(a);var s=r(1);var l=w(s);var u=r(5);var f=w(u);var c=r(3);var h=w(c);var p=r(4);var d=w(p);var v=r(0);var y=r(38);var m=r(10);var g=r(95);var _=r(96);var x=r(97);var b=r(6);function w(e){return e&&e.__esModule?e:{default:e}}var S=function(e){(0,d.default)(t,e);function t(e){(0,l.default)(this,t);var r=e?e:{};var i=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,r));i.pnt=r.pnt!==undefined?r.pnt:null;i.line=r.line!==undefined?r.line:null;i.reg=r.reg!==undefined?r.reg:null;i.nearDis=r.nearDis!==undefined?r.nearDis:.01;i.relativeObj=r.relativeObj!==undefined?r.relativeObj:null;i.p_onSuccess=r.p_onSuccess!==undefined?r.p_onSuccess:null;return i}(0,f.default)(t,[{key:"setPnt",value:function e(t){this.pnt=t}},{key:"setLine",value:function e(t){this.line=t}},{key:"setReg",value:function e(t){this.reg=t}},{key:"setRelativeObj",value:function e(t){this.relativeObj=t}},{key:"onGetRltSuccess",value:function e(t){var r=(0,b.getTopAnalysisResult)(t);this.p_onSuccess(r)}},{key:"execute",value:function e(t,r){var i=this;i.p_onSuccess=t;var a={};a.NearDis=this.nearDis;a.Pnt=this.pnt;a.Line=this.line;a.Reg=this.reg;a.RelativeObj=this.relativeObj;i.partUrl="geomservice/topanalysis?f=json";var o=i.getFullUrl();var i=this;var s=new m.IgsServiceBase(o,{eventListeners:{scope:i,processCompleted:i.onGetRltSuccess,processFailed:r}});s.processAsync({method:"POST",data:(0,n.default)(a),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}}]);return t}(y.GeometryAnalysisBase);t.TopAnalysis=S;v.Zondy.Service.TopAnalysis=S},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CoordinateElpTrans=undefined;var i=r(9);var n=g(i);var a=r(2);var o=g(a);var s=r(1);var l=g(s);var u=r(5);var f=g(u);var c=r(3);var h=g(c);var p=r(4);var d=g(p);var v=r(0);var y=r(38);var m=r(10);function g(e){return e&&e.__esModule?e:{default:e}}var _=function(e){(0,d.default)(t,e);function t(e){(0,l.default)(this,t);var r=e?e:{};var i=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,r));i.points=r.points!==undefined?r.points:"";i.dx=r.dx!==undefined?r.dx:"";i.dy=r.dy!==undefined?r.dy:"";i.dz=r.dz!==undefined?r.dz:"";i.m=r.m!==undefined?r.m:"";i.wx=r.wx!==undefined?r.wx:"";i.wy=r.wy!==undefined?r.wy:"";i.wz=r.wz!==undefined?r.wz:"";i.srcsrsname=r.srcsrsname!==undefined?r.srcsrsname:"";i.dessrsname=r.dessrsname!==undefined?r.dessrsname:"";return i}(0,f.default)(t,[{key:"coordinateTrans",value:function e(t,r,i){var a={};if(i!==null&&i.toUpperCase()==="POST"){a.paraValues="";this.partUrl="geomservice/transcoordinate?points="+this.points+"&dx="+this.dx+"&dy="+this.dy+"&dz="+this.dz+"&m="+this.m+"&wx="+this.wx+"&wy="+this.wy+"&wz="+this.wz+"&srcsrsname="+this.srcsrsname+"&dessrsname="+this.dessrsname}else{a=this;this.partUrl="geomservice/transcoordinate"}var o=this.getFullUrl();var s=this;var l=new m.IgsServiceBase(o,{eventListeners:{scope:s,processCompleted:t,processFailed:r}});if(i!==null&&i.toUpperCase()==="POST"){l.processAsync({method:"POST",data:(0,n.default)(a)})}else{l.processAsync()}}}]);return t}(y.GeometryAnalysisBase);t.CoordinateElpTrans=_;v.Zondy.Service.CoordinateTransform=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MapServiceBase=t.GetTileImageService=t.GetMapInfoService=t.GetMapImageService=t.GetLayerImageService=t.GetDocImageService=undefined;var i=r(362);var n=r(363);var a=r(364);var o=r(365);var s=r(366);var l=r(41);t.GetDocImageService=i.GetDocImageService;t.GetLayerImageService=n.GetLayerImageService;t.GetMapImageService=a.GetMapImageService;t.GetMapInfoService=o.GetMapInfoService;t.GetTileImageService=s.GetTileImageService;t.MapServiceBase=l.MapServiceBase},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GetDocImageService=undefined;var i=r(9);var n=_(i);var a=r(2);var o=_(a);var s=r(1);var l=_(s);var u=r(5);var f=_(u);var c=r(3);var h=_(c);var p=r(4);var d=_(p);var v=r(0);var y=r(41);var m=r(109);var g=r(6);function _(e){return e&&e.__esModule?e:{default:e}}var x=function(e){(0,d.default)(t,e);function t(e){(0,l.default)(this,t);var r=e||{};var i=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,r));i.docName=r.docName!==undefined?r.docName:null;i.cache=r.cache!==undefined?r.cache:false;if(i.cache){i.level=r.level!==undefined?r.level:0;i.row=r.row!==undefined?r.row:0;i.col=r.col!==undefined?r.col:0;i.update=r.update!==undefined?r.update:false}else{i.layers=r.layers!==undefined?r.layers:null;i.style=r.style!==undefined?r.style:null;i.picType=r.picType!==undefined?r.picType:"gif";i.bbox=r.bbox!==undefined?r.bbox:null;i.filters=r.filters!==undefined?r.filters:null;i.picWidth=r.picWidth!==undefined?r.picWidth:512;i.picHeight=r.picHeight!==undefined?r.picHeight:512;i.proj=r.proj!==undefined?r.proj:null;i.guid=r.guid!==undefined?r.guid:(0,g.newGuid)()}return i}(0,f.default)(t,[{key:"GetMapImage",value:function e(){if(this.docName){if(this.cache===true){this.partUrl="docs/"+this.docName+"?"+"cache="+this.cache.toString()+"&level="+this.level+"&row="+this.row+"&col="+this.col+"&update="+this.update.toString()}else{this.partUrl="docs/"+this.docName+"?";if(this.bbox!==null){this.partUrl+="bbox="+this.bbox}if(this.picWidth!==null){this.partUrl+="&w="+this.picWidth}if(this.picHeight!==null){this.partUrl+="&h="+this.picHeight}if(this.layers!==null){this.partUrl+="&layers="+this.layers}if(this.filters!==null){this.partUrl+="&filters="+encodeURI(this.filters)}if(this.style!==null){this.partUrl+="&style="+(0,n.default)(this.style)}if(this.proj!==null){this.partUrl+="&proj="+(0,n.default)(this.proj)}if(this.picType!==null){this.partUrl+="&f="+this.picType}if(this.guid!==null){this.partUrl+="&guid="+this.guid}}var t=this.getFullUrl();return t}return null}}]);return t}(y.MapServiceBase);t.GetDocImageService=x;v.Zondy.Service.GetDocImageService=x},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GetLayerImageService=undefined;var i=r(9);var n=g(i);var a=r(2);var o=g(a);var s=r(1);var l=g(s);var u=r(5);var f=g(u);var c=r(3);var h=g(c);var p=r(4);var d=g(p);var v=r(0);var y=r(41);var m=r(142);function g(e){return e&&e.__esModule?e:{default:e}}var _=function(e){(0,d.default)(t,e);function t(e){(0,l.default)(this,t);var r=e||{};var i=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,r));i.gdbps=r.gdbps!==undefined?r.gdbps:null;i.picType=r.picType!==undefined?r.picType:"gif";i.style=r.style!==undefined?r.style:null;i.bbox=r.bbox!==undefined?r.bbox:null;i.filters=r.filters!==undefined?r.filters:null;i.picWidth=r.picWidth!==undefined?r.picWidth:512;i.picHeight=r.picHeight!==undefined?r.picHeight:512;return i}(0,f.default)(t,[{key:"GetLayerImage",value:function e(){if(this.gdbps!==null&&this.picWidth!==null&&this.picHeight!==null){this.partUrl="layers?"+"f="+this.picType;this.partUrl+="&gdbps=";this.gdbps.split(",");var t=this.gdbps.split(",");for(var r=0;r<t.length;r++){this.partUrl+=t[r];if(r<t.length-1){this.partUrl+=","}}if(this.style!==null){this.partUrl+="&style="+(0,n.default)(this.style)}if(this.filters!==null){this.partUrl+="&filters="+this.filters}if(this.bbox!==null){this.partUrl+="&bbox="+this.bbox}this.partUrl+="&w="+this.picWidth;this.partUrl+="&h="+this.picHeight;var i=this.getFullUrl();return i}return null}}]);return t}(y.MapServiceBase);t.GetLayerImageService=_;v.Zondy.Service.GetLayerImageService=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GetMapImageService=undefined;var i=r(2);var n=y(i);var a=r(1);var o=y(a);var s=r(5);var l=y(s);var u=r(3);var f=y(u);var c=r(4);var h=y(c);var p=r(0);var d=r(41);var v=r(15);function y(e){return e&&e.__esModule?e:{default:e}}var m=function(e){(0,h.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.mapName=r.mapName!==undefined?r.mapName:null;i.mapType=r.mapType!==undefined?r.mapType:v.MapType.Doc;if(i.mapType===v.MapType.Tile){i.level=r.level!==undefined?r.level:0;i.row=r.row!==undefined?r.row:0;i.col=r.col!==undefined?r.col:0}else{i.picType=r.picType!==undefined?r.picType:"gif";i.picWidth=r.picWidth!==undefined?r.picWidth:512;i.picHeight=r.picHeight!==undefined?r.picHeight:512;i.xmin=r.xmin!==undefined?r.xmin:null;i.xmax=r.xmax!==undefined?r.xmax:null;i.ymin=r.ymin!==undefined?r.ymin:null;i.ymax=r.ymax!==undefined?r.ymax:null}return i}(0,l.default)(t,[{key:"GetImage",value:function e(){if(this.mapName){if(this.mapType===v.MapType.Tile){this.partUrl="tile/"+this.mapName+"?"+"lvl="+this.level+"&row="+this.row+"&col="+this.col}else{this.partUrl="map/"+this.mapName+"?"+"width="+this.picWidth+"&height="+this.picHeight+"&f="+this.picType;if(this.xmin!==null&&this.xmax!==null&&this.ymin!==null&&this.ymax!==null){this.partUrl+="&xmin="+this.xmin+"&ymin="+this.ymin+"&xmax="+this.xmax+"&ymax="+this.ymax}}var t=this.getFullUrl();return t}return null}}]);return t}(d.MapServiceBase);t.GetMapImageService=m;p.Zondy.Service.GetMapImageService=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GetMapInfoService=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(4);var h=m(c);var p=r(0);var d=r(41);var v=r(10);var y=r(6);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,h.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.mapName=r.mapName!==undefined?r.mapName:null;i.guid=r.guid!==undefined?r.guid:(0,y.newGuid)();i.token=r.token;i.type=r.type;return i}(0,l.default)(t,[{key:"GetMapInfo",value:function e(t,r){var i=this;if(i.mapName){i.partUrl="info/"+this.mapName;var n=[];if(i.guid){n.push("guid="+i.guid)}if(this.token){n.push("token="+i.token)}if(this.type){n.push("type="+i.type)}if(n.length>0){i.partUrl+="?"+n.join("&")}var a=i.getFullUrl();var o=new v.IgsServiceBase(a,{eventListeners:{scope:i,processCompleted:t,processFailed:r}});o.processAsync()}}}]);return t}(d.MapServiceBase);t.GetMapInfoService=g;p.Zondy.Service.GetMapInfoService=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GetTileImageService=undefined;var i=r(2);var n=v(i);var a=r(1);var o=v(a);var s=r(5);var l=v(s);var u=r(3);var f=v(u);var c=r(4);var h=v(c);var p=r(0);var d=r(41);function v(e){return e&&e.__esModule?e:{default:e}}var y=function(e){(0,h.default)(t,e);function t(e){(0,o.default)(this,t);var r=e||{};var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,r));i.hdfName=r.hdfName!==undefined?r.hdfName:null;i.level=r.level!==undefined?r.level:0;i.row=r.row!==undefined?r.row:0;i.col=r.col!==undefined?r.col:0;return i}(0,l.default)(t,[{key:"GetTileImage",value:function e(){if(this.hdfName!==undefined){this.partUrl="tile/"+this.hdfName+"/"+this.level+"/"+this.row+"/"+this.col;var t=this.getFullUrl();return t}return null}}]);return t}(d.MapServiceBase);t.GetTileImageService=y;p.Zondy.Service.GetTileImageService=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ThemesInfo=t.ThemeOper=t.ItemValue=t.FolderInfoAttribute=t.FolderInfo=t.ExpInfo=t.CUniqueThemeInfo=t.CUniqueTheme=t.CThemeInfo=t.CTheme=t.CSimpleTheme=t.CRegInfo=t.CRangeThemeInfo=t.CRangeTheme=t.CRandomTheme=t.CPntInfo=t.CMultiClassTheme=t.CLinInfo=t.CGraduatedSymbolTheme=t.CFourColorTheme=t.CDotDensityTheme=t.CChartType=t.CChartThemeRepresentInfo=t.CChartThemeInfo=t.CChartTheme=t.CChartLabelFormat=t.CAnnInfo=t.CAllOtherDataItemInfoSource=undefined;var i=r(169);var n=r(170);var a=r(171);var o=r(172);var s=r(174);var l=r(177);var u=r(173);var f=r(178);var c=r(179);var h=r(180);var p=r(175);var d=r(181);var v=r(65);var y=r(183);var m=r(184);var g=r(185);var _=r(176);var x=r(186);var b=r(22);var w=r(32);var S=r(187);var C=r(188);var T=r(182);var P=r(189);var M=r(110);var I=r(368);var A=r(369);var L=r(190);t.CAllOtherDataItemInfoSource=i.CAllOtherDataItemInfoSource;t.CAnnInfo=n.CAnnInfo;t.CChartLabelFormat=a.CChartLabelFormat;t.CChartTheme=o.CChartTheme;t.CChartThemeInfo=s.CChartThemeInfo;t.CChartThemeRepresentInfo=l.CChartThemeRepresentInfo;t.CChartType=u.CChartType;t.CDotDensityTheme=f.CDotDensityTheme;t.CFourColorTheme=c.CFourColorTheme;t.CGraduatedSymbolTheme=h.CGraduatedSymbolTheme;t.CLinInfo=p.CLinInfo;t.CMultiClassTheme=d.CMultiClassTheme;t.CPntInfo=v.CPntInfo;t.CRandomTheme=y.CRandomTheme;t.CRangeTheme=m.CRangeTheme;t.CRangeThemeInfo=g.CRangeThemeInfo;t.CRegInfo=_.CRegInfo;t.CSimpleTheme=x.CSimpleTheme;t.CTheme=b.CTheme;t.CThemeInfo=w.CThemeInfo;t.CUniqueTheme=S.CUniqueTheme;t.CUniqueThemeInfo=C.CUniqueThemeInfo;t.ExpInfo=T.ExpInfo;t.FolderInfo=P.FolderInfo;t.FolderInfoAttribute=M.FolderInfoAttribute;t.ItemValue=I.ItemValue;t.ThemeOper=A.ThemeOper;t.ThemesInfo=L.ThemesInfo},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ItemValue=undefined;var i=r(0);var n=r(6);var a=r(15);var o=function e(t,r,i,o){var s=o!==undefined?o:{};(0,n.extend)(this,s);this.StartValue=t!==undefined?t:"";this.EndValue=r!==undefined?r:"";this.ClassItemType=i!==undefined?i:a.CItemType.RangeTheme};t.ItemValue=o;i.Zondy.Object.Theme.ItemValue=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ThemeOper=undefined;var i=r(9);var n=E(i);var a=r(2);var o=E(a);var s=r(1);var l=E(s);var u=r(5);var f=E(u);var c=r(3);var h=E(c);var p=r(4);var d=E(p);var v=r(0);var y=r(27);var m=r(6);var g=r(10);var _=r(181);var x=r(186);var b=r(172);var w=r(180);var S=r(178);var C=r(183);var T=r(179);var P=r(187);var M=r(184);var I=r(110);var A=r(189);var L=r(190);function E(e){return e&&e.__esModule?e:{default:e}}var k=function(e){(0,d.default)(t,e);function t(e,r){(0,l.default)(this,t);var r=r||{};r.baseUrl="igs/rest/theme";var i=(0,h.default)(this,(t.__proto__||(0,o.default)(t)).call(this,r));if(e!==null){i.guid=e}else{i.guid=(0,m.newGuid)()}i.p_onSuccess=r.p_onSuccess!==undefined?r.p_onSuccess:null;return i}(0,f.default)(t,[{key:"onGetThemesInfoSuccess",value:function e(t){var r=new A.FolderInfo;(0,m.extendDeep)(r,t.result||t);if(r!==null&&r.attribute!==null&&r.attribute.length>0){var i=[];var n=null;for(var a=0;a<r.attribute.length;a++){i[a]=new L.ThemesInfo;if(r.attribute[a]!==null){i[a].LayerName=r.attribute[a].name;n=JSON.parse(r.attribute[a].value);if(n!==null&&n.length>0){i[a].ThemeArr=[];for(var o=0;o<n.length;o++){switch(n[o].name){case"CMultiClassTheme":i[a].ThemeArr[o]=new _.CMultiClassTheme;break;case"CSimpleTheme":i[a].ThemeArr[o]=new x.CSimpleTheme;break;case"CChartTheme":i[a].ThemeArr[o]=new b.CChartTheme;break;case"CGraduatedSymbolTheme":i[a].ThemeArr[o]=new w.CGraduatedSymbolTheme;break;case"CDotDensityTheme":i[a].ThemeArr[o]=new S.CDotDensityTheme;break;case"CRandomTheme":i[a].ThemeArr[o]=new C.CRandomTheme;break;case"CFourColorTheme":i[a].ThemeArr[o]=new T.CFourColorTheme;break;case"CUniqueTheme":i[a].ThemeArr[o]=new P.CUniqueTheme;break;case"CRangeTheme":i[a].ThemeArr[o]=new M.CRangeTheme;break}(0,m.extendDeep)(i[a].ThemeArr[o],JSON.parse(n[o].value))}}}}if(this.p_onSuccess!==null&&typeof this.p_onSuccess==="function"){this.p_onSuccess(i)}}}},{key:"getThemesInfo",value:function e(t,r,i,n){var a=this;a.p_onSuccess=i;var o=Math.random();a.partUrl=t+"/get?idxArr="+r+"&r="+o+"&guid="+a.guid;var s=a.getFullUrl();var l=new g.IgsServiceBase(s,{eventListeners:{scope:a,processCompleted:a.onGetThemesInfoSuccess,processFailed:n}});l.processAsync()}},{key:"removeThemesInfo",value:function e(t,r,i,n){var a=this;var o=Math.random();a.partUrl=t+"/remove?idxArr="+r+"&r="+o+"&guid="+a.guid;var s=a.getFullUrl();var l=new g.IgsServiceBase(s,{eventListeners:{scope:a,processCompleted:i,processFailed:n}});l.processAsync()}},{key:"updateThemesInfo",value:function e(t,r,i,a,o){var s=this;var l=Math.random();s.partUrl=t+"/update?idxArr="+r+"&guid="+this.guid;var u=s.getFullUrl();var f=new A.FolderInfo;if(i!==null&&i.length>0){f.name="ThemeInfo";f.attribute=[];for(var c=0;c<i.length;c++){f.attribute[c]=new I.FolderInfoAttribute;f.attribute[c].name=i[c].LayerName;if(i[c].ThemeArr!==null&&i[c].ThemeArr.length>0){var h=[];for(var p=0;p<i[c].ThemeArr.length;p++){if(i[c].ThemeArr[p]!==null)h[p]=new I.FolderInfoAttribute(i[c].ThemeArr[p].Type,(0,n.default)(i[c].ThemeArr[p]))}f.attribute[c].value=(0,n.default)(h)}}}var d=new g.IgsServiceBase(u,{eventListeners:{scope:s,processCompleted:a,processFailed:o}});d.processAsync({method:"POST",data:(0,n.default)(f),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}},{key:"addThemesInfo",value:function e(t,r,i,a,o){var s=this;var l=Math.random();s.partUrl=t+"/add?idxArr="+r+"&guid="+this.guid;var u=s.getFullUrl();var f=new A.FolderInfo;if(i!==null&&i.length>0){f.name="ThemeInfo";f.attribute=[];for(var c=0;c<i.length;c++){f.attribute[c]=new I.FolderInfoAttribute;f.attribute[c].name=i[c].LayerName;if(i[c].ThemeArr!==null&&i[c].ThemeArr.length>0){var h=[];for(var p=0;p<i[c].ThemeArr.length;p++){if(i[c].ThemeArr[p]!==null)h[p]=new I.FolderInfoAttribute(i[c].ThemeArr[p].Type,(0,n.default)(i[c].ThemeArr[p]))}f.attribute[c].value=(0,n.default)(h)}}}var d=new g.IgsServiceBase(u,{eventListeners:{scope:s,processCompleted:a,processFailed:o}});d.processAsync({method:"POST",data:(0,n.default)(f),headers:{"Content-Type":"text/plain;charset=UTF-8"}})}}]);return t}(y.ServiceBase);t.ThemeOper=k;v.Zondy.Service.ThemeOper=k},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.uniqueTheme3DLayer=t.UniqueTheme3DLayer=t.rangeTheme3DLayer=t.RangeTheme3DLayer=t.Theme3DLayer=t.ThemeStyle=t.RankSymbolThemeLayer=t.SimpleThemeLayer=t.RandomThemeLayer=t.graphThemeLayer=t.GraphThemeLayer=t.UniqueThemeLayer=t.rangeThemeLayer=t.RangeThemeLayer=t.ThemeLayer=t.GeoFeatureThemeLayer=undefined;var i=r(66);var n=r(111);var a=r(214);var o=r(371);var s=r(217);var l=r(385);var u=r(386);var f=r(387);var c=r(388);var h=r(119);var p=r(389);var d=r(390);t.GeoFeatureThemeLayer=i.GeoFeatureThemeLayer;t.ThemeLayer=n.ThemeLayer;t.RangeThemeLayer=a.RangeThemeLayer;t.rangeThemeLayer=a.rangeThemeLayer;t.UniqueThemeLayer=o.UniqueThemeLayer;t.GraphThemeLayer=s.GraphThemeLayer;t.graphThemeLayer=s.graphThemeLayer;t.RandomThemeLayer=l.RandomThemeLayer;t.SimpleThemeLayer=u.SimpleThemeLayer;t.RankSymbolThemeLayer=f.RankSymbolThemeLayer;t.ThemeStyle=c.ThemeStyle;t.Theme3DLayer=h.Theme3DLayer;t.RangeTheme3DLayer=p.RangeTheme3DLayer;t.rangeTheme3DLayer=p.rangeTheme3DLayer;t.UniqueTheme3DLayer=d.UniqueTheme3DLayer;t.uniqueTheme3DLayer=d.uniqueTheme3DLayer},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.uniqueThemeLayer=undefined;var i=r(2);var n=x(i);var a=r(1);var o=x(a);var s=r(5);var l=x(s);var u=r(3);var f=x(u);var c=r(4);var h=x(c);var p=r(25);var d=x(p);var v=r(0);var y=r(6);var m=r(214);var g=r(13);var _=r(215);function x(e){return e&&e.__esModule?e:{default:e}}var b=function(e){(0,h.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r));i.themeField=r.themeField;i.style=r.style;i.styleGroups=r.styleGroups;i.isHoverAble=r.isHoverAble;i.highlightStyle=r.highlightStyle;return i}(0,l.default)(t,[{key:"createThematicFeature",value:function e(t){var r=this.getStyleByData(t);var i={};i.nodesClipPixel=this.nodesClipPixel;i.isHoverAble=this.isHoverAble;i.isMultiHover=this.isMultiHover;i.isClickAble=this.isClickAble;i.highlightStyle=g.ShapeFactory.transformStyle(this.highlightStyle);var n=new _.ThemeVector(t,this,g.ShapeFactory.transformStyle(r),i);for(var a=0;a<n.shapes.length;a++){this.renderer.addShape(n.shapes[a])}return n}},{key:"getStyleByData",value:function e(t){var r={};var i=t;r=(0,y.copyAttributesWithClip)(r,this.style);if(this.themeField&&this.styleGroups&&this.styleGroups.length>0&&i.attributes){var n=this.themeField;var a=i.attributes;var o=this.styleGroups;var s=false;var l=null;for(var u in a){if(n===u){s=true;l=a[u];break}}if(s){for(var f=0,c=o.length;f<c;f++){if(l.toString()===o[f].value.toString()){var h=o[f].style;r=(0,y.copyAttributesWithClip)(r,h)}}}}if(i.style&&this.isAllowFeatureStyle===true){r=(0,y.copyAttributesWithClip)(i.style)}return r}}]);return t}(m.RangeThemeLayer);var w=t.uniqueThemeLayer=function e(t,r){return new b(t,r)};v.Zondy.Map.uniqueThemeLayer=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Bar=undefined;var i=r(2);var n=b(i);var a=r(1);var o=b(a);var s=r(5);var l=b(s);var u=r(3);var f=b(u);var c=r(7);var h=b(c);var p=r(4);var d=b(p);var v=r(0);var y=r(6);var m=r(13);var g=r(71);var _=r(112);var x=r(33);function b(e){return e&&e.__esModule?e:{default:e}}var w=function(e){(0,d.default)(t,e);function t(e,r,i,a,s,l){(0,o.default)(this,t);var u=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i,a,s,l));u.CLASS_NAME="Zondy.Theme.Bar";return u}(0,l.default)(t,[{key:"destroy",value:function e(){(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"assembleShapes",value:function e(){var t=[["#00FF00","#00CD00"],["#00CCFF","#5E87A2"],["#00FF66","#669985"],["#CCFF00","#94A25E"],["#FF9900","#A2945E"]];var r={showShadow:true,shadowBlur:8,shadowColor:"rgba(100,100,100,0.8)",shadowOffsetX:2,shadowOffsetY:2};var i=this.setting;if(!i.barLinearGradient){i.barLinearGradient=t}if(!i.dataViewBoxParameter){if(typeof i.useAxis==="undefined"||i.useAxis){i.dataViewBoxParameter=[45,15,15,15]}else{i.dataViewBoxParameter=[5,5,5,5]}}if(!this.initBaseParameter()){return}var n=this.DVBCodomain;this.DVBUnitValue=(n[1]-n[0])/this.DVBHeight;var a=this.dataViewBox;var o=this.dataValues;if(o.length<1){return}for(var s=0,l=o.length;s<l;s++){if(o[s]<n[0]||o[s]>n[1]){return}}var u=this.calculateXShapeInfo();if(!u){return}var f=u.xPositions;var c=u.width;if(typeof i.useBackground==="undefined"||i.useBackground){this.shapes.push(m.ShapeFactory.Background(this.shapeFactory,this.chartBox,i))}if(typeof i.useAxis==="undefined"||i.useAxis){this.shapes=this.shapes.concat(m.ShapeFactory.GraphAxis(this.shapeFactory,a,i,u))}for(var h=0;h<o.length;h++){var p=a[1]-(o[h]-n[0])/this.DVBUnitValue;var d=[[f[h]-c/2,a[1]-1],[f[h]+c/2,a[1]-1],[f[h]+c/2,p],[f[h]-c/2,p]];var v=new g.Polygon(d);if(typeof i.showShadow==="undefined"||i.showShadow){if(i.barShadowStyle){var _=i.barShadowStyle;if(_.shadowBlur){r.shadowBlur=_.shadowBlur}if(_.shadowColor){r.shadowColor=_.shadowColor}if(_.shadowOffsetX){r.shadowOffsetX=_.shadowOffsetX}if(_.shadowOffsetY){r.shadowOffsetY=_.shadowOffsetY}}v.style={};(0,y.copyAttributesWithClip)(v.style,r)}v.refDataID=this.data.FID;v.dataInfo={field:this.fields[h],value:o[h]};if(typeof i.barHoverAble!=="undefined"){v.hoverable=i.barHoverAble}if(typeof i.barClickAble!=="undefined"){v.clickable=i.barClickAble}this.shapes.push(this.shapeFactory.createShape(v))}this.shapesConvertToRelativeCoordinate()}},{key:"calculateXShapeInfo",value:function e(){var t=this.dataViewBox;var r=this.setting;var i=this.dataValues.length;if(i<1){return null}var n;var a=[];var o=0;var s=this.DVBWidth;if(r.xShapeBlank&&r.xShapeBlank.length&&r.xShapeBlank.length===3){n=r.xShapeBlank;var l=s-(n[0]+n[2]+(i-1)*n[1]);if(l<=i){return null}o=l/i}else{o=s/(2*i+1);n=[o,o,o]}var u=0;for(var f=0;f<i;f++){if(f===0){u=n[0]+o/2}else{u+=o+n[1]}a.push(t[0]+u)}return{xPositions:a,width:o}}},{key:"resetLinearGradient",value:function e(){if(this.RelativeCoordinate){var t=this.shapes.length;var r=this.setting.barLinearGradient;var i=-1;for(var n=0;n<t;n++){var a=this.shapes[n];if(a.CLASS_NAME==="Zondy.LevelRenderer.Shape.SmicPolygon"){var o=a.style;var s=this.location[0]+o.pointList[0][0];var l=this.location[0]+o.pointList[1][0];i++;if(i>=r.length){i=i%r.length}var u=r[i][0];var f=r[i][1];var c=new _.Color;var h=c.getLinearGradient(s,0,l,0,[[0,u],[1,f]]);a.style.color=h}}}}}]);return t}(x.Graph);t.Bar=w;v.Zondy.Theme.Bar=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Bar3D=undefined;var i=r(2);var n=x(i);var a=r(1);var o=x(a);var s=r(5);var l=x(s);var u=r(3);var f=x(u);var c=r(7);var h=x(c);var p=r(4);var d=x(p);var v=r(0);var y=r(6);var m=r(13);var g=r(71);var _=r(33);function x(e){return e&&e.__esModule?e:{default:e}}var b=function(e){(0,d.default)(t,e);function t(e,r,i,a,s,l){(0,o.default)(this,t);var u=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i,a,s,l));u.CLASS_NAME="Zondy.Theme.Bar3D";return u}(0,l.default)(t,[{key:"destroy",value:function e(){(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"assembleShapes",value:function e(){var t=this.setting;if(!t.dataViewBoxParameter){if(typeof t.useAxis==="undefined"||t.useAxis){t.dataViewBoxParameter=[45,25,20,20]}else{t.dataViewBoxParameter=[5,5,5,5]}}t.axisUseArrow=typeof t.axisUseArrow!=="undefined"?t.axisUseArrow:true;t.axisXLabelsOffset=typeof t.axisXLabelsOffset!=="undefined"?t.axisXLabelsOffset:[-10,10];if(!this.initBaseParameter()){return}var r=this.DVBCodomain;this.DVBUnitValue=(r[1]-r[0])/this.DVBHeight;var i=this.dataViewBox;var n=this.dataValues;if(n.length<1){return}for(var a=0,o=n.length;a<o;a++){if(n[a]<r[0]||n[a]>r[1]){return}}var s=this.calculateXShapeInfo();if(!s){return}var l=s.xPositions;var u=s.width;if(typeof t.useBackground==="undefined"||t.useBackground){this.shapes.push(m.ShapeFactory.Background(this.shapeFactory,this.chartBox,t))}if(!t.axis3DParameter||isNaN(t.axis3DParameter)||t.axis3DParameter<15){t.axis3DParameter=20}if(typeof t.useAxis==="undefined"||t.useAxis){this.shapes=this.shapes.concat(m.ShapeFactory.GraphAxis(this.shapeFactory,i,t,s))}var f=t.bar3DParameter&&!isNaN(t.bar3DParameter)?t.bar3DParameter:10;for(var c=0;c<n.length;c++){var h=i[1]-(n[c]-r[0])/this.DVBUnitValue;var p=l[c]-u/2;var d=l[c]+u/2;var v=[[p,h],[d,h],[d-f,h+f],[p-f,h+f]];var _=[[d,h],[d-f,h+f],[d-f,i[1]+f],[d,i[1]]];var x=[[p-f,i[1]+f],[d-f,i[1]+f],[d-f,h+f],[p-f,h+f]];if(f<=0){x=[[p,i[1]],[d,i[1]],[d,h],[p,h]]}var b=new g.Polygon(v);var w=new g.Polygon(_);var S=new g.Polygon(x);t.barSideStyle=t.barSideStyle?t.barSideStyle:t.barFaceStyle;t.barSideStyleByFields=t.barSideStyleByFields?t.barSideStyleByFields:t.barFaceStyleByFields;t.barSideStyleByCodomain=t.barSideStyleByCodomain?t.barSideStyleByCodomain:t.barFaceStyleByCodomain;t.barTopStyle=t.barTopStyle?t.barTopStyle:t.barFaceStyle;t.barTopStyleByFields=t.barTopStyleByFields?t.barTopStyleByFields:t.barFaceStyleByFields;t.barTopStyleByCodomain=t.barTopStyleByCodomain?t.barTopStyleByCodomain:t.barFaceStyleByCodomain;S.style=m.ShapeFactory.ShapeStyleTool({stroke:true,strokeColor:"#ffffff",fillColor:"#ee9900"},t.barFaceStyle,t.barFaceStyleByFields,t.barFaceStyleByCodomain,c,n[c]);w.style=m.ShapeFactory.ShapeStyleTool({stroke:true,strokeColor:"#ffffff",fillColor:"#ee9900"},t.barSideStyle,t.barSideStyleByFields,t.barSideStyleByCodomain,c,n[c]);b.style=m.ShapeFactory.ShapeStyleTool({stroke:true,strokeColor:"#ffffff",fillColor:"#ee9900"},t.barTopStyle,t.barTopStyleByFields,t.barTopStyleByCodomain,c,n[c]);t.barSideHoverStyle=t.barSideHoverStyle?t.barSideHoverStyle:t.barFaceHoverStyle;t.barTopHoverStyle=t.barTopHoverStyle?t.barTopHoverStyle:t.barFaceHoverStyle;S.highlightStyle=m.ShapeFactory.ShapeStyleTool({stroke:true},t.barFaceHoverStyle);w.highlightStyle=m.ShapeFactory.ShapeStyleTool({stroke:true},t.barSideHoverStyle);b.highlightStyle=m.ShapeFactory.ShapeStyleTool({stroke:true},t.barTopHoverStyle);b.refDataID=w.refDataID=S.refDataID=this.data.FID;b.isHoverByRefDataID=w.isHoverByRefDataID=S.isHoverByRefDataID=true;b.refDataHoverGroup=w.refDataHoverGroup=S.refDataHoverGroup=(0,y.newGuid)();b.dataInfo=w.dataInfo=S.dataInfo={field:this.fields[c],value:n[c]};if(typeof t.barHoverAble!=="undefined"){b.hoverable=w.hoverable=S.hoverable=t.barHoverAble}if(typeof t.barClickAble!=="undefined"){b.clickable=w.clickable=S.clickable=t.barClickAble}this.shapes.push(this.shapeFactory.createShape(w));this.shapes.push(this.shapeFactory.createShape(b));this.shapes.push(this.shapeFactory.createShape(S))}this.shapesConvertToRelativeCoordinate()}},{key:"calculateXShapeInfo",value:function e(){var t=this.dataViewBox;var r=this.setting;var i=this.dataValues.length;if(i<1){return null}var n;var a=[];var o=0;var s=this.DVBWidth;if(r.xShapeBlank&&r.xShapeBlank.length&&r.xShapeBlank.length===3){n=r.xShapeBlank;var l=s-(n[0]+n[2]+(i-1)*n[1]);if(l<=i){return null}o=l/i}else{o=s/(2*i+1);n=[o,o,o]}var u=0;for(var f=0;f<i;f++){if(f===0){u=n[0]+o/2}else{u+=o+n[1]}a.push(t[0]+u)}return{xPositions:a,width:o}}}]);return t}(_.Graph);t.Bar3D=b;v.Zondy.Theme.Bar3D=b},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Circle=undefined;var i=r(2);var n=x(i);var a=r(1);var o=x(a);var s=r(5);var l=x(s);var u=r(3);var f=x(u);var c=r(7);var h=x(c);var p=r(4);var d=x(p);var v=r(0);var y=r(43);var m=r(116);var g=r(13);var _=r(216);function x(e){return e&&e.__esModule?e:{default:e}}var b=function(e){(0,d.default)(t,e);function t(e,r,i,a,s,l){(0,o.default)(this,t);var u=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i,a,s,l));u.CLASS_NAME="Zondy.Theme.Circle";return u}(0,l.default)(t,[{key:"destroy",value:function e(){(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"assembleShapes",value:function e(){var t="#ff9277";if(!this.setting){return false}var r=this.setting;if(!r.codomain){return false}var i=typeof r.decimalNumber!=="undefined"&&!isNaN(r.decimalNumber)?r.decimalNumber:-1;var n=y.Theme.getDataValues(this.data,this.fields,i);this.dataValues=n?n:[];var a=this.dataValues;if(!r.maxR){r.maxR=100}if(!r.minR){r.minR=0}var o=this.DVBCodomain;if(o&&o[1]-o[0]>0){this.DVBUnitValue=r.maxR/(o[1]-o[0])}else{this.DVBUnitValue=r.maxR}var s=this.DVBUnitValue;var l=a[0]*s+r.minR;this.width=2*l;this.height=2*l;if(!this.initBaseParameter()){return}if(o){if(a[0]<o[0]||a[0]>o[1]){return}}var u=this.DVBCenterPoint;var f=new m.Circle(u[0],u[1],l);f.style=g.ShapeFactory.ShapeStyleTool(null,r.circleStyle,null,null,0);if(typeof r.fillColor!=="undefined"){f.style.fillColor=r.fillColor}else{f.style.fillColor=t}f.highlightStyle=g.ShapeFactory.ShapeStyleTool(null,r.circleHoverStyle);if(typeof r.circleHoverAble!=="undefined"){f.hoverable=r.circleHoverAble}if(typeof r.circleClickAble!=="undefined"){f.clickable=r.circleClickAble}f.refDataID=this.data.FID;f.dataInfo={field:this.fields[0],r:l,value:a[0]};this.shapes.push(this.shapeFactory.createShape(f));this.shapesConvertToRelativeCoordinate()}}]);return t}(_.RankSymbol);t.Circle=b;v.Zondy.Theme.Circle=b},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Line=undefined;var i=r(2);var n=x(i);var a=r(1);var o=x(a);var s=r(5);var l=x(s);var u=r(3);var f=x(u);var c=r(7);var h=x(c);var p=r(4);var d=x(p);var v=r(0);var y=r(13);var m=r(70);var g=r(115);var _=r(33);function x(e){return e&&e.__esModule?e:{default:e}}var b=function(e){(0,d.default)(t,e);function t(e,r,i,a,s,l){(0,o.default)(this,t);var u=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i,a,s,l));u.CLASS_NAME="Zondy.Theme.Line";return u}(0,l.default)(t,[{key:"destroy",value:function e(){(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"assembleShapes",value:function e(){var t=this.setting;if(!t.dataViewBoxParameter){if(typeof t.useAxis==="undefined"||t.useAxis){t.dataViewBoxParameter=[45,15,15,15]}else{t.dataViewBoxParameter=[5,5,5,5]}}if(!this.initBaseParameter()){return}var r=this.dataViewBox;var i=this.DVBCodomain;this.DVBUnitValue=(i[1]-i[0])/this.DVBHeight;var n=this.DVBUnitValue;var a=this.dataValues;if(a.length<1){return}var o=this.calculateXShapeInfo();if(!o){return}var s=o.xPositions;if(typeof t.useBackground==="undefined"||t.useBackground){this.shapes.push(y.ShapeFactory.Background(this.shapeFactory,this.chartBox,t))}this.shapes=this.shapes.concat(y.ShapeFactory.GraphAxis(this.shapeFactory,r,t,o));var l;var u;var f=[];var c=[];for(var h=0,p=a.length;h<p;h++){if(a[h]<i[0]||a[h]>i[1]){return null}l=s[h];u=r[1]-(a[h]-i[0])/n;var d=new m.Point(l,u);d.style=y.ShapeFactory.ShapeStyleTool({fillColor:"#ee9900"},t.pointStyle,t.pointStyleByFields,t.pointStyleByCodomain,h,a[h]);d.highlightStyle=y.ShapeFactory.ShapeStyleTool(null,t.pointHoverStyle);if(typeof t.pointHoverAble!=="undefined"){d.hoverable=t.pointHoverAble}if(typeof t.pointClickAble!=="undefined"){d.clickable=t.pointClickAble}d.refDataID=this.data.FID;d.dataInfo={field:this.fields[h],value:a[h]};c.push(this.shapeFactory.createShape(d));var v=[l,u];f.push(v)}var _=new g.Line(f);_.style=y.ShapeFactory.ShapeStyleTool({strokeColor:"#ee9900"},t.lineStyle);_.clickable=false;_.hoverable=false;var x=this.shapeFactory.createShape(_);this.shapes.push(x);this.shapes=this.shapes.concat(c);this.shapesConvertToRelativeCoordinate()}},{key:"calculateXShapeInfo",value:function e(){var t=this.dataViewBox;var r=this.setting;var i=this.dataValues.length;if(i<1){return null}var n;var a=[];var o=0;var s=this.DVBWidth;var l=0;if(r.xShapeBlank&&r.xShapeBlank.length&&r.xShapeBlank.length===2){n=r.xShapeBlank;var u=s-(n[0]+n[1]);if(u<=i){return null}l=u/(i-1)}else{l=s/(i+1);n=[l,l,l]}var f=0;for(var c=0;c<i;c++){if(c===0){f=n[0]}else{f+=l}a.push(t[0]+f)}return{xPositions:a,width:o}}}]);return t}(_.Graph);t.Line=b;v.Zondy.Theme.Line=b},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Pie=undefined;var i=r(2);var n=_(i);var a=r(1);var o=_(a);var s=r(5);var l=_(s);var u=r(3);var f=_(u);var c=r(7);var h=_(c);var p=r(4);var d=_(p);var v=r(0);var y=r(13);var m=r(72);var g=r(33);function _(e){return e&&e.__esModule?e:{default:e}}var x=function(e){(0,d.default)(t,e);function t(e,r,i,a,s,l){(0,o.default)(this,t);var u=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i,a,s,l));u.CLASS_NAME="Zondy.Theme.Pie";return u}(0,l.default)(t,[{key:"destroy",value:function e(){(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"assembleShapes",value:function e(){var t=this.setting;var r=[{fillColor:"#ff9277"},{fillColor:"#dddd00"},{fillColor:"#ffc877"},{fillColor:"#bbe3ff"},{fillColor:"#d5ffbb"},{fillColor:"#bbbbff"},{fillColor:"#ddb000"},{fillColor:"#b0dd00"},{fillColor:"#e2bbff"},{fillColor:"#ffbbe3"},{fillColor:"#ff7777"},{fillColor:"#ff9900"},{fillColor:"#83dd00"},{fillColor:"#77e3ff"},{fillColor:"#778fff"},{fillColor:"#c877ff"},{fillColor:"#ff77ab"},{fillColor:"#ff6600"},{fillColor:"#aa8800"},{fillColor:"#77c7ff"},{fillColor:"#ad77ff"},{fillColor:"#ff77ff"},{fillColor:"#dd0083"},{fillColor:"#777700"},{fillColor:"#00aa00"},{fillColor:"#0088aa"},{fillColor:"#8400dd"},{fillColor:"#aa0088"},{fillColor:"#dd0000"},{fillColor:"#772e00"}];if(!this.initBaseParameter()){return}if(t.useBackground){this.shapes.push(y.ShapeFactory.Background(this.shapeFactory,this.chartBox,t))}var i=this.dataValues;if(i.length<1){return}var n=this.DVBCodomain;for(var a=0;a<i.length;a++){if(i[a]<n[0]||i[a]>n[1]){return}}var o=0;for(var s=0;s<i.length;s++){o+=Math.abs(i[s])}this.DVBUnitValue=360/o;var l=this.DVBUnitValue;var u=this.DVBCenterPoint;var f=0;var c=0;var h=f;var p=this.DVBHeight<this.DVBWidth?this.DVBHeight/2:this.DVBWidth/2;for(var d=0;d<i.length;d++){var v=Math.abs(i[d]);if(d===0){c=f+v*l}else if(d===v.length-1){c=h}else{c=f+v*l}if(c-f>=360){c=359.9999999}var g=new m.Sector(u[0],u[1],p,f,c);if(typeof t.sectorStyleByFields==="undefined"){var _=d%r.length;g.style=y.ShapeFactory.ShapeStyleTool(null,t.sectorStyle,r,null,_)}else{g.style=y.ShapeFactory.ShapeStyleTool(null,t.sectorStyle,t.sectorStyleByFields,t.sectorStyleByCodomain,d,i[d])}g.highlightStyle=y.ShapeFactory.ShapeStyleTool(null,t.sectorHoverStyle);if(typeof t.sectorHoverAble!=="undefined"){g.hoverable=t.sectorHoverAble}if(typeof t.sectorClickAble!=="undefined"){g.clickable=t.sectorClickAble}g.refDataID=this.data.FID;g.dataInfo={field:this.fields[d],value:i[d]};this.shapes.push(this.shapeFactory.createShape(g));f=c}this.shapesConvertToRelativeCoordinate()}}]);return t}(g.Graph);t.Pie=x;v.Zondy.Theme.Pie=x},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Point=undefined;var i=r(2);var n=_(i);var a=r(1);var o=_(a);var s=r(5);var l=_(s);var u=r(3);var f=_(u);var c=r(7);var h=_(c);var p=r(4);var d=_(p);var v=r(0);var y=r(13);var m=r(70);var g=r(33);function _(e){return e&&e.__esModule?e:{default:e}}var x=function(e){(0,d.default)(t,e);function t(e,r,i,a,s,l){(0,o.default)(this,t);var u=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i,a,s,l));u.CLASS_NAME="Zondy.Theme.Point";return u}(0,l.default)(t,[{key:"destroy",value:function e(){(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"assembleShapes",value:function e(){var t=this.setting;if(!t.dataViewBoxParameter){if(typeof t.useAxis==="undefined"||t.useAxis){t.dataViewBoxParameter=[45,15,15,15]}else{t.dataViewBoxParameter=[5,5,5,5]}}if(!this.initBaseParameter()){return}var r=this.dataViewBox;var i=this.DVBCodomain;this.DVBUnitValue=(i[1]-i[0])/this.DVBHeight;var n=this.DVBUnitValue;var a=this.dataValues;var o=this.calculateXShapeInfo();if(!o){return}var s=o.xPositions;if(typeof t.useBackground==="undefined"||t.useBackground){this.shapes.push(y.ShapeFactory.Background(this.shapeFactory,this.chartBox,t))}this.shapes=this.shapes.concat(y.ShapeFactory.GraphAxis(this.shapeFactory,r,t,o));var l;var u;for(var f=0,c=a.length;f<c;f++){if(a[f]<i[0]||a[f]>i[1]){return null}l=s[f];u=r[1]-(a[f]-i[0])/n;var h=new m.Point(l,u);h.style=y.ShapeFactory.ShapeStyleTool({fillColor:"#ee9900"},t.pointStyle,t.pointStyleByFields,t.pointStyleByCodomain,f,a[f]);h.highlightStyle=y.ShapeFactory.ShapeStyleTool(null,t.pointHoverStyle);if(typeof t.pointHoverAble!=="undefined"){h.hoverable=t.pointHoverAble}if(typeof t.pointClickAble!=="undefined"){h.clickable=t.pointClickAble}h.refDataID=this.data.FID;h.dataInfo={field:this.fields[f],value:a[f]};this.shapes.push(this.shapeFactory.createShape(h))}this.shapesConvertToRelativeCoordinate()}},{key:"calculateXShapeInfo",value:function e(){var t=this.dataViewBox;var r=this.setting;var i=this.dataValues.length;if(i<1){return null}var n;var a=[];var o=0;var s=this.DVBWidth;var l=0;if(r.xShapeBlank&&r.xShapeBlank.length&&r.xShapeBlank.length===2){n=r.xShapeBlank;var u=s-(n[0]+n[1]);if(u<=i){return null}l=u/(i-1)}else{l=s/(i+1);n=[l,l,l]}var f=0;for(var c=0;c<i;c++){if(c===0){f=n[0]}else{f+=l}a.push(t[0]+f)}return{xPositions:a,width:o}}}]);return t}(g.Graph);t.Point=x;v.Zondy.Theme.Point=x},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Ring=undefined;var i=r(2);var n=_(i);var a=r(1);var o=_(a);var s=r(5);var l=_(s);var u=r(3);var f=_(u);var c=r(7);var h=_(c);var p=r(4);var d=_(p);var v=r(0);var y=r(13);var m=r(72);var g=r(33);function _(e){return e&&e.__esModule?e:{default:e}}var x=function(e){(0,d.default)(t,e);function t(e,r,i,a,s,l){(0,o.default)(this,t);var u=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i,a,s,l));u.CLASS_NAME="Zondy.Theme.Ring";return u}(0,l.default)(t,[{key:"destroy",value:function e(){(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"assembleShapes",value:function e(){if(!this.initBaseParameter()){return}var t=[{fillColor:"#ff9277"},{fillColor:"#dddd00"},{fillColor:"#ffc877"},{fillColor:"#bbe3ff"},{fillColor:"#d5ffbb"},{fillColor:"#bbbbff"},{fillColor:"#ddb000"},{fillColor:"#b0dd00"},{fillColor:"#e2bbff"},{fillColor:"#ffbbe3"},{fillColor:"#ff7777"},{fillColor:"#ff9900"},{fillColor:"#83dd00"},{fillColor:"#77e3ff"},{fillColor:"#778fff"},{fillColor:"#c877ff"},{fillColor:"#ff77ab"},{fillColor:"#ff6600"},{fillColor:"#aa8800"},{fillColor:"#77c7ff"},{fillColor:"#ad77ff"},{fillColor:"#ff77ff"},{fillColor:"#dd0083"},{fillColor:"#777700"},{fillColor:"#00aa00"},{fillColor:"#0088aa"},{fillColor:"#8400dd"},{fillColor:"#aa0088"},{fillColor:"#dd0000"},{fillColor:"#772e00"}];var r=this.setting;if(r.useBackground){this.shapes.push(y.ShapeFactory.Background(this.shapeFactory,this.chartBox,r))}var i=this.dataValues;if(i.length<1){return}var n=this.DVBCodomain;for(var a=0;a<i.length;a++){if(i[a]<n[0]||i[a]>n[1]){return}}var o=0;for(var s=0;s<i.length;s++){o+=Math.abs(i[s])}this.DVBUnitValue=360/o;var l=this.DVBUnitValue;var u=this.DVBCenterPoint;var f=0;var c=0;var h=f;var p=this.DVBHeight<this.DVBWidth?this.DVBHeight/2:this.DVBWidth/2;var d=r.innerRingRadius>=0&&r.innerRingRadius<p;var v=typeof r.innerRingRadius!=="undefined"&&!isNaN(r.innerRingRadius)&&d?r.innerRingRadius:0;for(var g=0;g<i.length;g++){var _=Math.abs(i[g]);if(g===0){c=f+_*l}else if(g===_.length-1){c=h}else{c=f+_*l}var x=new m.Sector(u[0],u[1],p,f,c,v);if(typeof r.sectorStyleByFields==="undefined"){var b=g%t.length;x.style=y.ShapeFactory.ShapeStyleTool(null,r.sectorStyle,t,null,b)}else{x.style=y.ShapeFactory.ShapeStyleTool(null,r.sectorStyle,r.sectorStyleByFields,r.sectorStyleByCodomain,g,i[g])}x.highlightStyle=y.ShapeFactory.ShapeStyleTool(null,r.sectorHoverStyle);if(typeof r.sectorHoverAble!=="undefined"){x.hoverable=r.sectorHoverAble}if(typeof r.sectorClickAble!=="undefined"){x.clickable=r.sectorClickAble}x.refDataID=this.data.FID;x.dataInfo={field:this.fields[g],value:i[g]};this.shapes.push(this.shapeFactory.createShape(x));f=c}this.shapesConvertToRelativeCoordinate()}}]);return t}(g.Graph);t.Ring=x;v.Zondy.Theme.Ring=x},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FeatureTheme=t.Sector=t.FeatureRectangle=t.FeaturePolygon=t.Point=t.FeatureLine=t.Label=t.Image=t.FeatureCircle=t.ShapeParameters=t.ShapeFactory=undefined;var i=r(13);var n=r(29);var a=r(116);var o=r(209);var s=r(208);var l=r(115);var u=r(70);var f=r(71);var c=r(207);var h=r(72);var p=r(43);t.ShapeFactory=i.ShapeFactory;t.ShapeParameters=n.ShapeParameters;t.FeatureCircle=a.Circle;t.Image=o.Image;t.Label=s.Label;t.FeatureLine=l.Line;t.Point=u.Point;t.FeaturePolygon=f.Polygon;t.FeatureRectangle=c.Rectangle;t.Sector=h.Sector;t.FeatureTheme=p.Theme},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SUtil=t.LevelRendererVector=t.Util=t.Transformable=t.Storage=t.SmicText=t.SmicStar=t.SmicSector=t.SmicRing=t.SmicRectangle=t.SmicPolygon=t.SmicPoint=t.SmicIsogon=t.SmicImage=t.SmicEllipse=t.SmicCircle=t.SmicBrokenLine=t.Shape=t.PaintLayer=t.Painter=t.Matrix=t.Math=t.Http=t.Handler=t.Group=t.Eventful=t.LevelRendererEvent=t.Env=t.Easing=t.LevelRendererCurve=t.Config=t.ComputeBoundingBox=t.Color=t.Clip=t.Area=t.Animator=t.Animation=t.Render=t.LevelRenderer=undefined;var i=r(191);var n=r(192);var a=r(204);var o=r(195);var s=r(205);var l=r(112);var u=r(196);var f=r(113);var c=r(68);var h=r(206);var p=r(197);var d=r(198);var v=r(50);var y=r(194);var m=r(203);var g=r(199);var _=r(200);var x=r(201);var b=r(202);var w=r(16);var S=r(118);var C=r(211);var T=r(381);var P=r(114);var M=r(382);var I=r(117);var A=r(73);var L=r(212);var E=r(383);var k=r(213);var D=r(384);var B=r(210);var R=r(193);var F=r(67);var O=r(42);var z=r(69);var U=r(20);t.LevelRenderer=i.LevelRenderer;t.Render=n.Render;t.Animation=a.Animation;t.Animator=a.Animator;t.Area=o.Area;t.Clip=s.Clip;t.Color=l.Color;t.ComputeBoundingBox=u.ComputeBoundingBox;t.Config=f.Config;t.LevelRendererCurve=c.Curve;t.Easing=h.Easing;t.Env=p.Env;t.LevelRendererEvent=d.Event;t.Eventful=v.Eventful;t.Group=y.Group;t.Handler=m.Handler;t.Http=g.Http;t.Math=_.Math;t.Matrix=x.Matrix;t.Painter=b.Painter;t.PaintLayer=b.PaintLayer;t.Shape=w.Shape;t.SmicBrokenLine=S.SmicBrokenLine;t.SmicCircle=C.SmicCircle;t.SmicEllipse=T.SmicEllipse;t.SmicImage=P.SmicImage;t.SmicIsogon=M.SmicIsogon;t.SmicPoint=I.SmicPoint;t.SmicPolygon=A.SmicPolygon;t.SmicRectangle=L.SmicRectangle;t.SmicRing=E.SmicRing;t.SmicSector=k.SmicSector;t.SmicStar=D.SmicStar;t.SmicText=B.SmicText;t.Storage=R.Storage;t.Transformable=F.Transformable;t.Util=O.Util;t.LevelRendererVector=z.Vector;t.SUtil=U.SUtil},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SmicEllipse=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(7);var h=m(c);var p=r(4);var d=m(p);var v=r(0);var y=r(16);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,d.default)(t,e);function t(e){(0,o.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));r.type="smicellipse";if(!r.refOriginalPosition||r.refOriginalPosition.length!==2){r.refOriginalPosition=[0,0]}r.CLASS_NAME="Zondy.LevelRenderer.Shape.SmicEllipse";return r}(0,l.default)(t,[{key:"destroy",value:function e(){this.type=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"buildPath",value:function e(t,r){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var i=this.refOriginalPosition;var n=.5522848;var a=r.x+i[0];var o=r.y+i[1];var s=r.a;var l=r.b;var u=s*n;var f=l*n;t.moveTo(a-s,o);t.bezierCurveTo(a-s,o-f,a-u,o-l,a,o-l);t.bezierCurveTo(a+u,o-l,a+s,o-f,a+s,o);t.bezierCurveTo(a+s,o+f,a+u,o+l,a,o+l);t.bezierCurveTo(a-u,o+l,a-s,o+f,a-s,o);t.closePath()}},{key:"getRect",value:function e(t){if(t.__rect){return t.__rect}if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var r=this.refOriginalPosition;var i;if(t.brushType==="stroke"||t.brushType==="fill"){i=t.lineWidth||1}else{i=0}t.__rect={x:Math.round(t.x+r[0]-t.a-i/2),y:Math.round(t.x+r[1]-t.b-i/2),width:t.a*2+i,height:t.b*2+i};return t.__rect}}]);return t}(y.Shape);t.SmicEllipse=g;v.Zondy.LevelRenderer.SmicEllipse=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SmicIsogon=undefined;var i=r(2);var n=g(i);var a=r(1);var o=g(a);var s=r(5);var l=g(s);var u=r(3);var f=g(u);var c=r(7);var h=g(c);var p=r(4);var d=g(p);var v=r(0);var y=r(16);var m=r(20);function g(e){return e&&e.__esModule?e:{default:e}}var _=function(e){(0,d.default)(t,e);function t(e){(0,o.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));r.type="smicisogon";if(!r.refOriginalPosition||r.refOriginalPosition.length!==2){r.refOriginalPosition=[0,0]}r.CLASS_NAME="Zondy.LevelRenderer.SmicIsogon";return r}(0,l.default)(t,[{key:"destroy",value:function e(){this.type=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"buildPath",value:function e(t,r){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var i=this.refOriginalPosition;var n=m.SUtil.Util_math.sin;var a=m.SUtil.Util_math.cos;var o=Math.PI;var s=r.n;if(!s||s<2){return}var l=r.x+i[0];var u=r.y+i[1];var f=r.r;var c=2*o/s;var h=-o/2;var p=l+f*a(h);var d=u+f*n(h);h+=c;var v=r.pointList=[];v.push([p,d]);for(var y=0,g=s-1;y<g;y++){v.push([l+f*a(h),u+f*n(h)]);h+=c}v.push([p,d]);t.moveTo(v[0][0],v[0][1]);for(var _=0;_<v.length;_++){t.lineTo(v[_][0],v[_][1])}t.closePath();return}},{key:"getRect",value:function e(t){if(t.__rect){return t.__rect}if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var r=this.refOriginalPosition;var i;if(t.brushType==="stroke"||t.brushType==="fill"){i=t.lineWidth||1}else{i=0}t.__rect={x:Math.round(t.x+r[0]-t.r-i/2),y:Math.round(t.y+r[1]-t.r-i/2),width:t.r*2+i,height:t.r*2+i};return t.__rect}}]);return t}(y.Shape);t.SmicIsogon=_;v.Zondy.LevelRenderer.SmicIsogon=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SmicRing=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(7);var h=m(c);var p=r(4);var d=m(p);var v=r(0);var y=r(16);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,d.default)(t,e);function t(e){(0,o.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));r.type="smicring";if(!r.refOriginalPosition||r.refOriginalPosition.length!==2){r.refOriginalPosition=[0,0]}r.CLASS_NAME="Zondy.LevelRenderer.Shape.SmicRing";return r}(0,l.default)(t,[{key:"destroy",value:function e(){this.type=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"buildPath",value:function e(t,r){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var i=this.refOriginalPosition;t.arc(r.x+i[0],r.y+i[1],r.r,0,Math.PI*2,false);t.moveTo(r.x+i[0]+r.r0,r.y+i[1]);t.arc(r.x+i[0],r.y+i[1],r.r0,0,Math.PI*2,true);return}},{key:"getRect",value:function e(t){if(t.__rect){return t.__rect}if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var r=this.refOriginalPosition;var i;if(t.brushType==="stroke"||t.brushType==="fill"){i=t.lineWidth||1}else{i=0}t.__rect={x:Math.round(t.x+r[0]-t.r-i/2),y:Math.round(t.y+r[1]-t.r-i/2),width:t.r*2+i,height:t.r*2+i};return t.__rect}}]);return t}(y.Shape);t.SmicRing=g;v.Zondy.LevelRenderer.SmicRing=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.SmicStar=undefined;var i=r(2);var n=g(i);var a=r(1);var o=g(a);var s=r(5);var l=g(s);var u=r(3);var f=g(u);var c=r(7);var h=g(c);var p=r(4);var d=g(p);var v=r(0);var y=r(16);var m=r(20);function g(e){return e&&e.__esModule?e:{default:e}}var _=function(e){(0,d.default)(t,e);function t(e){(0,o.default)(this,t);var r=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));r.type="smicstar";if(!r.refOriginalPosition||r.refOriginalPosition.length!==2){r.refOriginalPosition=[0,0]}r.CLASS_NAME="Zondy.LevelRenderer.Shape.SmicStar";return r}(0,l.default)(t,[{key:"destroy",value:function e(){this.type=null;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"destroy",this).call(this)}},{key:"buildPath",value:function e(t,r){if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var i=this.refOriginalPosition;var n=r.n;if(!n||n<2){return}var a=m.SUtil.Util_math.sin;var o=m.SUtil.Util_math.cos;var s=Math.PI;var l=r.x+i[0];var u=r.y+i[1];var f=r.r;var c=r.r0;if(c==null){c=n>4?f*o(2*s/n)/o(s/n):f/3}var h=s/n;var p=-s/2;var d=l+f*o(p);var v=u+f*a(p);p+=h;var y=r.pointList=[];y.push([d,v]);for(var g=0,_=n*2-1,x;g<_;g++){x=g%2===0?c:f;y.push([l+x*o(p),u+x*a(p)]);p+=h}y.push([d,v]);t.moveTo(y[0][0],y[0][1]);for(var b=0;b<y.length;b++){t.lineTo(y[b][0],y[b][1])}t.closePath();return}},{key:"getRect",value:function e(t){if(t.__rect){return t.__rect}if(!this.refOriginalPosition||this.refOriginalPosition.length!==2){this.refOriginalPosition=[0,0]}var r=this.refOriginalPosition;var i;if(t.brushType==="stroke"||t.brushType==="fill"){i=t.lineWidth||1}else{i=0}t.__rect={x:Math.round(t.x+r[0]-t.r-i/2),y:Math.round(t.y+r[1]-t.r-i/2),width:t.r*2+i,height:t.r*2+i};return t.__rect}}]);return t}(y.Shape);t.SmicStar=_;v.Zondy.LevelRenderer.SmicStar=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.randomThemeLayer=undefined;var i=r(2);var n=x(i);var a=r(1);var o=x(a);var s=r(5);var l=x(s);var u=r(3);var f=x(u);var c=r(4);var h=x(c);var p=r(25);var d=x(p);var v=r(0);var y=r(6);var m=r(66);var g=r(51);var _=r(13);function x(e){return e&&e.__esModule?e:{default:e}}var b=function(e){(0,h.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r));i.style=r.style;i.isHoverAble=r.isHoverAble;i.highlightStyle=r.highlightStyle;i.themeField=r.themeField;i.styleGroups=r.styleGroups;return i}(0,l.default)(t,[{key:"getColor",value:function e(){var t="0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f";var r=t.split(",");var i="#";for(var n=0;n<6;n++){i+=r[Math.floor(Math.random()*16)]}return i}},{key:"createThematicFeature",value:function e(t){var r=this.getStyleByData(t);var i={};i.nodesClipPixel=this.nodesClipPixel;i.isHoverAble=this.isHoverAble;i.isMultiHover=this.isMultiHover;i.isClickAble=this.isClickAble;i.highlightStyle=_.ShapeFactory.transformStyle(this.highlightStyle);var n=new g.ThemeVector(t,this,_.ShapeFactory.transformStyle(r),i);for(var a=0;a<n.shapes.length;a++){this.renderer.addShape(n.shapes[a])}return n}},{key:"getStyleByData",value:function e(){var t=this;var r=(0,y.copyAttributesWithClip)({},t.style);r.fillColor=t.getColor();return r}}]);return t}(m.GeoFeatureThemeLayer);var w=t.randomThemeLayer=function e(t,r){return new b(t,r)};v.Zondy.Map.randomThemeLayer=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.simpleThemeLayer=undefined;var i=r(2);var n=x(i);var a=r(1);var o=x(a);var s=r(5);var l=x(s);var u=r(3);var f=x(u);var c=r(4);var h=x(c);var p=r(25);var d=x(p);var v=r(0);var y=r(6);var m=r(66);var g=r(51);var _=r(13);function x(e){return e&&e.__esModule?e:{default:e}}var b=function(e){(0,h.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r));i.style=r.style;i.isHoverAble=r.isHoverAble;i.highlightStyle=r.highlightStyle;i.themeField=r.themeField;i.styleGroups=r.styleGroups;return i}(0,l.default)(t,[{key:"getColor",value:function e(){var t="0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f";var r=t.split(",");var i="#";for(var n=0;n<6;n++){i+=r[Math.floor(Math.random()*16)]}return i}},{key:"createThematicFeature",value:function e(t){var r=this.getStyleByData(t);var i={};i.nodesClipPixel=this.nodesClipPixel;i.isHoverAble=this.isHoverAble;i.isMultiHover=this.isMultiHover;i.isClickAble=this.isClickAble;i.highlightStyle=_.ShapeFactory.transformStyle(this.highlightStyle);var n=new g.ThemeVector(t,this,_.ShapeFactory.transformStyle(r),i);for(var a=0;a<n.shapes.length;a++){this.renderer.addShape(n.shapes[a])}return n}},{key:"getStyleByData",value:function e(){var t=this;var r=(0,y.copyAttributesWithClip)({},t.style);if(r.fillColor==null){r.fillColor=t.getColor()}t.style=r;return r}}]);return t}(m.GeoFeatureThemeLayer);var w=t.simpleThemeLayer=function e(t,r){return new b(t,r)};v.Zondy.Map.simpleThemeLayer=w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.rankSymbolThemeLayer=undefined;var i=r(2);var n=g(i);var a=r(1);var o=g(a);var s=r(5);var l=g(s);var u=r(3);var f=g(u);var c=r(4);var h=g(c);var p=r(25);var d=g(p);var v=r(0);var y=r(43);var m=r(217);function g(e){return e&&e.__esModule?e:{default:e}}var _=function(e){(0,h.default)(t,e);function t(e,r,i){(0,o.default)(this,t);var a=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i));a.symbolType=r;a.symbolSetting=i.symbolSetting;a.themeField=i.themeField;a.options={calGravity:i.calGravity||true};return a}(0,l.default)(t,[{key:"setSymbolType",value:function e(t){this.symbolType=t;this.redraw()}},{key:"createThematicFeature",value:function e(t){var r;if(y.Theme[this.symbolType]&&this.themeField&&this.symbolSetting){r=new y.Theme[this.symbolType](t,this,[this.themeField],this.symbolSetting,null,this.options)}if(!r){return false}r.assembleShapes();return r}}]);return t}(m.GraphThemeLayer);var x=t.rankSymbolThemeLayer=function e(t,r,i){return new _(t,r,i)};v.Zondy.Map.rankSymbolThemeLayer=x},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ThemeStyle=undefined;var i=r(1);var n=s(i);var a=r(0);var o=r(6);function s(e){return e&&e.__esModule?e:{default:e}}var l=function e(t){(0,n.default)(this,e);t=t||{};this.fill=true;this.fillColor="#000000";this.fillOpacity=1;this.stroke=false;this.strokeColor="#000000";this.strokeOpacity=1;this.strokeWidth=1;this.strokeLinecap="butt";this.strokeLineJoin="miter";this.strokeDashstyle="solid";this.pointRadius=6;this.shadowBlur=0;this.shadowColor="#000000";this.shadowOffsetX=0;this.shadowOffsetY=0;this.label="";this.labelRect=false;this.fontColor="";this.fontSize=12;this.fontStyle="normal";this.fontVariant="normal";this.fontWeight="normal";this.fontFamily="arial,sans-serif";this.labelPosition="top";this.labelAlign="center";this.labelBaseline="middle";this.labelXOffset=0;this.labelYOffset=0;(0,o.extend)(this,t)};t.ThemeStyle=l;a.Zondy.Map.ThemeStyle=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.rangeTheme3DLayer=t.RangeTheme3DLayer=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(4);var h=m(c);var p=r(21);var d=r(0);var v=r(119);var y=r(6);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,h.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r));i.heightStops=null;i.colorStops=null;i.base=null;i.legendRatio=1;(0,y.extend)(i,r);return i}(0,l.default)(t,[{key:"getLayerStyleOptions",value:function e(){var t=this.opacity==null?1:this.opacity;t=isNaN(parseFloat(t))?1:parseFloat(t);var r=/^[0-9]+.?[0-9]*$/;var i={"fill-extrusion-color":{stops:this.colorStops,property:this.themeField||this.heightField,type:"interval",base:r.test(this.base)?this.base:1},"fill-extrusion-opacity":t};if(this.heightStops){i["fill-extrusion-height"]={stops:this.heightStops,property:this.heightField||"height",base:r.test(this.base)?this.base:1}}else if(this.height){i["fill-extrusion-height"]=this.height}else{i["fill-extrusion-height"]={property:this.heightField||"height",type:"identity"}}if(this.baseHeightField){i["fill-extrusion-base"]={property:this.baseHeightField,type:"identity"}}return i}},{key:"getHighlightStyleOptions",value:function e(){var t=this.highlight&&this.highlight.color!=null?this.highlight.color:"#ADA91E";return{"fill-extrusion-color":t,"fill-extrusion-height":{stops:this.heightStops,property:this.heightField},"fill-extrusion-opacity":this.highlight&&this.highlight.opacity||.6}}},{key:"_createLegendElement",value:function e(){var t=this.colorStops&&this.colorStops.length||0;var r="<ul>";var i;for(i=0;i<t;i++){var n=this.colorStops[i][0];var a=this._getWrapperText(n);if(i===t-1){a="> "+a}else{var o=this._getWrapperText(this.colorStops[i+1][0]);a=a+"-"+o}var s=this.colorStops[i][1];r+="<li><span style='background-color:"+s+";'></span><span>"+a+"</span></li>"}r+="</ul>";return r}},{key:"_getWrapperText",value:function e(t){var r=t*(this.legendRatio==null?1:parseFloat(this.legendRatio));var i=parseFloat(r);if(i%1e6<=1e6){return i.toString()}return parseInt(i/1e3)+"k"}}]);return t}(v.Theme3DLayer);t.RangeTheme3DLayer=g;var _=t.rangeTheme3DLayer=function e(t,r){return new g(t,r)};d.Zondy.Map.rangeTheme3DLayer=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.uniqueTheme3DLayer=t.UniqueTheme3DLayer=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(4);var h=m(c);var p=r(21);var d=r(0);var v=r(119);var y=r(6);function m(e){return e&&e.__esModule?e:{default:e}}var g=function(e){(0,h.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r));i.colorStops=null;i.heightStops=null;(0,y.extend)(i,r);return i}(0,l.default)(t,[{key:"getLayerStyleOptions",value:function e(){var t=this.opacity==null?1:this.opacity;t=isNaN(parseFloat(t))?1:parseFloat(t);var r={"fill-extrusion-color":{stops:this.colorStops,property:this.themeField,type:"categorical"},"fill-extrusion-opacity":t};if(this.height!=null){r["fill-extrusion-height"]=this.height}else{r["fill-extrusion-height"]={property:this.heightField||"height",type:"categorical",stops:this.heightStops}}if(this.baseHeightField){r["fill-extrusion-base"]={property:this.baseHeightField,type:"identity"}}return r}},{key:"getHighlightStyleOptions",value:function e(){var t=this.highlight&&this.highlight.color!=null?this.highlight.color:"#ADA91E";var r={"fill-extrusion-color":t,"fill-extrusion-height":{stops:this.heightStops,property:this.heightField,type:"categorical"},"fill-extrusion-opacity":this.highlight&&this.highlight.opacity||.6};if(this.height!=null){r["fill-extrusion-height"]=this.height||0}return r}},{key:"_createLegendElement",value:function e(){var t="<ul>";var r=this.colorStops&&this.colorStops.length||0;for(var i=0;i<r;i++){var n=this.colorStops[i][0];var a=this.colorStops[i][1];t+="<li><span style='background-color:"+a+";'></span><span>"+n+"</span></li>"}t+="</ul>";return t}}]);return t}(v.Theme3DLayer);t.UniqueTheme3DLayer=g;var _=t.uniqueTheme3DLayer=function e(t,r){return new g(t,r)};d.Zondy.Map.uniqueTheme3DLayer=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.StreamLayer=t.MapvLayer=t.EchartsLayer=undefined;var i=r(392);var n=r(219);var a=r(396);t.EchartsLayer=i.EchartsLayer;t.MapvLayer=n.MapvLayer;t.StreamLayer=a.StreamLayer},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.EchartsLayer=undefined;var i=r(1);var n=h(i);var a=r(5);var o=h(a);var s=r(21);var l=h(s);var u=r(218);var f=h(u);r(39);var c=r(393);function h(e){return e&&e.__esModule?e:{default:e}}var p=t.EchartsLayer=function(){function e(t,r){(0,n.default)(this,e);this.map=t;this.options=r;this.layerId=r.layerId||"echartlayerdefaultid";this.layerClass=r.classId||"echartlayerdefaultclass";this.initDevicePixelRatio();this.mapContainer=t.getCanvasContainer();this.canvas=this._createCanvas();this.mapContainer.appendChild(this.canvas);this.mapContainer.style.perspective=this.map.transform.cameraToCenterDistance+"px";this.chart=f.default.init(this.canvas);this.initEcharts();this._resizeCanvas();return this}(0,o.default)(e,[{key:"initDevicePixelRatio",value:function e(){this.devicePixelRatio=window.devicePixelRatio||1}},{key:"initEcharts",value:function e(){f.default.mapboxglMap=this.map;f.default.registerCoordinateSystem("mapboxgl",c.MapCoordSys);f.default.extendComponentModel({type:"mapboxgl",getBMap:function e(){return this.__mapboxgl},defaultOption:{roam:false}});f.default.registerAction({type:"MapboxGLRoma",event:"MapboxGLRoma",update:"updateLayout"},function(e,t){});return this}},{key:"_createCanvas",value:function e(){var t=document.createElement("div");t.id=this.layerId;t.style.position="absolute";t.style.top="0px";t.style.left="0px";t.width=parseInt(this.map.getCanvas().style.width);t.height=parseInt(this.map.getCanvas().style.height);t.style.width=this.map.getCanvas().style.width;t.style.height=this.map.getCanvas().style.height;t.setAttribute("id",this.layerId);t.setAttribute("class",this.layerClass);return t}},{key:"_resizeCanvas",value:function e(){var t=this;window.onresize=function(){var e=t.canvas;var r=t.map;e.style.position="absolute";e.style.top="0px";e.style.left="0px";e.style.width=r.getCanvas().style.width;e.style.height=r.getCanvas().style.height;e.width=parseInt(r.getCanvas().style.width);e.height=parseInt(r.getCanvas().style.height);t.chart.resize()}}},{key:"addTo",value:function e(t){f.default.extendComponentView({type:"mapboxgl",render:function e(t,r,i){var n=true;var a=f.default.mapboxglMap;var o=i.getZr().painter.getViewportRoot();var s=t.coordinateSystem;var l=function e(r,a){if(n){return}var l=document.getElementsByClassName("mapboxgl-map")[0];var u=[-parseInt(l.style.left,10)||0,-parseInt(l.style.top,10)||0];o.style.left=u[0]+"px";o.style.top=u[1]+"px";s.setMapOffset(u);t.__mapOffset=u;i.dispatchAction({type:"MapboxGLRoma"})};function u(){if(n){return}i.dispatchAction({type:"MapboxGLRoma"})}a.off("move",this._oldMoveHandler);a.off("zoomend",this._oldZoomEndHandler);a.on("move",l);a.on("zoomend",u);this._oldMoveHandler=l;this._oldZoomEndHandler=u;var c=t.get("roam");if(c&&c!=="scale"){}else{}if(c&&c!=="move"){}else{}n=false}});this.chart.setOption(this.options);return this}},{key:"_visible",value:function e(){this.canvas.style.visibility="visible"}},{key:"_unvisible",value:function e(){this.canvas.style.visibility="hidden"}},{key:"show",value:function e(){this._visible()}},{key:"hide",value:function e(){this._unvisible()}},{key:"remove",value:function e(){var t=this;this.map._listeners.move.forEach(function(e){if(e.name==="moveHandler"){t.map.off("move",e)}});this.map._listeners.move.forEach(function(e){if(e.name==="zoomEndHandler"){t.map.off("zoomend",e)}});this.chart.clear();if(this.canvas.parentNode)this.canvas.parentNode.removeChild(this.canvas);this.map=undefined;return this}}]);return e}();l.default.zondy.EchartsLayer=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MapCoordSys=l;var i=r(21);var n=s(i);var a=r(218);var o=s(a);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){this._MapboxGLMap=e;this.dimensions=["lng","lat"];this._mapOffset=[0,0];this._api=t}l.prototype.dimensions=["lng","lat"];l.prototype.setMapOffset=function(e){this._mapOffset=e};l.prototype.getBMap=function(){return this._MapboxGLMap};l.prototype.dataToPoint=function(e){var t=this._MapboxGLMap.project(e);var r=this._mapOffset;return[t.x-r[0],t.y-r[1]]};l.prototype.pointToData=function(e){var t=this._mapOffset;var e=this._MapboxGLMap.project([e[0]+t[0],e[1]+t[1]]);return[e.lng,e.lat]};l.prototype.getViewRect=function(){var e=this._api;return new o.default.graphic.BoundingRect(0,0,e.getWidth(),e.getHeight())};l.prototype.getRoamTransform=function(){return o.default.matrix.create()};l.prototype.prepareCustoms=function(e){var t=o.default.util;var r=this.getViewRect();return{coordSys:{type:"mapboxgl",x:r.x,y:r.y,width:r.width,height:r.height},api:{coord:t.bind(this.dataToPoint,this),size:t.bind(i,this)}};function i(e,r){r=r||[0,0];return t.map([0,1],function(t){var i=r[t];var n=e[t]/2;var a=[];var o=[];a[t]=i-n;o[t]=i+n;a[1-t]=o[1-t]=r[1-t];return Math.abs(this.dataToPoint(a)[t]-this.dataToPoint(o)[t])},this)}};l.dimensions=l.prototype.dimensions;l.create=function(e,t){var r;e.eachComponent("mapboxgl",function(e){var i=t.getZr().painter.getViewportRoot();var n=o.default.mapboxglMap;r=new l(n,t);r.setMapOffset(e.__mapOffset||[0,0]);e.coordinateSystem=r});e.eachSeries(function(e){if(e.get("coordinateSystem")==="mapboxgl"){e.coordinateSystem=r}})};t.default=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MapvBaseLayer=undefined;var i=r(2);var n=g(i);var a=r(1);var o=g(a);var s=r(5);var l=g(s);var u=r(3);var f=g(u);var c=r(7);var h=g(c);var p=r(4);var d=g(p);var v=r(395);var y=r(21);var m=g(y);function g(e){return e&&e.__esModule?e:{default:e}}var _=v.baiduMapLayer?v.baiduMapLayer.__proto__:Function;var x=t.MapvBaseLayer=function(e){(0,d.default)(t,e);function t(e,r,i,a){(0,o.default)(this,t);var s=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,r,i));if(!_)return(0,f.default)(s);s.map=e;s.dataSet=r;var l=s;var u=null;i=i||{};l.init(i);l.argCheck(i);s.initDevicePixelRatio();s.canvasLayer=a;s.stopAniamation=false;s.animation=i.animation;s.mousemoveEvent=s.mousemoveEvent.bind(s);s.bindEvent();return s}(0,l.default)(t,[{key:"initDevicePixelRatio",value:function e(){this.devicePixelRatio=window.devicePixelRatio||1}},{key:"clickEvent",value:function e(r){var i=r.point;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"clickEvent",this).call(this,i,r)}},{key:"mousemoveEvent",value:function e(r){var i=r.point;(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"mousemoveEvent",this).call(this,i,r)}},{key:"addAnimatorEvent",value:function e(){}},{key:"animatorMovestartEvent",value:function e(){var t=this.options.animation;if(this.isEnabledTime()&&this.animator){this.steps.step=t.stepsRange.start}}},{key:"animatorMoveendEvent",value:function e(){if(this.isEnabledTime()&&this.animator){}}},{key:"bindEvent",value:function e(){var t=this.map;if(this.options.methods){if(this.options.methods.click){t.on("click",this.clickEvent)}if(this.options.methods.mousemove){t.on("mousemove",this.mousemoveEvent)}}}},{key:"unbindEvent",value:function e(){var t=this.map;if(this.options.methods){if(this.options.methods.click){t.off("click",this.clickEvent)}if(this.options.methods.mousemove){t.off("mousemove",this.mousemoveEvent)}}}},{key:"getContext",value:function e(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"init",value:function e(t){var r=this;r.options=t;this.initDataRange(t);this.context=r.options.context||"2d";if(r.options.zIndex){this.canvasLayer&&this.canvasLayer.setZIndex(r.options.zIndex)}this.initAnimator()}},{key:"_canvasUpdate",value:function e(t){var r=this.map;if(!this.canvasLayer||this.stopAniamation||this.canvasLayer.disposeFlag){return}var i=this;var n=i.options.animation;var a=this.getContext();if(i.isEnabledTime()){if(t===undefined){this.clear(a);return}if(this.context==="2d"){a.save();a.globalCompositeOperation="destination-out";a.fillStyle="rgba(0, 0, 0, .1)";a.fillRect(0,0,a.canvas.width,a.canvas.height);a.restore()}}else{this.clear(a)}if(this.context==="2d"){for(var o in i.options){a[o]=i.options[o]}}else{a.clear(a.COLOR_BUFFER_BIT)}if(i.options.minZoom&&r.getZoom()<i.options.minZoom||i.options.maxZoom&&r.getZoom()>i.options.maxZoom){return}var s={transferCoordinate:function e(t){var i=r.project(new m.default.LngLat(t[0],t[1]));return[i.x,i.y]}};if(t!==undefined){s.filter=function(e){var r=n.trails||10;if(t&&e.time>t-r&&e.time<t){return true}else{return false}}}var l=i.dataSet.get(s);this.processData(l);if(i.options.unit=="m"&&i.options.size){i.options._size=i.options.size}else{i.options._size=i.options.size}var u=r.project(new m.default.LngLat(0,0));this.drawContext(a,new v.DataSet(l),i.options,u);i.options.updateCallback&&i.options.updateCallback(t)}},{key:"updateData",value:function e(r,i){var a=r;if(a&&a.get){a=a.get()}if(a!=undefined){this.dataSet.set(a)}(0,h.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"update",this).call(this,{options:i})}},{key:"addData",value:function e(t,r){var i=t;if(t&&t.get){i=t.get()}this.dataSet.add(i);this.update({options:r})}},{key:"getData",value:function e(){return this.dataSet}},{key:"removeData",value:function e(t){if(!this.dataSet){return}var r=this.dataSet.get({filter:function e(r){return t!=null&&typeof t==="function"?!t(r):true}});this.dataSet.set(r);this.update({options:null})}},{key:"clearData",value:function e(){this.dataSet&&this.dataSet.clear();this.update({options:null})}},{key:"draw",value:function e(){this.canvasLayer.draw()}},{key:"clear",value:function e(t){t&&t.clearRect&&t.clearRect(0,0,t.canvas.width,t.canvas.height)}}]);return t}(_)},function(e,t){e.exports=function(){try{return mapv}catch(e){return{}}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.streamLayer=t.StreamLayer=undefined;var i=r(1);var n=p(i);var a=r(5);var o=p(a);var s=r(21);var l=p(s);r(39);var u=r(397);var f=r(120);var c=r(404);var h=r(405);function p(e){return e&&e.__esModule?e:{default:e}}var d=t.StreamLayer=function(){function e(t,r,i){(0,n.default)(this,e);this.options=i||{};this.map=t;this.url=r;this.layer=undefined;this.socketService=new u.SocketService(this.url,this.options)}(0,o.default)(e,[{key:"addTo",value:function e(t){this.map=t;this.bindEvent();if(this.options.render==="mapv"){this.layer=new c.MapvStreamLayer(this.map,this.url,this.options)}else{this.layer=new h.GeojsonStreamLayer(this.map,this.url,this.options)}}},{key:"bindEvent",value:function e(){var t=this;this.socketService.createSubscribe();this.socketService.on(f.SubscribeEvent.OPEN,function(e){return t.fire(f.SubscribeEvent.OPEN,e)});this.socketService.on(f.SubscribeEvent.MESSAGE,function(e){return t.onMessage(e)})}},{key:"unbindEvent",value:function e(){var t=this;if(!this.socketService)return;this.socketService.on(f.SubscribeEvent.OPEN,function(e){return t.fire(f.SubscribeEvent.OPEN,e)});this.socketService.on(f.SubscribeEvent.MESSAGE,function(e){return t.onMessage(e)});this.socketService&&this.socketService.closeSubscribe()}},{key:"remove",value:function e(){this.unbindEvent()}},{key:"fire",value:function e(t,r){}},{key:"onMessage",value:function e(t){this.layer.onMessage(t)}}]);return e}();var v=t.streamLayer=function e(t,r,i){return new d(t,r,i)};l.default.zondy.StreamLayer=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.socketService=t.SocketService=undefined;var i=r(2);var n=m(i);var a=r(1);var o=m(a);var s=r(5);var l=m(s);var u=r(3);var f=m(u);var c=r(4);var h=m(c);var p=r(21);var d=m(p);r(39);var v=r(120);var y=r(398);function m(e){return e&&e.__esModule?e:{default:e}}d.default.zondy.SocketService=undefined;var g=t.SocketService=function(e){(0,h.default)(t,e);function t(e,r){(0,o.default)(this,t);var i=(0,f.default)(this,(t.__proto__||(0,n.default)(t)).call(this));i.url=e||"";i.options=r||{};i.socket=new y.ISocketService(e,r);return i}(0,l.default)(t,[{key:"createSubscribe",value:function e(){console.log("在使用流图层的时候容易出现回调堆栈溢出的问题，其核心原因是socket通信是双工通信，因此上下文环境context在不同的场景下是不一样的，以leaflet的on为例，其函数原型off(types, fn, context)第三个参数context的默认会是运行时的this而不是绑定时的this，最好在使用on监听的时候主动传入真正的上下文环境this");this.socket.createSubscribe();this.socket.evented.on(v.SubscribeEvent.OPEN,this.mapEvent,this);this.socket.evented.on(v.SubscribeEvent.MESSAGE,this.mapEvent,this);this.socket.evented.on(v.SubscribeEvent.CLOSE,this.mapEvent,this);this.socket.evented.on(v.SubscribeEvent.ERROR,this.mapEvent,this)}},{key:"createBroadcast",value:function e(){this.socket.createBroadcast();this.socket.evented.on(v.BroadcastEvent.OPEN,this.mapEvent,this);this.socket.evented.on(v.BroadcastEvent.MESSAGE,this.mapEvent,this);this.socket.evented.on(v.BroadcastEvent.CLOSE,this.mapEvent,this);this.socket.evented.on(v.BroadcastEvent.ERROR,this.mapEvent,this)}},{key:"mapEvent",value:function e(t){this.fire(t.eventType||t.type,t)}},{key:"broadcast",value:function e(t){if(!this.socket){return}this.socket.broadcast(t)}},{key:"closeSubscribe",value:function e(){this.socket.closeSubscribe();this.socket.evented.off(v.SubscribeEvent.OPEN,this.mapEvent,this);this.socket.evented.off(v.SubscribeEvent.MESSAGE,this.mapEvent,this);this.socket.evented.off(v.SubscribeEvent.CLOSE,this.mapEvent,this);this.socket.evented.off(v.SubscribeEvent.ERROR,this.mapEvent,this)}},{key:"closeBroadcast",value:function e(){this.socket.closeBroadcast();this.socket.evented.off(v.BroadcastEvent.OPEN,this.mapEvent);this.socket.evented.off(v.BroadcastEvent.MESSAGE,this.mapEvent);this.socket.evented.off(v.BroadcastEvent.CLOSE,this.mapEvent);this.socket.evented.off(v.BroadcastEvent.ERROR,this.mapEvent)}}]);return t}(d.default.Evented);var _=t.socketService=function e(t,r){return new g(t,r)};d.default.zondy.SocketService=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ISocketService=undefined;var i=r(9);var n=h(i);var a=r(1);var o=h(a);var s=r(5);var l=h(s);var u=r(39);var f=r(399);var c=r(120);function h(e){return e&&e.__esModule?e:{default:e}}u.Zondy.Socket.ISocketService=undefined;var p=t.ISocketService=function(){function e(t,r){(0,o.default)(this,e);this.url=t||"";this.options=r;this.subscribesocket=null;this.subscribesocket=null;this.evented=new f.Evented}(0,l.default)(e,[{key:"createSubscribe",value:function e(){var t=this;this.subscribesocket=this.connect(this.url+c.SubscribePrefix);this.subscribesocket.onopen=function(e){e.eventType=c.SubscribeEvent.OPEN;t.evented.fire(c.SubscribeEvent.OPEN,e)};this.subscribesocket.onmessage=function(e){var r=JSON.parse(e.data);e.feature=r;e.eventType=c.SubscribeEvent.MESSAGE;t.evented.fire(c.SubscribeEvent.MESSAGE,e)};this.subscribesocket.onclose=function(e){e.eventType=c.SubscribeEvent.CLOSE;t.evented.fire(c.SubscribeEvent.CLOSE,e)};this.subscribesocket.onerror=function(e){e.eventType=c.SubscribeEvent.ERROR;t.evented.fire(c.SubscribeEvent.ERROR,e)}}},{key:"createBroadcast",value:function e(){var t=this;this.broadcastsocket=this.connect(this.url+c.BroadcastPrefix);this.broadcastsocket.onopen=function(e){e.eventType=c.BroadcastEvent.OPEN;t.evented.fire(c.BroadcastEvent.OPEN,e)};this.broadcastsocket.onmessage=function(e){var r=JSON.parse(e.data);e.feature=r;e.eventType=c.BroadcastEvent.MESSAGE;t.evented.fire(c.BroadcastEvent.MESSAGE,e)};this.broadcastsocket.onclose=function(e){e.eventType=c.BroadcastEvent.CLOSE;t.evented.fire(c.BroadcastEvent.CLOSE,e)};this.broadcastsocket.onerror=function(e){e.eventType=c.BroadcastEvent.ERROR;t.evented.fire(c.BroadcastEvent.ERROR,e)}}},{key:"connect",value:function e(t){var r="MozWebSocket"in window?window.MozWebSocket:WebSocket;return new r(t)}},{key:"broadcast",value:function e(t){if(!this.broadcastWebSocket||!this.broadcastWebSocket.isOpen){return}this.broadcastsocket.send((0,n.default)(t))}},{key:"closeSubscribe",value:function e(){this.subscribesocket.close();this.subscribesocket=null}},{key:"closeBroadcast",value:function e(){this.broadcastsocket.close();this.broadcastsocket=null}},{key:"close",value:function e(){this.subscribesocket.close();this.broadcastsocket.close();this.subscribesocket=null;this.broadcastsocket=null}}]);return e}();u.Zondy.Socket.ISocketService=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Evented=undefined;var i=r(18);var n=h(i);var a=r(1);var o=h(a);var s=r(5);var l=h(s);var u=r(400);var f=c(u);function c(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}function h(e){return e&&e.__esModule?e:{default:e}}var p=t.Evented=function(){function e(){(0,o.default)(this,e)}(0,l.default)(e,[{key:"on",value:function e(t,r,i){if((typeof t==="undefined"?"undefined":(0,n.default)(t))==="object"){for(var a in t){this._on(a,t[a],r)}}else{t=f.splitWords(t);for(var o=0,s=t.length;o<s;o++){this._on(t[o],r,i)}}return this}},{key:"off",value:function e(t,r,i){if(!t){delete this._Evented}else if((typeof t==="undefined"?"undefined":(0,n.default)(t))==="object"){for(var a in t){this._off(a,t[a],r)}}else{t=f.splitWords(t);for(var o=0,s=t.length;o<s;o++){this._off(t[o],r,i)}}return this}},{key:"_on",value:function e(t,r,i){this._Evented=this._Evented||{};var n=this._Evented[t];if(!n){n=[];this._Evented[t]=n}if(i===this){i=undefined}var a={fn:r,ctx:i},o=n;for(var s=0,l=o.length;s<l;s++){if(o[s].fn===r&&o[s].ctx===i){return}}o.push(a)}},{key:"_off",value:function e(t,r,i){var n,a,o;if(!this._Evented){return}n=this._Evented[t];if(!n){return}if(!r){for(a=0,o=n.length;a<o;a++){n[a].fn=f.falseFn}delete this._Evented[t];return}if(i===this){i=undefined}if(n){for(a=0,o=n.length;a<o;a++){var s=n[a];if(s.ctx!==i){continue}if(s.fn===r){s.fn=f.falseFn;if(this._firingCount){this._Evented[t]=n=n.slice()}n.splice(a,1);return}}}}},{key:"fire",value:function e(t,r,i){if(!this.listens(t,i)){return this}var n=f.extend({},r,{type:t,target:this,sourceTarget:r&&r.sourceTarget||this});if(this._Evented){var a=this._Evented[t];if(a){this._firingCount=this._firingCount+1||1;for(var o=0,s=a.length;o<s;o++){var l=a[o];l.fn.call(l.ctx||this,n)}this._firingCount--}}if(i){this._propagateEvent(n)}return this}},{key:"listens",value:function e(t,r){var i=this._Evented&&this._Evented[t];if(i&&i.length){return true}if(r){for(var n in this._eventParents){if(this._eventParents[n].listens(t,r)){return true}}}return false}},{key:"once",value:function e(t,r,i){if((typeof t==="undefined"?"undefined":(0,n.default)(t))==="object"){for(var a in t){this.once(a,t[a],r)}return this}var o=f.bind(function(){this.off(t,r,i).off(t,o,i)},this);return this.on(t,r,i).on(t,o,i)}},{key:"addEventParent",value:function e(t){this._eventParents=this._eventParents||{};this._eventParents[f.stamp(t)]=t;return this}},{key:"removeEventParent",value:function e(t){if(this._eventParents){delete this._eventParents[f.stamp(t)]}return this}},{key:"_propagateEvent",value:function e(t){for(var r in this._eventParents){this._eventParents[r].fire(t.type,f.extend({layer:t.target,propagatedFrom:t.target},t),true)}}}]);return e}();p.addEventListener=p.on;p.removeEventListener=p.clearAllEventListeners=p.off;p.addOneTimeEventListener=p.once;p.fireEvent=p.fire;p.hasEventListeners=p.listens},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.cancelFn=t.requestFn=t.emptyImageUrl=t.isArray=t.lastId=t.create=t.endsWith=t.extendFromArray=t.appendUrl=t.extend=t.Util=undefined;var i=r(85);var n=l(i);var a=r(401);var o=l(a);t.bind=v;t.stamp=m;t.throttle=g;t.wrapNum=_;t.falseFn=x;t.formatNum=b;t.trim=w;t.splitWords=S;t.setOptions=C;t.getParamString=T;t.template=M;t.indexOf=A;t.requestAnimFrame=F;t.cancelAnimFrame=O;var s=r(39);function l(e){return e&&e.__esModule?e:{default:e}}var u=t.Util=s.Zondy.Util=s.Zondy.Util||{};var f=t.extend=function e(t,r){t=t||{};if(r){for(var i in r){var n=r[i];if(n!==undefined){t[i]=n}}var a=typeof window.Event==="function"&&r instanceof window.Event;if(!a&&r.hasOwnProperty&&r.hasOwnProperty("toString")){t.toString=r.toString}}return t};var c=t.appendUrl=function e(t,r){var i=t;if(r){var n=(t+" ").split(/[?&]/);i+=n.pop()===" "?r:n.length?"&"+r:"?"+r}return i};var h=t.extendFromArray=function e(t,r){var i=true;var n=false;var a=undefined;try{for(var s=(0,o.default)(r),l;!(i=(l=s.next()).done);i=true){var u=l.value;for(var f in u){t[f]=u[f]}}}catch(e){n=true;a=e}finally{try{if(!i&&s.return){s.return()}}finally{if(n){throw a}}}return t};var p=t.endsWith=function e(t,r){return t.indexOf(r,t.length-r.length)!==-1};var d=t.create=n.default||function(){function e(){}return function(t){e.prototype=t;return new e}}();function v(e,t){var r=Array.prototype.slice;if(e.bind){return e.bind.apply(e,r.call(arguments,1))}var i=r.call(arguments,2);return function(){return e.apply(t,i.length?i.concat(r.call(arguments)):arguments)}}var y=t.lastId=0;function m(e){e._leaflet_id=e._leaflet_id||(t.lastId=y+=1);return e._leaflet_id}function g(e,t,r){var i,n,a,o;o=function e(){i=false;if(n){a.apply(r,n);n=false}};a=function a(){if(i){n=arguments}else{e.apply(r,arguments);setTimeout(o,t);i=true}};return a}function _(e,t,r){var i=t[1],n=t[0],a=i-n;return e===i&&r?e:((e-n)%a+a)%a+n}function x(){return false}function b(e,t){var r=Math.pow(10,t===undefined?6:t);return Math.round(e*r)/r}function w(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function S(e){return w(e).split(/\s+/)}function C(e,t){if(!e.hasOwnProperty("options")){e.options=e.options?d(e.options):{}}for(var r in t){e.options[r]=t[r]}return e.options}function T(e,t,r){var i=[];for(var n in e){i.push(encodeURIComponent(r?n.toUpperCase():n)+"="+encodeURIComponent(e[n]))}return(!t||t.indexOf("?")===-1?"?":"&")+i.join("&")}var P=/\{ *([\w_-]+) *\}/g;function M(e,t){return e.replace(P,function(e,r){var i=t[r];if(i===undefined){throw new Error("No value provided for variable "+e)}else if(typeof i==="function"){i=i(t)}return i})}var I=t.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function A(e,t){for(var r=0;r<e.length;r++){if(e[r]===t){return r}}return-1}var L=t.emptyImageUrl="data:image/gifbase64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function E(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}var k=0;function D(e){var t=+new Date,r=Math.max(0,16-(t-k));k=t+r;return window.setTimeout(e,r)}var B=t.requestFn=window.requestAnimationFrame||E("RequestAnimationFrame")||D;var R=t.cancelFn=window.cancelAnimationFrame||E("CancelAnimationFrame")||E("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)};function F(e,t,r){if(r&&B===D){e.call(t)}else{return B.call(window,v(e,t))}}function O(e){if(e){R.call(window,e)}}s.Zondy.Util.extend=f;s.Zondy.Util.appendUrl=c;s.Zondy.Util.endsWith=p;s.Zondy.Util.extendFromArray=h},function(e,t,r){e.exports={default:r(402),__esModule:true}},function(e,t,r){r(88);r(87);e.exports=r(403)},function(e,t,r){var i=r(23);var n=r(160);e.exports=r(8).getIterator=function(e){var t=n(e);if(typeof t!="function")throw TypeError(e+" is not iterable!");return i(t.call(e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MapvStreamLayer=undefined;var i=r(1);var n=f(i);var a=r(5);var o=f(a);var s=r(21);var l=f(s);var u=r(219);function f(e){return e&&e.__esModule?e:{default:e}}var c=t.MapvStreamLayer=function(){function e(t,r,i){(0,n.default)(this,e);i=i||{};this.mapvOption=i.mapvOption||{};this.data=[];this.lastDate=new Date;this.url=r;this.fieldHash={};this.fieldDeg=i.fieldDeg;this.iconUrl=i.iconUrl;this.timeSpeed=i.timeSpeed||100;this.createIcon();this.layer=new u.MapvLayer(t,new window.mapv.DataSet([]),this.mapvOption,i)}(0,o.default)(e,[{key:"onMessage",value:function e(t){var r=t.feature;var i=t.feature.properties[this.options.field];var n=this.parasIcon(r);if(i!==undefined&&this.fieldHash[i]){this.data[this.fieldHash[i]]=n}else{if(i!==undefined){this.data.push(n);this.fieldHash[i]=this.data.length-1}}this.updateLayer()}},{key:"createIcon",value:function e(){var t=this.iconUrl||"http://client.snanyun.com:8899/img/leaflet/marker/bike.png";this.icon=new Image;this.icon.src=t}},{key:"parasIcon",value:function e(t){this.mapvOption={draw:"icon"};var r=t.properties[this.fieldDeg]||0;var i={geometry:{type:"Point",coordinates:t.geometry.coordinates},deg:r,icon:this.icon};return i}},{key:"updateLayer",value:function e(){var t=new Date;if(t-this.lastDate<this.timeSpeed)return;this.updateData(this.data,this.mapvOption);this.lastDate=t}}]);return e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GeojsonStreamLayer=undefined;var i=r(128);var n=c(i);var a=r(1);var o=c(a);var s=r(5);var l=c(s);var u=r(21);var f=c(u);function c(e){return e&&e.__esModule?e:{default:e}}var h=t.GeojsonStreamLayer=function(){function e(t,r,i){(0,o.default)(this,e);i=i||{};this.map=t;this.url=r;this.options=i;this.icon=i?i.icon:"rocket-15";this.data={type:"FeatureCollection",features:[]};this.fieldHash={};this.bindData()}(0,l.default)(e,[{key:"getPopupHtml",value:function e(t){var r="";(0,n.default)(t.features[0].properties).map(function(e){r+="<div class='mapgis-inspect-layer-popup-li'>\n        <div class='mapgis-inspect-layer-popup-type'>"+e+"</div>\n        <div class='mapgis-inspect-layer-popup-value'>"+t.features[0].properties[e]+"</div>\n      </div>";return undefined});return"\n      <div class='mapgis-inspect-layer-popup-list'>\n        <div class='mapgis-inspect-layer-popup-li'>\n          <div class='mapgis-inspect-layer-popup-type'>经度</div>\n          <div class='mapgis-inspect-layer-popup-value'>"+t.lngLat.lng+"</div>\n        </div>\n        <div class='mapgis-inspect-layer-popup-li'>\n          <div class='mapgis-inspect-layer-popup-type'>纬度</div>\n          <div class='mapgis-inspect-layer-popup-value'>"+t.lngLat.lat+"</div>\n        </div>\n        <div class='mapgis-inspect-layer-popup-li'>\n          <div class='mapgis-inspect-layer-popup-type'>屏幕像素X</div>\n          <div class='mapgis-inspect-layer-popup-value'>"+t.point.x+"</div>\n        </div>\n        <div class='mapgis-inspect-layer-popup-li'>\n          <div class='mapgis-inspect-layer-popup-type'>屏幕像素Y</div>\n          <div class='mapgis-inspect-layer-popup-value'>"+t.point.y+"</div>\n        </div>\n      </div>\n      "+r}},{key:"bindData",value:function e(){var t=this.map;var r=this;t.addSource("webclient-mapboxgl-stream",{type:"geojson",data:this.data});t.addLayer({id:"webclient-mapboxgl-stream",type:"symbol",source:"webclient-mapboxgl-stream",layout:{"icon-image":this.icon}});t.on("click","webclient-mapboxgl-stream",function(e){console.log("stream item",e);(new f.default.Popup).setLngLat(e.lngLat).setHTML(r.getPopupHtml(e)).addTo(t)});t.on("mouseenter","webclient-mapboxgl-stream",function(){t.getCanvas().style.cursor="pointer"});t.on("mouseleave","webclient-mapboxgl-stream",function(){t.getCanvas().style.cursor=""})}},{key:"unbindData",value:function e(){var t=this.map;t.removeLayer("webclient-mapboxgl-stream");t.removeSource("webclient-mapboxgl-stream")}},{key:"onMessage",value:function e(t){var r=t.feature;var i=t.feature.properties[this.options.field];var n=r;if(!i)return;if(this.fieldHash[i]){this.data.features[this.fieldHash[i]]=n}else{this.data.features.push(n);this.fieldHash[i]=this.data.features.length-1}this.map.getSource("webclient-mapboxgl-stream").setData(this.data);if(this.options.onEachFeature){}}},{key:"parasFeature",value:function e(t,r){}}]);return e}()}]);